var wg=p=>{throw TypeError(p)};var Eu=(p,t,i)=>t.has(p)||wg("Cannot "+i);var Yt=(p,t,i)=>(Eu(p,t,"read from private field"),i?i.call(p):t.get(p)),Ai=(p,t,i)=>t.has(p)?wg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(p):t.set(p,i),Pe=(p,t,i,s)=>(Eu(p,t,"write to private field"),s?s.call(p,i):t.set(p,i),i),Si=(p,t,i)=>(Eu(p,t,"access private method"),i);var _g=(p,t,i,s)=>({set _(r){Pe(p,t,r,i)},get _(){return Yt(p,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=i(r);fetch(r.href,l)}})();function My(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var Tu={exports:{}},Wa={};var Eg;function Ry(){if(Eg)return Wa;Eg=1;var p=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var u in r)u!=="key"&&(l[u]=r[u])}else l=r;return r=l.ref,{$$typeof:p,type:s,key:c,ref:r!==void 0?r:null,props:l}}return Wa.Fragment=t,Wa.jsx=i,Wa.jsxs=i,Wa}var Tg;function Dy(){return Tg||(Tg=1,Tu.exports=Ry()),Tu.exports}var T=Dy(),Cu={exports:{}},ft={};var Cg;function Ny(){if(Cg)return ft;Cg=1;var p=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),y=Symbol.iterator;function A(D){return D===null||typeof D!="object"?null:(D=y&&D[y]||D["@@iterator"],typeof D=="function"?D:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function w(D,H,$){this.props=D,this.context=H,this.refs=E,this.updater=$||x}w.prototype.isReactComponent={},w.prototype.setState=function(D,H){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,H,"setState")},w.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function R(){}R.prototype=w.prototype;function C(D,H,$){this.props=D,this.context=H,this.refs=E,this.updater=$||x}var k=C.prototype=new R;k.constructor=C,S(k,w.prototype),k.isPureReactComponent=!0;var L=Array.isArray;function O(){}var P={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function K(D,H,$){var tt=$.ref;return{$$typeof:p,type:D,key:H,ref:tt!==void 0?tt:null,props:$}}function J(D,H){return K(D.type,H,D.props)}function Q(D){return typeof D=="object"&&D!==null&&D.$$typeof===p}function Z(D){var H={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function($){return H[$]})}var ht=/\/+/g;function vt(D,H){return typeof D=="object"&&D!==null&&D.key!=null?Z(""+D.key):H.toString(36)}function At(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(O,O):(D.status="pending",D.then(function(H){D.status==="pending"&&(D.status="fulfilled",D.value=H)},function(H){D.status==="pending"&&(D.status="rejected",D.reason=H)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function z(D,H,$,tt,lt){var ut=typeof D;(ut==="undefined"||ut==="boolean")&&(D=null);var ot=!1;if(D===null)ot=!0;else switch(ut){case"bigint":case"string":case"number":ot=!0;break;case"object":switch(D.$$typeof){case p:case t:ot=!0;break;case m:return ot=D._init,z(ot(D._payload),H,$,tt,lt)}}if(ot)return lt=lt(D),ot=tt===""?"."+vt(D,0):tt,L(lt)?($="",ot!=null&&($=ot.replace(ht,"$&/")+"/"),z(lt,H,$,"",function(Rn){return Rn})):lt!=null&&(Q(lt)&&(lt=J(lt,$+(lt.key==null||D&&D.key===lt.key?"":(""+lt.key).replace(ht,"$&/")+"/")+ot)),H.push(lt)),1;ot=0;var te=tt===""?".":tt+":";if(L(D))for(var jt=0;jt<D.length;jt++)tt=D[jt],ut=te+vt(tt,jt),ot+=z(tt,H,$,ut,lt);else if(jt=A(D),typeof jt=="function")for(D=jt.call(D),jt=0;!(tt=D.next()).done;)tt=tt.value,ut=te+vt(tt,jt++),ot+=z(tt,H,$,ut,lt);else if(ut==="object"){if(typeof D.then=="function")return z(At(D),H,$,tt,lt);throw H=String(D),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return ot}function V(D,H,$){if(D==null)return D;var tt=[],lt=0;return z(D,tt,"","",function(ut){return H.call($,ut,lt++)}),tt}function W(D){if(D._status===-1){var H=D._result;H=H(),H.then(function($){(D._status===0||D._status===-1)&&(D._status=1,D._result=$)},function($){(D._status===0||D._status===-1)&&(D._status=2,D._result=$)}),D._status===-1&&(D._status=0,D._result=H)}if(D._status===1)return D._result.default;throw D._result}var dt=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},St={map:V,forEach:function(D,H,$){V(D,function(){H.apply(this,arguments)},$)},count:function(D){var H=0;return V(D,function(){H++}),H},toArray:function(D){return V(D,function(H){return H})||[]},only:function(D){if(!Q(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return ft.Activity=b,ft.Children=St,ft.Component=w,ft.Fragment=i,ft.Profiler=r,ft.PureComponent=C,ft.StrictMode=s,ft.Suspense=h,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,ft.__COMPILER_RUNTIME={__proto__:null,c:function(D){return P.H.useMemoCache(D)}},ft.cache=function(D){return function(){return D.apply(null,arguments)}},ft.cacheSignal=function(){return null},ft.cloneElement=function(D,H,$){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var tt=S({},D.props),lt=D.key;if(H!=null)for(ut in H.key!==void 0&&(lt=""+H.key),H)!q.call(H,ut)||ut==="key"||ut==="__self"||ut==="__source"||ut==="ref"&&H.ref===void 0||(tt[ut]=H[ut]);var ut=arguments.length-2;if(ut===1)tt.children=$;else if(1<ut){for(var ot=Array(ut),te=0;te<ut;te++)ot[te]=arguments[te+2];tt.children=ot}return K(D.type,lt,tt)},ft.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:l,_context:D},D},ft.createElement=function(D,H,$){var tt,lt={},ut=null;if(H!=null)for(tt in H.key!==void 0&&(ut=""+H.key),H)q.call(H,tt)&&tt!=="key"&&tt!=="__self"&&tt!=="__source"&&(lt[tt]=H[tt]);var ot=arguments.length-2;if(ot===1)lt.children=$;else if(1<ot){for(var te=Array(ot),jt=0;jt<ot;jt++)te[jt]=arguments[jt+2];lt.children=te}if(D&&D.defaultProps)for(tt in ot=D.defaultProps,ot)lt[tt]===void 0&&(lt[tt]=ot[tt]);return K(D,ut,lt)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(D){return{$$typeof:u,render:D}},ft.isValidElement=Q,ft.lazy=function(D){return{$$typeof:m,_payload:{_status:-1,_result:D},_init:W}},ft.memo=function(D,H){return{$$typeof:f,type:D,compare:H===void 0?null:H}},ft.startTransition=function(D){var H=P.T,$={};P.T=$;try{var tt=D(),lt=P.S;lt!==null&&lt($,tt),typeof tt=="object"&&tt!==null&&typeof tt.then=="function"&&tt.then(O,dt)}catch(ut){dt(ut)}finally{H!==null&&$.types!==null&&(H.types=$.types),P.T=H}},ft.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},ft.use=function(D){return P.H.use(D)},ft.useActionState=function(D,H,$){return P.H.useActionState(D,H,$)},ft.useCallback=function(D,H){return P.H.useCallback(D,H)},ft.useContext=function(D){return P.H.useContext(D)},ft.useDebugValue=function(){},ft.useDeferredValue=function(D,H){return P.H.useDeferredValue(D,H)},ft.useEffect=function(D,H){return P.H.useEffect(D,H)},ft.useEffectEvent=function(D){return P.H.useEffectEvent(D)},ft.useId=function(){return P.H.useId()},ft.useImperativeHandle=function(D,H,$){return P.H.useImperativeHandle(D,H,$)},ft.useInsertionEffect=function(D,H){return P.H.useInsertionEffect(D,H)},ft.useLayoutEffect=function(D,H){return P.H.useLayoutEffect(D,H)},ft.useMemo=function(D,H){return P.H.useMemo(D,H)},ft.useOptimistic=function(D,H){return P.H.useOptimistic(D,H)},ft.useReducer=function(D,H,$){return P.H.useReducer(D,H,$)},ft.useRef=function(D){return P.H.useRef(D)},ft.useState=function(D){return P.H.useState(D)},ft.useSyncExternalStore=function(D,H,$){return P.H.useSyncExternalStore(D,H,$)},ft.useTransition=function(){return P.H.useTransition()},ft.version="19.2.3",ft}var Mg;function ah(){return Mg||(Mg=1,Cu.exports=Ny()),Cu.exports}var Zt=ah();const Ly=My(Zt);var Mu={exports:{}},Qa={},Ru={exports:{}},Du={};var Rg;function Oy(){return Rg||(Rg=1,(function(p){function t(z,V){var W=z.length;z.push(V);t:for(;0<W;){var dt=W-1>>>1,St=z[dt];if(0<r(St,V))z[dt]=V,z[W]=St,W=dt;else break t}}function i(z){return z.length===0?null:z[0]}function s(z){if(z.length===0)return null;var V=z[0],W=z.pop();if(W!==V){z[0]=W;t:for(var dt=0,St=z.length,D=St>>>1;dt<D;){var H=2*(dt+1)-1,$=z[H],tt=H+1,lt=z[tt];if(0>r($,W))tt<St&&0>r(lt,$)?(z[dt]=lt,z[tt]=W,dt=tt):(z[dt]=$,z[H]=W,dt=H);else if(tt<St&&0>r(lt,W))z[dt]=lt,z[tt]=W,dt=tt;else break t}}return V}function r(z,V){var W=z.sortIndex-V.sortIndex;return W!==0?W:z.id-V.id}if(p.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;p.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();p.unstable_now=function(){return c.now()-u}}var h=[],f=[],m=1,b=null,y=3,A=!1,x=!1,S=!1,E=!1,w=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function k(z){for(var V=i(f);V!==null;){if(V.callback===null)s(f);else if(V.startTime<=z)s(f),V.sortIndex=V.expirationTime,t(h,V);else break;V=i(f)}}function L(z){if(S=!1,k(z),!x)if(i(h)!==null)x=!0,O||(O=!0,Z());else{var V=i(f);V!==null&&At(L,V.startTime-z)}}var O=!1,P=-1,q=5,K=-1;function J(){return E?!0:!(p.unstable_now()-K<q)}function Q(){if(E=!1,O){var z=p.unstable_now();K=z;var V=!0;try{t:{x=!1,S&&(S=!1,R(P),P=-1),A=!0;var W=y;try{e:{for(k(z),b=i(h);b!==null&&!(b.expirationTime>z&&J());){var dt=b.callback;if(typeof dt=="function"){b.callback=null,y=b.priorityLevel;var St=dt(b.expirationTime<=z);if(z=p.unstable_now(),typeof St=="function"){b.callback=St,k(z),V=!0;break e}b===i(h)&&s(h),k(z)}else s(h);b=i(h)}if(b!==null)V=!0;else{var D=i(f);D!==null&&At(L,D.startTime-z),V=!1}}break t}finally{b=null,y=W,A=!1}V=void 0}}finally{V?Z():O=!1}}}var Z;if(typeof C=="function")Z=function(){C(Q)};else if(typeof MessageChannel<"u"){var ht=new MessageChannel,vt=ht.port2;ht.port1.onmessage=Q,Z=function(){vt.postMessage(null)}}else Z=function(){w(Q,0)};function At(z,V){P=w(function(){z(p.unstable_now())},V)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(z){z.callback=null},p.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<z?Math.floor(1e3/z):5},p.unstable_getCurrentPriorityLevel=function(){return y},p.unstable_next=function(z){switch(y){case 1:case 2:case 3:var V=3;break;default:V=y}var W=y;y=V;try{return z()}finally{y=W}},p.unstable_requestPaint=function(){E=!0},p.unstable_runWithPriority=function(z,V){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var W=y;y=z;try{return V()}finally{y=W}},p.unstable_scheduleCallback=function(z,V,W){var dt=p.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?dt+W:dt):W=dt,z){case 1:var St=-1;break;case 2:St=250;break;case 5:St=1073741823;break;case 4:St=1e4;break;default:St=5e3}return St=W+St,z={id:m++,callback:V,priorityLevel:z,startTime:W,expirationTime:St,sortIndex:-1},W>dt?(z.sortIndex=W,t(f,z),i(h)===null&&z===i(f)&&(S?(R(P),P=-1):S=!0,At(L,W-dt))):(z.sortIndex=St,t(h,z),x||A||(x=!0,O||(O=!0,Z()))),z},p.unstable_shouldYield=J,p.unstable_wrapCallback=function(z){var V=y;return function(){var W=y;y=V;try{return z.apply(this,arguments)}finally{y=W}}}})(Du)),Du}var Dg;function ky(){return Dg||(Dg=1,Ru.exports=Oy()),Ru.exports}var Nu={exports:{}},_e={};var Ng;function By(){if(Ng)return _e;Ng=1;var p=ah();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(h,f,m){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:b==null?null:""+b,children:h,containerInfo:f,implementation:m}}var c=p.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return _e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,_e.createPortal=function(h,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(h,f,null,m)},_e.flushSync=function(h){var f=c.T,m=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=f,s.p=m,s.d.f()}},_e.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(h,f))},_e.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},_e.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var m=f.as,b=u(m,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?s.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:b,integrity:y,fetchPriority:A}):m==="script"&&s.d.X(h,{crossOrigin:b,integrity:y,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},_e.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=u(f.as,f.crossOrigin);s.d.M(h,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(h)},_e.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,b=u(m,f.crossOrigin);s.d.L(h,m,{crossOrigin:b,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},_e.preloadModule=function(h,f){if(typeof h=="string")if(f){var m=u(f.as,f.crossOrigin);s.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(h)},_e.requestFormReset=function(h){s.d.r(h)},_e.unstable_batchedUpdates=function(h,f){return h(f)},_e.useFormState=function(h,f,m){return c.H.useFormState(h,f,m)},_e.useFormStatus=function(){return c.H.useHostTransitionStatus()},_e.version="19.2.3",_e}var Lg;function zy(){if(Lg)return Nu.exports;Lg=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(t){console.error(t)}}return p(),Nu.exports=By(),Nu.exports}var Og;function Py(){if(Og)return Qa;Og=1;var p=ky(),t=ah(),i=zy();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var n=e,a=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(a=n.return),e=n.return;while(e)}return n.tag===3?a:null}function c(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function u(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(s(188))}function f(e){var n=e.alternate;if(!n){if(n=l(e),n===null)throw Error(s(188));return n!==e?null:e}for(var a=e,o=n;;){var d=a.return;if(d===null)break;var g=d.alternate;if(g===null){if(o=d.return,o!==null){a=o;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===a)return h(d),e;if(g===o)return h(d),n;g=g.sibling}throw Error(s(188))}if(a.return!==o.return)a=d,o=g;else{for(var v=!1,_=d.child;_;){if(_===a){v=!0,a=d,o=g;break}if(_===o){v=!0,o=d,a=g;break}_=_.sibling}if(!v){for(_=g.child;_;){if(_===a){v=!0,a=g,o=d;break}if(_===o){v=!0,o=g,a=d;break}_=_.sibling}if(!v)throw Error(s(189))}}if(a.alternate!==o)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:n}function m(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=m(e),n!==null)return n;e=e.sibling}return null}var b=Object.assign,y=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),C=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function Z(e){return e===null||typeof e!="object"?null:(e=Q&&e[Q]||e["@@iterator"],typeof e=="function"?e:null)}var ht=Symbol.for("react.client.reference");function vt(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ht?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case w:return"Profiler";case E:return"StrictMode";case L:return"Suspense";case O:return"SuspenseList";case K:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case x:return"Portal";case C:return e.displayName||"Context";case R:return(e._context.displayName||"Context")+".Consumer";case k:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case P:return n=e.displayName||null,n!==null?n:vt(e.type)||"Memo";case q:n=e._payload,e=e._init;try{return vt(e(n))}catch{}}return null}var At=Array.isArray,z=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},dt=[],St=-1;function D(e){return{current:e}}function H(e){0>St||(e.current=dt[St],dt[St]=null,St--)}function $(e,n){St++,dt[St]=e.current,e.current=n}var tt=D(null),lt=D(null),ut=D(null),ot=D(null);function te(e,n){switch($(ut,n),$(lt,e),$(tt,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Yp(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Yp(n),e=Xp(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}H(tt),$(tt,e)}function jt(){H(tt),H(lt),H(ut)}function Rn(e){e.memoizedState!==null&&$(ot,e);var n=tt.current,a=Xp(n,e.type);n!==a&&($(lt,e),$(tt,a))}function Ki(e){lt.current===e&&(H(tt),H(lt)),ot.current===e&&(H(ot),Ya._currentValue=W)}var Dn,na;function Ci(e){if(Dn===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);Dn=n&&n[1]||"",na=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Dn+e+na}var lo=!1;function oo(e,n){if(!e||lo)return"";lo=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(n){var X=function(){throw Error()};if(Object.defineProperty(X.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(X,[])}catch(I){var j=I}Reflect.construct(e,[],X)}else{try{X.call()}catch(I){j=I}e.call(X.prototype)}}else{try{throw Error()}catch(I){j=I}(X=e())&&typeof X.catch=="function"&&X.catch(function(){})}}catch(I){if(I&&j&&typeof I.stack=="string")return[I.stack,j.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=o.DetermineComponentFrameRoot(),v=g[0],_=g[1];if(v&&_){var M=v.split(`
`),U=_.split(`
`);for(d=o=0;o<M.length&&!M[o].includes("DetermineComponentFrameRoot");)o++;for(;d<U.length&&!U[d].includes("DetermineComponentFrameRoot");)d++;if(o===M.length||d===U.length)for(o=M.length-1,d=U.length-1;1<=o&&0<=d&&M[o]!==U[d];)d--;for(;1<=o&&0<=d;o--,d--)if(M[o]!==U[d]){if(o!==1||d!==1)do if(o--,d--,0>d||M[o]!==U[d]){var G=`
`+M[o].replace(" at new "," at ");return e.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",e.displayName)),G}while(1<=o&&0<=d);break}}}finally{lo=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Ci(a):""}function a0(e,n){switch(e.tag){case 26:case 27:case 5:return Ci(e.type);case 16:return Ci("Lazy");case 13:return e.child!==n&&n!==null?Ci("Suspense Fallback"):Ci("Suspense");case 19:return Ci("SuspenseList");case 0:case 15:return oo(e.type,!1);case 11:return oo(e.type.render,!1);case 1:return oo(e.type,!0);case 31:return Ci("Activity");default:return""}}function xh(e){try{var n="",a=null;do n+=a0(e,a),a=e,e=e.return;while(e);return n}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var co=Object.prototype.hasOwnProperty,uo=p.unstable_scheduleCallback,ho=p.unstable_cancelCallback,r0=p.unstable_shouldYield,l0=p.unstable_requestPaint,je=p.unstable_now,o0=p.unstable_getCurrentPriorityLevel,wh=p.unstable_ImmediatePriority,_h=p.unstable_UserBlockingPriority,Sr=p.unstable_NormalPriority,c0=p.unstable_LowPriority,Eh=p.unstable_IdlePriority,u0=p.log,h0=p.unstable_setDisableYieldValue,sa=null,Ie=null;function Wi(e){if(typeof u0=="function"&&h0(e),Ie&&typeof Ie.setStrictMode=="function")try{Ie.setStrictMode(sa,e)}catch{}}var He=Math.clz32?Math.clz32:p0,d0=Math.log,f0=Math.LN2;function p0(e){return e>>>=0,e===0?32:31-(d0(e)/f0|0)|0}var xr=256,wr=262144,_r=4194304;function Nn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Er(e,n,a){var o=e.pendingLanes;if(o===0)return 0;var d=0,g=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var _=o&134217727;return _!==0?(o=_&~g,o!==0?d=Nn(o):(v&=_,v!==0?d=Nn(v):a||(a=_&~e,a!==0&&(d=Nn(a))))):(_=o&~g,_!==0?d=Nn(_):v!==0?d=Nn(v):a||(a=o&~e,a!==0&&(d=Nn(a)))),d===0?0:n!==0&&n!==d&&(n&g)===0&&(g=d&-d,a=n&-n,g>=a||g===32&&(a&4194048)!==0)?n:d}function aa(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function g0(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Th(){var e=_r;return _r<<=1,(_r&62914560)===0&&(_r=4194304),e}function fo(e){for(var n=[],a=0;31>a;a++)n.push(e);return n}function ra(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function m0(e,n,a,o,d,g){var v=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var _=e.entanglements,M=e.expirationTimes,U=e.hiddenUpdates;for(a=v&~a;0<a;){var G=31-He(a),X=1<<G;_[G]=0,M[G]=-1;var j=U[G];if(j!==null)for(U[G]=null,G=0;G<j.length;G++){var I=j[G];I!==null&&(I.lane&=-536870913)}a&=~X}o!==0&&Ch(e,o,0),g!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=g&~(v&~n))}function Ch(e,n,a){e.pendingLanes|=n,e.suspendedLanes&=~n;var o=31-He(n);e.entangledLanes|=n,e.entanglements[o]=e.entanglements[o]|1073741824|a&261930}function Mh(e,n){var a=e.entangledLanes|=n;for(e=e.entanglements;a;){var o=31-He(a),d=1<<o;d&n|e[o]&n&&(e[o]|=n),a&=~d}}function Rh(e,n){var a=n&-n;return a=(a&42)!==0?1:po(a),(a&(e.suspendedLanes|n))!==0?0:a}function po(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function go(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Dh(){var e=V.p;return e!==0?e:(e=window.event,e===void 0?32:mg(e.type))}function Nh(e,n){var a=V.p;try{return V.p=e,n()}finally{V.p=a}}var Qi=Math.random().toString(36).slice(2),ge="__reactFiber$"+Qi,De="__reactProps$"+Qi,ss="__reactContainer$"+Qi,mo="__reactEvents$"+Qi,b0="__reactListeners$"+Qi,y0="__reactHandles$"+Qi,Lh="__reactResources$"+Qi,la="__reactMarker$"+Qi;function bo(e){delete e[ge],delete e[De],delete e[mo],delete e[b0],delete e[y0]}function as(e){var n=e[ge];if(n)return n;for(var a=e.parentNode;a;){if(n=a[ss]||a[ge]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(e=tg(e);e!==null;){if(a=e[ge])return a;e=tg(e)}return n}e=a,a=e.parentNode}return null}function rs(e){if(e=e[ge]||e[ss]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function oa(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function ls(e){var n=e[Lh];return n||(n=e[Lh]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function he(e){e[la]=!0}var Oh=new Set,kh={};function Ln(e,n){os(e,n),os(e+"Capture",n)}function os(e,n){for(kh[e]=n,e=0;e<n.length;e++)Oh.add(n[e])}var v0=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Bh={},zh={};function A0(e){return co.call(zh,e)?!0:co.call(Bh,e)?!1:v0.test(e)?zh[e]=!0:(Bh[e]=!0,!1)}function Tr(e,n,a){if(A0(n))if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var o=n.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+a)}}function Cr(e,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+a)}}function Mi(e,n,a,o){if(o===null)e.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(n,a,""+o)}}function Ze(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ph(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function S0(e,n,a){var o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var d=o.get,g=o.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return d.call(this)},set:function(v){a=""+v,g.call(this,v)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return a},setValue:function(v){a=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function yo(e){if(!e._valueTracker){var n=Ph(e)?"checked":"value";e._valueTracker=S0(e,n,""+e[n])}}function Fh(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var a=n.getValue(),o="";return e&&(o=Ph(e)?e.checked?"true":"false":e.value),e=o,e!==a?(n.setValue(e),!0):!1}function Mr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var x0=/[\n"\\]/g;function Je(e){return e.replace(x0,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function vo(e,n,a,o,d,g,v,_){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+Ze(n)):e.value!==""+Ze(n)&&(e.value=""+Ze(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?Ao(e,v,Ze(n)):a!=null?Ao(e,v,Ze(a)):o!=null&&e.removeAttribute("value"),d==null&&g!=null&&(e.defaultChecked=!!g),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?e.name=""+Ze(_):e.removeAttribute("name")}function Uh(e,n,a,o,d,g,v,_){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(e.type=g),n!=null||a!=null){if(!(g!=="submit"&&g!=="reset"||n!=null)){yo(e);return}a=a!=null?""+Ze(a):"",n=n!=null?""+Ze(n):a,_||n===e.value||(e.value=n),e.defaultValue=n}o=o??d,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=_?e.checked:!!o,e.defaultChecked=!!o,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),yo(e)}function Ao(e,n,a){n==="number"&&Mr(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function cs(e,n,a,o){if(e=e.options,n){n={};for(var d=0;d<a.length;d++)n["$"+a[d]]=!0;for(a=0;a<e.length;a++)d=n.hasOwnProperty("$"+e[a].value),e[a].selected!==d&&(e[a].selected=d),d&&o&&(e[a].defaultSelected=!0)}else{for(a=""+Ze(a),n=null,d=0;d<e.length;d++){if(e[d].value===a){e[d].selected=!0,o&&(e[d].defaultSelected=!0);return}n!==null||e[d].disabled||(n=e[d])}n!==null&&(n.selected=!0)}}function jh(e,n,a){if(n!=null&&(n=""+Ze(n),n!==e.value&&(e.value=n),a==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=a!=null?""+Ze(a):""}function Ih(e,n,a,o){if(n==null){if(o!=null){if(a!=null)throw Error(s(92));if(At(o)){if(1<o.length)throw Error(s(93));o=o[0]}a=o}a==null&&(a=""),n=a}a=Ze(n),e.defaultValue=a,o=e.textContent,o===a&&o!==""&&o!==null&&(e.value=o),yo(e)}function us(e,n){if(n){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=n;return}}e.textContent=n}var w0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Hh(e,n,a){var o=n.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?o?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":o?e.setProperty(n,a):typeof a!="number"||a===0||w0.has(n)?n==="float"?e.cssFloat=a:e[n]=(""+a).trim():e[n]=a+"px"}function Gh(e,n,a){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,a!=null){for(var o in a)!a.hasOwnProperty(o)||n!=null&&n.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var d in n)o=n[d],n.hasOwnProperty(d)&&a[d]!==o&&Hh(e,d,o)}else for(var g in n)n.hasOwnProperty(g)&&Hh(e,g,n[g])}function So(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),E0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Rr(e){return E0.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ri(){}var xo=null;function wo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hs=null,ds=null;function Vh(e){var n=rs(e);if(n&&(e=n.stateNode)){var a=e[De]||null;t:switch(e=n.stateNode,n.type){case"input":if(vo(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),n=a.name,a.type==="radio"&&n!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Je(""+n)+'"][type="radio"]'),n=0;n<a.length;n++){var o=a[n];if(o!==e&&o.form===e.form){var d=o[De]||null;if(!d)throw Error(s(90));vo(o,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(n=0;n<a.length;n++)o=a[n],o.form===e.form&&Fh(o)}break t;case"textarea":jh(e,a.value,a.defaultValue);break t;case"select":n=a.value,n!=null&&cs(e,!!a.multiple,n,!1)}}}var _o=!1;function qh(e,n,a){if(_o)return e(n,a);_o=!0;try{var o=e(n);return o}finally{if(_o=!1,(hs!==null||ds!==null)&&(ml(),hs&&(n=hs,e=ds,ds=hs=null,Vh(n),e)))for(n=0;n<e.length;n++)Vh(e[n])}}function ca(e,n){var a=e.stateNode;if(a===null)return null;var o=a[De]||null;if(o===null)return null;a=o[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,n,typeof a));return a}var Di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Eo=!1;if(Di)try{var ua={};Object.defineProperty(ua,"passive",{get:function(){Eo=!0}}),window.addEventListener("test",ua,ua),window.removeEventListener("test",ua,ua)}catch{Eo=!1}var Zi=null,To=null,Dr=null;function Yh(){if(Dr)return Dr;var e,n=To,a=n.length,o,d="value"in Zi?Zi.value:Zi.textContent,g=d.length;for(e=0;e<a&&n[e]===d[e];e++);var v=a-e;for(o=1;o<=v&&n[a-o]===d[g-o];o++);return Dr=d.slice(e,1<o?1-o:void 0)}function Nr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Lr(){return!0}function Xh(){return!1}function Ne(e){function n(a,o,d,g,v){this._reactName=a,this._targetInst=d,this.type=o,this.nativeEvent=g,this.target=v,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(a=e[_],this[_]=a?a(g):g[_]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Lr:Xh,this.isPropagationStopped=Xh,this}return b(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Lr)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Lr)},persist:function(){},isPersistent:Lr}),n}var On={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Or=Ne(On),ha=b({},On,{view:0,detail:0}),T0=Ne(ha),Co,Mo,da,kr=b({},ha,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Do,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==da&&(da&&e.type==="mousemove"?(Co=e.screenX-da.screenX,Mo=e.screenY-da.screenY):Mo=Co=0,da=e),Co)},movementY:function(e){return"movementY"in e?e.movementY:Mo}}),$h=Ne(kr),C0=b({},kr,{dataTransfer:0}),M0=Ne(C0),R0=b({},ha,{relatedTarget:0}),Ro=Ne(R0),D0=b({},On,{animationName:0,elapsedTime:0,pseudoElement:0}),N0=Ne(D0),L0=b({},On,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),O0=Ne(L0),k0=b({},On,{data:0}),Kh=Ne(k0),B0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},P0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function F0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=P0[e])?!!n[e]:!1}function Do(){return F0}var U0=b({},ha,{key:function(e){if(e.key){var n=B0[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Nr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?z0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Do,charCode:function(e){return e.type==="keypress"?Nr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),j0=Ne(U0),I0=b({},kr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wh=Ne(I0),H0=b({},ha,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Do}),G0=Ne(H0),V0=b({},On,{propertyName:0,elapsedTime:0,pseudoElement:0}),q0=Ne(V0),Y0=b({},kr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),X0=Ne(Y0),$0=b({},On,{newState:0,oldState:0}),K0=Ne($0),W0=[9,13,27,32],No=Di&&"CompositionEvent"in window,fa=null;Di&&"documentMode"in document&&(fa=document.documentMode);var Q0=Di&&"TextEvent"in window&&!fa,Qh=Di&&(!No||fa&&8<fa&&11>=fa),Zh=" ",Jh=!1;function td(e,n){switch(e){case"keyup":return W0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ed(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fs=!1;function Z0(e,n){switch(e){case"compositionend":return ed(n);case"keypress":return n.which!==32?null:(Jh=!0,Zh);case"textInput":return e=n.data,e===Zh&&Jh?null:e;default:return null}}function J0(e,n){if(fs)return e==="compositionend"||!No&&td(e,n)?(e=Yh(),Dr=To=Zi=null,fs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Qh&&n.locale!=="ko"?null:n.data;default:return null}}var tb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function id(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!tb[e.type]:n==="textarea"}function nd(e,n,a,o){hs?ds?ds.push(o):ds=[o]:hs=o,n=wl(n,"onChange"),0<n.length&&(a=new Or("onChange","change",null,a,o),e.push({event:a,listeners:n}))}var pa=null,ga=null;function eb(e){jp(e,0)}function Br(e){var n=oa(e);if(Fh(n))return e}function sd(e,n){if(e==="change")return n}var ad=!1;if(Di){var Lo;if(Di){var Oo="oninput"in document;if(!Oo){var rd=document.createElement("div");rd.setAttribute("oninput","return;"),Oo=typeof rd.oninput=="function"}Lo=Oo}else Lo=!1;ad=Lo&&(!document.documentMode||9<document.documentMode)}function ld(){pa&&(pa.detachEvent("onpropertychange",od),ga=pa=null)}function od(e){if(e.propertyName==="value"&&Br(ga)){var n=[];nd(n,ga,e,wo(e)),qh(eb,n)}}function ib(e,n,a){e==="focusin"?(ld(),pa=n,ga=a,pa.attachEvent("onpropertychange",od)):e==="focusout"&&ld()}function nb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Br(ga)}function sb(e,n){if(e==="click")return Br(n)}function ab(e,n){if(e==="input"||e==="change")return Br(n)}function rb(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Ge=typeof Object.is=="function"?Object.is:rb;function ma(e,n){if(Ge(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var a=Object.keys(e),o=Object.keys(n);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var d=a[o];if(!co.call(n,d)||!Ge(e[d],n[d]))return!1}return!0}function cd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ud(e,n){var a=cd(e);e=0;for(var o;a;){if(a.nodeType===3){if(o=e+a.textContent.length,e<=n&&o>=n)return{node:a,offset:n-e};e=o}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=cd(a)}}function hd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?hd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function dd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=Mr(e.document);n instanceof e.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)e=n.contentWindow;else break;n=Mr(e.document)}return n}function ko(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var lb=Di&&"documentMode"in document&&11>=document.documentMode,ps=null,Bo=null,ba=null,zo=!1;function fd(e,n,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;zo||ps==null||ps!==Mr(o)||(o=ps,"selectionStart"in o&&ko(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),ba&&ma(ba,o)||(ba=o,o=wl(Bo,"onSelect"),0<o.length&&(n=new Or("onSelect","select",null,n,a),e.push({event:n,listeners:o}),n.target=ps)))}function kn(e,n){var a={};return a[e.toLowerCase()]=n.toLowerCase(),a["Webkit"+e]="webkit"+n,a["Moz"+e]="moz"+n,a}var gs={animationend:kn("Animation","AnimationEnd"),animationiteration:kn("Animation","AnimationIteration"),animationstart:kn("Animation","AnimationStart"),transitionrun:kn("Transition","TransitionRun"),transitionstart:kn("Transition","TransitionStart"),transitioncancel:kn("Transition","TransitionCancel"),transitionend:kn("Transition","TransitionEnd")},Po={},pd={};Di&&(pd=document.createElement("div").style,"AnimationEvent"in window||(delete gs.animationend.animation,delete gs.animationiteration.animation,delete gs.animationstart.animation),"TransitionEvent"in window||delete gs.transitionend.transition);function Bn(e){if(Po[e])return Po[e];if(!gs[e])return e;var n=gs[e],a;for(a in n)if(n.hasOwnProperty(a)&&a in pd)return Po[e]=n[a];return e}var gd=Bn("animationend"),md=Bn("animationiteration"),bd=Bn("animationstart"),ob=Bn("transitionrun"),cb=Bn("transitionstart"),ub=Bn("transitioncancel"),yd=Bn("transitionend"),vd=new Map,Fo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Fo.push("scrollEnd");function di(e,n){vd.set(e,n),Ln(n,[e])}var zr=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},ti=[],ms=0,Uo=0;function Pr(){for(var e=ms,n=Uo=ms=0;n<e;){var a=ti[n];ti[n++]=null;var o=ti[n];ti[n++]=null;var d=ti[n];ti[n++]=null;var g=ti[n];if(ti[n++]=null,o!==null&&d!==null){var v=o.pending;v===null?d.next=d:(d.next=v.next,v.next=d),o.pending=d}g!==0&&Ad(a,d,g)}}function Fr(e,n,a,o){ti[ms++]=e,ti[ms++]=n,ti[ms++]=a,ti[ms++]=o,Uo|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function jo(e,n,a,o){return Fr(e,n,a,o),Ur(e)}function zn(e,n){return Fr(e,null,null,n),Ur(e)}function Ad(e,n,a){e.lanes|=a;var o=e.alternate;o!==null&&(o.lanes|=a);for(var d=!1,g=e.return;g!==null;)g.childLanes|=a,o=g.alternate,o!==null&&(o.childLanes|=a),g.tag===22&&(e=g.stateNode,e===null||e._visibility&1||(d=!0)),e=g,g=g.return;return e.tag===3?(g=e.stateNode,d&&n!==null&&(d=31-He(a),e=g.hiddenUpdates,o=e[d],o===null?e[d]=[n]:o.push(n),n.lane=a|536870912),g):null}function Ur(e){if(50<Ua)throw Ua=0,Kc=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var bs={};function hb(e,n,a,o){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ve(e,n,a,o){return new hb(e,n,a,o)}function Io(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ni(e,n){var a=e.alternate;return a===null?(a=Ve(e.tag,n,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=n,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,n=e.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Sd(e,n){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,n=a.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function jr(e,n,a,o,d,g){var v=0;if(o=e,typeof e=="function")Io(e)&&(v=1);else if(typeof e=="string")v=my(e,a,tt.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case K:return e=Ve(31,a,n,d),e.elementType=K,e.lanes=g,e;case S:return Pn(a.children,d,g,n);case E:v=8,d|=24;break;case w:return e=Ve(12,a,n,d|2),e.elementType=w,e.lanes=g,e;case L:return e=Ve(13,a,n,d),e.elementType=L,e.lanes=g,e;case O:return e=Ve(19,a,n,d),e.elementType=O,e.lanes=g,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case C:v=10;break t;case R:v=9;break t;case k:v=11;break t;case P:v=14;break t;case q:v=16,o=null;break t}v=29,a=Error(s(130,e===null?"null":typeof e,"")),o=null}return n=Ve(v,a,n,d),n.elementType=e,n.type=o,n.lanes=g,n}function Pn(e,n,a,o){return e=Ve(7,e,o,n),e.lanes=a,e}function Ho(e,n,a){return e=Ve(6,e,null,n),e.lanes=a,e}function xd(e){var n=Ve(18,null,null,0);return n.stateNode=e,n}function Go(e,n,a){return n=Ve(4,e.children!==null?e.children:[],e.key,n),n.lanes=a,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var wd=new WeakMap;function ei(e,n){if(typeof e=="object"&&e!==null){var a=wd.get(e);return a!==void 0?a:(n={value:e,source:n,stack:xh(n)},wd.set(e,n),n)}return{value:e,source:n,stack:xh(n)}}var ys=[],vs=0,Ir=null,ya=0,ii=[],ni=0,Ji=null,mi=1,bi="";function Li(e,n){ys[vs++]=ya,ys[vs++]=Ir,Ir=e,ya=n}function _d(e,n,a){ii[ni++]=mi,ii[ni++]=bi,ii[ni++]=Ji,Ji=e;var o=mi;e=bi;var d=32-He(o)-1;o&=~(1<<d),a+=1;var g=32-He(n)+d;if(30<g){var v=d-d%5;g=(o&(1<<v)-1).toString(32),o>>=v,d-=v,mi=1<<32-He(n)+d|a<<d|o,bi=g+e}else mi=1<<g|a<<d|o,bi=e}function Vo(e){e.return!==null&&(Li(e,1),_d(e,1,0))}function qo(e){for(;e===Ir;)Ir=ys[--vs],ys[vs]=null,ya=ys[--vs],ys[vs]=null;for(;e===Ji;)Ji=ii[--ni],ii[ni]=null,bi=ii[--ni],ii[ni]=null,mi=ii[--ni],ii[ni]=null}function Ed(e,n){ii[ni++]=mi,ii[ni++]=bi,ii[ni++]=Ji,mi=n.id,bi=n.overflow,Ji=e}var me=null,Gt=null,Tt=!1,tn=null,si=!1,Yo=Error(s(519));function en(e){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw va(ei(n,e)),Yo}function Td(e){var n=e.stateNode,a=e.type,o=e.memoizedProps;switch(n[ge]=e,n[De]=o,a){case"dialog":wt("cancel",n),wt("close",n);break;case"iframe":case"object":case"embed":wt("load",n);break;case"video":case"audio":for(a=0;a<Ia.length;a++)wt(Ia[a],n);break;case"source":wt("error",n);break;case"img":case"image":case"link":wt("error",n),wt("load",n);break;case"details":wt("toggle",n);break;case"input":wt("invalid",n),Uh(n,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":wt("invalid",n);break;case"textarea":wt("invalid",n),Ih(n,o.value,o.defaultValue,o.children)}a=o.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||n.textContent===""+a||o.suppressHydrationWarning===!0||Vp(n.textContent,a)?(o.popover!=null&&(wt("beforetoggle",n),wt("toggle",n)),o.onScroll!=null&&wt("scroll",n),o.onScrollEnd!=null&&wt("scrollend",n),o.onClick!=null&&(n.onclick=Ri),n=!0):n=!1,n||en(e,!0)}function Cd(e){for(me=e.return;me;)switch(me.tag){case 5:case 31:case 13:si=!1;return;case 27:case 3:si=!0;return;default:me=me.return}}function As(e){if(e!==me)return!1;if(!Tt)return Cd(e),Tt=!0,!1;var n=e.tag,a;if((a=n!==3&&n!==27)&&((a=n===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||uu(e.type,e.memoizedProps)),a=!a),a&&Gt&&en(e),Cd(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Gt=Jp(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Gt=Jp(e)}else n===27?(n=Gt,mn(e.type)?(e=gu,gu=null,Gt=e):Gt=n):Gt=me?ri(e.stateNode.nextSibling):null;return!0}function Fn(){Gt=me=null,Tt=!1}function Xo(){var e=tn;return e!==null&&(Be===null?Be=e:Be.push.apply(Be,e),tn=null),e}function va(e){tn===null?tn=[e]:tn.push(e)}var $o=D(null),Un=null,Oi=null;function nn(e,n,a){$($o,n._currentValue),n._currentValue=a}function ki(e){e._currentValue=$o.current,H($o)}function Ko(e,n,a){for(;e!==null;){var o=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),e===a)break;e=e.return}}function Wo(e,n,a,o){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var g=d.dependencies;if(g!==null){var v=d.child;g=g.firstContext;t:for(;g!==null;){var _=g;g=d;for(var M=0;M<n.length;M++)if(_.context===n[M]){g.lanes|=a,_=g.alternate,_!==null&&(_.lanes|=a),Ko(g.return,a,e),o||(v=null);break t}g=_.next}}else if(d.tag===18){if(v=d.return,v===null)throw Error(s(341));v.lanes|=a,g=v.alternate,g!==null&&(g.lanes|=a),Ko(v,a,e),v=null}else v=d.child;if(v!==null)v.return=d;else for(v=d;v!==null;){if(v===e){v=null;break}if(d=v.sibling,d!==null){d.return=v.return,v=d;break}v=v.return}d=v}}function Ss(e,n,a,o){e=null;for(var d=n,g=!1;d!==null;){if(!g){if((d.flags&524288)!==0)g=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var v=d.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var _=d.type;Ge(d.pendingProps.value,v.value)||(e!==null?e.push(_):e=[_])}}else if(d===ot.current){if(v=d.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(Ya):e=[Ya])}d=d.return}e!==null&&Wo(n,e,a,o),n.flags|=262144}function Hr(e){for(e=e.firstContext;e!==null;){if(!Ge(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function jn(e){Un=e,Oi=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function be(e){return Md(Un,e)}function Gr(e,n){return Un===null&&jn(e),Md(e,n)}function Md(e,n){var a=n._currentValue;if(n={context:n,memoizedValue:a,next:null},Oi===null){if(e===null)throw Error(s(308));Oi=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Oi=Oi.next=n;return a}var db=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(a,o){e.push(o)}};this.abort=function(){n.aborted=!0,e.forEach(function(a){return a()})}},fb=p.unstable_scheduleCallback,pb=p.unstable_NormalPriority,se={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qo(){return{controller:new db,data:new Map,refCount:0}}function Aa(e){e.refCount--,e.refCount===0&&fb(pb,function(){e.controller.abort()})}var Sa=null,Zo=0,xs=0,ws=null;function gb(e,n){if(Sa===null){var a=Sa=[];Zo=0,xs=eu(),ws={status:"pending",value:void 0,then:function(o){a.push(o)}}}return Zo++,n.then(Rd,Rd),n}function Rd(){if(--Zo===0&&Sa!==null){ws!==null&&(ws.status="fulfilled");var e=Sa;Sa=null,xs=0,ws=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function mb(e,n){var a=[],o={status:"pending",value:null,reason:null,then:function(d){a.push(d)}};return e.then(function(){o.status="fulfilled",o.value=n;for(var d=0;d<a.length;d++)(0,a[d])(n)},function(d){for(o.status="rejected",o.reason=d,d=0;d<a.length;d++)(0,a[d])(void 0)}),o}var Dd=z.S;z.S=function(e,n){pp=je(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&gb(e,n),Dd!==null&&Dd(e,n)};var In=D(null);function Jo(){var e=In.current;return e!==null?e:It.pooledCache}function Vr(e,n){n===null?$(In,In.current):$(In,n.pool)}function Nd(){var e=Jo();return e===null?null:{parent:se._currentValue,pool:e}}var _s=Error(s(460)),tc=Error(s(474)),qr=Error(s(542)),Yr={then:function(){}};function Ld(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Od(e,n,a){switch(a=e[a],a===void 0?e.push(n):a!==n&&(n.then(Ri,Ri),n=a),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Bd(e),e;default:if(typeof n.status=="string")n.then(Ri,Ri);else{if(e=It,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(o){if(n.status==="pending"){var d=n;d.status="fulfilled",d.value=o}},function(o){if(n.status==="pending"){var d=n;d.status="rejected",d.reason=o}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Bd(e),e}throw Gn=n,_s}}function Hn(e){try{var n=e._init;return n(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(Gn=a,_s):a}}var Gn=null;function kd(){if(Gn===null)throw Error(s(459));var e=Gn;return Gn=null,e}function Bd(e){if(e===_s||e===qr)throw Error(s(483))}var Es=null,xa=0;function Xr(e){var n=xa;return xa+=1,Es===null&&(Es=[]),Od(Es,e,n)}function wa(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function $r(e,n){throw n.$$typeof===y?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function zd(e){function n(B,N){if(e){var F=B.deletions;F===null?(B.deletions=[N],B.flags|=16):F.push(N)}}function a(B,N){if(!e)return null;for(;N!==null;)n(B,N),N=N.sibling;return null}function o(B){for(var N=new Map;B!==null;)B.key!==null?N.set(B.key,B):N.set(B.index,B),B=B.sibling;return N}function d(B,N){return B=Ni(B,N),B.index=0,B.sibling=null,B}function g(B,N,F){return B.index=F,e?(F=B.alternate,F!==null?(F=F.index,F<N?(B.flags|=67108866,N):F):(B.flags|=67108866,N)):(B.flags|=1048576,N)}function v(B){return e&&B.alternate===null&&(B.flags|=67108866),B}function _(B,N,F,Y){return N===null||N.tag!==6?(N=Ho(F,B.mode,Y),N.return=B,N):(N=d(N,F),N.return=B,N)}function M(B,N,F,Y){var at=F.type;return at===S?G(B,N,F.props.children,Y,F.key):N!==null&&(N.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===q&&Hn(at)===N.type)?(N=d(N,F.props),wa(N,F),N.return=B,N):(N=jr(F.type,F.key,F.props,null,B.mode,Y),wa(N,F),N.return=B,N)}function U(B,N,F,Y){return N===null||N.tag!==4||N.stateNode.containerInfo!==F.containerInfo||N.stateNode.implementation!==F.implementation?(N=Go(F,B.mode,Y),N.return=B,N):(N=d(N,F.children||[]),N.return=B,N)}function G(B,N,F,Y,at){return N===null||N.tag!==7?(N=Pn(F,B.mode,Y,at),N.return=B,N):(N=d(N,F),N.return=B,N)}function X(B,N,F){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=Ho(""+N,B.mode,F),N.return=B,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case A:return F=jr(N.type,N.key,N.props,null,B.mode,F),wa(F,N),F.return=B,F;case x:return N=Go(N,B.mode,F),N.return=B,N;case q:return N=Hn(N),X(B,N,F)}if(At(N)||Z(N))return N=Pn(N,B.mode,F,null),N.return=B,N;if(typeof N.then=="function")return X(B,Xr(N),F);if(N.$$typeof===C)return X(B,Gr(B,N),F);$r(B,N)}return null}function j(B,N,F,Y){var at=N!==null?N.key:null;if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return at!==null?null:_(B,N,""+F,Y);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case A:return F.key===at?M(B,N,F,Y):null;case x:return F.key===at?U(B,N,F,Y):null;case q:return F=Hn(F),j(B,N,F,Y)}if(At(F)||Z(F))return at!==null?null:G(B,N,F,Y,null);if(typeof F.then=="function")return j(B,N,Xr(F),Y);if(F.$$typeof===C)return j(B,N,Gr(B,F),Y);$r(B,F)}return null}function I(B,N,F,Y,at){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return B=B.get(F)||null,_(N,B,""+Y,at);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:return B=B.get(Y.key===null?F:Y.key)||null,M(N,B,Y,at);case x:return B=B.get(Y.key===null?F:Y.key)||null,U(N,B,Y,at);case q:return Y=Hn(Y),I(B,N,F,Y,at)}if(At(Y)||Z(Y))return B=B.get(F)||null,G(N,B,Y,at,null);if(typeof Y.then=="function")return I(B,N,F,Xr(Y),at);if(Y.$$typeof===C)return I(B,N,F,Gr(N,Y),at);$r(N,Y)}return null}function it(B,N,F,Y){for(var at=null,Rt=null,st=N,yt=N=0,Et=null;st!==null&&yt<F.length;yt++){st.index>yt?(Et=st,st=null):Et=st.sibling;var Dt=j(B,st,F[yt],Y);if(Dt===null){st===null&&(st=Et);break}e&&st&&Dt.alternate===null&&n(B,st),N=g(Dt,N,yt),Rt===null?at=Dt:Rt.sibling=Dt,Rt=Dt,st=Et}if(yt===F.length)return a(B,st),Tt&&Li(B,yt),at;if(st===null){for(;yt<F.length;yt++)st=X(B,F[yt],Y),st!==null&&(N=g(st,N,yt),Rt===null?at=st:Rt.sibling=st,Rt=st);return Tt&&Li(B,yt),at}for(st=o(st);yt<F.length;yt++)Et=I(st,B,yt,F[yt],Y),Et!==null&&(e&&Et.alternate!==null&&st.delete(Et.key===null?yt:Et.key),N=g(Et,N,yt),Rt===null?at=Et:Rt.sibling=Et,Rt=Et);return e&&st.forEach(function(Sn){return n(B,Sn)}),Tt&&Li(B,yt),at}function ct(B,N,F,Y){if(F==null)throw Error(s(151));for(var at=null,Rt=null,st=N,yt=N=0,Et=null,Dt=F.next();st!==null&&!Dt.done;yt++,Dt=F.next()){st.index>yt?(Et=st,st=null):Et=st.sibling;var Sn=j(B,st,Dt.value,Y);if(Sn===null){st===null&&(st=Et);break}e&&st&&Sn.alternate===null&&n(B,st),N=g(Sn,N,yt),Rt===null?at=Sn:Rt.sibling=Sn,Rt=Sn,st=Et}if(Dt.done)return a(B,st),Tt&&Li(B,yt),at;if(st===null){for(;!Dt.done;yt++,Dt=F.next())Dt=X(B,Dt.value,Y),Dt!==null&&(N=g(Dt,N,yt),Rt===null?at=Dt:Rt.sibling=Dt,Rt=Dt);return Tt&&Li(B,yt),at}for(st=o(st);!Dt.done;yt++,Dt=F.next())Dt=I(st,B,yt,Dt.value,Y),Dt!==null&&(e&&Dt.alternate!==null&&st.delete(Dt.key===null?yt:Dt.key),N=g(Dt,N,yt),Rt===null?at=Dt:Rt.sibling=Dt,Rt=Dt);return e&&st.forEach(function(Cy){return n(B,Cy)}),Tt&&Li(B,yt),at}function Ft(B,N,F,Y){if(typeof F=="object"&&F!==null&&F.type===S&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case A:t:{for(var at=F.key;N!==null;){if(N.key===at){if(at=F.type,at===S){if(N.tag===7){a(B,N.sibling),Y=d(N,F.props.children),Y.return=B,B=Y;break t}}else if(N.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===q&&Hn(at)===N.type){a(B,N.sibling),Y=d(N,F.props),wa(Y,F),Y.return=B,B=Y;break t}a(B,N);break}else n(B,N);N=N.sibling}F.type===S?(Y=Pn(F.props.children,B.mode,Y,F.key),Y.return=B,B=Y):(Y=jr(F.type,F.key,F.props,null,B.mode,Y),wa(Y,F),Y.return=B,B=Y)}return v(B);case x:t:{for(at=F.key;N!==null;){if(N.key===at)if(N.tag===4&&N.stateNode.containerInfo===F.containerInfo&&N.stateNode.implementation===F.implementation){a(B,N.sibling),Y=d(N,F.children||[]),Y.return=B,B=Y;break t}else{a(B,N);break}else n(B,N);N=N.sibling}Y=Go(F,B.mode,Y),Y.return=B,B=Y}return v(B);case q:return F=Hn(F),Ft(B,N,F,Y)}if(At(F))return it(B,N,F,Y);if(Z(F)){if(at=Z(F),typeof at!="function")throw Error(s(150));return F=at.call(F),ct(B,N,F,Y)}if(typeof F.then=="function")return Ft(B,N,Xr(F),Y);if(F.$$typeof===C)return Ft(B,N,Gr(B,F),Y);$r(B,F)}return typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint"?(F=""+F,N!==null&&N.tag===6?(a(B,N.sibling),Y=d(N,F),Y.return=B,B=Y):(a(B,N),Y=Ho(F,B.mode,Y),Y.return=B,B=Y),v(B)):a(B,N)}return function(B,N,F,Y){try{xa=0;var at=Ft(B,N,F,Y);return Es=null,at}catch(st){if(st===_s||st===qr)throw st;var Rt=Ve(29,st,null,B.mode);return Rt.lanes=Y,Rt.return=B,Rt}finally{}}}var Vn=zd(!0),Pd=zd(!1),sn=!1;function ec(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ic(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function an(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function rn(e,n,a){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(Nt&2)!==0){var d=o.pending;return d===null?n.next=n:(n.next=d.next,d.next=n),o.pending=n,n=Ur(e),Ad(e,null,a),n}return Fr(e,o,n,a),Ur(e)}function _a(e,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194048)!==0)){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Mh(e,a)}}function nc(e,n){var a=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var d=null,g=null;if(a=a.firstBaseUpdate,a!==null){do{var v={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};g===null?d=g=v:g=g.next=v,a=a.next}while(a!==null);g===null?d=g=n:g=g.next=n}else d=g=n;a={baseState:o.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:o.shared,callbacks:o.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=n:e.next=n,a.lastBaseUpdate=n}var sc=!1;function Ea(){if(sc){var e=ws;if(e!==null)throw e}}function Ta(e,n,a,o){sc=!1;var d=e.updateQueue;sn=!1;var g=d.firstBaseUpdate,v=d.lastBaseUpdate,_=d.shared.pending;if(_!==null){d.shared.pending=null;var M=_,U=M.next;M.next=null,v===null?g=U:v.next=U,v=M;var G=e.alternate;G!==null&&(G=G.updateQueue,_=G.lastBaseUpdate,_!==v&&(_===null?G.firstBaseUpdate=U:_.next=U,G.lastBaseUpdate=M))}if(g!==null){var X=d.baseState;v=0,G=U=M=null,_=g;do{var j=_.lane&-536870913,I=j!==_.lane;if(I?(_t&j)===j:(o&j)===j){j!==0&&j===xs&&(sc=!0),G!==null&&(G=G.next={lane:0,tag:_.tag,payload:_.payload,callback:null,next:null});t:{var it=e,ct=_;j=n;var Ft=a;switch(ct.tag){case 1:if(it=ct.payload,typeof it=="function"){X=it.call(Ft,X,j);break t}X=it;break t;case 3:it.flags=it.flags&-65537|128;case 0:if(it=ct.payload,j=typeof it=="function"?it.call(Ft,X,j):it,j==null)break t;X=b({},X,j);break t;case 2:sn=!0}}j=_.callback,j!==null&&(e.flags|=64,I&&(e.flags|=8192),I=d.callbacks,I===null?d.callbacks=[j]:I.push(j))}else I={lane:j,tag:_.tag,payload:_.payload,callback:_.callback,next:null},G===null?(U=G=I,M=X):G=G.next=I,v|=j;if(_=_.next,_===null){if(_=d.shared.pending,_===null)break;I=_,_=I.next,I.next=null,d.lastBaseUpdate=I,d.shared.pending=null}}while(!0);G===null&&(M=X),d.baseState=M,d.firstBaseUpdate=U,d.lastBaseUpdate=G,g===null&&(d.shared.lanes=0),hn|=v,e.lanes=v,e.memoizedState=X}}function Fd(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function Ud(e,n){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)Fd(a[e],n)}var Ts=D(null),Kr=D(0);function jd(e,n){e=Gi,$(Kr,e),$(Ts,n),Gi=e|n.baseLanes}function ac(){$(Kr,Gi),$(Ts,Ts.current)}function rc(){Gi=Kr.current,H(Ts),H(Kr)}var qe=D(null),ai=null;function ln(e){var n=e.alternate;$(ee,ee.current&1),$(qe,e),ai===null&&(n===null||Ts.current!==null||n.memoizedState!==null)&&(ai=e)}function lc(e){$(ee,ee.current),$(qe,e),ai===null&&(ai=e)}function Id(e){e.tag===22?($(ee,ee.current),$(qe,e),ai===null&&(ai=e)):on()}function on(){$(ee,ee.current),$(qe,qe.current)}function Ye(e){H(qe),ai===e&&(ai=null),H(ee)}var ee=D(0);function Wr(e){for(var n=e;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||fu(a)||pu(a)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Bi=0,bt=null,zt=null,ae=null,Qr=!1,Cs=!1,qn=!1,Zr=0,Ca=0,Ms=null,bb=0;function Wt(){throw Error(s(321))}function oc(e,n){if(n===null)return!1;for(var a=0;a<n.length&&a<e.length;a++)if(!Ge(e[a],n[a]))return!1;return!0}function cc(e,n,a,o,d,g){return Bi=g,bt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,z.H=e===null||e.memoizedState===null?Ef:_c,qn=!1,g=a(o,d),qn=!1,Cs&&(g=Gd(n,a,o,d)),Hd(e),g}function Hd(e){z.H=Da;var n=zt!==null&&zt.next!==null;if(Bi=0,ae=zt=bt=null,Qr=!1,Ca=0,Ms=null,n)throw Error(s(300));e===null||re||(e=e.dependencies,e!==null&&Hr(e)&&(re=!0))}function Gd(e,n,a,o){bt=e;var d=0;do{if(Cs&&(Ms=null),Ca=0,Cs=!1,25<=d)throw Error(s(301));if(d+=1,ae=zt=null,e.updateQueue!=null){var g=e.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}z.H=Tf,g=n(a,o)}while(Cs);return g}function yb(){var e=z.H,n=e.useState()[0];return n=typeof n.then=="function"?Ma(n):n,e=e.useState()[0],(zt!==null?zt.memoizedState:null)!==e&&(bt.flags|=1024),n}function uc(){var e=Zr!==0;return Zr=0,e}function hc(e,n,a){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~a}function dc(e){if(Qr){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}Qr=!1}Bi=0,ae=zt=bt=null,Cs=!1,Ca=Zr=0,Ms=null}function Ee(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ae===null?bt.memoizedState=ae=e:ae=ae.next=e,ae}function ie(){if(zt===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=zt.next;var n=ae===null?bt.memoizedState:ae.next;if(n!==null)ae=n,zt=e;else{if(e===null)throw bt.alternate===null?Error(s(467)):Error(s(310));zt=e,e={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},ae===null?bt.memoizedState=ae=e:ae=ae.next=e}return ae}function Jr(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ma(e){var n=Ca;return Ca+=1,Ms===null&&(Ms=[]),e=Od(Ms,e,n),n=bt,(ae===null?n.memoizedState:ae.next)===null&&(n=n.alternate,z.H=n===null||n.memoizedState===null?Ef:_c),e}function tl(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ma(e);if(e.$$typeof===C)return be(e)}throw Error(s(438,String(e)))}function fc(e){var n=null,a=bt.updateQueue;if(a!==null&&(n=a.memoCache),n==null){var o=bt.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(n={data:o.data.map(function(d){return d.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),a===null&&(a=Jr(),bt.updateQueue=a),a.memoCache=n,a=n.data[n.index],a===void 0)for(a=n.data[n.index]=Array(e),o=0;o<e;o++)a[o]=J;return n.index++,a}function zi(e,n){return typeof n=="function"?n(e):n}function el(e){var n=ie();return pc(n,zt,e)}function pc(e,n,a){var o=e.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=a;var d=e.baseQueue,g=o.pending;if(g!==null){if(d!==null){var v=d.next;d.next=g.next,g.next=v}n.baseQueue=d=g,o.pending=null}if(g=e.baseState,d===null)e.memoizedState=g;else{n=d.next;var _=v=null,M=null,U=n,G=!1;do{var X=U.lane&-536870913;if(X!==U.lane?(_t&X)===X:(Bi&X)===X){var j=U.revertLane;if(j===0)M!==null&&(M=M.next={lane:0,revertLane:0,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),X===xs&&(G=!0);else if((Bi&j)===j){U=U.next,j===xs&&(G=!0);continue}else X={lane:0,revertLane:U.revertLane,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},M===null?(_=M=X,v=g):M=M.next=X,bt.lanes|=j,hn|=j;X=U.action,qn&&a(g,X),g=U.hasEagerState?U.eagerState:a(g,X)}else j={lane:X,revertLane:U.revertLane,gesture:U.gesture,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},M===null?(_=M=j,v=g):M=M.next=j,bt.lanes|=X,hn|=X;U=U.next}while(U!==null&&U!==n);if(M===null?v=g:M.next=_,!Ge(g,e.memoizedState)&&(re=!0,G&&(a=ws,a!==null)))throw a;e.memoizedState=g,e.baseState=v,e.baseQueue=M,o.lastRenderedState=g}return d===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function gc(e){var n=ie(),a=n.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var o=a.dispatch,d=a.pending,g=n.memoizedState;if(d!==null){a.pending=null;var v=d=d.next;do g=e(g,v.action),v=v.next;while(v!==d);Ge(g,n.memoizedState)||(re=!0),n.memoizedState=g,n.baseQueue===null&&(n.baseState=g),a.lastRenderedState=g}return[g,o]}function Vd(e,n,a){var o=bt,d=ie(),g=Tt;if(g){if(a===void 0)throw Error(s(407));a=a()}else a=n();var v=!Ge((zt||d).memoizedState,a);if(v&&(d.memoizedState=a,re=!0),d=d.queue,yc(Xd.bind(null,o,d,e),[e]),d.getSnapshot!==n||v||ae!==null&&ae.memoizedState.tag&1){if(o.flags|=2048,Rs(9,{destroy:void 0},Yd.bind(null,o,d,a,n),null),It===null)throw Error(s(349));g||(Bi&127)!==0||qd(o,n,a)}return a}function qd(e,n,a){e.flags|=16384,e={getSnapshot:n,value:a},n=bt.updateQueue,n===null?(n=Jr(),bt.updateQueue=n,n.stores=[e]):(a=n.stores,a===null?n.stores=[e]:a.push(e))}function Yd(e,n,a,o){n.value=a,n.getSnapshot=o,$d(n)&&Kd(e)}function Xd(e,n,a){return a(function(){$d(n)&&Kd(e)})}function $d(e){var n=e.getSnapshot;e=e.value;try{var a=n();return!Ge(e,a)}catch{return!0}}function Kd(e){var n=zn(e,2);n!==null&&ze(n,e,2)}function mc(e){var n=Ee();if(typeof e=="function"){var a=e;if(e=a(),qn){Wi(!0);try{a()}finally{Wi(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:e},n}function Wd(e,n,a,o){return e.baseState=a,pc(e,zt,typeof o=="function"?o:zi)}function vb(e,n,a,o,d){if(sl(e))throw Error(s(485));if(e=n.action,e!==null){var g={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){g.listeners.push(v)}};z.T!==null?a(!0):g.isTransition=!1,o(g),a=n.pending,a===null?(g.next=n.pending=g,Qd(n,g)):(g.next=a.next,n.pending=a.next=g)}}function Qd(e,n){var a=n.action,o=n.payload,d=e.state;if(n.isTransition){var g=z.T,v={};z.T=v;try{var _=a(d,o),M=z.S;M!==null&&M(v,_),Zd(e,n,_)}catch(U){bc(e,n,U)}finally{g!==null&&v.types!==null&&(g.types=v.types),z.T=g}}else try{g=a(d,o),Zd(e,n,g)}catch(U){bc(e,n,U)}}function Zd(e,n,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(o){Jd(e,n,o)},function(o){return bc(e,n,o)}):Jd(e,n,a)}function Jd(e,n,a){n.status="fulfilled",n.value=a,tf(n),e.state=a,n=e.pending,n!==null&&(a=n.next,a===n?e.pending=null:(a=a.next,n.next=a,Qd(e,a)))}function bc(e,n,a){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do n.status="rejected",n.reason=a,tf(n),n=n.next;while(n!==o)}e.action=null}function tf(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function ef(e,n){return n}function nf(e,n){if(Tt){var a=It.formState;if(a!==null){t:{var o=bt;if(Tt){if(Gt){e:{for(var d=Gt,g=si;d.nodeType!==8;){if(!g){d=null;break e}if(d=ri(d.nextSibling),d===null){d=null;break e}}g=d.data,d=g==="F!"||g==="F"?d:null}if(d){Gt=ri(d.nextSibling),o=d.data==="F!";break t}}en(o)}o=!1}o&&(n=a[0])}}return a=Ee(),a.memoizedState=a.baseState=n,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ef,lastRenderedState:n},a.queue=o,a=xf.bind(null,bt,o),o.dispatch=a,o=mc(!1),g=wc.bind(null,bt,!1,o.queue),o=Ee(),d={state:n,dispatch:null,action:e,pending:null},o.queue=d,a=vb.bind(null,bt,d,g,a),d.dispatch=a,o.memoizedState=e,[n,a,!1]}function sf(e){var n=ie();return af(n,zt,e)}function af(e,n,a){if(n=pc(e,n,ef)[0],e=el(zi)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var o=Ma(n)}catch(v){throw v===_s?qr:v}else o=n;n=ie();var d=n.queue,g=d.dispatch;return a!==n.memoizedState&&(bt.flags|=2048,Rs(9,{destroy:void 0},Ab.bind(null,d,a),null)),[o,g,e]}function Ab(e,n){e.action=n}function rf(e){var n=ie(),a=zt;if(a!==null)return af(n,a,e);ie(),n=n.memoizedState,a=ie();var o=a.queue.dispatch;return a.memoizedState=e,[n,o,!1]}function Rs(e,n,a,o){return e={tag:e,create:a,deps:o,inst:n,next:null},n=bt.updateQueue,n===null&&(n=Jr(),bt.updateQueue=n),a=n.lastEffect,a===null?n.lastEffect=e.next=e:(o=a.next,a.next=e,e.next=o,n.lastEffect=e),e}function lf(){return ie().memoizedState}function il(e,n,a,o){var d=Ee();bt.flags|=e,d.memoizedState=Rs(1|n,{destroy:void 0},a,o===void 0?null:o)}function nl(e,n,a,o){var d=ie();o=o===void 0?null:o;var g=d.memoizedState.inst;zt!==null&&o!==null&&oc(o,zt.memoizedState.deps)?d.memoizedState=Rs(n,g,a,o):(bt.flags|=e,d.memoizedState=Rs(1|n,g,a,o))}function of(e,n){il(8390656,8,e,n)}function yc(e,n){nl(2048,8,e,n)}function Sb(e){bt.flags|=4;var n=bt.updateQueue;if(n===null)n=Jr(),bt.updateQueue=n,n.events=[e];else{var a=n.events;a===null?n.events=[e]:a.push(e)}}function cf(e){var n=ie().memoizedState;return Sb({ref:n,nextImpl:e}),function(){if((Nt&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function uf(e,n){return nl(4,2,e,n)}function hf(e,n){return nl(4,4,e,n)}function df(e,n){if(typeof n=="function"){e=e();var a=n(e);return function(){typeof a=="function"?a():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function ff(e,n,a){a=a!=null?a.concat([e]):null,nl(4,4,df.bind(null,n,e),a)}function vc(){}function pf(e,n){var a=ie();n=n===void 0?null:n;var o=a.memoizedState;return n!==null&&oc(n,o[1])?o[0]:(a.memoizedState=[e,n],e)}function gf(e,n){var a=ie();n=n===void 0?null:n;var o=a.memoizedState;if(n!==null&&oc(n,o[1]))return o[0];if(o=e(),qn){Wi(!0);try{e()}finally{Wi(!1)}}return a.memoizedState=[o,n],o}function Ac(e,n,a){return a===void 0||(Bi&1073741824)!==0&&(_t&261930)===0?e.memoizedState=n:(e.memoizedState=a,e=mp(),bt.lanes|=e,hn|=e,a)}function mf(e,n,a,o){return Ge(a,n)?a:Ts.current!==null?(e=Ac(e,a,o),Ge(e,n)||(re=!0),e):(Bi&42)===0||(Bi&1073741824)!==0&&(_t&261930)===0?(re=!0,e.memoizedState=a):(e=mp(),bt.lanes|=e,hn|=e,n)}function bf(e,n,a,o,d){var g=V.p;V.p=g!==0&&8>g?g:8;var v=z.T,_={};z.T=_,wc(e,!1,n,a);try{var M=d(),U=z.S;if(U!==null&&U(_,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var G=mb(M,o);Ra(e,n,G,Ke(e))}else Ra(e,n,o,Ke(e))}catch(X){Ra(e,n,{then:function(){},status:"rejected",reason:X},Ke())}finally{V.p=g,v!==null&&_.types!==null&&(v.types=_.types),z.T=v}}function xb(){}function Sc(e,n,a,o){if(e.tag!==5)throw Error(s(476));var d=yf(e).queue;bf(e,d,n,W,a===null?xb:function(){return vf(e),a(o)})}function yf(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:W},next:null};var a={};return n.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:a},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function vf(e){var n=yf(e);n.next===null&&(n=e.alternate.memoizedState),Ra(e,n.next.queue,{},Ke())}function xc(){return be(Ya)}function Af(){return ie().memoizedState}function Sf(){return ie().memoizedState}function wb(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var a=Ke();e=an(a);var o=rn(n,e,a);o!==null&&(ze(o,n,a),_a(o,n,a)),n={cache:Qo()},e.payload=n;return}n=n.return}}function _b(e,n,a){var o=Ke();a={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},sl(e)?wf(n,a):(a=jo(e,n,a,o),a!==null&&(ze(a,e,o),_f(a,n,o)))}function xf(e,n,a){var o=Ke();Ra(e,n,a,o)}function Ra(e,n,a,o){var d={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(sl(e))wf(n,d);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=n.lastRenderedReducer,g!==null))try{var v=n.lastRenderedState,_=g(v,a);if(d.hasEagerState=!0,d.eagerState=_,Ge(_,v))return Fr(e,n,d,0),It===null&&Pr(),!1}catch{}finally{}if(a=jo(e,n,d,o),a!==null)return ze(a,e,o),_f(a,n,o),!0}return!1}function wc(e,n,a,o){if(o={lane:2,revertLane:eu(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},sl(e)){if(n)throw Error(s(479))}else n=jo(e,a,o,2),n!==null&&ze(n,e,2)}function sl(e){var n=e.alternate;return e===bt||n!==null&&n===bt}function wf(e,n){Cs=Qr=!0;var a=e.pending;a===null?n.next=n:(n.next=a.next,a.next=n),e.pending=n}function _f(e,n,a){if((a&4194048)!==0){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Mh(e,a)}}var Da={readContext:be,use:tl,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useLayoutEffect:Wt,useInsertionEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useSyncExternalStore:Wt,useId:Wt,useHostTransitionStatus:Wt,useFormState:Wt,useActionState:Wt,useOptimistic:Wt,useMemoCache:Wt,useCacheRefresh:Wt};Da.useEffectEvent=Wt;var Ef={readContext:be,use:tl,useCallback:function(e,n){return Ee().memoizedState=[e,n===void 0?null:n],e},useContext:be,useEffect:of,useImperativeHandle:function(e,n,a){a=a!=null?a.concat([e]):null,il(4194308,4,df.bind(null,n,e),a)},useLayoutEffect:function(e,n){return il(4194308,4,e,n)},useInsertionEffect:function(e,n){il(4,2,e,n)},useMemo:function(e,n){var a=Ee();n=n===void 0?null:n;var o=e();if(qn){Wi(!0);try{e()}finally{Wi(!1)}}return a.memoizedState=[o,n],o},useReducer:function(e,n,a){var o=Ee();if(a!==void 0){var d=a(n);if(qn){Wi(!0);try{a(n)}finally{Wi(!1)}}}else d=n;return o.memoizedState=o.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},o.queue=e,e=e.dispatch=_b.bind(null,bt,e),[o.memoizedState,e]},useRef:function(e){var n=Ee();return e={current:e},n.memoizedState=e},useState:function(e){e=mc(e);var n=e.queue,a=xf.bind(null,bt,n);return n.dispatch=a,[e.memoizedState,a]},useDebugValue:vc,useDeferredValue:function(e,n){var a=Ee();return Ac(a,e,n)},useTransition:function(){var e=mc(!1);return e=bf.bind(null,bt,e.queue,!0,!1),Ee().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,a){var o=bt,d=Ee();if(Tt){if(a===void 0)throw Error(s(407));a=a()}else{if(a=n(),It===null)throw Error(s(349));(_t&127)!==0||qd(o,n,a)}d.memoizedState=a;var g={value:a,getSnapshot:n};return d.queue=g,of(Xd.bind(null,o,g,e),[e]),o.flags|=2048,Rs(9,{destroy:void 0},Yd.bind(null,o,g,a,n),null),a},useId:function(){var e=Ee(),n=It.identifierPrefix;if(Tt){var a=bi,o=mi;a=(o&~(1<<32-He(o)-1)).toString(32)+a,n="_"+n+"R_"+a,a=Zr++,0<a&&(n+="H"+a.toString(32)),n+="_"}else a=bb++,n="_"+n+"r_"+a.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:xc,useFormState:nf,useActionState:nf,useOptimistic:function(e){var n=Ee();n.memoizedState=n.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=a,n=wc.bind(null,bt,!0,a),a.dispatch=n,[e,n]},useMemoCache:fc,useCacheRefresh:function(){return Ee().memoizedState=wb.bind(null,bt)},useEffectEvent:function(e){var n=Ee(),a={impl:e};return n.memoizedState=a,function(){if((Nt&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},_c={readContext:be,use:tl,useCallback:pf,useContext:be,useEffect:yc,useImperativeHandle:ff,useInsertionEffect:uf,useLayoutEffect:hf,useMemo:gf,useReducer:el,useRef:lf,useState:function(){return el(zi)},useDebugValue:vc,useDeferredValue:function(e,n){var a=ie();return mf(a,zt.memoizedState,e,n)},useTransition:function(){var e=el(zi)[0],n=ie().memoizedState;return[typeof e=="boolean"?e:Ma(e),n]},useSyncExternalStore:Vd,useId:Af,useHostTransitionStatus:xc,useFormState:sf,useActionState:sf,useOptimistic:function(e,n){var a=ie();return Wd(a,zt,e,n)},useMemoCache:fc,useCacheRefresh:Sf};_c.useEffectEvent=cf;var Tf={readContext:be,use:tl,useCallback:pf,useContext:be,useEffect:yc,useImperativeHandle:ff,useInsertionEffect:uf,useLayoutEffect:hf,useMemo:gf,useReducer:gc,useRef:lf,useState:function(){return gc(zi)},useDebugValue:vc,useDeferredValue:function(e,n){var a=ie();return zt===null?Ac(a,e,n):mf(a,zt.memoizedState,e,n)},useTransition:function(){var e=gc(zi)[0],n=ie().memoizedState;return[typeof e=="boolean"?e:Ma(e),n]},useSyncExternalStore:Vd,useId:Af,useHostTransitionStatus:xc,useFormState:rf,useActionState:rf,useOptimistic:function(e,n){var a=ie();return zt!==null?Wd(a,zt,e,n):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:fc,useCacheRefresh:Sf};Tf.useEffectEvent=cf;function Ec(e,n,a,o){n=e.memoizedState,a=a(o,n),a=a==null?n:b({},n,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Tc={enqueueSetState:function(e,n,a){e=e._reactInternals;var o=Ke(),d=an(o);d.payload=n,a!=null&&(d.callback=a),n=rn(e,d,o),n!==null&&(ze(n,e,o),_a(n,e,o))},enqueueReplaceState:function(e,n,a){e=e._reactInternals;var o=Ke(),d=an(o);d.tag=1,d.payload=n,a!=null&&(d.callback=a),n=rn(e,d,o),n!==null&&(ze(n,e,o),_a(n,e,o))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var a=Ke(),o=an(a);o.tag=2,n!=null&&(o.callback=n),n=rn(e,o,a),n!==null&&(ze(n,e,a),_a(n,e,a))}};function Cf(e,n,a,o,d,g,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,g,v):n.prototype&&n.prototype.isPureReactComponent?!ma(a,o)||!ma(d,g):!0}function Mf(e,n,a,o){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,o),n.state!==e&&Tc.enqueueReplaceState(n,n.state,null)}function Yn(e,n){var a=n;if("ref"in n){a={};for(var o in n)o!=="ref"&&(a[o]=n[o])}if(e=e.defaultProps){a===n&&(a=b({},a));for(var d in e)a[d]===void 0&&(a[d]=e[d])}return a}function Rf(e){zr(e)}function Df(e){console.error(e)}function Nf(e){zr(e)}function al(e,n){try{var a=e.onUncaughtError;a(n.value,{componentStack:n.stack})}catch(o){setTimeout(function(){throw o})}}function Lf(e,n,a){try{var o=e.onCaughtError;o(a.value,{componentStack:a.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Cc(e,n,a){return a=an(a),a.tag=3,a.payload={element:null},a.callback=function(){al(e,n)},a}function Of(e){return e=an(e),e.tag=3,e}function kf(e,n,a,o){var d=a.type.getDerivedStateFromError;if(typeof d=="function"){var g=o.value;e.payload=function(){return d(g)},e.callback=function(){Lf(n,a,o)}}var v=a.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){Lf(n,a,o),typeof d!="function"&&(dn===null?dn=new Set([this]):dn.add(this));var _=o.stack;this.componentDidCatch(o.value,{componentStack:_!==null?_:""})})}function Eb(e,n,a,o,d){if(a.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(n=a.alternate,n!==null&&Ss(n,a,d,!0),a=qe.current,a!==null){switch(a.tag){case 31:case 13:return ai===null?bl():a.alternate===null&&Qt===0&&(Qt=3),a.flags&=-257,a.flags|=65536,a.lanes=d,o===Yr?a.flags|=16384:(n=a.updateQueue,n===null?a.updateQueue=new Set([o]):n.add(o),Zc(e,o,d)),!1;case 22:return a.flags|=65536,o===Yr?a.flags|=16384:(n=a.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([o])},a.updateQueue=n):(a=n.retryQueue,a===null?n.retryQueue=new Set([o]):a.add(o)),Zc(e,o,d)),!1}throw Error(s(435,a.tag))}return Zc(e,o,d),bl(),!1}if(Tt)return n=qe.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=d,o!==Yo&&(e=Error(s(422),{cause:o}),va(ei(e,a)))):(o!==Yo&&(n=Error(s(423),{cause:o}),va(ei(n,a))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,o=ei(o,a),d=Cc(e.stateNode,o,d),nc(e,d),Qt!==4&&(Qt=2)),!1;var g=Error(s(520),{cause:o});if(g=ei(g,a),Fa===null?Fa=[g]:Fa.push(g),Qt!==4&&(Qt=2),n===null)return!0;o=ei(o,a),a=n;do{switch(a.tag){case 3:return a.flags|=65536,e=d&-d,a.lanes|=e,e=Cc(a.stateNode,o,e),nc(a,e),!1;case 1:if(n=a.type,g=a.stateNode,(a.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(dn===null||!dn.has(g))))return a.flags|=65536,d&=-d,a.lanes|=d,d=Of(d),kf(d,e,a,o),nc(a,d),!1}a=a.return}while(a!==null);return!1}var Mc=Error(s(461)),re=!1;function ye(e,n,a,o){n.child=e===null?Pd(n,null,a,o):Vn(n,e.child,a,o)}function Bf(e,n,a,o,d){a=a.render;var g=n.ref;if("ref"in o){var v={};for(var _ in o)_!=="ref"&&(v[_]=o[_])}else v=o;return jn(n),o=cc(e,n,a,v,g,d),_=uc(),e!==null&&!re?(hc(e,n,d),Pi(e,n,d)):(Tt&&_&&Vo(n),n.flags|=1,ye(e,n,o,d),n.child)}function zf(e,n,a,o,d){if(e===null){var g=a.type;return typeof g=="function"&&!Io(g)&&g.defaultProps===void 0&&a.compare===null?(n.tag=15,n.type=g,Pf(e,n,g,o,d)):(e=jr(a.type,null,o,n,n.mode,d),e.ref=n.ref,e.return=n,n.child=e)}if(g=e.child,!zc(e,d)){var v=g.memoizedProps;if(a=a.compare,a=a!==null?a:ma,a(v,o)&&e.ref===n.ref)return Pi(e,n,d)}return n.flags|=1,e=Ni(g,o),e.ref=n.ref,e.return=n,n.child=e}function Pf(e,n,a,o,d){if(e!==null){var g=e.memoizedProps;if(ma(g,o)&&e.ref===n.ref)if(re=!1,n.pendingProps=o=g,zc(e,d))(e.flags&131072)!==0&&(re=!0);else return n.lanes=e.lanes,Pi(e,n,d)}return Rc(e,n,a,o,d)}function Ff(e,n,a,o){var d=o.children,g=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((n.flags&128)!==0){if(g=g!==null?g.baseLanes|a:a,e!==null){for(o=n.child=e.child,d=0;o!==null;)d=d|o.lanes|o.childLanes,o=o.sibling;o=d&~g}else o=0,n.child=null;return Uf(e,n,g,a,o)}if((a&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&Vr(n,g!==null?g.cachePool:null),g!==null?jd(n,g):ac(),Id(n);else return o=n.lanes=536870912,Uf(e,n,g!==null?g.baseLanes|a:a,a,o)}else g!==null?(Vr(n,g.cachePool),jd(n,g),on(),n.memoizedState=null):(e!==null&&Vr(n,null),ac(),on());return ye(e,n,d,a),n.child}function Na(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Uf(e,n,a,o,d){var g=Jo();return g=g===null?null:{parent:se._currentValue,pool:g},n.memoizedState={baseLanes:a,cachePool:g},e!==null&&Vr(n,null),ac(),Id(n),e!==null&&Ss(e,n,o,!0),n.childLanes=d,null}function rl(e,n){return n=ol({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function jf(e,n,a){return Vn(n,e.child,null,a),e=rl(n,n.pendingProps),e.flags|=2,Ye(n),n.memoizedState=null,e}function Tb(e,n,a){var o=n.pendingProps,d=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Tt){if(o.mode==="hidden")return e=rl(n,o),n.lanes=536870912,Na(null,e);if(lc(n),(e=Gt)?(e=Zp(e,si),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Ji!==null?{id:mi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},a=xd(e),a.return=n,n.child=a,me=n,Gt=null)):e=null,e===null)throw en(n);return n.lanes=536870912,null}return rl(n,o)}var g=e.memoizedState;if(g!==null){var v=g.dehydrated;if(lc(n),d)if(n.flags&256)n.flags&=-257,n=jf(e,n,a);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(s(558));else if(re||Ss(e,n,a,!1),d=(a&e.childLanes)!==0,re||d){if(o=It,o!==null&&(v=Rh(o,a),v!==0&&v!==g.retryLane))throw g.retryLane=v,zn(e,v),ze(o,e,v),Mc;bl(),n=jf(e,n,a)}else e=g.treeContext,Gt=ri(v.nextSibling),me=n,Tt=!0,tn=null,si=!1,e!==null&&Ed(n,e),n=rl(n,o),n.flags|=4096;return n}return e=Ni(e.child,{mode:o.mode,children:o.children}),e.ref=n.ref,n.child=e,e.return=n,e}function ll(e,n){var a=n.ref;if(a===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(n.flags|=4194816)}}function Rc(e,n,a,o,d){return jn(n),a=cc(e,n,a,o,void 0,d),o=uc(),e!==null&&!re?(hc(e,n,d),Pi(e,n,d)):(Tt&&o&&Vo(n),n.flags|=1,ye(e,n,a,d),n.child)}function If(e,n,a,o,d,g){return jn(n),n.updateQueue=null,a=Gd(n,o,a,d),Hd(e),o=uc(),e!==null&&!re?(hc(e,n,g),Pi(e,n,g)):(Tt&&o&&Vo(n),n.flags|=1,ye(e,n,a,g),n.child)}function Hf(e,n,a,o,d){if(jn(n),n.stateNode===null){var g=bs,v=a.contextType;typeof v=="object"&&v!==null&&(g=be(v)),g=new a(o,g),n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Tc,n.stateNode=g,g._reactInternals=n,g=n.stateNode,g.props=o,g.state=n.memoizedState,g.refs={},ec(n),v=a.contextType,g.context=typeof v=="object"&&v!==null?be(v):bs,g.state=n.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(Ec(n,a,v,o),g.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(v=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),v!==g.state&&Tc.enqueueReplaceState(g,g.state,null),Ta(n,o,g,d),Ea(),g.state=n.memoizedState),typeof g.componentDidMount=="function"&&(n.flags|=4194308),o=!0}else if(e===null){g=n.stateNode;var _=n.memoizedProps,M=Yn(a,_);g.props=M;var U=g.context,G=a.contextType;v=bs,typeof G=="object"&&G!==null&&(v=be(G));var X=a.getDerivedStateFromProps;G=typeof X=="function"||typeof g.getSnapshotBeforeUpdate=="function",_=n.pendingProps!==_,G||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(_||U!==v)&&Mf(n,g,o,v),sn=!1;var j=n.memoizedState;g.state=j,Ta(n,o,g,d),Ea(),U=n.memoizedState,_||j!==U||sn?(typeof X=="function"&&(Ec(n,a,X,o),U=n.memoizedState),(M=sn||Cf(n,a,M,o,j,U,v))?(G||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(n.flags|=4194308)):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=U),g.props=o,g.state=U,g.context=v,o=M):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{g=n.stateNode,ic(e,n),v=n.memoizedProps,G=Yn(a,v),g.props=G,X=n.pendingProps,j=g.context,U=a.contextType,M=bs,typeof U=="object"&&U!==null&&(M=be(U)),_=a.getDerivedStateFromProps,(U=typeof _=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(v!==X||j!==M)&&Mf(n,g,o,M),sn=!1,j=n.memoizedState,g.state=j,Ta(n,o,g,d),Ea();var I=n.memoizedState;v!==X||j!==I||sn||e!==null&&e.dependencies!==null&&Hr(e.dependencies)?(typeof _=="function"&&(Ec(n,a,_,o),I=n.memoizedState),(G=sn||Cf(n,a,G,o,j,I,M)||e!==null&&e.dependencies!==null&&Hr(e.dependencies))?(U||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(o,I,M),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(o,I,M)),typeof g.componentDidUpdate=="function"&&(n.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof g.componentDidUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=I),g.props=o,g.state=I,g.context=M,o=G):(typeof g.componentDidUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=1024),o=!1)}return g=o,ll(e,n),o=(n.flags&128)!==0,g||o?(g=n.stateNode,a=o&&typeof a.getDerivedStateFromError!="function"?null:g.render(),n.flags|=1,e!==null&&o?(n.child=Vn(n,e.child,null,d),n.child=Vn(n,null,a,d)):ye(e,n,a,d),n.memoizedState=g.state,e=n.child):e=Pi(e,n,d),e}function Gf(e,n,a,o){return Fn(),n.flags|=256,ye(e,n,a,o),n.child}var Dc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nc(e){return{baseLanes:e,cachePool:Nd()}}function Lc(e,n,a){return e=e!==null?e.childLanes&~a:0,n&&(e|=$e),e}function Vf(e,n,a){var o=n.pendingProps,d=!1,g=(n.flags&128)!==0,v;if((v=g)||(v=e!==null&&e.memoizedState===null?!1:(ee.current&2)!==0),v&&(d=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(Tt){if(d?ln(n):on(),(e=Gt)?(e=Zp(e,si),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Ji!==null?{id:mi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},a=xd(e),a.return=n,n.child=a,me=n,Gt=null)):e=null,e===null)throw en(n);return pu(e)?n.lanes=32:n.lanes=536870912,null}var _=o.children;return o=o.fallback,d?(on(),d=n.mode,_=ol({mode:"hidden",children:_},d),o=Pn(o,d,a,null),_.return=n,o.return=n,_.sibling=o,n.child=_,o=n.child,o.memoizedState=Nc(a),o.childLanes=Lc(e,v,a),n.memoizedState=Dc,Na(null,o)):(ln(n),Oc(n,_))}var M=e.memoizedState;if(M!==null&&(_=M.dehydrated,_!==null)){if(g)n.flags&256?(ln(n),n.flags&=-257,n=kc(e,n,a)):n.memoizedState!==null?(on(),n.child=e.child,n.flags|=128,n=null):(on(),_=o.fallback,d=n.mode,o=ol({mode:"visible",children:o.children},d),_=Pn(_,d,a,null),_.flags|=2,o.return=n,_.return=n,o.sibling=_,n.child=o,Vn(n,e.child,null,a),o=n.child,o.memoizedState=Nc(a),o.childLanes=Lc(e,v,a),n.memoizedState=Dc,n=Na(null,o));else if(ln(n),pu(_)){if(v=_.nextSibling&&_.nextSibling.dataset,v)var U=v.dgst;v=U,o=Error(s(419)),o.stack="",o.digest=v,va({value:o,source:null,stack:null}),n=kc(e,n,a)}else if(re||Ss(e,n,a,!1),v=(a&e.childLanes)!==0,re||v){if(v=It,v!==null&&(o=Rh(v,a),o!==0&&o!==M.retryLane))throw M.retryLane=o,zn(e,o),ze(v,e,o),Mc;fu(_)||bl(),n=kc(e,n,a)}else fu(_)?(n.flags|=192,n.child=e.child,n=null):(e=M.treeContext,Gt=ri(_.nextSibling),me=n,Tt=!0,tn=null,si=!1,e!==null&&Ed(n,e),n=Oc(n,o.children),n.flags|=4096);return n}return d?(on(),_=o.fallback,d=n.mode,M=e.child,U=M.sibling,o=Ni(M,{mode:"hidden",children:o.children}),o.subtreeFlags=M.subtreeFlags&65011712,U!==null?_=Ni(U,_):(_=Pn(_,d,a,null),_.flags|=2),_.return=n,o.return=n,o.sibling=_,n.child=o,Na(null,o),o=n.child,_=e.child.memoizedState,_===null?_=Nc(a):(d=_.cachePool,d!==null?(M=se._currentValue,d=d.parent!==M?{parent:M,pool:M}:d):d=Nd(),_={baseLanes:_.baseLanes|a,cachePool:d}),o.memoizedState=_,o.childLanes=Lc(e,v,a),n.memoizedState=Dc,Na(e.child,o)):(ln(n),a=e.child,e=a.sibling,a=Ni(a,{mode:"visible",children:o.children}),a.return=n,a.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=a,n.memoizedState=null,a)}function Oc(e,n){return n=ol({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function ol(e,n){return e=Ve(22,e,null,n),e.lanes=0,e}function kc(e,n,a){return Vn(n,e.child,null,a),e=Oc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function qf(e,n,a){e.lanes|=n;var o=e.alternate;o!==null&&(o.lanes|=n),Ko(e.return,n,a)}function Bc(e,n,a,o,d,g){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:d,treeForkCount:g}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=o,v.tail=a,v.tailMode=d,v.treeForkCount=g)}function Yf(e,n,a){var o=n.pendingProps,d=o.revealOrder,g=o.tail;o=o.children;var v=ee.current,_=(v&2)!==0;if(_?(v=v&1|2,n.flags|=128):v&=1,$(ee,v),ye(e,n,o,a),o=Tt?ya:0,!_&&e!==null&&(e.flags&128)!==0)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&qf(e,a,n);else if(e.tag===19)qf(e,a,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(a=n.child,d=null;a!==null;)e=a.alternate,e!==null&&Wr(e)===null&&(d=a),a=a.sibling;a=d,a===null?(d=n.child,n.child=null):(d=a.sibling,a.sibling=null),Bc(n,!1,d,a,g,o);break;case"backwards":case"unstable_legacy-backwards":for(a=null,d=n.child,n.child=null;d!==null;){if(e=d.alternate,e!==null&&Wr(e)===null){n.child=d;break}e=d.sibling,d.sibling=a,a=d,d=e}Bc(n,!0,a,null,g,o);break;case"together":Bc(n,!1,null,null,void 0,o);break;default:n.memoizedState=null}return n.child}function Pi(e,n,a){if(e!==null&&(n.dependencies=e.dependencies),hn|=n.lanes,(a&n.childLanes)===0)if(e!==null){if(Ss(e,n,a,!1),(a&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,a=Ni(e,e.pendingProps),n.child=a,a.return=n;e.sibling!==null;)e=e.sibling,a=a.sibling=Ni(e,e.pendingProps),a.return=n;a.sibling=null}return n.child}function zc(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&Hr(e)))}function Cb(e,n,a){switch(n.tag){case 3:te(n,n.stateNode.containerInfo),nn(n,se,e.memoizedState.cache),Fn();break;case 27:case 5:Rn(n);break;case 4:te(n,n.stateNode.containerInfo);break;case 10:nn(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,lc(n),null;break;case 13:var o=n.memoizedState;if(o!==null)return o.dehydrated!==null?(ln(n),n.flags|=128,null):(a&n.child.childLanes)!==0?Vf(e,n,a):(ln(n),e=Pi(e,n,a),e!==null?e.sibling:null);ln(n);break;case 19:var d=(e.flags&128)!==0;if(o=(a&n.childLanes)!==0,o||(Ss(e,n,a,!1),o=(a&n.childLanes)!==0),d){if(o)return Yf(e,n,a);n.flags|=128}if(d=n.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),$(ee,ee.current),o)break;return null;case 22:return n.lanes=0,Ff(e,n,a,n.pendingProps);case 24:nn(n,se,e.memoizedState.cache)}return Pi(e,n,a)}function Xf(e,n,a){if(e!==null)if(e.memoizedProps!==n.pendingProps)re=!0;else{if(!zc(e,a)&&(n.flags&128)===0)return re=!1,Cb(e,n,a);re=(e.flags&131072)!==0}else re=!1,Tt&&(n.flags&1048576)!==0&&_d(n,ya,n.index);switch(n.lanes=0,n.tag){case 16:t:{var o=n.pendingProps;if(e=Hn(n.elementType),n.type=e,typeof e=="function")Io(e)?(o=Yn(e,o),n.tag=1,n=Hf(null,n,e,o,a)):(n.tag=0,n=Rc(null,n,e,o,a));else{if(e!=null){var d=e.$$typeof;if(d===k){n.tag=11,n=Bf(null,n,e,o,a);break t}else if(d===P){n.tag=14,n=zf(null,n,e,o,a);break t}}throw n=vt(e)||e,Error(s(306,n,""))}}return n;case 0:return Rc(e,n,n.type,n.pendingProps,a);case 1:return o=n.type,d=Yn(o,n.pendingProps),Hf(e,n,o,d,a);case 3:t:{if(te(n,n.stateNode.containerInfo),e===null)throw Error(s(387));o=n.pendingProps;var g=n.memoizedState;d=g.element,ic(e,n),Ta(n,o,null,a);var v=n.memoizedState;if(o=v.cache,nn(n,se,o),o!==g.cache&&Wo(n,[se],a,!0),Ea(),o=v.element,g.isDehydrated)if(g={element:o,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){n=Gf(e,n,o,a);break t}else if(o!==d){d=ei(Error(s(424)),n),va(d),n=Gf(e,n,o,a);break t}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Gt=ri(e.firstChild),me=n,Tt=!0,tn=null,si=!0,a=Pd(n,null,o,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Fn(),o===d){n=Pi(e,n,a);break t}ye(e,n,o,a)}n=n.child}return n;case 26:return ll(e,n),e===null?(a=sg(n.type,null,n.pendingProps,null))?n.memoizedState=a:Tt||(a=n.type,e=n.pendingProps,o=_l(ut.current).createElement(a),o[ge]=n,o[De]=e,ve(o,a,e),he(o),n.stateNode=o):n.memoizedState=sg(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Rn(n),e===null&&Tt&&(o=n.stateNode=eg(n.type,n.pendingProps,ut.current),me=n,si=!0,d=Gt,mn(n.type)?(gu=d,Gt=ri(o.firstChild)):Gt=d),ye(e,n,n.pendingProps.children,a),ll(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Tt&&((d=o=Gt)&&(o=ny(o,n.type,n.pendingProps,si),o!==null?(n.stateNode=o,me=n,Gt=ri(o.firstChild),si=!1,d=!0):d=!1),d||en(n)),Rn(n),d=n.type,g=n.pendingProps,v=e!==null?e.memoizedProps:null,o=g.children,uu(d,g)?o=null:v!==null&&uu(d,v)&&(n.flags|=32),n.memoizedState!==null&&(d=cc(e,n,yb,null,null,a),Ya._currentValue=d),ll(e,n),ye(e,n,o,a),n.child;case 6:return e===null&&Tt&&((e=a=Gt)&&(a=sy(a,n.pendingProps,si),a!==null?(n.stateNode=a,me=n,Gt=null,e=!0):e=!1),e||en(n)),null;case 13:return Vf(e,n,a);case 4:return te(n,n.stateNode.containerInfo),o=n.pendingProps,e===null?n.child=Vn(n,null,o,a):ye(e,n,o,a),n.child;case 11:return Bf(e,n,n.type,n.pendingProps,a);case 7:return ye(e,n,n.pendingProps,a),n.child;case 8:return ye(e,n,n.pendingProps.children,a),n.child;case 12:return ye(e,n,n.pendingProps.children,a),n.child;case 10:return o=n.pendingProps,nn(n,n.type,o.value),ye(e,n,o.children,a),n.child;case 9:return d=n.type._context,o=n.pendingProps.children,jn(n),d=be(d),o=o(d),n.flags|=1,ye(e,n,o,a),n.child;case 14:return zf(e,n,n.type,n.pendingProps,a);case 15:return Pf(e,n,n.type,n.pendingProps,a);case 19:return Yf(e,n,a);case 31:return Tb(e,n,a);case 22:return Ff(e,n,a,n.pendingProps);case 24:return jn(n),o=be(se),e===null?(d=Jo(),d===null&&(d=It,g=Qo(),d.pooledCache=g,g.refCount++,g!==null&&(d.pooledCacheLanes|=a),d=g),n.memoizedState={parent:o,cache:d},ec(n),nn(n,se,d)):((e.lanes&a)!==0&&(ic(e,n),Ta(n,null,null,a),Ea()),d=e.memoizedState,g=n.memoizedState,d.parent!==o?(d={parent:o,cache:o},n.memoizedState=d,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=d),nn(n,se,o)):(o=g.cache,nn(n,se,o),o!==d.cache&&Wo(n,[se],a,!0))),ye(e,n,n.pendingProps.children,a),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function Fi(e){e.flags|=4}function Pc(e,n,a,o,d){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(Ap())e.flags|=8192;else throw Gn=Yr,tc}else e.flags&=-16777217}function $f(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!cg(n))if(Ap())e.flags|=8192;else throw Gn=Yr,tc}function cl(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Th():536870912,e.lanes|=n,Os|=n)}function La(e,n){if(!Tt)switch(e.tailMode){case"hidden":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Vt(e){var n=e.alternate!==null&&e.alternate.child===e.child,a=0,o=0;if(n)for(var d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags&65011712,o|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags,o|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=o,e.childLanes=a,n}function Mb(e,n,a){var o=n.pendingProps;switch(qo(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vt(n),null;case 1:return Vt(n),null;case 3:return a=n.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),ki(se),jt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(As(n)?Fi(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Xo())),Vt(n),null;case 26:var d=n.type,g=n.memoizedState;return e===null?(Fi(n),g!==null?(Vt(n),$f(n,g)):(Vt(n),Pc(n,d,null,o,a))):g?g!==e.memoizedState?(Fi(n),Vt(n),$f(n,g)):(Vt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==o&&Fi(n),Vt(n),Pc(n,d,e,o,a)),null;case 27:if(Ki(n),a=ut.current,d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&Fi(n);else{if(!o){if(n.stateNode===null)throw Error(s(166));return Vt(n),null}e=tt.current,As(n)?Td(n):(e=eg(d,o,a),n.stateNode=e,Fi(n))}return Vt(n),null;case 5:if(Ki(n),d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&Fi(n);else{if(!o){if(n.stateNode===null)throw Error(s(166));return Vt(n),null}if(g=tt.current,As(n))Td(n);else{var v=_l(ut.current);switch(g){case 1:g=v.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:g=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":g=v.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":g=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":g=v.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof o.is=="string"?v.createElement("select",{is:o.is}):v.createElement("select"),o.multiple?g.multiple=!0:o.size&&(g.size=o.size);break;default:g=typeof o.is=="string"?v.createElement(d,{is:o.is}):v.createElement(d)}}g[ge]=n,g[De]=o;t:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)g.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break t;for(;v.sibling===null;){if(v.return===null||v.return===n)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=g;t:switch(ve(g,d,o),d){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&Fi(n)}}return Vt(n),Pc(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,a),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==o&&Fi(n);else{if(typeof o!="string"&&n.stateNode===null)throw Error(s(166));if(e=ut.current,As(n)){if(e=n.stateNode,a=n.memoizedProps,o=null,d=me,d!==null)switch(d.tag){case 27:case 5:o=d.memoizedProps}e[ge]=n,e=!!(e.nodeValue===a||o!==null&&o.suppressHydrationWarning===!0||Vp(e.nodeValue,a)),e||en(n,!0)}else e=_l(e).createTextNode(o),e[ge]=n,n.stateNode=e}return Vt(n),null;case 31:if(a=n.memoizedState,e===null||e.memoizedState!==null){if(o=As(n),a!==null){if(e===null){if(!o)throw Error(s(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[ge]=n}else Fn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Vt(n),e=!1}else a=Xo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return n.flags&256?(Ye(n),n):(Ye(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Vt(n),null;case 13:if(o=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=As(n),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(s(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));d[ge]=n}else Fn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Vt(n),d=!1}else d=Xo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return n.flags&256?(Ye(n),n):(Ye(n),null)}return Ye(n),(n.flags&128)!==0?(n.lanes=a,n):(a=o!==null,e=e!==null&&e.memoizedState!==null,a&&(o=n.child,d=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(d=o.alternate.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==d&&(o.flags|=2048)),a!==e&&a&&(n.child.flags|=8192),cl(n,n.updateQueue),Vt(n),null);case 4:return jt(),e===null&&au(n.stateNode.containerInfo),Vt(n),null;case 10:return ki(n.type),Vt(n),null;case 19:if(H(ee),o=n.memoizedState,o===null)return Vt(n),null;if(d=(n.flags&128)!==0,g=o.rendering,g===null)if(d)La(o,!1);else{if(Qt!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(g=Wr(e),g!==null){for(n.flags|=128,La(o,!1),e=g.updateQueue,n.updateQueue=e,cl(n,e),n.subtreeFlags=0,e=a,a=n.child;a!==null;)Sd(a,e),a=a.sibling;return $(ee,ee.current&1|2),Tt&&Li(n,o.treeForkCount),n.child}e=e.sibling}o.tail!==null&&je()>pl&&(n.flags|=128,d=!0,La(o,!1),n.lanes=4194304)}else{if(!d)if(e=Wr(g),e!==null){if(n.flags|=128,d=!0,e=e.updateQueue,n.updateQueue=e,cl(n,e),La(o,!0),o.tail===null&&o.tailMode==="hidden"&&!g.alternate&&!Tt)return Vt(n),null}else 2*je()-o.renderingStartTime>pl&&a!==536870912&&(n.flags|=128,d=!0,La(o,!1),n.lanes=4194304);o.isBackwards?(g.sibling=n.child,n.child=g):(e=o.last,e!==null?e.sibling=g:n.child=g,o.last=g)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=je(),e.sibling=null,a=ee.current,$(ee,d?a&1|2:a&1),Tt&&Li(n,o.treeForkCount),e):(Vt(n),null);case 22:case 23:return Ye(n),rc(),o=n.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(n.flags|=8192):o&&(n.flags|=8192),o?(a&536870912)!==0&&(n.flags&128)===0&&(Vt(n),n.subtreeFlags&6&&(n.flags|=8192)):Vt(n),a=n.updateQueue,a!==null&&cl(n,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),o=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),o!==a&&(n.flags|=2048),e!==null&&H(In),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),n.memoizedState.cache!==a&&(n.flags|=2048),ki(se),Vt(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function Rb(e,n){switch(qo(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return ki(se),jt(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Ki(n),null;case 31:if(n.memoizedState!==null){if(Ye(n),n.alternate===null)throw Error(s(340));Fn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(Ye(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));Fn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return H(ee),null;case 4:return jt(),null;case 10:return ki(n.type),null;case 22:case 23:return Ye(n),rc(),e!==null&&H(In),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return ki(se),null;case 25:return null;default:return null}}function Kf(e,n){switch(qo(n),n.tag){case 3:ki(se),jt();break;case 26:case 27:case 5:Ki(n);break;case 4:jt();break;case 31:n.memoizedState!==null&&Ye(n);break;case 13:Ye(n);break;case 19:H(ee);break;case 10:ki(n.type);break;case 22:case 23:Ye(n),rc(),e!==null&&H(In);break;case 24:ki(se)}}function Oa(e,n){try{var a=n.updateQueue,o=a!==null?a.lastEffect:null;if(o!==null){var d=o.next;a=d;do{if((a.tag&e)===e){o=void 0;var g=a.create,v=a.inst;o=g(),v.destroy=o}a=a.next}while(a!==d)}}catch(_){Bt(n,n.return,_)}}function cn(e,n,a){try{var o=n.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var g=d.next;o=g;do{if((o.tag&e)===e){var v=o.inst,_=v.destroy;if(_!==void 0){v.destroy=void 0,d=n;var M=a,U=_;try{U()}catch(G){Bt(d,M,G)}}}o=o.next}while(o!==g)}}catch(G){Bt(n,n.return,G)}}function Wf(e){var n=e.updateQueue;if(n!==null){var a=e.stateNode;try{Ud(n,a)}catch(o){Bt(e,e.return,o)}}}function Qf(e,n,a){a.props=Yn(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(o){Bt(e,n,o)}}function ka(e,n){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof a=="function"?e.refCleanup=a(o):a.current=o}}catch(d){Bt(e,n,d)}}function yi(e,n){var a=e.ref,o=e.refCleanup;if(a!==null)if(typeof o=="function")try{o()}catch(d){Bt(e,n,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(d){Bt(e,n,d)}else a.current=null}function Zf(e){var n=e.type,a=e.memoizedProps,o=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":a.autoFocus&&o.focus();break t;case"img":a.src?o.src=a.src:a.srcSet&&(o.srcset=a.srcSet)}}catch(d){Bt(e,e.return,d)}}function Fc(e,n,a){try{var o=e.stateNode;Qb(o,e.type,a,n),o[De]=n}catch(d){Bt(e,e.return,d)}}function Jf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&mn(e.type)||e.tag===4}function Uc(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Jf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&mn(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function jc(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,n):(n=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,n.appendChild(e),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=Ri));else if(o!==4&&(o===27&&mn(e.type)&&(a=e.stateNode,n=null),e=e.child,e!==null))for(jc(e,n,a),e=e.sibling;e!==null;)jc(e,n,a),e=e.sibling}function ul(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?a.insertBefore(e,n):a.appendChild(e);else if(o!==4&&(o===27&&mn(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(ul(e,n,a),e=e.sibling;e!==null;)ul(e,n,a),e=e.sibling}function tp(e){var n=e.stateNode,a=e.memoizedProps;try{for(var o=e.type,d=n.attributes;d.length;)n.removeAttributeNode(d[0]);ve(n,o,a),n[ge]=e,n[De]=a}catch(g){Bt(e,e.return,g)}}var Ui=!1,le=!1,Ic=!1,ep=typeof WeakSet=="function"?WeakSet:Set,de=null;function Db(e,n){if(e=e.containerInfo,ou=Nl,e=dd(e),ko(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var d=o.anchorOffset,g=o.focusNode;o=o.focusOffset;try{a.nodeType,g.nodeType}catch{a=null;break t}var v=0,_=-1,M=-1,U=0,G=0,X=e,j=null;e:for(;;){for(var I;X!==a||d!==0&&X.nodeType!==3||(_=v+d),X!==g||o!==0&&X.nodeType!==3||(M=v+o),X.nodeType===3&&(v+=X.nodeValue.length),(I=X.firstChild)!==null;)j=X,X=I;for(;;){if(X===e)break e;if(j===a&&++U===d&&(_=v),j===g&&++G===o&&(M=v),(I=X.nextSibling)!==null)break;X=j,j=X.parentNode}X=I}a=_===-1||M===-1?null:{start:_,end:M}}else a=null}a=a||{start:0,end:0}}else a=null;for(cu={focusedElem:e,selectionRange:a},Nl=!1,de=n;de!==null;)if(n=de,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,de=e;else for(;de!==null;){switch(n=de,g=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)d=e[a],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&g!==null){e=void 0,a=n,d=g.memoizedProps,g=g.memoizedState,o=a.stateNode;try{var it=Yn(a.type,d);e=o.getSnapshotBeforeUpdate(it,g),o.__reactInternalSnapshotBeforeUpdate=e}catch(ct){Bt(a,a.return,ct)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,a=e.nodeType,a===9)du(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":du(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,de=e;break}de=n.return}}function ip(e,n,a){var o=a.flags;switch(a.tag){case 0:case 11:case 15:Ii(e,a),o&4&&Oa(5,a);break;case 1:if(Ii(e,a),o&4)if(e=a.stateNode,n===null)try{e.componentDidMount()}catch(v){Bt(a,a.return,v)}else{var d=Yn(a.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(d,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Bt(a,a.return,v)}}o&64&&Wf(a),o&512&&ka(a,a.return);break;case 3:if(Ii(e,a),o&64&&(e=a.updateQueue,e!==null)){if(n=null,a.child!==null)switch(a.child.tag){case 27:case 5:n=a.child.stateNode;break;case 1:n=a.child.stateNode}try{Ud(e,n)}catch(v){Bt(a,a.return,v)}}break;case 27:n===null&&o&4&&tp(a);case 26:case 5:Ii(e,a),n===null&&o&4&&Zf(a),o&512&&ka(a,a.return);break;case 12:Ii(e,a);break;case 31:Ii(e,a),o&4&&ap(e,a);break;case 13:Ii(e,a),o&4&&rp(e,a),o&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=Ub.bind(null,a),ay(e,a))));break;case 22:if(o=a.memoizedState!==null||Ui,!o){n=n!==null&&n.memoizedState!==null||le,d=Ui;var g=le;Ui=o,(le=n)&&!g?Hi(e,a,(a.subtreeFlags&8772)!==0):Ii(e,a),Ui=d,le=g}break;case 30:break;default:Ii(e,a)}}function np(e){var n=e.alternate;n!==null&&(e.alternate=null,np(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&bo(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var qt=null,Le=!1;function ji(e,n,a){for(a=a.child;a!==null;)sp(e,n,a),a=a.sibling}function sp(e,n,a){if(Ie&&typeof Ie.onCommitFiberUnmount=="function")try{Ie.onCommitFiberUnmount(sa,a)}catch{}switch(a.tag){case 26:le||yi(a,n),ji(e,n,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:le||yi(a,n);var o=qt,d=Le;mn(a.type)&&(qt=a.stateNode,Le=!1),ji(e,n,a),Ga(a.stateNode),qt=o,Le=d;break;case 5:le||yi(a,n);case 6:if(o=qt,d=Le,qt=null,ji(e,n,a),qt=o,Le=d,qt!==null)if(Le)try{(qt.nodeType===9?qt.body:qt.nodeName==="HTML"?qt.ownerDocument.body:qt).removeChild(a.stateNode)}catch(g){Bt(a,n,g)}else try{qt.removeChild(a.stateNode)}catch(g){Bt(a,n,g)}break;case 18:qt!==null&&(Le?(e=qt,Wp(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),Is(e)):Wp(qt,a.stateNode));break;case 4:o=qt,d=Le,qt=a.stateNode.containerInfo,Le=!0,ji(e,n,a),qt=o,Le=d;break;case 0:case 11:case 14:case 15:cn(2,a,n),le||cn(4,a,n),ji(e,n,a);break;case 1:le||(yi(a,n),o=a.stateNode,typeof o.componentWillUnmount=="function"&&Qf(a,n,o)),ji(e,n,a);break;case 21:ji(e,n,a);break;case 22:le=(o=le)||a.memoizedState!==null,ji(e,n,a),le=o;break;default:ji(e,n,a)}}function ap(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Is(e)}catch(a){Bt(n,n.return,a)}}}function rp(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Is(e)}catch(a){Bt(n,n.return,a)}}function Nb(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new ep),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new ep),n;default:throw Error(s(435,e.tag))}}function hl(e,n){var a=Nb(e);n.forEach(function(o){if(!a.has(o)){a.add(o);var d=jb.bind(null,e,o);o.then(d,d)}})}function Oe(e,n){var a=n.deletions;if(a!==null)for(var o=0;o<a.length;o++){var d=a[o],g=e,v=n,_=v;t:for(;_!==null;){switch(_.tag){case 27:if(mn(_.type)){qt=_.stateNode,Le=!1;break t}break;case 5:qt=_.stateNode,Le=!1;break t;case 3:case 4:qt=_.stateNode.containerInfo,Le=!0;break t}_=_.return}if(qt===null)throw Error(s(160));sp(g,v,d),qt=null,Le=!1,g=d.alternate,g!==null&&(g.return=null),d.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)lp(n,e),n=n.sibling}var fi=null;function lp(e,n){var a=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Oe(n,e),ke(e),o&4&&(cn(3,e,e.return),Oa(3,e),cn(5,e,e.return));break;case 1:Oe(n,e),ke(e),o&512&&(le||a===null||yi(a,a.return)),o&64&&Ui&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?o:a.concat(o))));break;case 26:var d=fi;if(Oe(n,e),ke(e),o&512&&(le||a===null||yi(a,a.return)),o&4){var g=a!==null?a.memoizedState:null;if(o=e.memoizedState,a===null)if(o===null)if(e.stateNode===null){t:{o=e.type,a=e.memoizedProps,d=d.ownerDocument||d;e:switch(o){case"title":g=d.getElementsByTagName("title")[0],(!g||g[la]||g[ge]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=d.createElement(o),d.head.insertBefore(g,d.querySelector("head > title"))),ve(g,o,a),g[ge]=e,he(g),o=g;break t;case"link":var v=lg("link","href",d).get(o+(a.href||""));if(v){for(var _=0;_<v.length;_++)if(g=v[_],g.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&g.getAttribute("rel")===(a.rel==null?null:a.rel)&&g.getAttribute("title")===(a.title==null?null:a.title)&&g.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){v.splice(_,1);break e}}g=d.createElement(o),ve(g,o,a),d.head.appendChild(g);break;case"meta":if(v=lg("meta","content",d).get(o+(a.content||""))){for(_=0;_<v.length;_++)if(g=v[_],g.getAttribute("content")===(a.content==null?null:""+a.content)&&g.getAttribute("name")===(a.name==null?null:a.name)&&g.getAttribute("property")===(a.property==null?null:a.property)&&g.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&g.getAttribute("charset")===(a.charSet==null?null:a.charSet)){v.splice(_,1);break e}}g=d.createElement(o),ve(g,o,a),d.head.appendChild(g);break;default:throw Error(s(468,o))}g[ge]=e,he(g),o=g}e.stateNode=o}else og(d,e.type,e.stateNode);else e.stateNode=rg(d,o,e.memoizedProps);else g!==o?(g===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):g.count--,o===null?og(d,e.type,e.stateNode):rg(d,o,e.memoizedProps)):o===null&&e.stateNode!==null&&Fc(e,e.memoizedProps,a.memoizedProps)}break;case 27:Oe(n,e),ke(e),o&512&&(le||a===null||yi(a,a.return)),a!==null&&o&4&&Fc(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Oe(n,e),ke(e),o&512&&(le||a===null||yi(a,a.return)),e.flags&32){d=e.stateNode;try{us(d,"")}catch(it){Bt(e,e.return,it)}}o&4&&e.stateNode!=null&&(d=e.memoizedProps,Fc(e,d,a!==null?a.memoizedProps:d)),o&1024&&(Ic=!0);break;case 6:if(Oe(n,e),ke(e),o&4){if(e.stateNode===null)throw Error(s(162));o=e.memoizedProps,a=e.stateNode;try{a.nodeValue=o}catch(it){Bt(e,e.return,it)}}break;case 3:if(Cl=null,d=fi,fi=El(n.containerInfo),Oe(n,e),fi=d,ke(e),o&4&&a!==null&&a.memoizedState.isDehydrated)try{Is(n.containerInfo)}catch(it){Bt(e,e.return,it)}Ic&&(Ic=!1,op(e));break;case 4:o=fi,fi=El(e.stateNode.containerInfo),Oe(n,e),ke(e),fi=o;break;case 12:Oe(n,e),ke(e);break;case 31:Oe(n,e),ke(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,hl(e,o)));break;case 13:Oe(n,e),ke(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(fl=je()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,hl(e,o)));break;case 22:d=e.memoizedState!==null;var M=a!==null&&a.memoizedState!==null,U=Ui,G=le;if(Ui=U||d,le=G||M,Oe(n,e),le=G,Ui=U,ke(e),o&8192)t:for(n=e.stateNode,n._visibility=d?n._visibility&-2:n._visibility|1,d&&(a===null||M||Ui||le||Xn(e)),a=null,n=e;;){if(n.tag===5||n.tag===26){if(a===null){M=a=n;try{if(g=M.stateNode,d)v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{_=M.stateNode;var X=M.memoizedProps.style,j=X!=null&&X.hasOwnProperty("display")?X.display:null;_.style.display=j==null||typeof j=="boolean"?"":(""+j).trim()}}catch(it){Bt(M,M.return,it)}}}else if(n.tag===6){if(a===null){M=n;try{M.stateNode.nodeValue=d?"":M.memoizedProps}catch(it){Bt(M,M.return,it)}}}else if(n.tag===18){if(a===null){M=n;try{var I=M.stateNode;d?Qp(I,!0):Qp(M.stateNode,!1)}catch(it){Bt(M,M.return,it)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;a===n&&(a=null),n=n.return}a===n&&(a=null),n.sibling.return=n.return,n=n.sibling}o&4&&(o=e.updateQueue,o!==null&&(a=o.retryQueue,a!==null&&(o.retryQueue=null,hl(e,a))));break;case 19:Oe(n,e),ke(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,hl(e,o)));break;case 30:break;case 21:break;default:Oe(n,e),ke(e)}}function ke(e){var n=e.flags;if(n&2){try{for(var a,o=e.return;o!==null;){if(Jf(o)){a=o;break}o=o.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var d=a.stateNode,g=Uc(e);ul(e,g,d);break;case 5:var v=a.stateNode;a.flags&32&&(us(v,""),a.flags&=-33);var _=Uc(e);ul(e,_,v);break;case 3:case 4:var M=a.stateNode.containerInfo,U=Uc(e);jc(e,U,M);break;default:throw Error(s(161))}}catch(G){Bt(e,e.return,G)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function op(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;op(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function Ii(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)ip(e,n.alternate,n),n=n.sibling}function Xn(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:cn(4,n,n.return),Xn(n);break;case 1:yi(n,n.return);var a=n.stateNode;typeof a.componentWillUnmount=="function"&&Qf(n,n.return,a),Xn(n);break;case 27:Ga(n.stateNode);case 26:case 5:yi(n,n.return),Xn(n);break;case 22:n.memoizedState===null&&Xn(n);break;case 30:Xn(n);break;default:Xn(n)}e=e.sibling}}function Hi(e,n,a){for(a=a&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var o=n.alternate,d=e,g=n,v=g.flags;switch(g.tag){case 0:case 11:case 15:Hi(d,g,a),Oa(4,g);break;case 1:if(Hi(d,g,a),o=g,d=o.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(U){Bt(o,o.return,U)}if(o=g,d=o.updateQueue,d!==null){var _=o.stateNode;try{var M=d.shared.hiddenCallbacks;if(M!==null)for(d.shared.hiddenCallbacks=null,d=0;d<M.length;d++)Fd(M[d],_)}catch(U){Bt(o,o.return,U)}}a&&v&64&&Wf(g),ka(g,g.return);break;case 27:tp(g);case 26:case 5:Hi(d,g,a),a&&o===null&&v&4&&Zf(g),ka(g,g.return);break;case 12:Hi(d,g,a);break;case 31:Hi(d,g,a),a&&v&4&&ap(d,g);break;case 13:Hi(d,g,a),a&&v&4&&rp(d,g);break;case 22:g.memoizedState===null&&Hi(d,g,a),ka(g,g.return);break;case 30:break;default:Hi(d,g,a)}n=n.sibling}}function Hc(e,n){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&Aa(a))}function Gc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Aa(e))}function pi(e,n,a,o){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)cp(e,n,a,o),n=n.sibling}function cp(e,n,a,o){var d=n.flags;switch(n.tag){case 0:case 11:case 15:pi(e,n,a,o),d&2048&&Oa(9,n);break;case 1:pi(e,n,a,o);break;case 3:pi(e,n,a,o),d&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Aa(e)));break;case 12:if(d&2048){pi(e,n,a,o),e=n.stateNode;try{var g=n.memoizedProps,v=g.id,_=g.onPostCommit;typeof _=="function"&&_(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(M){Bt(n,n.return,M)}}else pi(e,n,a,o);break;case 31:pi(e,n,a,o);break;case 13:pi(e,n,a,o);break;case 23:break;case 22:g=n.stateNode,v=n.alternate,n.memoizedState!==null?g._visibility&2?pi(e,n,a,o):Ba(e,n):g._visibility&2?pi(e,n,a,o):(g._visibility|=2,Ds(e,n,a,o,(n.subtreeFlags&10256)!==0||!1)),d&2048&&Hc(v,n);break;case 24:pi(e,n,a,o),d&2048&&Gc(n.alternate,n);break;default:pi(e,n,a,o)}}function Ds(e,n,a,o,d){for(d=d&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var g=e,v=n,_=a,M=o,U=v.flags;switch(v.tag){case 0:case 11:case 15:Ds(g,v,_,M,d),Oa(8,v);break;case 23:break;case 22:var G=v.stateNode;v.memoizedState!==null?G._visibility&2?Ds(g,v,_,M,d):Ba(g,v):(G._visibility|=2,Ds(g,v,_,M,d)),d&&U&2048&&Hc(v.alternate,v);break;case 24:Ds(g,v,_,M,d),d&&U&2048&&Gc(v.alternate,v);break;default:Ds(g,v,_,M,d)}n=n.sibling}}function Ba(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var a=e,o=n,d=o.flags;switch(o.tag){case 22:Ba(a,o),d&2048&&Hc(o.alternate,o);break;case 24:Ba(a,o),d&2048&&Gc(o.alternate,o);break;default:Ba(a,o)}n=n.sibling}}var za=8192;function Ns(e,n,a){if(e.subtreeFlags&za)for(e=e.child;e!==null;)up(e,n,a),e=e.sibling}function up(e,n,a){switch(e.tag){case 26:Ns(e,n,a),e.flags&za&&e.memoizedState!==null&&by(a,fi,e.memoizedState,e.memoizedProps);break;case 5:Ns(e,n,a);break;case 3:case 4:var o=fi;fi=El(e.stateNode.containerInfo),Ns(e,n,a),fi=o;break;case 22:e.memoizedState===null&&(o=e.alternate,o!==null&&o.memoizedState!==null?(o=za,za=16777216,Ns(e,n,a),za=o):Ns(e,n,a));break;default:Ns(e,n,a)}}function hp(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Pa(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];de=o,fp(o,e)}hp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)dp(e),e=e.sibling}function dp(e){switch(e.tag){case 0:case 11:case 15:Pa(e),e.flags&2048&&cn(9,e,e.return);break;case 3:Pa(e);break;case 12:Pa(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,dl(e)):Pa(e);break;default:Pa(e)}}function dl(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];de=o,fp(o,e)}hp(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:cn(8,n,n.return),dl(n);break;case 22:a=n.stateNode,a._visibility&2&&(a._visibility&=-3,dl(n));break;default:dl(n)}e=e.sibling}}function fp(e,n){for(;de!==null;){var a=de;switch(a.tag){case 0:case 11:case 15:cn(8,a,n);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var o=a.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Aa(a.memoizedState.cache)}if(o=a.child,o!==null)o.return=a,de=o;else t:for(a=e;de!==null;){o=de;var d=o.sibling,g=o.return;if(np(o),o===a){de=null;break t}if(d!==null){d.return=g,de=d;break t}de=g}}}var Lb={getCacheForType:function(e){var n=be(se),a=n.data.get(e);return a===void 0&&(a=e(),n.data.set(e,a)),a},cacheSignal:function(){return be(se).controller.signal}},Ob=typeof WeakMap=="function"?WeakMap:Map,Nt=0,It=null,xt=null,_t=0,kt=0,Xe=null,un=!1,Ls=!1,Vc=!1,Gi=0,Qt=0,hn=0,$n=0,qc=0,$e=0,Os=0,Fa=null,Be=null,Yc=!1,fl=0,pp=0,pl=1/0,gl=null,dn=null,ue=0,fn=null,ks=null,Vi=0,Xc=0,$c=null,gp=null,Ua=0,Kc=null;function Ke(){return(Nt&2)!==0&&_t!==0?_t&-_t:z.T!==null?eu():Dh()}function mp(){if($e===0)if((_t&536870912)===0||Tt){var e=wr;wr<<=1,(wr&3932160)===0&&(wr=262144),$e=e}else $e=536870912;return e=qe.current,e!==null&&(e.flags|=32),$e}function ze(e,n,a){(e===It&&(kt===2||kt===9)||e.cancelPendingCommit!==null)&&(Bs(e,0),pn(e,_t,$e,!1)),ra(e,a),((Nt&2)===0||e!==It)&&(e===It&&((Nt&2)===0&&($n|=a),Qt===4&&pn(e,_t,$e,!1)),vi(e))}function bp(e,n,a){if((Nt&6)!==0)throw Error(s(327));var o=!a&&(n&127)===0&&(n&e.expiredLanes)===0||aa(e,n),d=o?zb(e,n):Qc(e,n,!0),g=o;do{if(d===0){Ls&&!o&&pn(e,n,0,!1);break}else{if(a=e.current.alternate,g&&!kb(a)){d=Qc(e,n,!1),g=!1;continue}if(d===2){if(g=n,e.errorRecoveryDisabledLanes&g)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;t:{var _=e;d=Fa;var M=_.current.memoizedState.isDehydrated;if(M&&(Bs(_,v).flags|=256),v=Qc(_,v,!1),v!==2){if(Vc&&!M){_.errorRecoveryDisabledLanes|=g,$n|=g,d=4;break t}g=Be,Be=d,g!==null&&(Be===null?Be=g:Be.push.apply(Be,g))}d=v}if(g=!1,d!==2)continue}}if(d===1){Bs(e,0),pn(e,n,0,!0);break}t:{switch(o=e,g=d,g){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:pn(o,n,$e,!un);break t;case 2:Be=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(d=fl+300-je(),10<d)){if(pn(o,n,$e,!un),Er(o,0,!0)!==0)break t;Vi=n,o.timeoutHandle=$p(yp.bind(null,o,a,Be,gl,Yc,n,$e,$n,Os,un,g,"Throttled",-0,0),d);break t}yp(o,a,Be,gl,Yc,n,$e,$n,Os,un,g,null,-0,0)}}break}while(!0);vi(e)}function yp(e,n,a,o,d,g,v,_,M,U,G,X,j,I){if(e.timeoutHandle=-1,X=n.subtreeFlags,X&8192||(X&16785408)===16785408){X={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ri},up(n,g,X);var it=(g&62914560)===g?fl-je():(g&4194048)===g?pp-je():0;if(it=yy(X,it),it!==null){Vi=g,e.cancelPendingCommit=it(Tp.bind(null,e,n,g,a,o,d,v,_,M,G,X,null,j,I)),pn(e,g,v,!U);return}}Tp(e,n,g,a,o,d,v,_,M)}function kb(e){for(var n=e;;){var a=n.tag;if((a===0||a===11||a===15)&&n.flags&16384&&(a=n.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var o=0;o<a.length;o++){var d=a[o],g=d.getSnapshot;d=d.value;try{if(!Ge(g(),d))return!1}catch{return!1}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function pn(e,n,a,o){n&=~qc,n&=~$n,e.suspendedLanes|=n,e.pingedLanes&=~n,o&&(e.warmLanes|=n),o=e.expirationTimes;for(var d=n;0<d;){var g=31-He(d),v=1<<g;o[g]=-1,d&=~v}a!==0&&Ch(e,a,n)}function ml(){return(Nt&6)===0?(ja(0),!1):!0}function Wc(){if(xt!==null){if(kt===0)var e=xt.return;else e=xt,Oi=Un=null,dc(e),Es=null,xa=0,e=xt;for(;e!==null;)Kf(e.alternate,e),e=e.return;xt=null}}function Bs(e,n){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,ty(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Vi=0,Wc(),It=e,xt=a=Ni(e.current,null),_t=n,kt=0,Xe=null,un=!1,Ls=aa(e,n),Vc=!1,Os=$e=qc=$n=hn=Qt=0,Be=Fa=null,Yc=!1,(n&8)!==0&&(n|=n&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=n;0<o;){var d=31-He(o),g=1<<d;n|=e[d],o&=~g}return Gi=n,Pr(),a}function vp(e,n){bt=null,z.H=Da,n===_s||n===qr?(n=kd(),kt=3):n===tc?(n=kd(),kt=4):kt=n===Mc?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Xe=n,xt===null&&(Qt=1,al(e,ei(n,e.current)))}function Ap(){var e=qe.current;return e===null?!0:(_t&4194048)===_t?ai===null:(_t&62914560)===_t||(_t&536870912)!==0?e===ai:!1}function Sp(){var e=z.H;return z.H=Da,e===null?Da:e}function xp(){var e=z.A;return z.A=Lb,e}function bl(){Qt=4,un||(_t&4194048)!==_t&&qe.current!==null||(Ls=!0),(hn&134217727)===0&&($n&134217727)===0||It===null||pn(It,_t,$e,!1)}function Qc(e,n,a){var o=Nt;Nt|=2;var d=Sp(),g=xp();(It!==e||_t!==n)&&(gl=null,Bs(e,n)),n=!1;var v=Qt;t:do try{if(kt!==0&&xt!==null){var _=xt,M=Xe;switch(kt){case 8:Wc(),v=6;break t;case 3:case 2:case 9:case 6:qe.current===null&&(n=!0);var U=kt;if(kt=0,Xe=null,zs(e,_,M,U),a&&Ls){v=0;break t}break;default:U=kt,kt=0,Xe=null,zs(e,_,M,U)}}Bb(),v=Qt;break}catch(G){vp(e,G)}while(!0);return n&&e.shellSuspendCounter++,Oi=Un=null,Nt=o,z.H=d,z.A=g,xt===null&&(It=null,_t=0,Pr()),v}function Bb(){for(;xt!==null;)wp(xt)}function zb(e,n){var a=Nt;Nt|=2;var o=Sp(),d=xp();It!==e||_t!==n?(gl=null,pl=je()+500,Bs(e,n)):Ls=aa(e,n);t:do try{if(kt!==0&&xt!==null){n=xt;var g=Xe;e:switch(kt){case 1:kt=0,Xe=null,zs(e,n,g,1);break;case 2:case 9:if(Ld(g)){kt=0,Xe=null,_p(n);break}n=function(){kt!==2&&kt!==9||It!==e||(kt=7),vi(e)},g.then(n,n);break t;case 3:kt=7;break t;case 4:kt=5;break t;case 7:Ld(g)?(kt=0,Xe=null,_p(n)):(kt=0,Xe=null,zs(e,n,g,7));break;case 5:var v=null;switch(xt.tag){case 26:v=xt.memoizedState;case 5:case 27:var _=xt;if(v?cg(v):_.stateNode.complete){kt=0,Xe=null;var M=_.sibling;if(M!==null)xt=M;else{var U=_.return;U!==null?(xt=U,yl(U)):xt=null}break e}}kt=0,Xe=null,zs(e,n,g,5);break;case 6:kt=0,Xe=null,zs(e,n,g,6);break;case 8:Wc(),Qt=6;break t;default:throw Error(s(462))}}Pb();break}catch(G){vp(e,G)}while(!0);return Oi=Un=null,z.H=o,z.A=d,Nt=a,xt!==null?0:(It=null,_t=0,Pr(),Qt)}function Pb(){for(;xt!==null&&!r0();)wp(xt)}function wp(e){var n=Xf(e.alternate,e,Gi);e.memoizedProps=e.pendingProps,n===null?yl(e):xt=n}function _p(e){var n=e,a=n.alternate;switch(n.tag){case 15:case 0:n=If(a,n,n.pendingProps,n.type,void 0,_t);break;case 11:n=If(a,n,n.pendingProps,n.type.render,n.ref,_t);break;case 5:dc(n);default:Kf(a,n),n=xt=Sd(n,Gi),n=Xf(a,n,Gi)}e.memoizedProps=e.pendingProps,n===null?yl(e):xt=n}function zs(e,n,a,o){Oi=Un=null,dc(n),Es=null,xa=0;var d=n.return;try{if(Eb(e,d,n,a,_t)){Qt=1,al(e,ei(a,e.current)),xt=null;return}}catch(g){if(d!==null)throw xt=d,g;Qt=1,al(e,ei(a,e.current)),xt=null;return}n.flags&32768?(Tt||o===1?e=!0:Ls||(_t&536870912)!==0?e=!1:(un=e=!0,(o===2||o===9||o===3||o===6)&&(o=qe.current,o!==null&&o.tag===13&&(o.flags|=16384))),Ep(n,e)):yl(n)}function yl(e){var n=e;do{if((n.flags&32768)!==0){Ep(n,un);return}e=n.return;var a=Mb(n.alternate,n,Gi);if(a!==null){xt=a;return}if(n=n.sibling,n!==null){xt=n;return}xt=n=e}while(n!==null);Qt===0&&(Qt=5)}function Ep(e,n){do{var a=Rb(e.alternate,e);if(a!==null){a.flags&=32767,xt=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!n&&(e=e.sibling,e!==null)){xt=e;return}xt=e=a}while(e!==null);Qt=6,xt=null}function Tp(e,n,a,o,d,g,v,_,M){e.cancelPendingCommit=null;do vl();while(ue!==0);if((Nt&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(g=n.lanes|n.childLanes,g|=Uo,m0(e,a,g,v,_,M),e===It&&(xt=It=null,_t=0),ks=n,fn=e,Vi=a,Xc=g,$c=d,gp=o,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ib(Sr,function(){return Np(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||o){o=z.T,z.T=null,d=V.p,V.p=2,v=Nt,Nt|=4;try{Db(e,n,a)}finally{Nt=v,V.p=d,z.T=o}}ue=1,Cp(),Mp(),Rp()}}function Cp(){if(ue===1){ue=0;var e=fn,n=ks,a=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||a){a=z.T,z.T=null;var o=V.p;V.p=2;var d=Nt;Nt|=4;try{lp(n,e);var g=cu,v=dd(e.containerInfo),_=g.focusedElem,M=g.selectionRange;if(v!==_&&_&&_.ownerDocument&&hd(_.ownerDocument.documentElement,_)){if(M!==null&&ko(_)){var U=M.start,G=M.end;if(G===void 0&&(G=U),"selectionStart"in _)_.selectionStart=U,_.selectionEnd=Math.min(G,_.value.length);else{var X=_.ownerDocument||document,j=X&&X.defaultView||window;if(j.getSelection){var I=j.getSelection(),it=_.textContent.length,ct=Math.min(M.start,it),Ft=M.end===void 0?ct:Math.min(M.end,it);!I.extend&&ct>Ft&&(v=Ft,Ft=ct,ct=v);var B=ud(_,ct),N=ud(_,Ft);if(B&&N&&(I.rangeCount!==1||I.anchorNode!==B.node||I.anchorOffset!==B.offset||I.focusNode!==N.node||I.focusOffset!==N.offset)){var F=X.createRange();F.setStart(B.node,B.offset),I.removeAllRanges(),ct>Ft?(I.addRange(F),I.extend(N.node,N.offset)):(F.setEnd(N.node,N.offset),I.addRange(F))}}}}for(X=[],I=_;I=I.parentNode;)I.nodeType===1&&X.push({element:I,left:I.scrollLeft,top:I.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<X.length;_++){var Y=X[_];Y.element.scrollLeft=Y.left,Y.element.scrollTop=Y.top}}Nl=!!ou,cu=ou=null}finally{Nt=d,V.p=o,z.T=a}}e.current=n,ue=2}}function Mp(){if(ue===2){ue=0;var e=fn,n=ks,a=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||a){a=z.T,z.T=null;var o=V.p;V.p=2;var d=Nt;Nt|=4;try{ip(e,n.alternate,n)}finally{Nt=d,V.p=o,z.T=a}}ue=3}}function Rp(){if(ue===4||ue===3){ue=0,l0();var e=fn,n=ks,a=Vi,o=gp;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?ue=5:(ue=0,ks=fn=null,Dp(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(dn=null),go(a),n=n.stateNode,Ie&&typeof Ie.onCommitFiberRoot=="function")try{Ie.onCommitFiberRoot(sa,n,void 0,(n.current.flags&128)===128)}catch{}if(o!==null){n=z.T,d=V.p,V.p=2,z.T=null;try{for(var g=e.onRecoverableError,v=0;v<o.length;v++){var _=o[v];g(_.value,{componentStack:_.stack})}}finally{z.T=n,V.p=d}}(Vi&3)!==0&&vl(),vi(e),d=e.pendingLanes,(a&261930)!==0&&(d&42)!==0?e===Kc?Ua++:(Ua=0,Kc=e):Ua=0,ja(0)}}function Dp(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Aa(n)))}function vl(){return Cp(),Mp(),Rp(),Np()}function Np(){if(ue!==5)return!1;var e=fn,n=Xc;Xc=0;var a=go(Vi),o=z.T,d=V.p;try{V.p=32>a?32:a,z.T=null,a=$c,$c=null;var g=fn,v=Vi;if(ue=0,ks=fn=null,Vi=0,(Nt&6)!==0)throw Error(s(331));var _=Nt;if(Nt|=4,dp(g.current),cp(g,g.current,v,a),Nt=_,ja(0,!1),Ie&&typeof Ie.onPostCommitFiberRoot=="function")try{Ie.onPostCommitFiberRoot(sa,g)}catch{}return!0}finally{V.p=d,z.T=o,Dp(e,n)}}function Lp(e,n,a){n=ei(a,n),n=Cc(e.stateNode,n,2),e=rn(e,n,2),e!==null&&(ra(e,2),vi(e))}function Bt(e,n,a){if(e.tag===3)Lp(e,e,a);else for(;n!==null;){if(n.tag===3){Lp(n,e,a);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(dn===null||!dn.has(o))){e=ei(a,e),a=Of(2),o=rn(n,a,2),o!==null&&(kf(a,o,n,e),ra(o,2),vi(o));break}}n=n.return}}function Zc(e,n,a){var o=e.pingCache;if(o===null){o=e.pingCache=new Ob;var d=new Set;o.set(n,d)}else d=o.get(n),d===void 0&&(d=new Set,o.set(n,d));d.has(a)||(Vc=!0,d.add(a),e=Fb.bind(null,e,n,a),n.then(e,e))}function Fb(e,n,a){var o=e.pingCache;o!==null&&o.delete(n),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,It===e&&(_t&a)===a&&(Qt===4||Qt===3&&(_t&62914560)===_t&&300>je()-fl?(Nt&2)===0&&Bs(e,0):qc|=a,Os===_t&&(Os=0)),vi(e)}function Op(e,n){n===0&&(n=Th()),e=zn(e,n),e!==null&&(ra(e,n),vi(e))}function Ub(e){var n=e.memoizedState,a=0;n!==null&&(a=n.retryLane),Op(e,a)}function jb(e,n){var a=0;switch(e.tag){case 31:case 13:var o=e.stateNode,d=e.memoizedState;d!==null&&(a=d.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(s(314))}o!==null&&o.delete(n),Op(e,a)}function Ib(e,n){return uo(e,n)}var Al=null,Ps=null,Jc=!1,Sl=!1,tu=!1,gn=0;function vi(e){e!==Ps&&e.next===null&&(Ps===null?Al=Ps=e:Ps=Ps.next=e),Sl=!0,Jc||(Jc=!0,Gb())}function ja(e,n){if(!tu&&Sl){tu=!0;do for(var a=!1,o=Al;o!==null;){if(e!==0){var d=o.pendingLanes;if(d===0)var g=0;else{var v=o.suspendedLanes,_=o.pingedLanes;g=(1<<31-He(42|e)+1)-1,g&=d&~(v&~_),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(a=!0,Pp(o,g))}else g=_t,g=Er(o,o===It?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(g&3)===0||aa(o,g)||(a=!0,Pp(o,g));o=o.next}while(a);tu=!1}}function Hb(){kp()}function kp(){Sl=Jc=!1;var e=0;gn!==0&&Jb()&&(e=gn);for(var n=je(),a=null,o=Al;o!==null;){var d=o.next,g=Bp(o,n);g===0?(o.next=null,a===null?Al=d:a.next=d,d===null&&(Ps=a)):(a=o,(e!==0||(g&3)!==0)&&(Sl=!0)),o=d}ue!==0&&ue!==5||ja(e),gn!==0&&(gn=0)}function Bp(e,n){for(var a=e.suspendedLanes,o=e.pingedLanes,d=e.expirationTimes,g=e.pendingLanes&-62914561;0<g;){var v=31-He(g),_=1<<v,M=d[v];M===-1?((_&a)===0||(_&o)!==0)&&(d[v]=g0(_,n)):M<=n&&(e.expiredLanes|=_),g&=~_}if(n=It,a=_t,a=Er(e,e===n?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,a===0||e===n&&(kt===2||kt===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&ho(o),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||aa(e,a)){if(n=a&-a,n===e.callbackPriority)return n;switch(o!==null&&ho(o),go(a)){case 2:case 8:a=_h;break;case 32:a=Sr;break;case 268435456:a=Eh;break;default:a=Sr}return o=zp.bind(null,e),a=uo(a,o),e.callbackPriority=n,e.callbackNode=a,n}return o!==null&&o!==null&&ho(o),e.callbackPriority=2,e.callbackNode=null,2}function zp(e,n){if(ue!==0&&ue!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(vl()&&e.callbackNode!==a)return null;var o=_t;return o=Er(e,e===It?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(bp(e,o,n),Bp(e,je()),e.callbackNode!=null&&e.callbackNode===a?zp.bind(null,e):null)}function Pp(e,n){if(vl())return null;bp(e,n,!0)}function Gb(){ey(function(){(Nt&6)!==0?uo(wh,Hb):kp()})}function eu(){if(gn===0){var e=xs;e===0&&(e=xr,xr<<=1,(xr&261888)===0&&(xr=256)),gn=e}return gn}function Fp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Rr(""+e)}function Up(e,n){var a=n.ownerDocument.createElement("input");return a.name=n.name,a.value=n.value,e.id&&a.setAttribute("form",e.id),n.parentNode.insertBefore(a,n),e=new FormData(e),a.parentNode.removeChild(a),e}function Vb(e,n,a,o,d){if(n==="submit"&&a&&a.stateNode===d){var g=Fp((d[De]||null).action),v=o.submitter;v&&(n=(n=v[De]||null)?Fp(n.formAction):v.getAttribute("formAction"),n!==null&&(g=n,v=null));var _=new Or("action","action",null,o,d);e.push({event:_,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(gn!==0){var M=v?Up(d,v):new FormData(d);Sc(a,{pending:!0,data:M,method:d.method,action:g},null,M)}}else typeof g=="function"&&(_.preventDefault(),M=v?Up(d,v):new FormData(d),Sc(a,{pending:!0,data:M,method:d.method,action:g},g,M))},currentTarget:d}]})}}for(var iu=0;iu<Fo.length;iu++){var nu=Fo[iu],qb=nu.toLowerCase(),Yb=nu[0].toUpperCase()+nu.slice(1);di(qb,"on"+Yb)}di(gd,"onAnimationEnd"),di(md,"onAnimationIteration"),di(bd,"onAnimationStart"),di("dblclick","onDoubleClick"),di("focusin","onFocus"),di("focusout","onBlur"),di(ob,"onTransitionRun"),di(cb,"onTransitionStart"),di(ub,"onTransitionCancel"),di(yd,"onTransitionEnd"),os("onMouseEnter",["mouseout","mouseover"]),os("onMouseLeave",["mouseout","mouseover"]),os("onPointerEnter",["pointerout","pointerover"]),os("onPointerLeave",["pointerout","pointerover"]),Ln("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ln("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ln("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ln("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ln("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ln("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ia="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ia));function jp(e,n){n=(n&4)!==0;for(var a=0;a<e.length;a++){var o=e[a],d=o.event;o=o.listeners;t:{var g=void 0;if(n)for(var v=o.length-1;0<=v;v--){var _=o[v],M=_.instance,U=_.currentTarget;if(_=_.listener,M!==g&&d.isPropagationStopped())break t;g=_,d.currentTarget=U;try{g(d)}catch(G){zr(G)}d.currentTarget=null,g=M}else for(v=0;v<o.length;v++){if(_=o[v],M=_.instance,U=_.currentTarget,_=_.listener,M!==g&&d.isPropagationStopped())break t;g=_,d.currentTarget=U;try{g(d)}catch(G){zr(G)}d.currentTarget=null,g=M}}}}function wt(e,n){var a=n[mo];a===void 0&&(a=n[mo]=new Set);var o=e+"__bubble";a.has(o)||(Ip(n,e,2,!1),a.add(o))}function su(e,n,a){var o=0;n&&(o|=4),Ip(a,e,o,n)}var xl="_reactListening"+Math.random().toString(36).slice(2);function au(e){if(!e[xl]){e[xl]=!0,Oh.forEach(function(a){a!=="selectionchange"&&(Xb.has(a)||su(a,!1,e),su(a,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[xl]||(n[xl]=!0,su("selectionchange",!1,n))}}function Ip(e,n,a,o){switch(mg(n)){case 2:var d=Sy;break;case 8:d=xy;break;default:d=Au}a=d.bind(null,n,a,e),d=void 0,!Eo||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(d=!0),o?d!==void 0?e.addEventListener(n,a,{capture:!0,passive:d}):e.addEventListener(n,a,!0):d!==void 0?e.addEventListener(n,a,{passive:d}):e.addEventListener(n,a,!1)}function ru(e,n,a,o,d){var g=o;if((n&1)===0&&(n&2)===0&&o!==null)t:for(;;){if(o===null)return;var v=o.tag;if(v===3||v===4){var _=o.stateNode.containerInfo;if(_===d)break;if(v===4)for(v=o.return;v!==null;){var M=v.tag;if((M===3||M===4)&&v.stateNode.containerInfo===d)return;v=v.return}for(;_!==null;){if(v=as(_),v===null)return;if(M=v.tag,M===5||M===6||M===26||M===27){o=g=v;continue t}_=_.parentNode}}o=o.return}qh(function(){var U=g,G=wo(a),X=[];t:{var j=vd.get(e);if(j!==void 0){var I=Or,it=e;switch(e){case"keypress":if(Nr(a)===0)break t;case"keydown":case"keyup":I=j0;break;case"focusin":it="focus",I=Ro;break;case"focusout":it="blur",I=Ro;break;case"beforeblur":case"afterblur":I=Ro;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=$h;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=M0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=G0;break;case gd:case md:case bd:I=N0;break;case yd:I=q0;break;case"scroll":case"scrollend":I=T0;break;case"wheel":I=X0;break;case"copy":case"cut":case"paste":I=O0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Wh;break;case"toggle":case"beforetoggle":I=K0}var ct=(n&4)!==0,Ft=!ct&&(e==="scroll"||e==="scrollend"),B=ct?j!==null?j+"Capture":null:j;ct=[];for(var N=U,F;N!==null;){var Y=N;if(F=Y.stateNode,Y=Y.tag,Y!==5&&Y!==26&&Y!==27||F===null||B===null||(Y=ca(N,B),Y!=null&&ct.push(Ha(N,Y,F))),Ft)break;N=N.return}0<ct.length&&(j=new I(j,it,null,a,G),X.push({event:j,listeners:ct}))}}if((n&7)===0){t:{if(j=e==="mouseover"||e==="pointerover",I=e==="mouseout"||e==="pointerout",j&&a!==xo&&(it=a.relatedTarget||a.fromElement)&&(as(it)||it[ss]))break t;if((I||j)&&(j=G.window===G?G:(j=G.ownerDocument)?j.defaultView||j.parentWindow:window,I?(it=a.relatedTarget||a.toElement,I=U,it=it?as(it):null,it!==null&&(Ft=l(it),ct=it.tag,it!==Ft||ct!==5&&ct!==27&&ct!==6)&&(it=null)):(I=null,it=U),I!==it)){if(ct=$h,Y="onMouseLeave",B="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(ct=Wh,Y="onPointerLeave",B="onPointerEnter",N="pointer"),Ft=I==null?j:oa(I),F=it==null?j:oa(it),j=new ct(Y,N+"leave",I,a,G),j.target=Ft,j.relatedTarget=F,Y=null,as(G)===U&&(ct=new ct(B,N+"enter",it,a,G),ct.target=F,ct.relatedTarget=Ft,Y=ct),Ft=Y,I&&it)e:{for(ct=$b,B=I,N=it,F=0,Y=B;Y;Y=ct(Y))F++;Y=0;for(var at=N;at;at=ct(at))Y++;for(;0<F-Y;)B=ct(B),F--;for(;0<Y-F;)N=ct(N),Y--;for(;F--;){if(B===N||N!==null&&B===N.alternate){ct=B;break e}B=ct(B),N=ct(N)}ct=null}else ct=null;I!==null&&Hp(X,j,I,ct,!1),it!==null&&Ft!==null&&Hp(X,Ft,it,ct,!0)}}t:{if(j=U?oa(U):window,I=j.nodeName&&j.nodeName.toLowerCase(),I==="select"||I==="input"&&j.type==="file")var Rt=sd;else if(id(j))if(ad)Rt=ab;else{Rt=nb;var st=ib}else I=j.nodeName,!I||I.toLowerCase()!=="input"||j.type!=="checkbox"&&j.type!=="radio"?U&&So(U.elementType)&&(Rt=sd):Rt=sb;if(Rt&&(Rt=Rt(e,U))){nd(X,Rt,a,G);break t}st&&st(e,j,U),e==="focusout"&&U&&j.type==="number"&&U.memoizedProps.value!=null&&Ao(j,"number",j.value)}switch(st=U?oa(U):window,e){case"focusin":(id(st)||st.contentEditable==="true")&&(ps=st,Bo=U,ba=null);break;case"focusout":ba=Bo=ps=null;break;case"mousedown":zo=!0;break;case"contextmenu":case"mouseup":case"dragend":zo=!1,fd(X,a,G);break;case"selectionchange":if(lb)break;case"keydown":case"keyup":fd(X,a,G)}var yt;if(No)t:{switch(e){case"compositionstart":var Et="onCompositionStart";break t;case"compositionend":Et="onCompositionEnd";break t;case"compositionupdate":Et="onCompositionUpdate";break t}Et=void 0}else fs?td(e,a)&&(Et="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Et="onCompositionStart");Et&&(Qh&&a.locale!=="ko"&&(fs||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&fs&&(yt=Yh()):(Zi=G,To="value"in Zi?Zi.value:Zi.textContent,fs=!0)),st=wl(U,Et),0<st.length&&(Et=new Kh(Et,e,null,a,G),X.push({event:Et,listeners:st}),yt?Et.data=yt:(yt=ed(a),yt!==null&&(Et.data=yt)))),(yt=Q0?Z0(e,a):J0(e,a))&&(Et=wl(U,"onBeforeInput"),0<Et.length&&(st=new Kh("onBeforeInput","beforeinput",null,a,G),X.push({event:st,listeners:Et}),st.data=yt)),Vb(X,e,U,a,G)}jp(X,n)})}function Ha(e,n,a){return{instance:e,listener:n,currentTarget:a}}function wl(e,n){for(var a=n+"Capture",o=[];e!==null;){var d=e,g=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||g===null||(d=ca(e,a),d!=null&&o.unshift(Ha(e,d,g)),d=ca(e,n),d!=null&&o.push(Ha(e,d,g))),e.tag===3)return o;e=e.return}return[]}function $b(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Hp(e,n,a,o,d){for(var g=n._reactName,v=[];a!==null&&a!==o;){var _=a,M=_.alternate,U=_.stateNode;if(_=_.tag,M!==null&&M===o)break;_!==5&&_!==26&&_!==27||U===null||(M=U,d?(U=ca(a,g),U!=null&&v.unshift(Ha(a,U,M))):d||(U=ca(a,g),U!=null&&v.push(Ha(a,U,M)))),a=a.return}v.length!==0&&e.push({event:n,listeners:v})}var Kb=/\r\n?/g,Wb=/\u0000|\uFFFD/g;function Gp(e){return(typeof e=="string"?e:""+e).replace(Kb,`
`).replace(Wb,"")}function Vp(e,n){return n=Gp(n),Gp(e)===n}function Pt(e,n,a,o,d,g){switch(a){case"children":typeof o=="string"?n==="body"||n==="textarea"&&o===""||us(e,o):(typeof o=="number"||typeof o=="bigint")&&n!=="body"&&us(e,""+o);break;case"className":Cr(e,"class",o);break;case"tabIndex":Cr(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":Cr(e,a,o);break;case"style":Gh(e,o,g);break;case"data":if(n!=="object"){Cr(e,"data",o);break}case"src":case"href":if(o===""&&(n!=="a"||a!=="href")){e.removeAttribute(a);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Rr(""+o),e.setAttribute(a,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(a==="formAction"?(n!=="input"&&Pt(e,n,"name",d.name,d,null),Pt(e,n,"formEncType",d.formEncType,d,null),Pt(e,n,"formMethod",d.formMethod,d,null),Pt(e,n,"formTarget",d.formTarget,d,null)):(Pt(e,n,"encType",d.encType,d,null),Pt(e,n,"method",d.method,d,null),Pt(e,n,"target",d.target,d,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Rr(""+o),e.setAttribute(a,o);break;case"onClick":o!=null&&(e.onclick=Ri);break;case"onScroll":o!=null&&wt("scroll",e);break;case"onScrollEnd":o!=null&&wt("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}a=Rr(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""+o):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":o===!0?e.setAttribute(a,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,o):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(a,o):e.removeAttribute(a);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(a):e.setAttribute(a,o);break;case"popover":wt("beforetoggle",e),wt("toggle",e),Tr(e,"popover",o);break;case"xlinkActuate":Mi(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Mi(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Mi(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Mi(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Mi(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Mi(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Mi(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Mi(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Mi(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":Tr(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=_0.get(a)||a,Tr(e,a,o))}}function lu(e,n,a,o,d,g){switch(a){case"style":Gh(e,o,g);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof o=="string"?us(e,o):(typeof o=="number"||typeof o=="bigint")&&us(e,""+o);break;case"onScroll":o!=null&&wt("scroll",e);break;case"onScrollEnd":o!=null&&wt("scrollend",e);break;case"onClick":o!=null&&(e.onclick=Ri);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kh.hasOwnProperty(a))t:{if(a[0]==="o"&&a[1]==="n"&&(d=a.endsWith("Capture"),n=a.slice(2,d?a.length-7:void 0),g=e[De]||null,g=g!=null?g[a]:null,typeof g=="function"&&e.removeEventListener(n,g,d),typeof o=="function")){typeof g!="function"&&g!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(n,o,d);break t}a in e?e[a]=o:o===!0?e.setAttribute(a,""):Tr(e,a,o)}}}function ve(e,n,a){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wt("error",e),wt("load",e);var o=!1,d=!1,g;for(g in a)if(a.hasOwnProperty(g)){var v=a[g];if(v!=null)switch(g){case"src":o=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Pt(e,n,g,v,a,null)}}d&&Pt(e,n,"srcSet",a.srcSet,a,null),o&&Pt(e,n,"src",a.src,a,null);return;case"input":wt("invalid",e);var _=g=v=d=null,M=null,U=null;for(o in a)if(a.hasOwnProperty(o)){var G=a[o];if(G!=null)switch(o){case"name":d=G;break;case"type":v=G;break;case"checked":M=G;break;case"defaultChecked":U=G;break;case"value":g=G;break;case"defaultValue":_=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(s(137,n));break;default:Pt(e,n,o,G,a,null)}}Uh(e,g,_,M,U,v,d,!1);return;case"select":wt("invalid",e),o=v=g=null;for(d in a)if(a.hasOwnProperty(d)&&(_=a[d],_!=null))switch(d){case"value":g=_;break;case"defaultValue":v=_;break;case"multiple":o=_;default:Pt(e,n,d,_,a,null)}n=g,a=v,e.multiple=!!o,n!=null?cs(e,!!o,n,!1):a!=null&&cs(e,!!o,a,!0);return;case"textarea":wt("invalid",e),g=d=o=null;for(v in a)if(a.hasOwnProperty(v)&&(_=a[v],_!=null))switch(v){case"value":o=_;break;case"defaultValue":d=_;break;case"children":g=_;break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(s(91));break;default:Pt(e,n,v,_,a,null)}Ih(e,o,d,g);return;case"option":for(M in a)if(a.hasOwnProperty(M)&&(o=a[M],o!=null))switch(M){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:Pt(e,n,M,o,a,null)}return;case"dialog":wt("beforetoggle",e),wt("toggle",e),wt("cancel",e),wt("close",e);break;case"iframe":case"object":wt("load",e);break;case"video":case"audio":for(o=0;o<Ia.length;o++)wt(Ia[o],e);break;case"image":wt("error",e),wt("load",e);break;case"details":wt("toggle",e);break;case"embed":case"source":case"link":wt("error",e),wt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(U in a)if(a.hasOwnProperty(U)&&(o=a[U],o!=null))switch(U){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Pt(e,n,U,o,a,null)}return;default:if(So(n)){for(G in a)a.hasOwnProperty(G)&&(o=a[G],o!==void 0&&lu(e,n,G,o,a,void 0));return}}for(_ in a)a.hasOwnProperty(_)&&(o=a[_],o!=null&&Pt(e,n,_,o,a,null))}function Qb(e,n,a,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,g=null,v=null,_=null,M=null,U=null,G=null;for(I in a){var X=a[I];if(a.hasOwnProperty(I)&&X!=null)switch(I){case"checked":break;case"value":break;case"defaultValue":M=X;default:o.hasOwnProperty(I)||Pt(e,n,I,null,o,X)}}for(var j in o){var I=o[j];if(X=a[j],o.hasOwnProperty(j)&&(I!=null||X!=null))switch(j){case"type":g=I;break;case"name":d=I;break;case"checked":U=I;break;case"defaultChecked":G=I;break;case"value":v=I;break;case"defaultValue":_=I;break;case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(s(137,n));break;default:I!==X&&Pt(e,n,j,I,o,X)}}vo(e,v,_,M,U,G,g,d);return;case"select":I=v=_=j=null;for(g in a)if(M=a[g],a.hasOwnProperty(g)&&M!=null)switch(g){case"value":break;case"multiple":I=M;default:o.hasOwnProperty(g)||Pt(e,n,g,null,o,M)}for(d in o)if(g=o[d],M=a[d],o.hasOwnProperty(d)&&(g!=null||M!=null))switch(d){case"value":j=g;break;case"defaultValue":_=g;break;case"multiple":v=g;default:g!==M&&Pt(e,n,d,g,o,M)}n=_,a=v,o=I,j!=null?cs(e,!!a,j,!1):!!o!=!!a&&(n!=null?cs(e,!!a,n,!0):cs(e,!!a,a?[]:"",!1));return;case"textarea":I=j=null;for(_ in a)if(d=a[_],a.hasOwnProperty(_)&&d!=null&&!o.hasOwnProperty(_))switch(_){case"value":break;case"children":break;default:Pt(e,n,_,null,o,d)}for(v in o)if(d=o[v],g=a[v],o.hasOwnProperty(v)&&(d!=null||g!=null))switch(v){case"value":j=d;break;case"defaultValue":I=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(s(91));break;default:d!==g&&Pt(e,n,v,d,o,g)}jh(e,j,I);return;case"option":for(var it in a)if(j=a[it],a.hasOwnProperty(it)&&j!=null&&!o.hasOwnProperty(it))switch(it){case"selected":e.selected=!1;break;default:Pt(e,n,it,null,o,j)}for(M in o)if(j=o[M],I=a[M],o.hasOwnProperty(M)&&j!==I&&(j!=null||I!=null))switch(M){case"selected":e.selected=j&&typeof j!="function"&&typeof j!="symbol";break;default:Pt(e,n,M,j,o,I)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ct in a)j=a[ct],a.hasOwnProperty(ct)&&j!=null&&!o.hasOwnProperty(ct)&&Pt(e,n,ct,null,o,j);for(U in o)if(j=o[U],I=a[U],o.hasOwnProperty(U)&&j!==I&&(j!=null||I!=null))switch(U){case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(137,n));break;default:Pt(e,n,U,j,o,I)}return;default:if(So(n)){for(var Ft in a)j=a[Ft],a.hasOwnProperty(Ft)&&j!==void 0&&!o.hasOwnProperty(Ft)&&lu(e,n,Ft,void 0,o,j);for(G in o)j=o[G],I=a[G],!o.hasOwnProperty(G)||j===I||j===void 0&&I===void 0||lu(e,n,G,j,o,I);return}}for(var B in a)j=a[B],a.hasOwnProperty(B)&&j!=null&&!o.hasOwnProperty(B)&&Pt(e,n,B,null,o,j);for(X in o)j=o[X],I=a[X],!o.hasOwnProperty(X)||j===I||j==null&&I==null||Pt(e,n,X,j,o,I)}function qp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Zb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,a=performance.getEntriesByType("resource"),o=0;o<a.length;o++){var d=a[o],g=d.transferSize,v=d.initiatorType,_=d.duration;if(g&&_&&qp(v)){for(v=0,_=d.responseEnd,o+=1;o<a.length;o++){var M=a[o],U=M.startTime;if(U>_)break;var G=M.transferSize,X=M.initiatorType;G&&qp(X)&&(M=M.responseEnd,v+=G*(M<_?1:(_-U)/(M-U)))}if(--o,n+=8*(g+v)/(d.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var ou=null,cu=null;function _l(e){return e.nodeType===9?e:e.ownerDocument}function Yp(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xp(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function uu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var hu=null;function Jb(){var e=window.event;return e&&e.type==="popstate"?e===hu?!1:(hu=e,!0):(hu=null,!1)}var $p=typeof setTimeout=="function"?setTimeout:void 0,ty=typeof clearTimeout=="function"?clearTimeout:void 0,Kp=typeof Promise=="function"?Promise:void 0,ey=typeof queueMicrotask=="function"?queueMicrotask:typeof Kp<"u"?function(e){return Kp.resolve(null).then(e).catch(iy)}:$p;function iy(e){setTimeout(function(){throw e})}function mn(e){return e==="head"}function Wp(e,n){var a=n,o=0;do{var d=a.nextSibling;if(e.removeChild(a),d&&d.nodeType===8)if(a=d.data,a==="/$"||a==="/&"){if(o===0){e.removeChild(d),Is(n);return}o--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")o++;else if(a==="html")Ga(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,Ga(a);for(var g=a.firstChild;g;){var v=g.nextSibling,_=g.nodeName;g[la]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&g.rel.toLowerCase()==="stylesheet"||a.removeChild(g),g=v}}else a==="body"&&Ga(e.ownerDocument.body);a=d}while(a);Is(n)}function Qp(e,n){var a=e;e=0;do{var o=a.nextSibling;if(a.nodeType===1?n?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(n?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=o}while(a)}function du(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var a=n;switch(n=n.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":du(a),bo(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function ny(e,n,a,o){for(;e.nodeType===1;){var d=a;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[la])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(g=e.getAttribute("rel"),g==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(g!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(g=e.getAttribute("src"),(g!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&g&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var g=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===g)return e}else return e;if(e=ri(e.nextSibling),e===null)break}return null}function sy(e,n,a){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=ri(e.nextSibling),e===null))return null;return e}function Zp(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=ri(e.nextSibling),e===null))return null;return e}function fu(e){return e.data==="$?"||e.data==="$~"}function pu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function ay(e,n){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||a.readyState!=="loading")n();else{var o=function(){n(),a.removeEventListener("DOMContentLoaded",o)};a.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function ri(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var gu=null;function Jp(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(n===0)return ri(e.nextSibling);n--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||n++}e=e.nextSibling}return null}function tg(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(n===0)return e;n--}else a!=="/$"&&a!=="/&"||n++}e=e.previousSibling}return null}function eg(e,n,a){switch(n=_l(a),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Ga(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);bo(e)}var li=new Map,ig=new Set;function El(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var qi=V.d;V.d={f:ry,r:ly,D:oy,C:cy,L:uy,m:hy,X:fy,S:dy,M:py};function ry(){var e=qi.f(),n=ml();return e||n}function ly(e){var n=rs(e);n!==null&&n.tag===5&&n.type==="form"?vf(n):qi.r(e)}var Fs=typeof document>"u"?null:document;function ng(e,n,a){var o=Fs;if(o&&typeof n=="string"&&n){var d=Je(n);d='link[rel="'+e+'"][href="'+d+'"]',typeof a=="string"&&(d+='[crossorigin="'+a+'"]'),ig.has(d)||(ig.add(d),e={rel:e,crossOrigin:a,href:n},o.querySelector(d)===null&&(n=o.createElement("link"),ve(n,"link",e),he(n),o.head.appendChild(n)))}}function oy(e){qi.D(e),ng("dns-prefetch",e,null)}function cy(e,n){qi.C(e,n),ng("preconnect",e,n)}function uy(e,n,a){qi.L(e,n,a);var o=Fs;if(o&&e&&n){var d='link[rel="preload"][as="'+Je(n)+'"]';n==="image"&&a&&a.imageSrcSet?(d+='[imagesrcset="'+Je(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(d+='[imagesizes="'+Je(a.imageSizes)+'"]')):d+='[href="'+Je(e)+'"]';var g=d;switch(n){case"style":g=Us(e);break;case"script":g=js(e)}li.has(g)||(e=b({rel:"preload",href:n==="image"&&a&&a.imageSrcSet?void 0:e,as:n},a),li.set(g,e),o.querySelector(d)!==null||n==="style"&&o.querySelector(Va(g))||n==="script"&&o.querySelector(qa(g))||(n=o.createElement("link"),ve(n,"link",e),he(n),o.head.appendChild(n)))}}function hy(e,n){qi.m(e,n);var a=Fs;if(a&&e){var o=n&&typeof n.as=="string"?n.as:"script",d='link[rel="modulepreload"][as="'+Je(o)+'"][href="'+Je(e)+'"]',g=d;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=js(e)}if(!li.has(g)&&(e=b({rel:"modulepreload",href:e},n),li.set(g,e),a.querySelector(d)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(qa(g)))return}o=a.createElement("link"),ve(o,"link",e),he(o),a.head.appendChild(o)}}}function dy(e,n,a){qi.S(e,n,a);var o=Fs;if(o&&e){var d=ls(o).hoistableStyles,g=Us(e);n=n||"default";var v=d.get(g);if(!v){var _={loading:0,preload:null};if(v=o.querySelector(Va(g)))_.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":n},a),(a=li.get(g))&&mu(e,a);var M=v=o.createElement("link");he(M),ve(M,"link",e),M._p=new Promise(function(U,G){M.onload=U,M.onerror=G}),M.addEventListener("load",function(){_.loading|=1}),M.addEventListener("error",function(){_.loading|=2}),_.loading|=4,Tl(v,n,o)}v={type:"stylesheet",instance:v,count:1,state:_},d.set(g,v)}}}function fy(e,n){qi.X(e,n);var a=Fs;if(a&&e){var o=ls(a).hoistableScripts,d=js(e),g=o.get(d);g||(g=a.querySelector(qa(d)),g||(e=b({src:e,async:!0},n),(n=li.get(d))&&bu(e,n),g=a.createElement("script"),he(g),ve(g,"link",e),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(d,g))}}function py(e,n){qi.M(e,n);var a=Fs;if(a&&e){var o=ls(a).hoistableScripts,d=js(e),g=o.get(d);g||(g=a.querySelector(qa(d)),g||(e=b({src:e,async:!0,type:"module"},n),(n=li.get(d))&&bu(e,n),g=a.createElement("script"),he(g),ve(g,"link",e),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(d,g))}}function sg(e,n,a,o){var d=(d=ut.current)?El(d):null;if(!d)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(n=Us(a.href),a=ls(d).hoistableStyles,o=a.get(n),o||(o={type:"style",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Us(a.href);var g=ls(d).hoistableStyles,v=g.get(e);if(v||(d=d.ownerDocument||d,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(e,v),(g=d.querySelector(Va(e)))&&!g._p&&(v.instance=g,v.state.loading=5),li.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},li.set(e,a),g||gy(d,e,a,v.state))),n&&o===null)throw Error(s(528,""));return v}if(n&&o!==null)throw Error(s(529,""));return null;case"script":return n=a.async,a=a.src,typeof a=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=js(a),a=ls(d).hoistableScripts,o=a.get(n),o||(o={type:"script",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Us(e){return'href="'+Je(e)+'"'}function Va(e){return'link[rel="stylesheet"]['+e+"]"}function ag(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function gy(e,n,a,o){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?o.loading=1:(n=e.createElement("link"),o.preload=n,n.addEventListener("load",function(){return o.loading|=1}),n.addEventListener("error",function(){return o.loading|=2}),ve(n,"link",a),he(n),e.head.appendChild(n))}function js(e){return'[src="'+Je(e)+'"]'}function qa(e){return"script[async]"+e}function rg(e,n,a){if(n.count++,n.instance===null)switch(n.type){case"style":var o=e.querySelector('style[data-href~="'+Je(a.href)+'"]');if(o)return n.instance=o,he(o),o;var d=b({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),he(o),ve(o,"style",d),Tl(o,a.precedence,e),n.instance=o;case"stylesheet":d=Us(a.href);var g=e.querySelector(Va(d));if(g)return n.state.loading|=4,n.instance=g,he(g),g;o=ag(a),(d=li.get(d))&&mu(o,d),g=(e.ownerDocument||e).createElement("link"),he(g);var v=g;return v._p=new Promise(function(_,M){v.onload=_,v.onerror=M}),ve(g,"link",o),n.state.loading|=4,Tl(g,a.precedence,e),n.instance=g;case"script":return g=js(a.src),(d=e.querySelector(qa(g)))?(n.instance=d,he(d),d):(o=a,(d=li.get(g))&&(o=b({},a),bu(o,d)),e=e.ownerDocument||e,d=e.createElement("script"),he(d),ve(d,"link",o),e.head.appendChild(d),n.instance=d);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(o=n.instance,n.state.loading|=4,Tl(o,a.precedence,e));return n.instance}function Tl(e,n,a){for(var o=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=o.length?o[o.length-1]:null,g=d,v=0;v<o.length;v++){var _=o[v];if(_.dataset.precedence===n)g=_;else if(g!==d)break}g?g.parentNode.insertBefore(e,g.nextSibling):(n=a.nodeType===9?a.head:a,n.insertBefore(e,n.firstChild))}function mu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function bu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Cl=null;function lg(e,n,a){if(Cl===null){var o=new Map,d=Cl=new Map;d.set(a,o)}else d=Cl,o=d.get(a),o||(o=new Map,d.set(a,o));if(o.has(e))return o;for(o.set(e,null),a=a.getElementsByTagName(e),d=0;d<a.length;d++){var g=a[d];if(!(g[la]||g[ge]||e==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var v=g.getAttribute(n)||"";v=e+v;var _=o.get(v);_?_.push(g):o.set(v,[g])}}return o}function og(e,n,a){e=e.ownerDocument||e,e.head.insertBefore(a,n==="title"?e.querySelector("head > title"):null)}function my(e,n,a){if(a===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function cg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function by(e,n,a,o){if(a.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var d=Us(o.href),g=n.querySelector(Va(d));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=Ml.bind(e),n.then(e,e)),a.state.loading|=4,a.instance=g,he(g);return}g=n.ownerDocument||n,o=ag(o),(d=li.get(d))&&mu(o,d),g=g.createElement("link"),he(g);var v=g;v._p=new Promise(function(_,M){v.onload=_,v.onerror=M}),ve(g,"link",o),a.instance=g}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,n),(n=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=Ml.bind(e),n.addEventListener("load",a),n.addEventListener("error",a))}}var yu=0;function yy(e,n){return e.stylesheets&&e.count===0&&Dl(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var o=setTimeout(function(){if(e.stylesheets&&Dl(e,e.stylesheets),e.unsuspend){var g=e.unsuspend;e.unsuspend=null,g()}},6e4+n);0<e.imgBytes&&yu===0&&(yu=62500*Zb());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Dl(e,e.stylesheets),e.unsuspend)){var g=e.unsuspend;e.unsuspend=null,g()}},(e.imgBytes>yu?50:800)+n);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(o),clearTimeout(d)}}:null}function Ml(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Dl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Rl=null;function Dl(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Rl=new Map,n.forEach(vy,e),Rl=null,Ml.call(e))}function vy(e,n){if(!(n.state.loading&4)){var a=Rl.get(e);if(a)var o=a.get(null);else{a=new Map,Rl.set(e,a);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<d.length;g++){var v=d[g];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(a.set(v.dataset.precedence,v),o=v)}o&&a.set(null,o)}d=n.instance,v=d.getAttribute("data-precedence"),g=a.get(v)||o,g===o&&a.set(null,d),a.set(v,d),this.count++,o=Ml.bind(this),d.addEventListener("load",o),d.addEventListener("error",o),g?g.parentNode.insertBefore(d,g.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),n.state.loading|=4}}var Ya={$$typeof:C,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function Ay(e,n,a,o,d,g,v,_,M){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fo(0),this.hiddenUpdates=fo(null),this.identifierPrefix=o,this.onUncaughtError=d,this.onCaughtError=g,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function ug(e,n,a,o,d,g,v,_,M,U,G,X){return e=new Ay(e,n,a,v,M,U,G,X,_),n=1,g===!0&&(n|=24),g=Ve(3,null,null,n),e.current=g,g.stateNode=e,n=Qo(),n.refCount++,e.pooledCache=n,n.refCount++,g.memoizedState={element:o,isDehydrated:a,cache:n},ec(g),e}function hg(e){return e?(e=bs,e):bs}function dg(e,n,a,o,d,g){d=hg(d),o.context===null?o.context=d:o.pendingContext=d,o=an(n),o.payload={element:a},g=g===void 0?null:g,g!==null&&(o.callback=g),a=rn(e,o,n),a!==null&&(ze(a,e,n),_a(a,e,n))}function fg(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<n?a:n}}function vu(e,n){fg(e,n),(e=e.alternate)&&fg(e,n)}function pg(e){if(e.tag===13||e.tag===31){var n=zn(e,67108864);n!==null&&ze(n,e,67108864),vu(e,67108864)}}function gg(e){if(e.tag===13||e.tag===31){var n=Ke();n=po(n);var a=zn(e,n);a!==null&&ze(a,e,n),vu(e,n)}}var Nl=!0;function Sy(e,n,a,o){var d=z.T;z.T=null;var g=V.p;try{V.p=2,Au(e,n,a,o)}finally{V.p=g,z.T=d}}function xy(e,n,a,o){var d=z.T;z.T=null;var g=V.p;try{V.p=8,Au(e,n,a,o)}finally{V.p=g,z.T=d}}function Au(e,n,a,o){if(Nl){var d=Su(o);if(d===null)ru(e,n,o,Ll,a),bg(e,o);else if(_y(d,e,n,a,o))o.stopPropagation();else if(bg(e,o),n&4&&-1<wy.indexOf(e)){for(;d!==null;){var g=rs(d);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var v=Nn(g.pendingLanes);if(v!==0){var _=g;for(_.pendingLanes|=2,_.entangledLanes|=2;v;){var M=1<<31-He(v);_.entanglements[1]|=M,v&=~M}vi(g),(Nt&6)===0&&(pl=je()+500,ja(0))}}break;case 31:case 13:_=zn(g,2),_!==null&&ze(_,g,2),ml(),vu(g,2)}if(g=Su(o),g===null&&ru(e,n,o,Ll,a),g===d)break;d=g}d!==null&&o.stopPropagation()}else ru(e,n,o,null,a)}}function Su(e){return e=wo(e),xu(e)}var Ll=null;function xu(e){if(Ll=null,e=as(e),e!==null){var n=l(e);if(n===null)e=null;else{var a=n.tag;if(a===13){if(e=c(n),e!==null)return e;e=null}else if(a===31){if(e=u(n),e!==null)return e;e=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return Ll=e,null}function mg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(o0()){case wh:return 2;case _h:return 8;case Sr:case c0:return 32;case Eh:return 268435456;default:return 32}default:return 32}}var wu=!1,bn=null,yn=null,vn=null,Xa=new Map,$a=new Map,An=[],wy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bg(e,n){switch(e){case"focusin":case"focusout":bn=null;break;case"dragenter":case"dragleave":yn=null;break;case"mouseover":case"mouseout":vn=null;break;case"pointerover":case"pointerout":Xa.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":$a.delete(n.pointerId)}}function Ka(e,n,a,o,d,g){return e===null||e.nativeEvent!==g?(e={blockedOn:n,domEventName:a,eventSystemFlags:o,nativeEvent:g,targetContainers:[d]},n!==null&&(n=rs(n),n!==null&&pg(n)),e):(e.eventSystemFlags|=o,n=e.targetContainers,d!==null&&n.indexOf(d)===-1&&n.push(d),e)}function _y(e,n,a,o,d){switch(n){case"focusin":return bn=Ka(bn,e,n,a,o,d),!0;case"dragenter":return yn=Ka(yn,e,n,a,o,d),!0;case"mouseover":return vn=Ka(vn,e,n,a,o,d),!0;case"pointerover":var g=d.pointerId;return Xa.set(g,Ka(Xa.get(g)||null,e,n,a,o,d)),!0;case"gotpointercapture":return g=d.pointerId,$a.set(g,Ka($a.get(g)||null,e,n,a,o,d)),!0}return!1}function yg(e){var n=as(e.target);if(n!==null){var a=l(n);if(a!==null){if(n=a.tag,n===13){if(n=c(a),n!==null){e.blockedOn=n,Nh(e.priority,function(){gg(a)});return}}else if(n===31){if(n=u(a),n!==null){e.blockedOn=n,Nh(e.priority,function(){gg(a)});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ol(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var a=Su(e.nativeEvent);if(a===null){a=e.nativeEvent;var o=new a.constructor(a.type,a);xo=o,a.target.dispatchEvent(o),xo=null}else return n=rs(a),n!==null&&pg(n),e.blockedOn=a,!1;n.shift()}return!0}function vg(e,n,a){Ol(e)&&a.delete(n)}function Ey(){wu=!1,bn!==null&&Ol(bn)&&(bn=null),yn!==null&&Ol(yn)&&(yn=null),vn!==null&&Ol(vn)&&(vn=null),Xa.forEach(vg),$a.forEach(vg)}function kl(e,n){e.blockedOn===n&&(e.blockedOn=null,wu||(wu=!0,p.unstable_scheduleCallback(p.unstable_NormalPriority,Ey)))}var Bl=null;function Ag(e){Bl!==e&&(Bl=e,p.unstable_scheduleCallback(p.unstable_NormalPriority,function(){Bl===e&&(Bl=null);for(var n=0;n<e.length;n+=3){var a=e[n],o=e[n+1],d=e[n+2];if(typeof o!="function"){if(xu(o||a)===null)continue;break}var g=rs(a);g!==null&&(e.splice(n,3),n-=3,Sc(g,{pending:!0,data:d,method:a.method,action:o},o,d))}}))}function Is(e){function n(M){return kl(M,e)}bn!==null&&kl(bn,e),yn!==null&&kl(yn,e),vn!==null&&kl(vn,e),Xa.forEach(n),$a.forEach(n);for(var a=0;a<An.length;a++){var o=An[a];o.blockedOn===e&&(o.blockedOn=null)}for(;0<An.length&&(a=An[0],a.blockedOn===null);)yg(a),a.blockedOn===null&&An.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(o=0;o<a.length;o+=3){var d=a[o],g=a[o+1],v=d[De]||null;if(typeof g=="function")v||Ag(a);else if(v){var _=null;if(g&&g.hasAttribute("formAction")){if(d=g,v=g[De]||null)_=v.formAction;else if(xu(d)!==null)continue}else _=v.action;typeof _=="function"?a[o+1]=_:(a.splice(o,3),o-=3),Ag(a)}}}function Sg(){function e(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(v){return d=v})},focusReset:"manual",scroll:"manual"})}function n(){d!==null&&(d(),d=null),o||setTimeout(a,20)}function a(){if(!o&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(a,100),function(){o=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),d!==null&&(d(),d=null)}}}function _u(e){this._internalRoot=e}zl.prototype.render=_u.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var a=n.current,o=Ke();dg(a,o,e,n,null,null)},zl.prototype.unmount=_u.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;dg(e.current,2,null,e,null,null),ml(),n[ss]=null}};function zl(e){this._internalRoot=e}zl.prototype.unstable_scheduleHydration=function(e){if(e){var n=Dh();e={blockedOn:null,target:e,priority:n};for(var a=0;a<An.length&&n!==0&&n<An[a].priority;a++);An.splice(a,0,e),a===0&&yg(e)}};var xg=t.version;if(xg!=="19.2.3")throw Error(s(527,xg,"19.2.3"));V.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=f(n),e=e!==null?m(e):null,e=e===null?null:e.stateNode,e};var Ty={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pl.isDisabled&&Pl.supportsFiber)try{sa=Pl.inject(Ty),Ie=Pl}catch{}}return Qa.createRoot=function(e,n){if(!r(e))throw Error(s(299));var a=!1,o="",d=Rf,g=Df,v=Nf;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(d=n.onUncaughtError),n.onCaughtError!==void 0&&(g=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=ug(e,1,!1,null,null,a,o,null,d,g,v,Sg),e[ss]=n.current,au(e),new _u(n)},Qa.hydrateRoot=function(e,n,a){if(!r(e))throw Error(s(299));var o=!1,d="",g=Rf,v=Df,_=Nf,M=null;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(_=a.onRecoverableError),a.formState!==void 0&&(M=a.formState)),n=ug(e,1,!0,n,a??null,o,d,M,g,v,_,Sg),n.context=hg(null),a=n.current,o=Ke(),o=po(o),d=an(o),d.callback=null,rn(a,d,o),a=o,n.current.lanes=a,ra(n,a),vi(n),e[ss]=n.current,au(e),new zl(n)},Qa.version="19.2.3",Qa}var kg;function Fy(){if(kg)return Mu.exports;kg=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(t){console.error(t)}}return p(),Mu.exports=Py(),Mu.exports}var Uy=Fy();function Am(p){if(p==null||!Number.isFinite(p))return"";const t=Math.abs(p),i=p<0?"-":"";return t>=1e9?`${i}$${(t/1e9).toFixed(2)}B`:t>=1e6?`${i}$${(t/1e6).toFixed(2)}M`:t>=1e3?`${i}$${Math.round(t/1e3)}K`:`${i}$${t.toFixed(0)}`}function Bg(p){if(p==null||!Number.isFinite(p))return{number:"",suffix:""};const t=Math.abs(p),i=p<0?"-":"";return t>=1e9?{number:`${i}$${(t/1e9).toFixed(2)}`,suffix:"B"}:t>=1e6?{number:`${i}$${(t/1e6).toFixed(2)}`,suffix:"M"}:t>=1e3?{number:`${i}$${Math.round(t/1e3)}`,suffix:"K"}:{number:`${i}$${t.toFixed(0)}`,suffix:""}}function Kn(p,t=2,i=!1){return p==null||!Number.isFinite(p)?"":`${i&&p>0?"+":""}${p.toFixed(t)}%`}function Lu(p){if(!p)return"";try{return new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return p}}function zg(p){if(!p)return"";try{return new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short"})}catch{return p}}function jy(p){return p.charAt(0).toUpperCase()+p.slice(1)}function Iy(p){return{defensive:"Low Risk",balanced:"Medium Risk",growth:"High Risk",unknown:""}[p]||""}function Hy(p){return{defensive:"Defensive Income Fund",balanced:"Balanced Growth Fund",growth:"Growth Strategy Fund",unknown:"Investment Portfolio"}[p]||"Investment Portfolio"}const Gy={"Australian Equities":"#4299e1","Australian Fixed Interest":"#48bb78",Cash:"#ecc94b","International Equities":"#9f7aea","Listed Property":"#ed8936",Other:"#718096",Unknown:"#a0aec0"},Vy={"Australian Equities":"AU Equities","Australian Fixed Interest":"Fixed Interest",Cash:"Cash","International Equities":"Intl Equities","Listed Property":"Property",Other:"Other",Unknown:"Unknown"};function Pg(p,t=100){if(p==null||!Number.isFinite(p))return 0;const i=Math.min(Math.abs(p)/15*t,t);return Math.max(i,10)}function qy({fund:p}){const t=p?.classification?.classification||"unknown",i=p?.classification?.growthPercent??0,s=p?.classification?.defensivePercent??0,r=p?.classification?.otherPercent??0,l=p?.assetAllocation?.totalValue||p?.performance?.endingValue||null,c=p?.assetAllocation?.assetClasses||[],u=p?.assetAllocation?.asAtDate||null,h=p?.performance?.dollarReturn||null,f=p?.performance?.period?.start||null,m=p?.performance?.period?.end||null,b=p?.performance?.twr?.oneYear??null;p?.performance?.twr?.threeYears,p?.performance?.twr?.sinceStart;const y=p?.benchmark?.name||"Benchmark",A=p?.benchmarkComparison||{},x=p?.performanceScore??null,S=p?.fundId||"",E=p?.lastUpdated||null;p?.derivedInsights;const w=Bg(l),R=Bg(h),C=f&&m?`${zg(f)}  ${zg(m)}`:"",k=A?.oneYear?.benchmarkReturn??null,L=A?.oneYear?.difference??null;A?.sinceInception?.benchmarkReturn,A?.sinceInception?.difference;const O=x!==null?Math.min(Math.max(x,0),100):0,q=[...c].filter(Z=>Z.value&&Z.value>0).sort((Z,ht)=>(ht.value||0)-(Z.value||0)).map(Z=>{const ht=l>0?Z.value/l*100:0;return{...Z,percent:ht,color:Gy[Z.name]||"#718096",label:Vy[Z.name]||Z.name}}),K=q.slice(0,4),J=q.slice(0,6),Q=Yy({classification:t,growthPercent:i,oneYearDiff:L,dollarReturn:h});return T.jsx("div",{style:{width:"100vw",minHeight:"100vh",background:"linear-gradient(165deg, #0a0a0f 0%, #12121a 50%, #0d0d14 100%)",fontFamily:'"DM Sans", system-ui, sans-serif',color:"#ffffff",position:"relative",overflowX:"hidden"},children:T.jsxs("div",{style:{padding:"48px 56px",maxWidth:"1600px",margin:"0 auto",position:"relative",zIndex:1},children:[T.jsx("div",{style:{position:"absolute",top:"-200px",right:"-100px",width:"600px",height:"600px",background:"radial-gradient(circle, rgba(99, 179, 237, 0.08) 0%, transparent 70%)",pointerEvents:"none"}}),T.jsx("div",{style:{position:"absolute",bottom:"-300px",left:"-200px",width:"800px",height:"800px",background:"radial-gradient(circle, rgba(72, 187, 120, 0.06) 0%, transparent 70%)",pointerEvents:"none"}}),T.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"56px",position:"relative",zIndex:1},children:[T.jsxs("div",{children:[T.jsx("div",{style:{fontSize:"11px",letterSpacing:"3px",textTransform:"uppercase",color:"rgba(255,255,255,0.4)",marginBottom:"8px",fontWeight:"500"},children:"Fund Analytics Report"}),T.jsx("h1",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"42px",fontWeight:"600",margin:0,letterSpacing:"-0.5px",background:"linear-gradient(135deg, #ffffff 0%, rgba(255,255,255,0.8) 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:Hy(t)}),T.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"rgba(255,255,255,0.5)"},children:["As of ",u?Lu(u):m?Lu(m):""]})]}),T.jsxs("div",{style:{textAlign:"center",position:"relative"},children:[T.jsx("div",{style:{width:"140px",height:"140px",borderRadius:"50%",background:x!==null?`conic-gradient(from 0deg, #48bb78 0%, #38a169 ${O}%, rgba(255,255,255,0.08) ${O}%)`:"rgba(255,255,255,0.08)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:T.jsx("div",{style:{width:"110px",height:"110px",borderRadius:"50%",background:"#0d0d14",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:T.jsx("span",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"48px",fontWeight:"700",lineHeight:1},children:x!==null?x:""})})}),T.jsx("div",{style:{marginTop:"12px",fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.5)"},children:"Performance Score"})]})]}),T.jsxs("section",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"32px",marginBottom:"56px",position:"relative",zIndex:1},children:[T.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.02) 100%)",borderRadius:"20px",padding:"36px 40px",border:"1px solid rgba(255,255,255,0.08)",backdropFilter:"blur(20px)"},children:[T.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"16px"},children:"Total Portfolio Value"}),T.jsxs("div",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"52px",fontWeight:"600",letterSpacing:"-1px",lineHeight:1},children:[w.number,T.jsx("span",{style:{fontSize:"32px",color:"rgba(255,255,255,0.6)"},children:w.suffix})]})]}),T.jsxs("div",{style:{background:h!==null&&h>=0?"linear-gradient(145deg, rgba(72, 187, 120, 0.15) 0%, rgba(72, 187, 120, 0.05) 100%)":"linear-gradient(145deg, rgba(245, 101, 101, 0.15) 0%, rgba(245, 101, 101, 0.05) 100%)",borderRadius:"20px",padding:"36px 40px",border:h!==null&&h>=0?"1px solid rgba(72, 187, 120, 0.25)":"1px solid rgba(245, 101, 101, 0.25)",backdropFilter:"blur(20px)"},children:[T.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:h!==null&&h>=0?"rgba(72, 187, 120, 0.8)":"rgba(245, 101, 101, 0.8)",marginBottom:"16px"},children:"Period Return"}),T.jsxs("div",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"52px",fontWeight:"600",letterSpacing:"-1px",lineHeight:1,color:h!==null&&h>=0?"#48bb78":"#f56565"},children:[h!==null&&h>=0?"+":"",R.number,R.suffix]}),T.jsx("div",{style:{marginTop:"12px",fontSize:"13px",color:"rgba(255,255,255,0.5)"},children:C})]}),T.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(99, 179, 237, 0.12) 0%, rgba(99, 179, 237, 0.04) 100%)",borderRadius:"20px",padding:"36px 40px",border:"1px solid rgba(99, 179, 237, 0.2)",backdropFilter:"blur(20px)"},children:[T.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(99, 179, 237, 0.8)",marginBottom:"16px"},children:"1-Year Return"}),T.jsxs("div",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"52px",fontWeight:"600",letterSpacing:"-1px",lineHeight:1,color:"#63b3ed"},children:[b!==null&&b>=0?"+":"",Kn(b,2,!1).replace("%",""),T.jsx("span",{style:{fontSize:"28px"},children:"%"})]}),T.jsx("div",{style:{marginTop:"12px",display:"flex",alignItems:"center",gap:"8px"},children:L!==null&&T.jsxs("span",{style:{background:L>=0?"rgba(72, 187, 120, 0.2)":"rgba(245, 101, 101, 0.2)",color:L>=0?"#48bb78":"#f56565",padding:"4px 10px",borderRadius:"20px",fontSize:"12px",fontWeight:"600"},children:[Kn(L,2,!0)," vs benchmark"]})})]})]}),T.jsxs("section",{style:{display:"grid",gridTemplateColumns:"1.2fr 0.8fr",gap:"32px",marginBottom:"56px",position:"relative",zIndex:1},children:[T.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0.01) 100%)",borderRadius:"20px",padding:"32px 36px",border:"1px solid rgba(255,255,255,0.06)"},children:[T.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"28px"},children:"Asset Allocation"}),T.jsx("div",{style:{marginBottom:"28px"},children:T.jsx("div",{style:{display:"flex",height:"48px",borderRadius:"8px",overflow:"hidden"},children:K.length>0?K.map((Z,ht)=>T.jsx("div",{style:{width:`${Z.percent}%`,background:`linear-gradient(135deg, ${Z.color}, ${Xy(Z.color,-20)})`,position:"relative"},children:Z.percent>8&&T.jsxs("span",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",fontSize:"13px",fontWeight:"600"},children:[Z.percent.toFixed(1),"%"]})},Z.name)):T.jsx("div",{style:{width:"100%",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",color:"rgba(255,255,255,0.4)",fontSize:"13px"},children:"No allocation data"})})}),T.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px"},children:J.length>0?J.map((Z,ht)=>T.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[T.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"3px",background:Z.color}}),T.jsxs("div",{children:[T.jsx("div",{style:{fontSize:"12px",color:"rgba(255,255,255,0.6)"},children:Z.label}),T.jsx("div",{style:{fontSize:"14px",fontWeight:"600"},children:Am(Z.value)})]})]},Z.name)):T.jsx("div",{style:{gridColumn:"span 3",color:"rgba(255,255,255,0.4)",fontSize:"13px"},children:"Upload asset allocation report for breakdown"})})]}),T.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0.01) 100%)",borderRadius:"20px",padding:"32px 36px",border:"1px solid rgba(255,255,255,0.06)"},children:[T.jsxs("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"28px"},children:["vs ",y]}),T.jsxs("div",{style:{marginBottom:"32px"},children:[T.jsx("div",{style:{fontSize:"12px",color:"rgba(255,255,255,0.5)",marginBottom:"12px"},children:"1 Year"}),T.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:"20px"},children:[T.jsxs("div",{style:{flex:1},children:[T.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:"12px",marginBottom:"8px"},children:[T.jsx("div",{style:{height:`${Pg(b,80)}px`,width:"48px",background:b!==null&&b>=0?"linear-gradient(180deg, #48bb78 0%, #38a169 100%)":"linear-gradient(180deg, #f56565 0%, #c53030 100%)",borderRadius:"6px 6px 0 0",position:"relative"},children:T.jsx("span",{style:{position:"absolute",top:"-28px",left:"50%",transform:"translateX(-50%)",fontSize:"18px",fontWeight:"700",color:b!==null&&b>=0?"#48bb78":"#f56565"},children:Kn(b,2)})}),T.jsx("div",{style:{height:`${Pg(k,80)}px`,width:"48px",background:"rgba(255,255,255,0.15)",borderRadius:"6px 6px 0 0",position:"relative"},children:T.jsx("span",{style:{position:"absolute",top:"-28px",left:"50%",transform:"translateX(-50%)",fontSize:"18px",fontWeight:"600",color:"rgba(255,255,255,0.6)"},children:Kn(k,2)})})]}),T.jsxs("div",{style:{display:"flex",gap:"12px"},children:[T.jsx("span",{style:{width:"48px",fontSize:"10px",color:"rgba(255,255,255,0.5)",textAlign:"center"},children:"Fund"}),T.jsx("span",{style:{width:"48px",fontSize:"10px",color:"rgba(255,255,255,0.5)",textAlign:"center"},children:"Bench"})]})]}),L!==null&&T.jsxs("div",{style:{background:L>=0?"rgba(72, 187, 120, 0.15)":"rgba(245, 101, 101, 0.15)",border:L>=0?"1px solid rgba(72, 187, 120, 0.3)":"1px solid rgba(245, 101, 101, 0.3)",borderRadius:"12px",padding:"12px 16px",textAlign:"center"},children:[T.jsx("div",{style:{fontSize:"10px",color:L>=0?"rgba(72, 187, 120, 0.8)":"rgba(245, 101, 101, 0.8)",marginBottom:"4px"},children:"ALPHA"}),T.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:L>=0?"#48bb78":"#f56565"},children:Kn(L,2,!0)})]})]})]})]})]}),T.jsxs("section",{style:{display:"grid",gridTemplateColumns:"0.7fr 1.3fr",gap:"32px",position:"relative",zIndex:1},children:[T.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0.01) 100%)",borderRadius:"20px",padding:"32px 36px",border:"1px solid rgba(255,255,255,0.06)"},children:[T.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"24px"},children:"Risk Profile"}),T.jsxs("div",{style:{marginBottom:"24px"},children:[T.jsxs("div",{style:{display:"flex",height:"12px",borderRadius:"6px",overflow:"hidden",marginBottom:"12px"},children:[T.jsx("div",{style:{width:`${i}%`,background:"linear-gradient(90deg, #4299e1, #63b3ed)"}}),T.jsx("div",{style:{width:`${s}%`,background:"linear-gradient(90deg, #48bb78, #68d391)"}}),r>0&&T.jsx("div",{style:{width:`${r}%`,background:"#718096"}})]}),T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[T.jsxs("span",{style:{color:"#63b3ed"},children:["Growth ",Kn(i,1)]}),T.jsxs("span",{style:{color:"#68d391"},children:["Defensive ",Kn(s,1)]})]})]}),T.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"16px 20px",textAlign:"center"},children:[T.jsx("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.5)",marginBottom:"4px"},children:"Classification"}),T.jsx("div",{style:{fontSize:"20px",fontWeight:"600"},children:jy(t)}),T.jsx("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",marginTop:"4px"},children:Iy(t)})]})]}),T.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0.01) 100%)",borderRadius:"20px",padding:"32px 36px",border:"1px solid rgba(255,255,255,0.06)"},children:[T.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"24px"},children:"Key Insights"}),T.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px"},children:Q.map((Z,ht)=>T.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",borderRadius:"14px",padding:"20px",borderLeft:`3px solid ${Z.accent}`},children:[T.jsx("div",{style:{fontSize:"28px",marginBottom:"12px"},children:Z.icon}),T.jsx("div",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"6px"},children:Z.title}),T.jsx("div",{style:{fontSize:"12px",color:"rgba(255,255,255,0.5)"},children:Z.desc})]},ht))})]})]}),T.jsxs("footer",{style:{marginTop:"48px",paddingTop:"24px",borderTop:"1px solid rgba(255,255,255,0.06)",display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1},children:[T.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.35)"},children:["Fund ID: ",S]}),T.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.35)"},children:["Last updated: ",E?Lu(E):"","  Confidential"]})]}),T.jsx("style",{children:`
          @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap');
        `})]})})}function Yy({classification:p,growthPercent:t,oneYearDiff:i,dollarReturn:s}){const r=[];if(p!=="unknown"){const l={defensive:"",balanced:"",growth:""},c={defensive:"Defensive Strategy",balanced:"Balanced Strategy",growth:"Growth Strategy"};r.push({icon:l[p]||"",title:c[p]||"Investment Strategy",desc:t>0?`${t.toFixed(1)}% growth allocation`:"Classification determined",accent:"#63b3ed"})}else r.push({icon:"",title:"Awaiting Data",desc:"Upload allocation report",accent:"#718096"});if(i!==null){const l=i>=0;r.push({icon:l?"":"",title:l?"Strong Outperformance":"Below Benchmark",desc:`${i>=0?"+":""}${i.toFixed(2)}% vs benchmark`,accent:l?"#48bb78":"#f56565"})}else r.push({icon:"",title:"Benchmark Pending",desc:"Upload performance report",accent:"#718096"});if(s!==null){const l=s>=0;r.push({icon:l?"":"",title:l?"Capital Growth":"Capital Loss",desc:`${l?"+":""}${Am(s)} this period`,accent:l?"#ecc94b":"#f56565"})}else r.push({icon:"",title:"Returns Pending",desc:"Upload performance report",accent:"#718096"});return r}function Xy(p,t){const i=f=>Math.min(255,Math.max(0,f));p=p.replace("#","");const s=parseInt(p.substring(0,2),16),r=parseInt(p.substring(2,4),16),l=parseInt(p.substring(4,6),16),c=i(s+t),u=i(r+t),h=i(l+t);return`#${c.toString(16).padStart(2,"0")}${u.toString(16).padStart(2,"0")}${h.toString(16).padStart(2,"0")}`}const $y=p=>p.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ky=p=>p.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,i,s)=>s?s.toUpperCase():i.toLowerCase()),Fg=p=>{const t=Ky(p);return t.charAt(0).toUpperCase()+t.slice(1)},Sm=(...p)=>p.filter((t,i,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===i).join(" ").trim(),Wy=p=>{for(const t in p)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var Qy={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Zy=Zt.forwardRef(({color:p="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:r="",children:l,iconNode:c,...u},h)=>Zt.createElement("svg",{ref:h,...Qy,width:t,height:t,stroke:p,strokeWidth:s?Number(i)*24/Number(t):i,className:Sm("lucide",r),...!l&&!Wy(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,m])=>Zt.createElement(f,m)),...Array.isArray(l)?l:[l]]));const fr=(p,t)=>{const i=Zt.forwardRef(({className:s,...r},l)=>Zt.createElement(Zy,{ref:l,iconNode:t,className:Sm(`lucide-${$y(Fg(p))}`,`lucide-${p}`,s),...r}));return i.displayName=Fg(p),i};const Jy=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],tv=fr("chevron-down",Jy);const ev=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],iv=fr("chevron-up",ev);const nv=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],sv=fr("download",nv);const av=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ug=fr("file-text",av);const rv=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],lv=fr("refresh-cw",rv);function ov({onFileSelect:p,status:t="idle",label:i,description:s,errorMessage:r,acceptedFileName:l}){const c=h=>{const f=h.target.files?.[0];if(console.log("[DropZone] File selected:",f?.name),!f){p(null,"No file selected");return}p(f,null)},u=()=>{switch(t){case"processing":return"border-blue-300 bg-blue-50/50 ring-4 ring-blue-100/50";case"success":return"border-emerald-300 bg-emerald-50/50";case"error":return"border-red-300 bg-red-50/50";default:return"border-gray-200 bg-gray-50/30 hover:border-blue-300 hover:bg-blue-50/30 hover:ring-4 hover:ring-blue-100/30"}};return T.jsxs("div",{className:"space-y-2",children:[i&&T.jsx("label",{className:"block text-sm font-medium text-gray-700",children:i}),T.jsxs("div",{className:`
        relative rounded-xl border-2 border-dashed transition-all duration-300
        ${u()}
      `,children:[T.jsx("input",{type:"file",accept:"application/pdf",onChange:c,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",disabled:t==="processing"}),T.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[T.jsxs("div",{className:`
            w-12 h-12 rounded-xl flex items-center justify-center mb-4 transition-all duration-300
            ${t==="processing"?"bg-blue-100":""}
            ${t==="success"?"bg-emerald-100":""}
            ${t==="error"?"bg-red-100":""}
            ${t==="idle"?"bg-gray-100":""}
          `,children:[t==="processing"&&T.jsxs("svg",{className:"w-6 h-6 text-blue-600 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[T.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),T.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t==="success"&&T.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),t==="error"&&T.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t==="idle"&&T.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]}),T.jsxs("div",{className:"text-center",children:[t==="processing"&&T.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Processing PDF"}),t==="success"&&T.jsx("p",{className:"text-sm font-medium text-emerald-700",children:l||"File uploaded successfully"}),t==="error"&&T.jsx("p",{className:"text-sm font-medium text-red-700",children:r||"Upload failed"}),t==="idle"&&T.jsxs(T.Fragment,{children:[T.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Drop PDF here or ",T.jsx("span",{className:"text-blue-600 font-semibold",children:"browse"})]}),s&&T.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s})]})]})]})]}),t==="idle"&&T.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Accepts PDF files only"})]})}const Ce=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),qu=[.001,0,0,.001,0,0],Ou=1.35,We={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},wn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},or="pdfjs_internal_editor_",mt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ct={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},cv={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Yu={TRIANGLES:1,LATTICE:2},Ae={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Xl={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ce={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Vs={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},to={ERRORS:0,WARNINGS:1,INFOS:5},cr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Za={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},uv={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let eo=to.WARNINGS;function hv(p){Number.isInteger(p)&&(eo=p)}function dv(){return eo}function io(p){eo>=to.INFOS&&console.info(`Info: ${p}`)}function pt(p){eo>=to.WARNINGS&&console.warn(`Warning: ${p}`)}function Ht(p){throw new Error(p)}function Mt(p,t){p||Ht(t)}function fv(p){switch(p?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function xm(p,t=null,i=null){if(!p)return null;if(i&&typeof p=="string"&&(i.addDefaultProtocol&&p.startsWith("www.")&&p.match(/\./g)?.length>=2&&(p=`http://${p}`),i.tryConvertEncoding))try{p=yv(p)}catch{}const s=t?URL.parse(p,t):URL.parse(p);return fv(s)?s:null}function wm(p,t,i=!1){const s=URL.parse(p);return s?(s.hash=t,s.href):i&&xm(p,"http://example.com")?p.split("#",1)[0]+`${t?`#${t}`:""}`:""}function gt(p,t,i,s=!1){return Object.defineProperty(p,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const is=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class jg extends is{constructor(t,i){super(t,"PasswordException"),this.code=i}}class ku extends is{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class Xu extends is{constructor(t){super(t,"InvalidPDFException")}}class Wl extends is{constructor(t,i,s){super(t,"ResponseException"),this.status=i,this.missing=s}}class pv extends is{constructor(t){super(t,"FormatError")}}class Cn extends is{constructor(t){super(t,"AbortException")}}function _m(p){(typeof p!="object"||p?.length===void 0)&&Ht("Invalid argument for bytesToString");const t=p.length,i=8192;if(t<i)return String.fromCharCode.apply(null,p);const s=[];for(let r=0;r<t;r+=i){const l=Math.min(r+i,t),c=p.subarray(r,l);s.push(String.fromCharCode.apply(null,c))}return s.join("")}function pr(p){typeof p!="string"&&Ht("Invalid argument for stringToBytes");const t=p.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=p.charCodeAt(s)&255;return i}function gv(p){return String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,p&255)}function mv(){const p=new Uint8Array(4);return p[0]=1,new Uint32Array(p.buffer,0,1)[0]===1}function bv(){try{return new Function(""),!0}catch{return!1}}class we{static get isLittleEndian(){return gt(this,"isLittleEndian",mv())}static get isEvalSupported(){return gt(this,"isEvalSupported",bv())}static get isOffscreenCanvasSupported(){return gt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return gt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return gt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return gt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return gt(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return gt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Bu=Array.from(Array(256).keys(),p=>p.toString(16).padStart(2,"0"));class nt{static makeHexColor(t,i,s){return`#${Bu[t]}${Bu[i]}${Bu[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,s=0){const r=t[s],l=t[s+1];t[s]=r*i[0]+l*i[2]+i[4],t[s+1]=r*i[1]+l*i[3]+i[5]}static applyTransformToBezier(t,i,s=0){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5];for(let m=0;m<6;m+=2){const b=t[s+m],y=t[s+m+1];t[s+m]=b*r+y*c+h,t[s+m+1]=b*l+y*u+f}}static applyInverseTransform(t,i){const s=t[0],r=t[1],l=i[0]*i[3]-i[1]*i[2];t[0]=(s*i[3]-r*i[2]+i[2]*i[5]-i[4]*i[3])/l,t[1]=(-s*i[1]+r*i[0]+i[4]*i[1]-i[5]*i[0])/l}static axialAlignedBoundingBox(t,i,s){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5],m=t[0],b=t[1],y=t[2],A=t[3];let x=r*m+h,S=x,E=r*y+h,w=E,R=u*b+f,C=R,k=u*A+f,L=k;if(l!==0||c!==0){const O=l*m,P=l*y,q=c*b,K=c*A;x+=q,w+=q,E+=K,S+=K,R+=O,L+=O,k+=P,C+=P}s[0]=Math.min(s[0],x,E,S,w),s[1]=Math.min(s[1],R,k,C,L),s[2]=Math.max(s[2],x,E,S,w),s[3]=Math.max(s[3],R,k,C,L)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const s=t[0],r=t[1],l=t[2],c=t[3],u=s**2+r**2,h=s*l+r*c,f=l**2+c**2,m=(u+f)/2,b=Math.sqrt(m**2-(u*f-h**2));i[0]=Math.sqrt(m+b||1),i[1]=Math.sqrt(m-b||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>r)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return l>c?null:[s,l,r,c]}static pointBoundingBox(t,i,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],i),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],i)}static rectBoundingBox(t,i,s,r,l){l[0]=Math.min(l[0],t,s),l[1]=Math.min(l[1],i,r),l[2]=Math.max(l[2],t,s),l[3]=Math.max(l[3],i,r)}static#t(t,i,s,r,l,c,u,h,f,m){if(f<=0||f>=1)return;const b=1-f,y=f*f,A=y*f,x=b*(b*(b*t+3*f*i)+3*y*s)+A*r,S=b*(b*(b*l+3*f*c)+3*y*u)+A*h;m[0]=Math.min(m[0],x),m[1]=Math.min(m[1],S),m[2]=Math.max(m[2],x),m[3]=Math.max(m[3],S)}static#e(t,i,s,r,l,c,u,h,f,m,b,y){if(Math.abs(f)<1e-12){Math.abs(m)>=1e-12&&this.#t(t,i,s,r,l,c,u,h,-b/m,y);return}const A=m**2-4*b*f;if(A<0)return;const x=Math.sqrt(A),S=2*f;this.#t(t,i,s,r,l,c,u,h,(-m+x)/S,y),this.#t(t,i,s,r,l,c,u,h,(-m-x)/S,y)}static bezierBoundingBox(t,i,s,r,l,c,u,h,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],i,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],i,h),this.#e(t,s,l,u,i,r,c,h,3*(-t+3*(s-l)+u),6*(t-2*s+l),3*(s-t),f),this.#e(t,s,l,u,i,r,c,h,3*(-i+3*(r-c)+h),6*(i-2*r+c),3*(r-i),f)}}function yv(p){return decodeURIComponent(escape(p))}let zu=null,Ig=null;function vv(p){return zu||(zu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ig=new Map([["","t"]])),p.replaceAll(zu,(t,i,s)=>i?i.normalize("NFKC"):Ig.get(s))}function Em(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const p=new Uint8Array(32);return crypto.getRandomValues(p),_m(p)}const Xs="pdfjs_internal_id_";function Av(p,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[s,r,...l]=i;if(!p(s)&&!Number.isInteger(s)||!t(r))return!1;const c=l.length;let u=!0;switch(r.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const h of l)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Me(p,t,i){return Math.min(Math.max(p,t),i)}function Tm(p){return Uint8Array.prototype.toBase64?p.toBase64():btoa(_m(p))}function Sv(p){return Uint8Array.fromBase64?Uint8Array.fromBase64(p):pr(atob(p))}typeof Promise.try!="function"&&(Promise.try=function(p,...t){return new Promise(i=>{i(p(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(p){return p.reduce((t,i)=>t+i,0)});class ur{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function r(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(ur.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&i.push({str:c}),!!l.children)for(const h of l.children)r(h)}return r(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Cm{static setupStorage(t,i,s,r,l){const c=r.getValue(i,{value:null});switch(s.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(c.value===s.attributes.xfaOn?t.setAttribute("checked",!0):c.value===s.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{r.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of s.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(i,{value:f})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:r,linkService:l}){const{attributes:c}=i,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${r}`);for(const[h,f]of Object.entries(c))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),s&&c.dataId&&this.setupStorage(t,c.dataId,i,s)}static render(t){const i=t.annotationStorage,s=t.linkService,r=t.xfaHtml,l=t.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:l,linkService:s});const u=l!=="richText",h=t.div;if(h.append(c),t.viewport){const b=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=b}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const b=document.createTextNode(r.value);c.append(b),u&&ur.shouldBuildText(r.name)&&f.push(b)}return{textDivs:f}}const m=[[r,-1,c]];for(;m.length>0;){const[b,y,A]=m.at(-1);if(y+1===b.children.length){m.pop();continue}const x=b.children[++m.at(-1)[1]];if(x===null)continue;const{name:S}=x;if(S==="#text"){const w=document.createTextNode(x.value);f.push(w),A.append(w);continue}const E=x?.attributes?.xmlns?document.createElementNS(x.attributes.xmlns,S):document.createElement(S);if(A.append(E),x.attributes&&this.setAttributes({html:E,element:x,storage:i,intent:l,linkService:s}),x.children?.length>0)m.push([x,-1,E]);else if(x.value){const w=document.createTextNode(x.value);u&&ur.shouldBuildText(S)&&f.push(w),E.append(w)}}for(const b of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const Yi="http://www.w3.org/2000/svg";class ia{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function gr(p,t="text"){if(sr(p,document.baseURI)){const i=await fetch(p);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const r=new XMLHttpRequest;r.open("GET",p,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(r.response);return}i(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class mr{constructor({viewBox:t,userUnit:i,scale:s,rotation:r,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=s,this.rotation=r,this.offsetX=l,this.offsetY=c,s*=i;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let m,b,y,A;switch(r%=360,r<0&&(r+=360),r){case 180:m=-1,b=0,y=0,A=1;break;case 90:m=0,b=1,y=1,A=0;break;case 270:m=0,b=-1,y=-1,A=0;break;case 0:m=1,b=0,y=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(y=-y,A=-A);let x,S,E,w;m===0?(x=Math.abs(f-t[1])*s+l,S=Math.abs(h-t[0])*s+c,E=(t[3]-t[1])*s,w=(t[2]-t[0])*s):(x=Math.abs(h-t[0])*s+l,S=Math.abs(f-t[1])*s+c,E=(t[2]-t[0])*s,w=(t[3]-t[1])*s),this.transform=[m*s,b*s,y*s,A*s,x-m*s*h-y*s*f,S-b*s*h-A*s*f],this.width=E,this.height=w}get rawDims(){const t=this.viewBox;return gt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:l=!1}={}){return new mr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:l})}convertToViewportPoint(t,i){const s=[t,i];return nt.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const i=[t[0],t[1]];nt.applyTransform(i,this.transform);const s=[t[2],t[3]];return nt.applyTransform(s,this.transform),[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){const s=[t,i];return nt.applyInverseTransform(s,this.transform),s}}class rh extends is{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function no(p){const t=p.length;let i=0;for(;i<t&&p[i].trim()==="";)i++;return p.substring(i,i+5).toLowerCase()==="data:"}function lh(p){return typeof p=="string"&&/\.pdf$/i.test(p)}function xv(p){return[p]=p.split(/[#?]/,1),p.substring(p.lastIndexOf("/")+1)}function wv(p,t="document.pdf"){if(typeof p!="string")return t;if(no(p))return pt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(p);if(!s)return t;const r=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},l=/\.pdf$/i,c=s.pathname.split("/").at(-1);if(l.test(c))return r(c);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(l.test(f))return r(f);const h=Array.from(s.searchParams.keys()).reverse();for(const f of h)if(l.test(f))return r(f)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return r(h[0])}return t}class Hg{started=Object.create(null);times=[];time(t){t in this.started&&pt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||pt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:r,end:l}of this.times)t.push(`${s.padEnd(i)} ${l-r}ms
`);return t.join("")}}function sr(p,t){const i=t?URL.parse(p,t):URL.parse(p);return i?.protocol==="http:"||i?.protocol==="https:"}function hi(p){p.preventDefault()}function Jt(p){p.preventDefault(),p.stopPropagation()}function _v(p){console.log("Deprecated API usage: "+p)}class $u{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const s=parseInt(i[1],10);let r=parseInt(i[2],10);r=r>=1&&r<=12?r-1:0;let l=parseInt(i[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(i[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(i[6],10);h=h>=0&&h<=59?h:0;const f=i[7]||"Z";let m=parseInt(i[8],10);m=m>=0&&m<=23?m:0;let b=parseInt(i[9],10)||0;return b=b>=0&&b<=59?b:0,f==="-"?(c+=m,u+=b):f==="+"&&(c-=m,u-=b),new Date(Date.UTC(s,r,l,c,u,h))}}function Ev(p,{scale:t=1,rotation:i=0}){const{width:s,height:r}=p.attributes.style,l=[0,0,parseInt(s),parseInt(r)];return new mr({viewBox:l,userUnit:1,scale:t,rotation:i})}function br(p){if(p.startsWith("#")){const t=parseInt(p.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return p.startsWith("rgb(")?p.slice(4,-1).split(",").map(t=>parseInt(t)):p.startsWith("rgba(")?p.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(pt(`Not a valid color format: "${p}"`),[0,0,0])}function Tv(p){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of p.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;p.set(i,br(s))}t.remove()}function $t(p){const{a:t,b:i,c:s,d:r,e:l,f:c}=p.getTransform();return[t,i,s,r,l,c]}function xi(p){const{a:t,b:i,c:s,d:r,e:l,f:c}=p.getTransform().invertSelf();return[t,i,s,r,l,c]}function ts(p,t,i=!1,s=!0){if(t instanceof mr){const{pageWidth:r,pageHeight:l}=t.rawDims,{style:c}=p,u=we.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${l}px`,m=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,b=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!i||t.rotation%180===0?(c.width=m,c.height=b):(c.width=b,c.height=m)}s&&p.setAttribute("data-main-rotation",t.rotation)}class Ti{constructor(){const{pixelRatio:t}=Ti;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,s,r,l=-1){let c=1/0,u=1/0,h=1/0;s=Ti.capPixels(s,l),s>0&&(c=Math.sqrt(s/(t*i))),r!==-1&&(u=r/t,h=r/i);const f=Math.min(c,u,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,s):s}return t}}const Ku=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Cv{static get isDarkMode(){return gt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class Mv{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),gt(this,"commentForegroundColor",br(s))}}function Rv(p,t,i,s){s=Math.min(Math.max(s??1,0),1);const r=255*(1-s);return p=Math.round(p*s+r),t=Math.round(t*s+r),i=Math.round(i*s+r),[p,t,i]}function Gg(p,t){const i=p[0]/255,s=p[1]/255,r=p[2]/255,l=Math.max(i,s,r),c=Math.min(i,s,r),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const h=l-c;switch(t[1]=u<.5?h/(l+c):h/(2-l-c),l){case i:t[0]=((s-r)/h+(s<r?6:0))*60;break;case s:t[0]=((r-i)/h+2)*60;break;case r:t[0]=((i-s)/h+4)*60;break}}t[2]=u}function Wu(p,t){const i=p[0],s=p[1],r=p[2],l=(1-Math.abs(2*r-1))*s,c=l*(1-Math.abs(i/60%2-1)),u=r-l/2;switch(Math.floor(i/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function Vg(p){return p<=.03928?p/12.92:((p+.055)/1.055)**2.4}function qg(p,t,i){Wu(p,i),i.map(Vg);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];Wu(t,i),i.map(Vg);const r=.2126*i[0]+.7152*i[1]+.0722*i[2];return s>r?(s+.05)/(r+.05):(r+.05)/(s+.05)}const Yg=new Map;function Dv(p,t){const i=p[0]+p[1]*256+p[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=Yg.get(i);if(s)return s;const r=new Float32Array(9),l=r.subarray(0,3),c=r.subarray(3,6);Gg(p,c);const u=r.subarray(6,9);Gg(t,u);const h=u[2]<.5,f=h?12:4.5;if(c[2]=h?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),qg(c,u,l)<f){let m,b;h?(m=c[2],b=1):(m=0,b=c[2]);const y=.005;for(;b-m>y;){const A=c[2]=(m+b)/2;h===qg(c,u,l)<f?m=A:b=A}c[2]=h?b:m}return Wu(c,l),s=nt.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),Yg.set(i,s),s}function Mm({html:p,dir:t,className:i},s){const r=document.createDocumentFragment();if(typeof p=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=p.split(/(?:\r\n?|\n)/);for(let u=0,h=c.length;u<h;++u){const f=c[u];l.append(document.createTextNode(f)),u<h-1&&l.append(document.createElement("br"))}r.append(l)}else Cm.render({xfaHtml:p,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",i),s.append(r)}function Rm(p){const t=new Path2D;if(!p)return t;for(let i=0,s=p.length;i<s;)switch(p[i++]){case Za.moveTo:t.moveTo(p[i++],p[i++]);break;case Za.lineTo:t.lineTo(p[i++],p[i++]);break;case Za.curveTo:t.bezierCurveTo(p[i++],p[i++],p[i++],p[i++],p[i++],p[i++]);break;case Za.quadraticCurveTo:t.quadraticCurveTo(p[i++],p[i++],p[i++],p[i++]);break;case Za.closePath:t.closePath();break;default:pt(`Unrecognized drawing path operator: ${p[i-1]}`);break}return t}class lr{#t=null;#e=null;#n;#i=null;#r=null;#a=null;#s=null;#l=null;static#c=null;constructor(t){this.#n=t,lr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#n._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",hi,{signal:i}),t.addEventListener("pointerdown",lr.#o,{signal:i}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const r=this.#n.toolbarPosition;if(r){const{style:l}=t,c=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#o(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,Jt(t)}#h(t){this.#n._focusEventsAllowed=!0,Jt(t)}#f(t){const i=this.#n._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",hi,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",lr.#c[t]),this.#f(s)&&s.addEventListener("click",r=>{i.delete()},{signal:i._signal}),this.#i.append(s)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#m),this.#r=t}addComment(t,i=null){if(this.#a)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const r=this.#s=this.#m;i?(this.#i.insertBefore(s,i),this.#i.insertBefore(r,i)):this.#i.append(s,r),this.#a=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#m)}async addEditSignatureButton(t){const i=this.#l=await t.renderEditButton(this.#n);this.#f(i),this.#i.append(i,this.#m)}removeButton(t){switch(t){case"comment":this.#a?.removeToolbarCommentButton(),this.#a=null,this.#s?.remove(),this.#s=null;break}}async addButton(t,i){switch(t){case"colorPicker":i&&this.addColorPicker(i);break;case"altText":i&&await this.addAltText(i);break;case"editSignature":i&&await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":i&&this.addComment(i);break}}async addButtonBefore(t,i,s){if(!i&&t==="comment")return;const r=this.#i.querySelector(s);r&&t==="comment"&&this.addComment(i,r)}updateEditSignatureButton(t){this.#l&&(this.#l.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class Nv{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#n._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",hi,{signal:i});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#r(t,i){let s=0,r=0;for(const l of t){const c=l.y+l.height;if(c<s)continue;const u=l.x+(i?l.width:0);if(c>s){r=u,s=c;continue}i?u>r&&(r=u):u<r&&(r=u)}return[i?1-r:r,s]}show(t,i,s){const[r,l]=this.#r(i,s),{style:c}=this.#e||=this.#i();t.append(this.#e),c.insetInlineEnd=`${100*r}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#a(t,i,s,r){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",i);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",hi,{signal:u}),l.addEventListener("click",r,{signal:u})),this.#t.append(l)}}function Dm(p,t,i){for(const s of i)t.addEventListener(s,p[s].bind(p))}class Ot{static#t=NaN;static#e=null;static#n=NaN;static#i=null;static initializeAndAddPointerId(t){(Ot.#e||=new Set).add(t)}static setPointer(t,i){Ot.#t||=i,Ot.#i??=t}static setTimeStamp(t){Ot.#n=t}static isSamePointerId(t){return Ot.#t===t}static isSamePointerIdOrRemove(t){return Ot.#t===t?!0:(Ot.#e?.delete(t),!1)}static isSamePointerType(t){return Ot.#i===t}static isInitializedAndDifferentPointerType(t){return Ot.#i!==null&&!Ot.isSamePointerType(t)}static isSameTimeStamp(t){return Ot.#n===t}static isUsingMultiplePointers(){return Ot.#e?.size>=1}static clearPointerType(){Ot.#i=null}static clearPointerIds(){Ot.#t=NaN,Ot.#e=null}static clearTimeStamp(){Ot.#n=NaN}}class Lv{#t=0;get id(){return`${or}${this.#t++}`}}class oh{#t=Em();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const l=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return gt(this,"_isSVGFittingCanvas",l)}async#i(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof i=="string"?(s.url=i,r=await gr(i,"blob")):i instanceof File?r=s.file=i:i instanceof Blob&&(r=i),r.type==="image/svg+xml"){const l=oh._isSVGFittingCanvas,c=new FileReader,u=new Image,h=new Promise((f,m)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},c.onload=async()=>{const b=s.svgUrl=c.result;u.src=await l?`${b}#svgView(preserveAspectRatio(none))`:b},u.onerror=c.onerror=m});c.readAsDataURL(r),await h}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){pt(r),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:i,name:s,size:r,type:l}=t;return this.#i(`${i}_${s}_${r}_${l}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const s=await i;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(i.width,i.height);return r.getContext("2d").drawImage(i,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const i=this.#n.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=r.convertToBlob()}s.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class Ov{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:i,post:s,mustExec:r,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:i,post:s,type:l};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(c&&this.#t[this.#i].type===l){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class yr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=we.platform;for(const[s,r,l={}]of t)for(const c of s){const u=c.startsWith("mac+");i&&u?(this.callbacks.set(c.slice(4),{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1))):!i&&!u&&(this.callbacks.set(c,{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(this.#t(i));if(!s)return;const{callback:r,options:{bubbles:l=!1,args:c=[],checker:u=null}}=s;u&&!u(t,i)||(r.bind(t,...c,i)(),l||Jt(i))}}class ch{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return Tv(t),gt(this,"_colors",t)}convert(t){const i=br(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,r]of this._colors)if(r.every((l,c)=>l===i[c]))return ch._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?nt.makeHexColor(...i):t}}class Mn{#t=new AbortController;#e=null;#n=null;#i=new Map;#r=new Map;#a=null;#s=null;#l=null;#c=new Ov;#o=null;#d=null;#h=null;#f=0;#m=new Set;#g=null;#u=null;#p=new Set;_editorUndoBar=null;#b=!1;#v=!1;#y=!1;#E=null;#w=null;#S=null;#C=null;#A=!1;#_=null;#D=new Lv;#M=!1;#R=!1;#P=!1;#L=null;#k=null;#F=null;#B=null;#V=null;#T=mt.NONE;#x=new Set;#O=null;#U=null;#I=null;#X=null;#Y=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#z=null;#q=null;#Z=null;#J=null;#j=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Mn.prototype,i=c=>c.#q.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),s=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return gt(this,"_keyboardManager",new yr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#q.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#q.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:i}]]))}constructor(t,i,s,r,l,c,u,h,f,m,b,y,A,x,S,E){const w=this._signal=this.#t.signal;this.#q=t,this.#Z=i,this.#J=s,this.#a=r,this.#o=l,this.#U=c,this.#Y=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:w}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:w}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:w}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:w}),u._on("setpreference",this.onSetPreference.bind(this),{signal:w}),u._on("switchannotationeditorparams",R=>this.updateParams(R.type,R.value),{signal:w}),window.addEventListener("pointerdown",()=>{this.#R=!0},{capture:!0,signal:w}),window.addEventListener("pointerup",()=>{this.#R=!1},{capture:!0,signal:w}),this.#rt(),this.#dt(),this.#et(),this.#s=h.annotationStorage,this.#E=h.filterFactory,this.#I=f,this.#C=m||null,this.#b=b,this.#v=y,this.#y=A,this.#V=x||null,this.viewParameters={realScale:ia.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=E!==!1,l?.setSidebarUiManager(this)}destroy(){this.#j?.resolve(),this.#j=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#p.clear(),this.#B?.clear(),this.#e=null,this.#x.clear(),this.#c.destroy(),this.#a?.destroy(),this.#o?.destroy(),this.#U?.destroy(),this.#_?.hide(),this.#_=null,this.#F?.destroy(),this.#F=null,this.#n=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#z&&(clearTimeout(this.#z),this.#z=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return gt(this,"hcmFilter",this.#I?this.#E.addHCMFilter(this.#I.foreground,this.#I.background):"none")}get direction(){return gt(this,"direction",getComputedStyle(this.#q).direction)}get _highlightColors(){return gt(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return gt(this,"highlightColors",null);const i=new Map,s=!!this.#I;for(const[r,l]of t){const c=r.endsWith("_HCM");if(s&&c){i.set(r.replace("_HCM",""),l);continue}!s&&!c&&i.set(r,l)}return gt(this,"highlightColors",i)}get highlightColorNames(){return gt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,i=!1){this.#a?.editAltText(this,t,i)}hasCommentManager(){return!!this.#o}editComment(t,i,s,r){this.#o?.showDialog(this,t,i,s,r)}selectComment(t,i){this.#r.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#o?.updateComment(t.getData())}updatePopupColor(t){this.#o?.updatePopupColor(t)}removeComment(t){this.#o?.removeComments([t.uid])}toggleComment(t,i,s=void 0){this.#o?.toggleCommentPopup(t,i,s)}makeCommentColor(t,i){return t&&this.#o?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#o?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:i,promise:s}=Promise.withResolvers(),r=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",r),i())};this._eventBus.on("editorsrendered",r),await s}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":this.#y=i;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#q.focus()}findParent(t,i){for(const s of this.#r.values()){const{x:r,y:l,width:c,height:u}=s.div.getBoundingClientRect();if(t>=r&&t<=r+c&&i>=l&&i<=l+u)return s}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ia.PDF_TO_CSS_UNITS;for(const i of this.#p)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of this.#r.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",i=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u}=s,h=s.toString(),m=this.#Q(s).closest(".textLayer"),b=this.getSelectionBoxes(m);if(!b)return;s.empty();const y=this.#tt(m),A=this.#T===mt.NONE,x=()=>{const S=y?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:b,anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u,text:h});A&&this.showAllEditors("highlight",!0,!0),i&&S?.editComment()};if(A){this.switchToMode(mt.HIGHLIGHT,x);return}x()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#Q(t).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(this.#_||=new Nv(this),this.#_.show(s,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const i=`${or}${t}`,s=this.#s.getRawValue(i);return s&&this.#s.remove(i),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,i=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),i?s.setAttribute("data-l10n-args",JSON.stringify(i)):s.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#O&&(this.#_?.hide(),this.#O=null,this.#N({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#O)return;const r=this.#Q(t).closest(".textLayer");if(!r){this.#O&&(this.#_?.hide(),this.#O=null,this.#N({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#O=i,this.#N({hasSelectedText:!0}),!(this.#T!==mt.HIGHLIGHT&&this.#T!==mt.NONE)&&(this.#T===mt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#T===mt.HIGHLIGHT?this.#tt(r):null;if(l?.toggleDrawing(),this.#R){const c=new AbortController,u=this.combinedSignal(c),h=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else l?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#T===mt.HIGHLIGHT?this.highlightSelection(t):this.#b&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#lt(){if(this.#S)return;this.#S=new AbortController;const t=this.combinedSignal(this.#S);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ot(){this.#S?.abort(),this.#S=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#x)if(i.div.contains(t)){this.#k=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#k)return;const[t,i]=this.#k;this.#k=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#L)return;this.#L=new AbortController;const t=this.combinedSignal(this.#L);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#L?.abort(),this.#L=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of this.#x){const r=s.serialize(!0);r&&i.push(r)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const l of i.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(l){pt(`paste: "${l.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const l=[];for(const h of s){const f=await r.deserialize(h);if(!f)return;l.push(f)}const c=()=>{for(const h of l)this.#it(h);this.#nt(l)},u=()=>{for(const h of l)h.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){pt(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==mt.NONE&&!this.isEditorHandlingKeyboard&&Mn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#N(t){Object.entries(t).some(([s,r])=>this.#$[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#T===mt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Ct.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#lt(),this.#ut(),this.#N({isEditing:this.#T!==mt.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ot(),this.#ht(),this.#N({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#G(i.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,i=null,s=!1,r=!1,l=!1){if(this.#T!==t&&!(this.#j&&(await this.#j.promise,!this.#j))){if(this.#j=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===mt.POPUP&&this.#o?.hideSidebar(),this.#o?.destroyPopup(),this.#T=t,t===mt.NONE){this.setEditingState(!1),this.#pt();for(const c of this.#i.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#j.resolve();return}for(const c of this.#i.values())c.addStandaloneCommentButton();t===mt.SIGNATURE&&await this.#U?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const c of this.#r.values())c.updateMode(t);if(t===mt.POPUP){this.#n||=await this.#Y.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const c=new Set,u=[];for(const h of this.#i.values()){const{annotationElementId:f,hasComment:m,deleted:b}=h;f&&c.add(f),m&&!b&&u.push(h.getData())}for(const h of this.#n){const{id:f,popupRef:m,contentsObj:b}=h;m&&b?.str&&!c.has(f)&&!this.#m.has(f)&&u.push(h)}this.#o?.showSidebar(u)}if(!i){s&&this.addNewEditorFromKeyboard(),this.#j.resolve();return}for(const c of this.#i.values())c.uid===i?(this.setSelected(c),l?c.editComment():r?c.enterInEditMode():c.focus()):c.unselect();this.#j.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case Ct.CREATE:this.currentLayer.addNewEditor(i);return;case Ct.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#X||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const s of this.#x)s.updateParams(t,i);else for(const s of this.#u)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(const l of this.#i.values())l.editorType===t&&l.show(i);(this.#X?.get(Ct.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#G([[Ct.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#P!==t){this.#P=t;for(const i of this.#r.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const i of this.#r.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#pt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const i=this.#r.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#x);return t}updateUI(t){this.#gt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#x.has(t)){this.#x.delete(t),t.unselect(),this.#N({hasSelectedEditor:this.hasSelection});return}this.#x.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const i of this.#x)i!==t&&i.unselect();this.#x.clear(),this.#x.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}isSelected(t){return this.#x.has(t)}get firstSelectedEditor(){return this.#x.values().next().value}unselect(t){t.unselect(),this.#x.delete(t),this.#N({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#x.size!==0}get isEnterHandled(){return this.#x.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#N({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#c.add(t),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#c.cleanType(t)}#W(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#x],s=()=>{this._editorUndoBar?.show(r,i.length===1?i[0].editorType:i.length);for(const l of i)l.remove()},r=()=>{for(const l of i)this.#it(l)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#nt(t){for(const i of this.#x)i.unselect();this.#x.clear();for(const i of t)i.isEmpty()||(this.#x.add(i),i.select());this.#N({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#x)t.commit();this.#nt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==mt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#x)t.unselect();this.#x.clear(),this.#N({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=i;const[r,l]=this.#H,c=[...this.#x],u=1e3;this.#z&&clearTimeout(this.#z),this.#z=setTimeout(()=>{this.#z=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(r,l),h.translationDone())},undo:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(-r,-l),h.translationDone())},mustExec:!1})},u);for(const h of c)h.translateInPage(t,i),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#x)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let i=!1;for(const[{x:r,y:l,pageIndex:c},u]of t)u.newX=r,u.newY=l,u.newPageIndex=c,i||=r!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!i)return!1;const s=(r,l,c,u)=>{if(this.#i.has(r.id)){const h=this.#r.get(u);h?r._setParentAndPosition(h,l,c):(r.pageIndex=u,r.x=l,r.y=c)}};return this.addCommands({cmd:()=>{for(const[r,{newX:l,newY:c,newPageIndex:u}]of t)s(r,l,c,u)},undo:()=>{for(const[r,{savedX:l,savedY:c,savedPageIndex:u}]of t)s(r,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#g)for(const s of this.#g.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#x.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==mt.NONE}get imageManager(){return gt(this,"imageManager",new oh)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let f=0,m=i.rangeCount;f<m;f++)if(!t.contains(i.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:r,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,m,b,y)=>({x:(m-r)/c,y:1-(f+b-s)/l,width:y/c,height:b/l});break;case"180":u=(f,m,b,y)=>({x:1-(f+b-s)/l,y:1-(m+y-r)/c,width:b/l,height:y/c});break;case"270":u=(f,m,b,y)=>({x:1-(m+y-r)/c,y:(f-s)/l,width:y/c,height:b/l});break;default:u=(f,m,b,y)=>({x:(f-s)/l,y:(m-r)/c,width:b/l,height:y/c});break}const h=[];for(let f=0,m=i.rangeCount;f<m;f++){const b=i.getRangeAt(f);if(!b.collapsed)for(const{x:y,y:A,width:x,height:S}of b.getClientRects())x===0||S===0||h.push(u(y,A,x,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#l||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const i=this.#l?.get(t.data.id);if(!i)return;const s=this.#s.getRawValue(i);s&&(this.#T===mt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,i,s){const r=this.#B?.get(t);r&&(r.setCanvas(i,s),this.#B.delete(t))}addMissingCanvas(t,i){(this.#B||=new Map).set(t,i)}}class Ei{#t=null;#e=!1;#n=null;#i=null;#r=null;#a=null;#s=!1;#l=null;#c=null;#o=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Ei.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ei._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ei.#f.missing),i.setAttribute("data-l10n-id",Ei.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",hi,{signal:s}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const r=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#s=!0,r(l))},{signal:s}),await this.#g(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#o:this.isEmpty()}get guessedText(){return this.#o}async setGuessedText(t){this.#t===null&&(this.#o=t,this.#d=await Ei._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#l?.remove(),this.#l=null;return}if(!this.#l){const i=this.#l=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#l.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#o===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#o,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:r,cancel:l=!1}){s&&(this.#o=s,this.#d=r),!(this.#t===t&&this.#e===i)&&(l||(this.#t=t,this.#e=i),this.#g())}toggle(t=!1){this.#n&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#l?.remove(),this.#l=null}async#g(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ei.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",Ei.#f[`${this.#m}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#r;if(!i){this.#r=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const r=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#r?.classList.remove("show")},{signal:l})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class Fl{#t=null;#e=null;#n=!1;#i=null;#r=null;#a=null;#s=null;#l=null;#c=!1;#o=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const r=this.#i.commentButtonColor;r&&(s.backgroundColor=r)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#o)return this.#o;if(!this.#t)return null;const{x:t,y:i,height:s}=this.#t.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#i.parent.boundingClientRect;return[(t-r)/c,(i+s-l)/u]}set commentPopupPositionInLayer(t){this.#o=t}hasDefaultPopupPosition(){return this.#o===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",hi,{signal:s}),i&&(t.addEventListener("focusin",l=>{this.#i._focusEventsAllowed=!1,Jt(l)},{capture:!0,signal:s}),t.addEventListener("focusout",l=>{this.#i._focusEventsAllowed=!0,Jt(l)},{capture:!0,signal:s})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const r=l=>{l.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#n=!0,r(l))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const i=this.commentPopupPositionInLayer;let s,r;if(i)[s,r]=i;else{[s,r]=this.#i.commentButtonPosition;const{width:m,height:b,x:y,y:A}=this.#i;s=y+s*m,r=A+r*b}const l=this.#i.parent.boundingClientRect,{x:c,y:u,width:h,height:f}=l;this.#i._uiManager.editComment(this.#i,c+s*h,u+r*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#r}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#a,date:this.#l,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#a=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#l=new Date,this.#c=!1}setInitialText(t,i=null){this.#r=t,this.data=t,this.#l=null,this.#a=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#a=null,this.#l=null,this.#i=null,this.#n=!1,this.#c=!1}}class so{#t;#e=!1;#n=null;#i;#r;#a;#s;#l=null;#c;#o=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#n=s,this.#i=i,this.#r=r,this.#a=l,this.#s=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ti.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#l)return;const r=this.#l=new AbortController,l=AbortSignal.any([this.#c,r.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#l?.abort(),this.#l=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(Jt(f),h(f))},u),c.addEventListener("pointerup",h,u),c.addEventListener("pointercancel",h,u);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:r,capture:!1,passive:!1};l.addEventListener("touchmove",this.#m.bind(this),c);const u=this.#g.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",Jt,c),l.addEventListener("pointermove",Jt,c),l.addEventListener("pointercancel",Jt,c),l.addEventListener("pointerup",Jt,c),this.#r?.()}if(Jt(t),t.touches.length!==2||this.#n?.()){this.#o=null;return}let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]),this.#o={touch0X:i.screenX,touch0Y:i.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(t){if(!this.#o||t.touches.length!==2)return;Jt(t);let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]);const{screenX:r,screenY:l}=i,{screenX:c,screenY:u}=s,h=this.#o,{touch0X:f,touch0Y:m,touch1X:b,touch1Y:y}=h,A=b-f,x=y-m,S=c-r,E=u-l,w=Math.hypot(S,E)||1,R=Math.hypot(A,x)||1;if(!this.#e&&Math.abs(R-w)<=so.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=l,h.touch1X=c,h.touch1Y=u,!this.#e){this.#e=!0;return}const C=[(r+c)/2,(l+u)/2];this.#a?.(C,R,w)}#g(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#o&&(Jt(t),this.#o=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#l?.abort(),this.#l=null}}class rt{#t=null;#e=null;#n=null;#i=null;#r=null;#a=!1;#s=null;#l="";#c=null;#o=null;#d=null;#h=null;#f=null;#m="";#g=!1;#u=null;#p=!1;#b=!1;#v=!1;#y=null;#E=0;#w=0;#S=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#_=rt._zIndex++;static _borderLineWidth=-1;static _colorManager=new ch;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=rt.prototype._resizeWithKeyboard,i=Mn.TRANSLATE_SMALL,s=Mn.TRANSLATE_BIG;return gt(this,"_resizerKeyboardManager",new yr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],rt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:i,rawDims:{pageWidth:s,pageHeight:r,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[l,c];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return gt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new kv({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(rt._l10n??=t,rt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),rt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);rt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){Ht("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#z(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,r){const[l,c]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(t+s)/l,this.y=(i+r)/c,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[s,r]=this.parentDimensions;this.setAt(t*s,i*r,this.width*s,this.height*r),this._onTranslated()}#D([t,i],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/t,this.y+=r/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#D(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#D(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[r,l]}=this;if(this.x+=t/r,this.y+=i/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:b,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,b,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[h,f]=this.getBaseTranslation();c+=h,u+=f;const{style:m}=s;m.left=`${(100*c).toFixed(2)}%`,m.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=rt,r=s/t,l=s/i;switch(this.rotation){case 90:return[-r,l];case 180:return[r,l];case 270:return[r,-l];default:return[-r,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[s,r]}=this;let{x:l,y:c,width:u,height:h}=this;if(u*=s,h*=r,l*=s,c*=r,this._mustFixPosition)switch(t){case 0:l=Me(l,0,s-u),c=Me(c,0,r-h);break;case 90:l=Me(l,0,s-h),c=Me(c,u,r);break;case 180:l=Me(l,u,s),c=Me(c,h,r);break;case 270:l=Me(l,h,s),c=Me(c,0,r-u);break}this.x=l/=s,this.y=c/=r;const[f,m]=this.getBaseTranslation();l+=f,c+=m,i.left=`${(100*l).toFixed(2)}%`,i.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#M(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return rt.#M(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return rt.#M(t,i,360-this.parentRotation)}#R(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(){const{div:{style:t},width:i,height:s}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#P(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",this.#L.bind(this,s),{signal:i}),r.addEventListener("contextmenu",hi,{signal:i}),r.tabIndex=-1}this.div.prepend(this.#c)}#L(t,i){i.preventDefault();const{isMac:s}=we.platform;if(i.button!==0||i.ctrlKey&&s)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#o=[i.screenX,i.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",Jt,{passive:!1,signal:c}),window.addEventListener("contextmenu",hi,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#F()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#k(t,i,s,r){this.width=s,this.height=r,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:s,savedHeight:r}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,h=this.height;l===t&&c===i&&u===s&&h===r||this.addCommands({cmd:this.#k.bind(this,l,c,u,h),undo:this.#k.bind(this,t,i,s,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,i){const[s,r]=this.parentDimensions,l=this.x,c=this.y,u=this.width,h=this.height,f=rt.MIN_SIZE/s,m=rt.MIN_SIZE/r,b=this.#R(this.rotation),y=(z,V)=>[b[0]*z+b[2]*V,b[1]*z+b[3]*V],A=this.#R(360-this.rotation),x=(z,V)=>[A[0]*z+A[2]*V,A[1]*z+A[3]*V];let S,E,w=!1,R=!1;switch(t){case"topLeft":w=!0,S=(z,V)=>[0,0],E=(z,V)=>[z,V];break;case"topMiddle":S=(z,V)=>[z/2,0],E=(z,V)=>[z/2,V];break;case"topRight":w=!0,S=(z,V)=>[z,0],E=(z,V)=>[0,V];break;case"middleRight":R=!0,S=(z,V)=>[z,V/2],E=(z,V)=>[0,V/2];break;case"bottomRight":w=!0,S=(z,V)=>[z,V],E=(z,V)=>[0,0];break;case"bottomMiddle":S=(z,V)=>[z/2,V],E=(z,V)=>[z/2,0];break;case"bottomLeft":w=!0,S=(z,V)=>[0,V],E=(z,V)=>[z,0];break;case"middleLeft":R=!0,S=(z,V)=>[0,V/2],E=(z,V)=>[z,V/2];break}const C=S(u,h),k=E(u,h);let L=y(...k);const O=rt._round(l+L[0]),P=rt._round(c+L[1]);let q=1,K=1,J,Q;if(i.fromKeyboard)({deltaX:J,deltaY:Q}=i);else{const{screenX:z,screenY:V}=i,[W,dt]=this.#o;[J,Q]=this.screenToPageTranslation(z-W,V-dt),this.#o[0]=z,this.#o[1]=V}if([J,Q]=x(J/s,Q/r),w){const z=Math.hypot(u,h);q=K=Math.max(Math.min(Math.hypot(k[0]-C[0]-J,k[1]-C[1]-Q)/z,1/u,1/h),f/u,m/h)}else R?q=Me(Math.abs(k[0]-C[0]-J),f,1)/u:K=Me(Math.abs(k[1]-C[1]-Q),m,1)/h;const Z=rt._round(u*q),ht=rt._round(h*K);L=y(...E(Z,ht));const vt=O-L[0],At=P-L[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=Z,this.height=ht,this.x=vt,this.y=At,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#b)return this._editToolbar;this._editToolbar=new lr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,s]of t)await this._editToolbar.addButton(i,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Ei.initialize(rt._l10n),this.#n=new Ei(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new Fl(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#i.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:i,date:s,deleted:r}}=this.#i;return{text:i,richText:t,date:s,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Fl(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:s}){if(!i||(this.#i||=new Fl(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Fl(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,h=r-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#I();const[i,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/s).toFixed(2)}%`);const[r,l]=this.getInitialTranslation();return this.translate(r,l),Dm(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new so({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#x.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#V(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,i,s){let l=.7*(s/i)+1-.7;if(l===1)return;const c=this.#R(this.rotation),u=(O,P)=>[c[0]*O+c[2]*P,c[1]*O+c[3]*P],[h,f]=this.parentDimensions,m=this.x,b=this.y,y=this.width,A=this.height,x=rt.MIN_SIZE/h,S=rt.MIN_SIZE/f;l=Math.max(Math.min(l,1/y,1/A),x/y,S/A);const E=rt._round(y*l),w=rt._round(A*l);if(E===y&&w===A)return;this.#u||=[m,b,y,A];const R=u(y/2,A/2),C=rt._round(m+R[0]),k=rt._round(b+R[1]),L=u(E/2,w/2);this.x=C-L[0],this.y=k-L[1],this.width=E,this.height=w,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#x(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:i}=we.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#U(t);return}this.#O(t)}#O(t){const{isMac:i}=we.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,l=this._uiManager.combinedSignal(r),c={capture:!0,passive:!1,signal:l},u=f=>{r.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#O(f),s&&this._onStopDragging()};i&&(this.#E=t.clientX,this.#w=t.clientY,this.#s=t.pointerId,this.#l=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:m,clientY:b,pointerId:y}=f;if(y!==this.#s){Jt(f);return}const[A,x]=this.screenToPageTranslation(m-this.#E,b-this.#w);this.#E=m,this.#w=b,this._uiManager.dragSelectedEditors(A,x)},c),window.addEventListener("touchmove",Jt,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#l&&(this.#C||f.isPrimary)&&u(f),Jt(f)},c));const h=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}Jt(f)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,s=this.rotation){const r=this.parentScale,[l,c]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/r,m=i/r,b=this.x*l,y=this.y*c,A=this.width*l,x=this.height*c;switch(s){case 0:return[b+f+u,c-y-m-x+h,b+f+A+u,c-y-m+h];case 90:return[b+m+u,c-y+f+h,b+m+x+u,c-y+f+A+h];case 180:return[b-f-A+u,c-y+m+h,b-f+u,c-y+m+x+h];case 270:return[b-m-x+u,c-y-f-A+h,b-m+u,c-y-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,r,l,c]=t,u=l-s,h=c-r;switch(this.rotation){case 0:return[s,i-c,u,h];case 90:return[s,i-r,h,u];case 180:return[l,i-r,u,h];case 270:return[l,i-c,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&rt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:s,opacity:r,deleted:l,richText:c},uid:u,pageIndex:h,creationDate:f,modificationDate:m}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:s||m,popupRef:!l,color:i,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#b=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#b=!1,!0):!1}isInEditMode(){return this.#b}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return i<c&&r>0&&t<l&&s>0}#I(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#I()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,s){const r=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[l,c]=r.pageDimensions,[u,h,f,m]=r.getRectInCurrentCoords(t.rect,c);return r.x=u/l,r.y=h/c,r.width=f/l,r.height=m/c,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#z(),this.removeEditToolbar(),this.#S){for(const t of this.#S.values())clearTimeout(t);this.#S=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[s,r,l,c]=this.getPDFRect();return[rt._round(s+(l-s)*t),rt._round(r+(c-r)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const c=this.#X.bind(this),u=this.#Y.bind(this),h=this._uiManager._signal;for(const f of this.#e){const m=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",this.#$.bind(this,m),{signal:h}),f.setAttribute("data-l10n-id",rt._l10nResizer[m])}}const s=this.#e[0];let r=0;for(const c of i){if(c===s)break;r++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==r){if(l<r)for(let u=0;u<r-l;u++)this.#c.append(this.#c.firstElementChild);else if(l>r)for(let u=0;u<l-r;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of i){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",rt._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#X(t){rt._resizerKeyboardManager.exec(this,t)}#Y(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#z()}#$(t){this.#m=this.#v?t:""}#H(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#B(this.#m,{deltaX:t,deltaY:i,fromKeyboard:!0})}#z(){this.#v=!1,this.#H(-1),this.#F()}_stopResizingWithKeyboard(){this.#z(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#S||=new Map;const{action:s}=t;let r=this.#S.get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#S.delete(s),this.#S.size===0&&(this.#S=null)},rt._telemetryTimeout),this.#S.set(s,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstElementChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class kv extends rt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Xg=3285377520,oi=4294901760,wi=65535;class Nm{constructor(t){this.h1=t?t&4294967295:Xg,this.h2=t?t&4294967295:Xg}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let S=0,E=t.length;S<E;S++){const w=t.charCodeAt(S);w<=255?i[s++]=w:(i[s++]=w>>>8,i[s++]=w&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,l=s-r*4,c=new Uint32Array(i.buffer,0,r);let u=0,h=0,f=this.h1,m=this.h2;const b=3432918353,y=461845907,A=b&wi,x=y&wi;for(let S=0;S<r;S++)S&1?(u=c[S],u=u*b&oi|u*A&wi,u=u<<15|u>>>17,u=u*y&oi|u*x&wi,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=c[S],h=h*b&oi|h*A&wi,h=h<<15|h>>>17,h=h*y&oi|h*x&wi,m^=h,m=m<<13|m>>>19,m=m*5+3864292196);switch(u=0,l){case 3:u^=i[r*4+2]<<16;case 2:u^=i[r*4+1]<<8;case 1:u^=i[r*4],u=u*b&oi|u*A&wi,u=u<<15|u>>>17,u=u*y&oi|u*x&wi,r&1?f^=u:m^=u}this.h1=f,this.h2=m}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&oi|t*36045&wi,i=i*4283543511&oi|((i<<16|t>>>16)*2950163797&oi)>>>16,t^=i>>>1,t=t*444984403&oi|t*60499&wi,i=i*3301882366&oi|((i<<16|t>>>16)*3120437893&oi)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const Qu=Object.freeze({map:null,hash:"",transfer:void 0});class uh{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=this.#i.get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof rt&&this.#n.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof rt)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=this.#i.get(t);let r=!1;if(s!==void 0)for(const[l,c]of Object.entries(i))s[l]!==c&&(r=!0,s[l]=c);else r=!0,this.#i.set(t,i);r&&this.#r(),i instanceof rt&&((this.#n||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Lm(this)}get serializable(){if(this.#i.size===0)return Qu;const t=new Map,i=new Nm,s=[],r=Object.create(null);let l=!1;for(const[c,u]of this.#i){const h=u instanceof rt?u.serialize(!1,r):u;h&&(t.set(c,h),i.update(`${c}:${JSON.stringify(h)}`),l||=!!h.bitmap)}if(l)for(const c of t.values())c.bitmap&&s.push(c.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:Qu}get editorStats(){let t=null;const i=new Map;let s=0,r=0;for(const l of this.#i.values()){if(!(l instanceof rt)){l.popup&&(l.popup.deleted?r+=1:s+=1);continue}l.isCommentDeleted?r+=1:l.hasEditedComment&&(s+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;i.has(u)||i.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const h=t[u]||=new Map;for(const[f,m]of Object.entries(c)){if(f==="type")continue;let b=h.get(f);b||(b=new Map,h.set(f,b));const y=b.get(m)??0;b.set(m,y+1)}}if((r>0||s>0)&&(t||=Object.create(null),t.comments={deleted:r,edited:s}),!t)return null;for(const[l,c]of i)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const s=this.#n?.get(t);return s?(s.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const i of this.#n.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class Lm extends uh{#t;constructor(t){super();const{map:i,hash:s,transfer:r}=t.serializable,l=structuredClone(i,r?{transfer:r}:null);this.#t={map:l,hash:s,transfer:r}}get print(){Ht("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return gt(this,"modifiedIds",{ids:new Set,hash:""})}}class Bv{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Mt(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:l,style:c}=t,u=new FontFace(r,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(r),s?.(t)}catch{pt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Ht("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw pt(`Failed to load font '${s.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return gt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return gt(this,"isSyncFontLoadingSupported",Ce||we.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Mt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const l=s.shift();setTimeout(l.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:i,callback:t};return s.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return gt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(k,L){return k.charCodeAt(L)<<24|k.charCodeAt(L+1)<<16|k.charCodeAt(L+2)<<8|k.charCodeAt(L+3)&255}function r(k,L,O,P){const q=k.substring(0,L),K=k.substring(L+O);return q+P+K}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function m(k,L){if(++f>30){pt("Load test font never loaded."),L();return}if(h.font="30px "+k,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(m.bind(null,k,L))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=r(y,976,b.length,b);const x=16,S=1482184792;let E=s(y,x);for(l=0,c=b.length-3;l<c;l+=4)E=E-S+s(b,l)|0;l<b.length&&(E=E-S+s(b+"XXX",l)|0),y=r(y,x,4,gv(E));const w=`url(data:font/opentype;base64,${btoa(y)});`,R=`@font-face {font-family:"${b}";src:${w}}`;this.insertRule(R);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const k of[t.loadedName,b]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=k,C.append(L)}this._document.body.append(C),m(b,()=>{C.remove(),i.complete()})}}class zv{#t;constructor(t,i=null,s,r){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,s&&Object.assign(this,s),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Tm(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const s=this.loadedName+"_path_"+i;let r;try{r=t.get(s)}catch(c){pt(`getPathGenerator - ignoring character: "${c}".`)}const l=Rm(r);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[i]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){gt(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){gt(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class Qs{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,s={};let r=0;for(const f of Qs.strings){const m=i.encode(t[f]);s[f]=m,r+=4+m.length}const l=new ArrayBuffer(r),c=new Uint8Array(l),u=new DataView(l);let h=0;for(const f of Qs.strings){const m=s[f],b=m.length;u.setUint32(h,b),c.set(m,h+4),h+=4+b}return Mt(h===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Mt(t<Qs.strings.length,"Invalid string index");let i=0;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class Zs{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,s={};let r=0;for(const y of Zs.strings){const A=i.encode(t[y]);s[y]=A,r+=4+A.length}r+=4;let l,c,u=1+r;t.style&&(l=i.encode(t.style.style),c=i.encode(t.style.weight),u+=4+l.length+4+c.length);const h=new ArrayBuffer(u),f=new Uint8Array(h),m=new DataView(h);let b=0;m.setUint8(b++,t.guessFallback?1:0),m.setUint32(b,0),b+=4,r=0;for(const y of Zs.strings){const A=s[y],x=A.length;r+=4+x,m.setUint32(b,x),f.set(A,b+4),b+=4+x}return m.setUint32(b-r-4,r),t.style&&(m.setUint32(b,l.length),f.set(l,b+4),b+=4+l.length,m.setUint32(b,c.length),f.set(c,b+4),b+=4+c.length),Mt(b<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(b)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Mt(t<Zs.strings.length,"Invalid string index");let i=5;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),s=this.#n.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const r=this.#e.getUint32(t),l=this.#n.decode(new Uint8Array(this.#t,t+4,r));return{style:s,weight:l}}}class Ut{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#r=this.#i+1+6;#a;#s;#l;constructor({data:t,extra:i}){this.#a=t,this.#s=new TextDecoder,this.#l=new DataView(this.#a),i&&Object.assign(this,i)}#c(t){Mt(t<Ut.bools.length,"Invalid boolean index");const i=Math.floor(t/4),s=t*2%8,r=this.#l.getUint8(i)>>s&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#o(t){return Mt(t<Ut.numbers.length,"Invalid number index"),this.#l.getFloat64(Ut.#t+t*8)}get ascent(){return this.#o(0)}get defaultWidth(){return this.#o(1)}get descent(){return this.#o(2)}get bbox(){let t=Ut.#e;if(this.#l.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<4;r++)s.push(this.#l.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=Ut.#n;if(this.#l.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<6;r++)s.push(this.#l.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=Ut.#i;if(this.#l.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<3;r++)s.push(this.#l.getInt16(t,!0)),t+=2;return s}#d(t){Mt(t<Ut.strings.length,"Invalid string index");let i=Ut.#r+4;for(let l=0;l<t;l++)i+=this.#l.getUint32(i)+4;const s=this.#l.getUint32(i),r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,i+4,s)),this.#s.decode(r)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Ut.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);t+=4+s;const r=this.#l.getUint32(t);t+=4+r;const l=this.#l.getUint32(t);if(l!==0)return new Uint8Array(this.#a,t+4,l)}clearData(){let t=Ut.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);t+=4+s;const r=this.#l.getUint32(t);t+=4+r;const l=this.#l.getUint32(t);new Uint8Array(this.#a,t+4,l).fill(0),this.#l.setUint32(t,0)}get cssFontInfo(){let t=Ut.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);t+=4+s;const r=this.#l.getUint32(t);if(r===0)return null;const l=new Uint8Array(r);return l.set(new Uint8Array(this.#a,t+4,r)),new Qs(l.buffer)}get systemFontInfo(){let t=Ut.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,t+4,s)),new Zs(r.buffer)}static write(t){const i=t.systemFontInfo?Zs.write(t.systemFontInfo):null,s=t.cssFontInfo?Qs.write(t.cssFontInfo):null,r=new TextEncoder,l={};let c=0;for(const S of Ut.strings)l[S]=r.encode(t[S]),c+=4+l[S].length;const u=Ut.#r+4+c+4+(i?i.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),f=new Uint8Array(h),m=new DataView(h);let b=0;const y=Ut.bools.length;let A=0,x=0;for(let S=0;S<y;S++){const E=t[Ut.bools[S]];A|=(E===void 0?0:E?2:1)<<x,x+=2,(x===8||S===y-1)&&(m.setUint8(b++,A),A=0,x=0)}Mt(b===Ut.#t,"FontInfo.write: Boolean properties offset mismatch");for(const S of Ut.numbers)m.setFloat64(b,t[S]),b+=8;if(Mt(b===Ut.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){m.setUint8(b++,4);for(const S of t.bbox)m.setInt16(b,S,!0),b+=2}else m.setUint8(b++,0),b+=8;if(Mt(b===Ut.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){m.setUint8(b++,6);for(const S of t.fontMatrix)m.setFloat64(b,S,!0),b+=8}else m.setUint8(b++,0),b+=48;if(Mt(b===Ut.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){m.setUint8(b++,1);for(const S of t.defaultVMetrics)m.setInt16(b,S,!0),b+=2}else m.setUint8(b++,0),b+=6;Mt(b===Ut.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),m.setUint32(Ut.#r,0),b+=4;for(const S of Ut.strings){const E=l[S],w=E.length;m.setUint32(b,w),f.set(E,b+4),b+=4+w}if(m.setUint32(Ut.#r,b-Ut.#r-4),!i)m.setUint32(b,0),b+=4;else{const S=i.byteLength;m.setUint32(b,S),Mt(b+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(i),b+4),b+=4+S}if(!s)m.setUint32(b,0),b+=4;else{const S=s.byteLength;m.setUint32(b,S),Mt(b+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),b+4),b+=4+S}return t.data===void 0?(m.setUint32(b,0),b+=4):(m.setUint32(b,t.data.length),f.set(t.data,b+4),b+=4+t.data.length),Mt(b<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(b)}}class fe{static#t=0;static#e=1;static#n=2;static#i=3;static#r=4;static#a=8;static#s=12;static#l=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let i,s=null,r=[],l=[],c=[],u=[],h=null,f=null;switch(t[0]){case"RadialAxial":i=t[1]==="axial"?1:2,s=t[2],c=t[3],i===1?r.push(...t[4],...t[5]):r.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":i=3,h=t[1],r=t[2],l=t[3],u=t[4]||[],s=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const m=Math.floor(r.length/2),b=Math.floor(l.length/3),y=c.length,A=u.length;let x=0;for(const L of u)x+=1,x=Math.ceil(x/4)*4,x+=4+L.coords.length*4,x+=4+L.colors.length*4,L.verticesPerRow!==void 0&&(x+=4);const S=20+m*8+b*3+y*8+(s?16:0)+(f?3:0)+x,E=new ArrayBuffer(S),w=new DataView(E),R=new Uint8Array(E);w.setUint8(fe.#t,i),w.setUint8(fe.#e,s?1:0),w.setUint8(fe.#n,f?1:0),w.setUint8(fe.#i,h),w.setUint32(fe.#r,m,!0),w.setUint32(fe.#a,b,!0),w.setUint32(fe.#s,y,!0),w.setUint32(fe.#l,A,!0);let C=20;new Float32Array(E,C,m*2).set(r),C+=m*8,R.set(l,C),C+=b*3;for(const[L,O]of c)w.setFloat32(C,L,!0),C+=4,w.setUint32(C,parseInt(O.slice(1),16),!0),C+=4;if(s)for(const L of s)w.setFloat32(C,L,!0),C+=4;f&&(R.set(f,C),C+=3);for(let L=0;L<u.length;L++){const O=u[L];w.setUint8(C,O.type),C+=1,C=Math.ceil(C/4)*4,w.setUint32(C,O.coords.length,!0),C+=4,new Int32Array(E,C,O.coords.length).set(O.coords),C+=O.coords.length*4,w.setUint32(C,O.colors.length,!0),C+=4,new Int32Array(E,C,O.colors.length).set(O.colors),C+=O.colors.length*4,O.verticesPerRow!==void 0&&(w.setUint32(C,O.verticesPerRow,!0),C+=4)}return E}getIR(){const t=this.view,i=this.data[fe.#t],s=!!this.data[fe.#e],r=!!this.data[fe.#n],l=t.getUint32(fe.#r,!0),c=t.getUint32(fe.#a,!0),u=t.getUint32(fe.#s,!0),h=t.getUint32(fe.#l,!0);let f=20;const m=new Float32Array(this.buffer,f,l*2);f+=l*8;const b=new Uint8Array(this.buffer,f,c*3);f+=c*3;const y=[];for(let E=0;E<u;++E){const w=t.getFloat32(f,!0);f+=4;const R=t.getUint32(f,!0);f+=4,y.push([w,`#${R.toString(16).padStart(6,"0")}`])}let A=null;if(s){A=[];for(let E=0;E<4;++E)A.push(t.getFloat32(f,!0)),f+=4}let x=null;r&&(x=new Uint8Array(this.buffer,f,3),f+=3);const S=[];for(let E=0;E<h;++E){const w=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const R=t.getUint32(f,!0);f+=4;const C=new Int32Array(this.buffer,f,R);f+=R*4;const k=t.getUint32(f,!0);f+=4;const L=new Int32Array(this.buffer,f,k);f+=k*4;const O={type:w,coords:C,colors:L};w===Yu.LATTICE&&(O.verticesPerRow=t.getUint32(f,!0),f+=4),S.push(O)}if(i===1)return["RadialAxial","axial",A,y,Array.from(m.slice(0,2)),Array.from(m.slice(2,4)),null,null];if(i===2)return["RadialAxial","radial",A,y,[m[0],m[1]],[m[3],m[4]],m[2],m[5]];if(i===3){const E=this.data[fe.#i];let w=null;if(m.length>0){let R=m[0],C=m[0],k=m[1],L=m[1];for(let O=0;O<m.length;O+=2){const P=m[O],q=m[O+1];R=R>P?P:R,k=k>q?q:k,C=C<P?P:C,L=L<q?q:L}w=[R,k,C,L]}return["Mesh",E,m,b,S,w,A,x]}throw new Error(`Unsupported pattern kind: ${i}`)}}function Pv(p){if(p instanceof URL)return p.href;if(typeof p=="string"){if(Ce)return p;const t=URL.parse(p,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Fv(p){if(Ce&&typeof Buffer<"u"&&p instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength)return p;if(typeof p=="string")return pr(p);if(p instanceof ArrayBuffer||ArrayBuffer.isView(p)||typeof p=="object"&&!isNaN(p?.length))return new Uint8Array(p);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Ul(p){if(typeof p!="string")return null;if(p.endsWith("/"))return p;throw new Error(`Invalid factory url: "${p}" must include trailing slash.`)}const Zu=p=>typeof p=="object"&&Number.isInteger(p?.num)&&p.num>=0&&Number.isInteger(p?.gen)&&p.gen>=0,Uv=p=>typeof p=="object"&&typeof p?.name=="string",jv=Av.bind(null,Zu,Uv);class Iv{#t=new Map;#e=Promise.resolve();postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,s)})}addEventListener(t,i,s=null){let r=null;if(s?.signal instanceof AbortSignal){const{signal:l}=s;if(l.aborted){pt("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,i);r=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(i,r)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const jl={DATA:1,ERROR:2},oe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function $g(){}function Fe(p){if(p instanceof Cn||p instanceof Xu||p instanceof jg||p instanceof Wl||p instanceof ku)return p;switch(p instanceof Error||typeof p=="object"&&p!==null||Ht('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new Cn(p.message);case"InvalidPDFException":return new Xu(p.message);case"PasswordException":return new jg(p.message,p.code);case"ResponseException":return new Wl(p.message,p.status,p.missing);case"UnknownErrorException":return new ku(p.message,p.details)}return new ku(p.message,p.toString())}class ar{#t=new AbortController;constructor(t,i,s){this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===jl.DATA)r.resolve(t.data);else if(t.callback===jl.ERROR)r.reject(Fe(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,r=t.sourceName,l=this.comObj;Promise.try(i,t.data).then(function(c){l.postMessage({sourceName:s,targetName:r,callback:jl.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:s,targetName:r,callback:jl.ERROR,callbackId:t.callbackId,reason:Fe(c)})});return}if(t.streamId){this.#n(t);return}i(t.data)}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const r=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[r]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:i},s)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,i,s,r){const l=this.streamId++,c=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const m=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:i,desiredSize:f.desiredSize},r),m.promise},pull:f=>{const m=Promise.withResolvers();return this.streamControllers[l].pullCall=m,h.postMessage({sourceName:c,targetName:u,stream:oe.PULL,streamId:l,desiredSize:f.desiredSize}),m.promise},cancel:f=>{Mt(f instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[l].cancelCall=m,this.streamControllers[l].isClosed=!0,h.postMessage({sourceName:c,targetName:u,stream:oe.CANCEL,streamId:l,reason:Fe(f)}),m.promise}},s)}#n(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],h={enqueue(f,m=1,b){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=m,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:s,targetName:r,stream:oe.ENQUEUE,streamId:i,chunk:f},b)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:r,stream:oe.CLOSE,streamId:i}),delete c.streamSinks[i])},error(f){Mt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:r,stream:oe.ERROR,streamId:i,reason:Fe(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,Promise.try(u,t.data,h).then(function(){l.postMessage({sourceName:s,targetName:r,stream:oe.START_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:oe.START_COMPLETE,streamId:i,reason:Fe(f)})})}#i(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,l=this.comObj,c=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case oe.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(Fe(t.reason));break;case oe.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(Fe(t.reason));break;case oe.PULL:if(!u){l.postMessage({sourceName:s,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||$g).then(function(){l.postMessage({sourceName:s,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,reason:Fe(f)})});break;case oe.ENQUEUE:if(Mt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case oe.CLOSE:if(Mt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,i);break;case oe.ERROR:Mt(c,"error should have stream controller"),c.controller.error(Fe(t.reason)),this.#r(c,i);break;case oe.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(Fe(t.reason)),this.#r(c,i);break;case oe.CANCEL:if(!u)break;const h=Fe(t.reason);Promise.try(u.onCancel||$g,h).then(function(){l.postMessage({sourceName:s,targetName:r,stream:oe.CANCEL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:oe.CANCEL_COMPLETE,streamId:i,reason:Fe(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#r(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class Om{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){Ht("Abstract method `_createCanvas` called.")}}class Hv extends Om{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class km{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){Ht("Abstract method `_fetch` called.")}}class Kg extends km{async _fetch(t){const i=await gr(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):pr(i)}}class Bm{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,r,l){return"none"}destroy(t=!1){}}class Gv extends Bm{#t;#e;#n;#i;#r;#a;#s=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#r=i}get#l(){return this.#e||=new Map}get#c(){return this.#a||=new Map}get#o(){if(!this.#n){const t=this.#r.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=this.#r.createElementNS(Yi,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#r.createElementNS(Yi,"defs"),t.append(s),s.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let b=0;b<256;b++)f[b]=h[b]/255;const m=f.join(",");return[m,m,m]}const[i,s,r]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let h=0;h<256;h++)l[h]=i[h]/255,c[h]=s[h]/255,u[h]=r[h]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#r.URL;i!==this.#r.baseURI&&(no(i)?pt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=wm(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#l.get(t);if(i)return i;const[s,r,l]=this.#d(t),c=t.length===1?s:`${s}${r}${l}`;if(i=this.#l.get(c),i)return this.#l.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#s++}`,h=this.#h(u);this.#l.set(t,h),this.#l.set(c,h);const f=this.#g(u);return this.#p(s,r,l,f),h}addHCMFilter(t,i){const s=`${t}-${i}`,r="base";let l=this.#c.get(r);if(l?.key===s||(l?(l.filter?.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},this.#c.set(r,l)),!t||!i))return l.url;const c=this.#v(t);t=nt.makeHexColor(...c);const u=this.#v(i);if(i=nt.makeHexColor(...u),this.#o.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return l.url;const h=new Array(256);for(let A=0;A<=255;A++){const x=A/255;h[A]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const f=h.join(","),m=`g_${this.#i}_hcm_filter`,b=l.filter=this.#g(m);this.#p(f,f,f,b),this.#m(b);const y=(A,x)=>{const S=c[A]/255,E=u[A]/255,w=new Array(x+1);for(let R=0;R<=x;R++)w[R]=S+R/x*(E-S);return w.join(",")};return this.#p(y(0,5),y(1,5),y(2,5),b),l.url=this.#h(m),l.url}addAlphaFilter(t){let i=this.#l.get(t);if(i)return i;const[s]=this.#d([t]),r=`alpha_${s}`;if(i=this.#l.get(r),i)return this.#l.set(t,i),i;const l=`g_${this.#i}_alpha_map_${this.#s++}`,c=this.#h(l);this.#l.set(t,c),this.#l.set(r,c);const u=this.#g(l);return this.#b(s,u),c}addLuminosityFilter(t){let i=this.#l.get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=this.#d([t]),r=`luminosity_${s}`):r="luminosity",i=this.#l.get(r),i)return this.#l.set(t,i),i;const l=`g_${this.#i}_luminosity_map_${this.#s++}`,c=this.#h(l);this.#l.set(t,c),this.#l.set(r,c);const u=this.#g(l);return this.#f(u),t&&this.#b(s,u),c}addHighlightHCMFilter(t,i,s,r,l){const c=`${i}-${s}-${r}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!i||!s))return u.url;const[h,f]=[i,s].map(this.#v.bind(this));let m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),b=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[y,A]=[r,l].map(this.#v.bind(this));b<m&&([m,b,y,A]=[b,m,A,y]),this.#o.style.color="";const x=(w,R,C)=>{const k=new Array(256),L=(b-m)/C,O=w/255,P=(R-w)/(255*C);let q=0;for(let K=0;K<=C;K++){const J=Math.round(m+K*L),Q=O+K*P;for(let Z=q;Z<=J;Z++)k[Z]=Q;q=J+1}for(let K=q;K<256;K++)k[K]=k[q-1];return k.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,E=u.filter=this.#g(S);return this.#m(E),this.#p(x(y[0],A[0],5),x(y[1],A[1],5),x(y[2],A[2],5),E),u.url=this.#h(S),u.url}destroy(t=!1){t&&this.#a?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#a?.clear(),this.#a=null,this.#s=0)}#f(t){const i=this.#r.createElementNS(Yi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#m(t){const i=this.#r.createElementNS(Yi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#g(t){const i=this.#r.createElementNS(Yi,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#o.append(i),i}#u(t,i,s){const r=this.#r.createElementNS(Yi,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)}#p(t,i,s,r){const l=this.#r.createElementNS(Yi,"feComponentTransfer");r.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",i),this.#u(l,"feFuncB",s)}#b(t,i){const s=this.#r.createElementNS(Yi,"feComponentTransfer");i.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#o.style.color=t,br(getComputedStyle(this.#o).getPropertyValue("color"))}}class zm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){Ht("Abstract method `_fetch` called.")}}class Wg extends zm{async _fetch(t){const i=await gr(t,"arraybuffer");return new Uint8Array(i)}}class Pm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){Ht("Abstract method `_fetch` called.")}}class Qg extends Pm{async _fetch(t){const i=await gr(t,"arraybuffer");return new Uint8Array(i)}}Ce&&pt("Please use the `legacy` build in Node.js environments.");async function hh(p){const i=await process.getBuiltinModule("fs").promises.readFile(p);return new Uint8Array(i)}class Vv extends Bm{}class qv extends Om{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class Yv extends km{async _fetch(t){return hh(t)}}class Xv extends zm{async _fetch(t){return hh(t)}}class $v extends Pm{async _fetch(t){return hh(t)}}const Hs="__forcedDependency",{floor:Zg,ceil:Jg}=Math;function Il(p,t,i,s,r,l){p[t*4+0]=Math.min(p[t*4+0],i),p[t*4+1]=Math.min(p[t*4+1],s),p[t*4+2]=Math.max(p[t*4+2],r),p[t*4+3]=Math.max(p[t*4+3],l)}const Ju=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class Kv{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Ju}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Hl=(p,t)=>{if(!p)return;let i=p.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},p.set(t,i)),i};class Wv{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Hs]:[]};#n=new Map;#i=[];#r=[];#a=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#l=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#o=new Set;#d=new Map;#h=new Map;#f;#m;#g;#u;#p;constructor(t,i,s=!1){this.#f=t.width,this.#m=t.height,this.#b(i),s&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#b(t,this.#u)}#b(t,i){const s=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),i&&i.length>0?(this.#u.set(i),this.#u.fill(Ju,i.length)):this.#u.fill(Ju)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Hs]:{__proto__:this.#e[Hs]}},this.#s={__proto__:this.#s},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const s=this.#i.pop();return s!==void 0&&(Hl(this.#p,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(Hl(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const i=this.#r.pop();return i!==void 0&&(Hl(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#a.push(nt.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#n.set(t,i),this}recordSimpleDataFromNamed(t,i,s){this.#t[t]=this.#n.get(i)??s}recordFutureForcedDependency(t,i){return this.recordIncrementalData(Hs,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#o)this.recordFutureForcedDependency(Hs,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#l[0]=1/0,this.#l[1]=1/0,this.#l[2]=-1/0,this.#l[3]=-1/0),this}recordClipBox(t,i,s,r,l,c){const u=nt.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform()),h=[1/0,1/0,-1/0,-1/0];nt.axialAlignedBoundingBox([s,l,r,c],u,h);const f=nt.intersect(this.#s,h);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,i,s,r,l,c){const u=this.#s;if(u[0]===1/0)return this;const h=nt.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform());if(u[0]===-1/0)return nt.axialAlignedBoundingBox([s,l,r,c],h,this.#l),this;const f=[1/0,1/0,-1/0,-1/0];return nt.axialAlignedBoundingBox([s,l,r,c],h,f),this.#l[0]=Math.min(this.#l[0],Math.max(f[0],u[0])),this.#l[1]=Math.min(this.#l[1],Math.max(f[1],u[1])),this.#l[2]=Math.max(this.#l[2],Math.min(f[2],u[2])),this.#l[3]=Math.max(this.#l[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,i,s,r=1,l=0,c=0,u){const h=s.bbox;let f,m;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(s),f!==!1&&(m=[0,0,0,0],nt.axialAlignedBoundingBox(h,s.fontMatrix,m),(r!==1||l!==0||c!==0)&&nt.scaleMinMax([r,0,0,-r,l,c],m),f)))return this.recordBBox(t,i,m[0],m[2],m[1],m[3]);if(!u)return this.recordFullPageBBox(t);const b=u();return h&&m&&f===void 0&&(f=m[0]<=l-b.actualBoundingBoxLeft&&m[2]>=l+b.actualBoundingBoxRight&&m[1]<=c-b.actualBoundingBoxAscent&&m[3]>=c+b.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,i,m[0],m[2],m[1],m[3]):this.recordBBox(t,i,l-b.actualBoundingBoxLeft,l+b.actualBoundingBoxRight,c-b.actualBoundingBoxAscent,c+b.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#l[0]=Math.max(0,this.#s[0]),this.#l[1]=Math.max(0,this.#s[1]),this.#l[2]=Math.min(this.#f,this.#s[2]),this.#l[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const s=this.#o,r=this.#t,l=this.#e;for(const c of i)c in this.#t?s.add(r[c]):c in l&&l[c].forEach(s.add,s);return this}recordNamedDependency(t,i){return this.#n.has(i)&&this.#o.add(this.#n.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[Hs]),this.#p){const s=Hl(this.#p,t),{dependencies:r}=s;this.#o.forEach(r.add,r),this.#i.forEach(r.add,r),this.#r.forEach(r.add,r),r.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=Zg(this.#l[0]*256/this.#f),r=Zg(this.#l[1]*256/this.#m),l=Jg(this.#l[2]*256/this.#f),c=Jg(this.#l[3]*256/this.#m);Il(this.#g,t,s,r,l,c);for(const u of this.#o)u!==t&&Il(this.#g,u,s,r,l,c);for(const u of this.#i)u!==t&&Il(this.#g,u,s,r,l,c);for(const u of this.#r)u!==t&&Il(this.#g,u,s,r,l,c);i||(this.#o.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const s=Array.from(this.#o);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const r of s)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#l[0]),this.#s[1]=Math.max(this.#s[1],this.#l[1]),this.#s[2]=Math.min(this.#s[2],this.#l[2]),this.#s[3]=Math.min(this.#s[3],this.#l[3]),i||this.#o.clear()),this}_takePendingDependencies(){const t=this.#o;return this.#o=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#o.add(i)}take(){return this.#h.clear(),new Kv(this.#u,this.#g)}takeDebugMetadata(){return this.#p}}class Ql{#t;#e;#n;#i=0;#r=0;constructor(t,i,s){if(t instanceof Ql&&t.#n===!!s)return t;this.#t=t,this.#e=i,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,s){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,s,r,l,c){return this.#n||this.#t.recordClipBox(this.#e,i,s,r,l,c),this}recordBBox(t,i,s,r,l,c){return this.#n||this.#t.recordBBox(this.#e,i,s,r,l,c),this}recordCharacterBBox(t,i,s,r,l,c,u){return this.#n||this.#t.recordCharacterBBox(this.#e,i,s,r,l,c,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const ci={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},xe={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function th(p,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],i,s),p.clip(r)}class dh{isModifyingCurrentTransform(){return!1}getPattern(){Ht("Abstract method `getPattern` called.")}}class Qv extends dh{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let i;this._type==="axial"?i=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)i.addColorStop(s[0],s[1]);return i}getPattern(t,i,s,r){let l;if(r===xe.STROKE||r===xe.FILL){const c=i.current.getClippedPathBoundingBox(r,$t(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,h=Math.ceil(c[3]-c[1])||1,f=i.cachedCanvases.getCanvas("pattern",u,h),m=f.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-c[0],-c[1]),s=nt.transform(s,[1,0,0,1,c[0],c[1]]),m.transform(...i.baseTransform),this.matrix&&m.transform(...this.matrix),th(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),l=t.createPattern(f.canvas,"no-repeat");const b=new DOMMatrix(s);l.setTransform(b)}else th(t,this._bbox),l=this._createGradient(t);return l}}function Pu(p,t,i,s,r,l,c,u){const h=t.coords,f=t.colors,m=p.data,b=p.width*4;let y;h[i+1]>h[s+1]&&(y=i,i=s,s=y,y=l,l=c,c=y),h[s+1]>h[r+1]&&(y=s,s=r,r=y,y=c,c=u,u=y),h[i+1]>h[s+1]&&(y=i,i=s,s=y,y=l,l=c,c=y);const A=(h[i]+t.offsetX)*t.scaleX,x=(h[i+1]+t.offsetY)*t.scaleY,S=(h[s]+t.offsetX)*t.scaleX,E=(h[s+1]+t.offsetY)*t.scaleY,w=(h[r]+t.offsetX)*t.scaleX,R=(h[r+1]+t.offsetY)*t.scaleY;if(x>=R)return;const C=f[l],k=f[l+1],L=f[l+2],O=f[c],P=f[c+1],q=f[c+2],K=f[u],J=f[u+1],Q=f[u+2],Z=Math.round(x),ht=Math.round(R);let vt,At,z,V,W,dt,St,D;for(let H=Z;H<=ht;H++){if(H<E){const ot=H<x?0:(x-H)/(x-E);vt=A-(A-S)*ot,At=C-(C-O)*ot,z=k-(k-P)*ot,V=L-(L-q)*ot}else{let ot;H>R?ot=1:E===R?ot=0:ot=(E-H)/(E-R),vt=S-(S-w)*ot,At=O-(O-K)*ot,z=P-(P-J)*ot,V=q-(q-Q)*ot}let $;H<x?$=0:H>R?$=1:$=(x-H)/(x-R),W=A-(A-w)*$,dt=C-(C-K)*$,St=k-(k-J)*$,D=L-(L-Q)*$;const tt=Math.round(Math.min(vt,W)),lt=Math.round(Math.max(vt,W));let ut=b*H+tt*4;for(let ot=tt;ot<=lt;ot++)$=(vt-ot)/(vt-W),$<0?$=0:$>1&&($=1),m[ut++]=At-(At-dt)*$|0,m[ut++]=z-(z-St)*$|0,m[ut++]=V-(V-D)*$|0,m[ut++]=255}}function Zv(p,t,i){const s=t.coords,r=t.colors;let l,c;switch(t.type){case Yu.LATTICE:const u=t.verticesPerRow,h=Math.floor(s.length/u)-1,f=u-1;for(l=0;l<h;l++){let m=l*u;for(let b=0;b<f;b++,m++)Pu(p,i,s[m],s[m+1],s[m+u],r[m],r[m+1],r[m+u]),Pu(p,i,s[m+u+1],s[m+1],s[m+u],r[m+u+1],r[m+1],r[m+u])}break;case Yu.TRIANGLES:for(l=0,c=s.length;l<c;l+=3)Pu(p,i,s[l],s[l+1],s[l+2],r[l],r[l+1],r[l+2]);break;default:throw new Error("illegal figure")}}class Jv extends dh{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,m=Math.ceil(this._bounds[3])-h,b=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(m*t[1]*1.1)),3e3),A=f/b,x=m/y,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/A,scaleY:1/x},E=b+4,w=y+4,R=s.getCanvas("mesh",E,w),C=R.context,k=C.createImageData(b,y);if(i){const O=k.data;for(let P=0,q=O.length;P<q;P+=4)O[P]=i[0],O[P+1]=i[1],O[P+2]=i[2],O[P+3]=255}for(const O of this._figures)Zv(k,O,S);return C.putImageData(k,2,2),{canvas:R.canvas,offsetX:u-2*A,offsetY:h-2*x,scaleX:A,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(t,i,s,r){th(t,this._bbox);const l=new Float32Array(2);if(r===xe.SHADING)nt.singularValueDecompose2dScale($t(t),l);else if(this.matrix){nt.singularValueDecompose2dScale(this.matrix,l);const[u,h]=l;nt.singularValueDecompose2dScale(i.baseTransform,l),l[0]*=u,l[1]*=h}else nt.singularValueDecompose2dScale(i.baseTransform,l);const c=this._createMeshCanvas(l,r===xe.SHADING?null:this._background,i.cachedCanvases);return r!==xe.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class tA extends dh{getPattern(){return"hotpink"}}function eA(p){switch(p[0]){case"RadialAxial":return new Qv(p);case"Mesh":return new Jv(p);case"Dummy":return new tA}throw new Error(`Unknown IR type: ${p[0]}`)}const tm={COLORED:1,UNCOLORED:2};class fh{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(t,i){const{bbox:s,operatorList:r,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:m}=this;f=Math.abs(f),m=Math.abs(m),io("TilingType: "+c);const b=s[0],y=s[1],A=s[2],x=s[3],S=A-b,E=x-y,w=new Float32Array(2);nt.singularValueDecompose2dScale(this.matrix,w);const[R,C]=w;nt.singularValueDecompose2dScale(this.baseTransform,w);const k=R*w[0],L=C*w[1];let O=S,P=E,q=!1,K=!1;const J=Math.ceil(f*k),Q=Math.ceil(m*L),Z=Math.ceil(S*k),ht=Math.ceil(E*L);J>=Z?O=f:q=!0,Q>=ht?P=m:K=!0;const vt=this.getSizeAndScale(O,this.ctx.canvas.width,k),At=this.getSizeAndScale(P,this.ctx.canvas.height,L),z=t.cachedCanvases.getCanvas("pattern",vt.size,At.size),V=z.context,W=h.createCanvasGraphics(V,i);if(W.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(W,l,u),V.translate(-vt.scale*b,-At.scale*y),W.transform(0,vt.scale,0,0,At.scale,0,0),V.save(),W.dependencyTracker?.save(),this.clipBbox(W,b,y,A,x),W.baseTransform=$t(W.ctx),W.executeOperatorList(r),W.endDrawing(),W.dependencyTracker?.restore(),V.restore(),q||K){const dt=z.canvas;q&&(O=f),K&&(P=m);const St=this.getSizeAndScale(O,this.ctx.canvas.width,k),D=this.getSizeAndScale(P,this.ctx.canvas.height,L),H=St.size,$=D.size,tt=t.cachedCanvases.getCanvas("pattern-workaround",H,$),lt=tt.context,ut=q?Math.floor(S/f):0,ot=K?Math.floor(E/m):0;for(let te=0;te<=ut;te++)for(let jt=0;jt<=ot;jt++)lt.drawImage(dt,H*te,$*jt,H,$,0,0,H,$);return{canvas:tt.canvas,scaleX:St.scale,scaleY:D.scale,offsetX:b,offsetY:y}}return{canvas:z.canvas,scaleX:vt.scale,scaleY:At.scale,offsetX:b,offsetY:y}}getSizeAndScale(t,i,s){const r=Math.max(fh.MAX_PATTERN_SIZE,i);let l=Math.ceil(t*s);return l>=r?l=r:s=l/t,{scale:s,size:l}}clipBbox(t,i,s,r,l){const c=r-i,u=l-s;t.ctx.rect(i,s,c,u),nt.axialAlignedBoundingBox([i,s,r,l],$t(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const r=t.ctx,l=t.current;switch(i){case tm.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;r.fillStyle=l.fillColor=c,r.strokeStyle=l.strokeColor=u;break;case tm.UNCOLORED:r.fillStyle=r.strokeStyle=s,l.fillColor=l.strokeColor=s;break;default:throw new pv(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,s,r,l){let c=s;r!==xe.SHADING&&(c=nt.transform(c,i.baseTransform),this.matrix&&(c=nt.transform(c,this.matrix)));const u=this.createPatternCanvas(i,l);let h=new DOMMatrix(c);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(h),f}}function iA({src:p,srcPos:t=0,dest:i,width:s,height:r,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=we.isLittleEndian?4278190080:255,[h,f]=c?[l,u]:[u,l],m=s>>3,b=s&7,y=p.length;i=new Uint32Array(i.buffer);let A=0;for(let x=0;x<r;x++){for(const E=t+m;t<E;t++){const w=t<y?p[t]:255;i[A++]=w&128?f:h,i[A++]=w&64?f:h,i[A++]=w&32?f:h,i[A++]=w&16?f:h,i[A++]=w&8?f:h,i[A++]=w&4?f:h,i[A++]=w&2?f:h,i[A++]=w&1?f:h}if(b===0)continue;const S=t<y?p[t++]:255;for(let E=0;E<b;E++)i[A++]=S&1<<7-E?f:h}return{srcPos:t,destPos:A}}const em=16,im=100,nA=15,nm=10,Ue=16,Fu=new DOMMatrix,Qe=new Float32Array(2),$s=new Float32Array([1/0,1/0,-1/0,-1/0]);function sA(p,t){if(p._removeMirroring)throw new Error("Context is already forwarding operations.");p.__originalSave=p.save,p.__originalRestore=p.restore,p.__originalRotate=p.rotate,p.__originalScale=p.scale,p.__originalTranslate=p.translate,p.__originalTransform=p.transform,p.__originalSetTransform=p.setTransform,p.__originalResetTransform=p.resetTransform,p.__originalClip=p.clip,p.__originalMoveTo=p.moveTo,p.__originalLineTo=p.lineTo,p.__originalBezierCurveTo=p.bezierCurveTo,p.__originalRect=p.rect,p.__originalClosePath=p.closePath,p.__originalBeginPath=p.beginPath,p._removeMirroring=()=>{p.save=p.__originalSave,p.restore=p.__originalRestore,p.rotate=p.__originalRotate,p.scale=p.__originalScale,p.translate=p.__originalTranslate,p.transform=p.__originalTransform,p.setTransform=p.__originalSetTransform,p.resetTransform=p.__originalResetTransform,p.clip=p.__originalClip,p.moveTo=p.__originalMoveTo,p.lineTo=p.__originalLineTo,p.bezierCurveTo=p.__originalBezierCurveTo,p.rect=p.__originalRect,p.closePath=p.__originalClosePath,p.beginPath=p.__originalBeginPath,delete p._removeMirroring},p.save=function(){t.save(),this.__originalSave()},p.restore=function(){t.restore(),this.__originalRestore()},p.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},p.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},p.transform=function(i,s,r,l,c,u){t.transform(i,s,r,l,c,u),this.__originalTransform(i,s,r,l,c,u)},p.setTransform=function(i,s,r,l,c,u){t.setTransform(i,s,r,l,c,u),this.__originalSetTransform(i,s,r,l,c,u)},p.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},p.rotate=function(i){t.rotate(i),this.__originalRotate(i)},p.clip=function(i){t.clip(i),this.__originalClip(i)},p.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},p.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},p.bezierCurveTo=function(i,s,r,l,c,u){t.bezierCurveTo(i,s,r,l,c,u),this.__originalBezierCurveTo(i,s,r,l,c,u)},p.rect=function(i,s,r,l){t.rect(i,s,r,l),this.__originalRect(i,s,r,l)},p.closePath=function(){t.closePath(),this.__originalClosePath()},p.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class aA{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,i,s)):(r=this.canvasFactory.create(i,s),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function Gl(p,t,i,s,r,l,c,u,h,f){const[m,b,y,A,x,S]=$t(p);if(b===0&&y===0){const R=c*m+x,C=Math.round(R),k=u*A+S,L=Math.round(k),O=(c+h)*m+x,P=Math.abs(Math.round(O)-C)||1,q=(u+f)*A+S,K=Math.abs(Math.round(q)-L)||1;return p.setTransform(Math.sign(m),0,0,Math.sign(A),C,L),p.drawImage(t,i,s,r,l,0,0,P,K),p.setTransform(m,b,y,A,x,S),[P,K]}if(m===0&&A===0){const R=u*y+x,C=Math.round(R),k=c*b+S,L=Math.round(k),O=(u+f)*y+x,P=Math.abs(Math.round(O)-C)||1,q=(c+h)*b+S,K=Math.abs(Math.round(q)-L)||1;return p.setTransform(0,Math.sign(b),Math.sign(y),0,C,L),p.drawImage(t,i,s,r,l,0,0,K,P),p.setTransform(m,b,y,A,x,S),[K,P]}p.drawImage(t,i,s,r,l,c,u,h,f);const E=Math.hypot(m,b),w=Math.hypot(y,A);return[E*h,w*f]}class sm{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=qu;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Ae.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,s){s?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=$s.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=xe.FILL,i=null){const s=this.minMax.slice();if(t===xe.STROKE){i||Ht("Stroke bounding box must include transform."),nt.singularValueDecompose2dScale(i,Qe);const r=Qe[0]*this.lineWidth/2,l=Qe[1]*this.lineWidth/2;s[0]-=r,s[1]-=l,s[2]+=r,s[3]+=l}return s}updateClipFromPath(){const t=nt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set($s,0)}getClippedPathBoundingBox(t=xe.FILL,i=null){return nt.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function am(p,t){if(t instanceof ImageData){p.putImageData(t,0,0);return}const i=t.height,s=t.width,r=i%Ue,l=(i-r)/Ue,c=r===0?l:l+1,u=p.createImageData(s,Ue);let h=0,f;const m=t.data,b=u.data;let y,A,x,S;if(t.kind===Xl.GRAYSCALE_1BPP){const E=m.byteLength,w=new Uint32Array(b.buffer,0,b.byteLength>>2),R=w.length,C=s+7>>3,k=4294967295,L=we.isLittleEndian?4278190080:255;for(y=0;y<c;y++){for(x=y<l?Ue:r,f=0,A=0;A<x;A++){const O=E-h;let P=0;const q=O>C?s:O*8-7,K=q&-8;let J=0,Q=0;for(;P<K;P+=8)Q=m[h++],w[f++]=Q&128?k:L,w[f++]=Q&64?k:L,w[f++]=Q&32?k:L,w[f++]=Q&16?k:L,w[f++]=Q&8?k:L,w[f++]=Q&4?k:L,w[f++]=Q&2?k:L,w[f++]=Q&1?k:L;for(;P<q;P++)J===0&&(Q=m[h++],J=128),w[f++]=Q&J?k:L,J>>=1}for(;f<R;)w[f++]=0;p.putImageData(u,0,y*Ue)}}else if(t.kind===Xl.RGBA_32BPP){for(A=0,S=s*Ue*4,y=0;y<l;y++)b.set(m.subarray(h,h+S)),h+=S,p.putImageData(u,0,A),A+=Ue;y<c&&(S=s*r*4,b.set(m.subarray(h,h+S)),p.putImageData(u,0,A))}else if(t.kind===Xl.RGB_24BPP)for(x=Ue,S=s*x,y=0;y<c;y++){for(y>=l&&(x=r,S=s*x),f=0,A=S;A--;)b[f++]=m[h++],b[f++]=m[h++],b[f++]=m[h++],b[f++]=255;p.putImageData(u,0,y*Ue)}else throw new Error(`bad image kind: ${t.kind}`)}function rm(p,t){if(t.bitmap){p.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,r=i%Ue,l=(i-r)/Ue,c=r===0?l:l+1,u=p.createImageData(s,Ue);let h=0;const f=t.data,m=u.data;for(let b=0;b<c;b++){const y=b<l?Ue:r;({srcPos:h}=iA({src:f,srcPos:h,dest:m,width:s,height:y,nonBlackColor:0})),p.putImageData(u,0,b*Ue)}}function Ja(p,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)p[s]!==void 0&&(t[s]=p[s]);p.setLineDash!==void 0&&(t.setLineDash(p.getLineDash()),t.lineDashOffset=p.lineDashOffset)}function Vl(p){p.strokeStyle=p.fillStyle="#000000",p.fillRule="nonzero",p.globalAlpha=1,p.lineWidth=1,p.lineCap="butt",p.lineJoin="miter",p.miterLimit=10,p.globalCompositeOperation="source-over",p.font="10px sans-serif",p.setLineDash!==void 0&&(p.setLineDash([]),p.lineDashOffset=0);const{filter:t}=p;t!=="none"&&t!==""&&(p.filter="none")}function lm(p,t){if(t)return!0;nt.singularValueDecompose2dScale(p,Qe);const i=Math.fround(Ti.pixelRatio*ia.PDF_TO_CSS_UNITS);return Qe[0]<=i&&Qe[1]<=i}const rA=["butt","round","square"],lA=["miter","round","bevel"],oA={},om={};class Js{constructor(t,i,s,r,l,{optionalContentConfig:c,markedContentStack:u=null},h,f,m){this.ctx=t,this.current=new sm(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=r,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new aA(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=m??null}getObject(t,i,s=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):s}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:r=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...$t(this.compositeCtx))}this.ctx.save(),Vl(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=$t(this.ctx)}executeOperatorList(t,i,s,r,l){const c=t.argsArray,u=t.fnArray;let h=i||0;const f=c.length;if(f===h)return h;const m=f-h>nm&&typeof s=="function",b=m?Date.now()+nA:0;let y=0;const A=this.commonObjs,x=this.objs;let S,E;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,s),h;if(!l||l(h))if(S=u[h],E=c[h]??null,S!==cr.dependency)E===null?this[S](h):this[S](h,...E);else for(const w of E){this.dependencyTracker?.recordNamedData(w,h);const R=w.startsWith("g_")?A:x;if(!R.has(w))return R.get(w,s),h}if(h++,h===f)return h;if(m&&++y>nm){if(Date.now()>b)return s(),h;y=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const s=t.width??t.displayWidth,r=t.height??t.displayHeight;let l=Math.max(Math.hypot(i[0],i[1]),1),c=Math.max(Math.hypot(i[2],i[3]),1),u=s,h=r,f="prescale1",m,b;for(;l>2&&u>1||c>2&&h>1;){let y=u,A=h;l>2&&u>1&&(y=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/y),c>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/A),m=this.cachedCanvases.getCanvas(f,y,A),b=m.context,b.clearRect(0,0,y,A),b.drawImage(t,0,0,u,h,0,0,y,A),t=m.canvas,u=y,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,i){const s=this.ctx,{width:r,height:l}=i,c=this.current.fillColor,u=this.current.patternFill,h=$t(s);let f,m,b,y;if((i.bitmap||i.data)&&i.count>1){const J=i.bitmap||i.data.buffer;m=JSON.stringify(u?h:[h.slice(0,4),c]),f=this._cachedBitmapsMap.get(J),f||(f=new Map,this._cachedBitmapsMap.set(J,f));const Q=f.get(m);if(Q&&!u){const Z=Math.round(Math.min(h[0],h[2])+h[4]),ht=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,ci.transformAndFill),{canvas:Q,offsetX:Z,offsetY:ht}}b=Q}b||(y=this.cachedCanvases.getCanvas("maskCanvas",r,l),rm(y.context,i));let A=nt.transform(h,[1/r,0,0,-1/l,0,0]);A=nt.transform(A,[1,0,0,1,0,-l]);const x=$s.slice();nt.axialAlignedBoundingBox([0,0,r,l],A,x);const[S,E,w,R]=x,C=Math.round(w-S)||1,k=Math.round(R-E)||1,L=this.cachedCanvases.getCanvas("fillCanvas",C,k),O=L.context,P=S,q=E;O.translate(-P,-q),O.transform(...A),b||(b=this._scaleImage(y.canvas,xi(O)),b=b.img,f&&u&&f.set(m,b)),O.imageSmoothingEnabled=lm($t(O),i.interpolate),Gl(O,b,0,0,b.width,b.height,0,0,r,l),O.globalCompositeOperation="source-in";const K=nt.transform(xi(O),[1,0,0,1,-P,-q]);return O.fillStyle=u?c.getPattern(s,this,K,xe.FILL,t):c,O.fillRect(0,0,r,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(m,L.canvas)),this.dependencyTracker?.recordDependencies(t,ci.transformAndFill),{canvas:L.canvas,offsetX:Math.round(P),offsetY:Math.round(q)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=rA[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=lA[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,s){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(i),r.lineDashOffset=s)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[s,r]of i)switch(s){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,s=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(r,i,s);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),Ja(this.suspendedCtx,c),sA(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ja(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,r){const l=r[0],c=r[1],u=r[2]-l,h=r[3]-c;u===0||h===0||(this.genericComposeSMask(i.context,s,u,h,i.subtype,i.backdrop,i.transferMap,l,c,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,r,l,c,u,h,f,m,b){let y=t.canvas,A=h-m,x=f-b;if(c)if(A<0||x<0||A+s>y.width||x+r>y.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,r),w=E.context;w.drawImage(y,-A,-x),w.globalCompositeOperation="destination-atop",w.fillStyle=c,w.fillRect(0,0,s,r),w.globalCompositeOperation="source-over",y=E.canvas,A=x=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(A,x,s,r),t.clip(E),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(A,x,s,r),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(h,f,s,r),i.clip(S),i.globalCompositeOperation="destination-in",i.drawImage(y,A,x,s,r,h,f,s,r),i.restore()}save(t){this.inSMaskMode&&Ja(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Ja(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,s,r,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,s,r,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s,r){let[l]=s;if(!r){l||=s[0]=new Path2D,this[i](t,l);return}if(this.dependencyTracker!==null){const c=i===cr.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-c,r[2]+c,r[1]-c,r[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=s[0]=Rm(l)),nt.axialAlignedBoundingBox(r,$t(this.ctx),this.current.minMax),this[i](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,s=!0){const r=this.ctx,l=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=l.getPattern(r,this,xi(r),xe.STROKE,t),c){const u=new Path2D;u.addPath(i,r.getTransform().invertSelf().multiplySelf(c)),i=u}this.rescaleAndStroke(i,!1),r.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,ci.stroke),s&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(xe.STROKE,$t(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,s=!0){const r=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=l.getPattern(r,this,xi(r),xe.FILL,t),f){const m=new Path2D;m.addPath(i,r.getTransform().invertSelf().multiplySelf(f)),i=m}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(i,"evenodd"),this.pendingEOFill=!1):r.fill(i)),this.dependencyTracker?.recordDependencies(t,ci.fill),u&&(r.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,i,h)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,ci.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=oA}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=om}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;i!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(i!==void 0){const r=new Path2D,l=s.getTransform().invertSelf();for(const{transform:c,x:u,y:h,fontSize:f,path:m}of i)m&&r.addPath(m,new DOMMatrix(c).preMultiplySelf(l).translate(u,h).scale(f,-f));s.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const r=this.commonObjs.get(i),l=this.current;if(!r)throw new Error(`Can't find font for ${i}`);if(l.fontMatrix=r.fontMatrix||qu,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&pt("Invalid font matrix for font "+i),s<0?(s=-s,l.fontDirection=-1):l.fontDirection=1,this.current.font=r,this.current.fontSize=s,r.isType3Font)return;const c=r.loadedName||"sans-serif",u=r.systemFontInfo?.css||`"${c}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let m=s;s<em?m=em:s>im&&(m=im),this.current.fontSizeScale=s/m,this.ctx.font=`${f} ${h} ${m}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,i,s){this.setLeading(t,-s),this.moveText(t,i,s)}setTextMatrix(t,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=i,s.textMatrixScale=Math.hypot(i[0],i[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,i,s){const r=new Path2D;return r.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(i)),r}paintChar(t,i,s,r,l,c){const u=this.ctx,h=this.current,f=h.font,m=h.textRenderingMode,b=h.fontSize/h.fontSizeScale,y=m&Ae.FILL_STROKE_MASK,A=!!(m&Ae.ADD_TO_PATH_FLAG),x=h.patternFill&&!f.missingFile,S=h.patternStroke&&!f.missingFile;let E;if((f.disableFontFace||A||x||S)&&!f.missingFile&&(E=f.getPathGenerator(this.commonObjs,i)),E&&(f.disableFontFace||x||S)){u.save(),u.translate(s,r),u.scale(b,-b),this.dependencyTracker?.recordCharacterBBox(t,u,f);let w;if(y===Ae.FILL||y===Ae.FILL_STROKE)if(l){w=u.getTransform(),u.setTransform(...l);const R=this.#n(E,w,l);u.fill(R)}else u.fill(E);if(y===Ae.STROKE||y===Ae.FILL_STROKE)if(c){w||=u.getTransform(),u.setTransform(...c);const{a:R,b:C,c:k,d:L}=w,O=nt.inverseTransform(c),P=nt.transform([R,C,k,L,0,0],O);nt.singularValueDecompose2dScale(P,Qe),u.lineWidth*=Math.max(Qe[0],Qe[1])/b,u.stroke(this.#n(E,w,c))}else u.lineWidth/=b,u.stroke(E);u.restore()}else(y===Ae.FILL||y===Ae.FILL_STROKE)&&(u.fillText(i,s,r),this.dependencyTracker?.recordCharacterBBox(t,u,f,b,s,r,()=>u.measureText(i))),(y===Ae.STROKE||y===Ae.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,b,s,r,()=>u.measureText(i)).recordDependencies(t,ci.stroke),u.strokeText(i,s,r));A&&((this.pendingTextPaths||=[]).push({transform:$t(u),x:s,y:r,fontSize:b,path:E}),this.dependencyTracker?.recordCharacterBBox(t,u,f,b,s,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<i.length;r+=4)if(i[r]>0&&i[r]<255){s=!0;break}return gt(this,"isFontSubpixelAAEnabled",s)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,ci.showText).resetBBox(t),this.current.textRenderingMode&Ae.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,r=s.font;if(r.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const l=s.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=s.fontSizeScale,h=s.charSpacing,f=s.wordSpacing,m=s.fontDirection,b=s.textHScale*m,y=i.length,A=r.vertical,x=A?1:-1,S=r.defaultVMetrics,E=l*s.fontMatrix[0],w=s.textRenderingMode===Ae.FILL&&!r.disableFontFace&&!s.patternFill;c.save(),s.textMatrix&&c.transform(...s.textMatrix),c.translate(s.x,s.y+s.textRise),m>0?c.scale(b,-1):c.scale(b,1);let R,C;if(s.patternFill){c.save();const q=s.fillColor.getPattern(c,this,xi(c),xe.FILL,t);R=$t(c),c.restore(),c.fillStyle=q}if(s.patternStroke){c.save();const q=s.strokeColor.getPattern(c,this,xi(c),xe.STROKE,t);C=$t(c),c.restore(),c.strokeStyle=q}let k=s.lineWidth;const L=s.textMatrixScale;if(L===0||k===0){const q=s.textRenderingMode&Ae.FILL_STROKE_MASK;(q===Ae.STROKE||q===Ae.FILL_STROKE)&&(k=this.getSinglePixelWidth())}else k/=L;if(u!==1&&(c.scale(u,u),k/=u),c.lineWidth=k,r.isInvalidPDFjsFont){const q=[];let K=0;for(const Q of i)q.push(Q.unicode),K+=Q.width;const J=q.join("");if(c.fillText(J,0,0),this.dependencyTracker!==null){const Q=c.measureText(J);this.dependencyTracker.recordBBox(t,this.ctx,-Q.actualBoundingBoxLeft,Q.actualBoundingBoxRight,-Q.actualBoundingBoxAscent,Q.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=K*E*b,c.restore(),this.compose();return}let O=0,P;for(P=0;P<y;++P){const q=i[P];if(typeof q=="number"){O+=x*q*l/1e3;continue}let K=!1;const J=(q.isSpace?f:0)+h,Q=q.fontChar,Z=q.accent;let ht,vt,At=q.width;if(A){const W=q.vmetric||S,dt=-(q.vmetric?W[1]:At*.5)*E,St=W[2]*E;At=W?-W[0]:At,ht=dt/u,vt=(O+St)/u}else ht=O/u,vt=0;let z;if(r.remeasure&&At>0){z=c.measureText(Q);const W=z.width*1e3/l*u;if(At<W&&this.isFontSubpixelAAEnabled){const dt=At/W;K=!0,c.save(),c.scale(dt,1),ht/=dt}else At!==W&&(ht+=(At-W)/2e3*l/u)}if(this.contentVisible&&(q.isInFont||r.missingFile)){if(w&&!Z)c.fillText(Q,ht,vt),this.dependencyTracker?.recordCharacterBBox(t,c,z?{bbox:null}:r,l/u,ht,vt,()=>z??c.measureText(Q));else if(this.paintChar(t,Q,ht,vt,R,C),Z){const W=ht+l*Z.offset.x/u,dt=vt-l*Z.offset.y/u;this.paintChar(t,Z.fontChar,W,dt,R,C)}}const V=A?At*E-J*m:At*E+J*m;O+=V,K&&c.restore()}A?s.y-=O:s.x+=O*b,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const s=this.ctx,r=this.current,l=r.font,c=r.fontSize,u=r.fontDirection,h=l.vertical?1:-1,f=r.charSpacing,m=r.wordSpacing,b=r.textHScale*u,y=r.fontMatrix||qu,A=i.length,x=r.textRenderingMode===Ae.INVISIBLE;let S,E,w,R;if(x||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),r.textMatrix&&s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),s.scale(b,u);const C=this.dependencyTracker;for(this.dependencyTracker=C?new Ql(C,t):null,S=0;S<A;++S){if(E=i[S],typeof E=="number"){R=h*E*c/1e3,this.ctx.translate(R,0),r.x+=R*b;continue}const k=(E.isSpace?m:0)+f,L=l.charProcOperatorList[E.operatorListId];L?this.contentVisible&&(this.save(),s.scale(c,c),s.transform(...y),this.executeOperatorList(L),this.restore()):pt(`Type3 character "${E.operatorListId}" is not available.`);const O=[E.width,0];nt.applyTransform(O,y),w=O[0]*c+k,s.translate(w,0),r.x+=w*b}s.restore(),C&&(this.dependencyTracker=C)}setCharWidth(t,i,s){}setCharWidthAndBounds(t,i,s,r,l,c,u){const h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,r,c,l,u).recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}getColorN_Pattern(t,i){let s;if(i[0]==="TilingPattern"){const r=this.baseTransform||$t(this.ctx),l={createCanvasGraphics:(c,u)=>new Js(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Ql(this.dependencyTracker,u,!0):null)};s=new fh(i,this.ctx,l,r)}else s=this._getPattern(t,i[1],i[2]);return s}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,s=null){let r;return this.cachedPatterns.has(i)?r=this.cachedPatterns.get(i):(r=eA(this.getObject(t,i)),this.cachedPatterns.set(i,r)),s&&(r.matrix=s),r}shadingFill(t,i){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const r=this._getPattern(t,i);s.fillStyle=r.getPattern(s,this,xi(s),xe.SHADING,t);const l=xi(s);if(l){const{width:c,height:u}=s.canvas,h=$s.slice();nt.axialAlignedBoundingBox([0,0,c,u],l,h);const[f,m,b,y]=h;this.ctx.fillRect(f,m,b-f,y-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,ci.transform).recordDependencies(t,ci.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Ht("Should not call beginInlineImage")}beginImageData(){Ht("Should not call beginImageData")}paintFormXObjectBegin(t,i,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=$t(this.ctx),s)){nt.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,l,c,u]=s,h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;i.isolated||io("TODO: Support non-isolated groups."),i.knockout&&pt("Knockout groups not supported.");const r=$t(s);if(i.matrix&&s.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let l=$s.slice();nt.axialAlignedBoundingBox(i.bbox,$t(s),l);const c=[0,0,s.canvas.width,s.canvas.height];l=nt.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),h=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),m=Math.max(Math.ceil(l[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,m]);let b="groupAt"+this.groupLevel;i.smask&&(b+="_smask_"+this.smaskCounter++%2);const y=this.cachedCanvases.getCanvas(b,f,m),A=y.context;A.translate(-u,-h),A.transform(...r);let x=new Path2D;const[S,E,w,R]=i.bbox;if(x.rect(S,E,w-S,R-E),i.matrix){const C=new Path2D;C.addPath(x,new DOMMatrix(i.matrix)),x=C}A.clip(x),i.smask&&this.smaskStack.push({canvas:y.canvas,context:A,offsetX:u,offsetY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,h),s.save()),Ja(s,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=$t(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=$s.slice();nt.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],l,c),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,i,s,r,l,c){if(this.#t(),Vl(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],h=s[3]-s[1];if(c&&this.annotationCanvasMap){r=r.slice(),r[4]-=s[0],r[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=h,nt.singularValueDecompose2dScale($t(this.ctx),Qe);const{viewportScale:f}=this,m=Math.ceil(u*this.outputScaleX*f),b=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(m,b);const{canvas:y,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(i,y),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(Qe[0],0,0,-Qe[1],0,h*Qe[1]),Vl(this.ctx)}else{Vl(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,h),this.ctx.clip(f)}}this.current=new sm(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const s=i.count;i=this.getObject(t,i.data,i),i.count=s;const r=this.ctx,l=this._createMaskCanvas(t,i),c=l.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s,r=0,l=0,c,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const h=this.ctx;h.save();const f=$t(h);h.transform(s,r,l,c,0,0);const m=this._createMaskCanvas(t,i);h.setTransform(1,0,0,1,m.offsetX-f[4],m.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let b=0,y=u.length;b<y;b+=2){const A=nt.transform(f,[s,r,l,c,u[b],u[b+1]]);h.drawImage(m.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+m.canvas.width,A[5],A[5]+m.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,ci.transformAndFill);for(const c of i){const{data:u,width:h,height:f,transform:m}=c,b=this.cachedCanvases.getCanvas("maskCanvas",h,f),y=b.context;y.save();const A=this.getObject(t,u,c);rm(y,A),y.globalCompositeOperation="source-in",y.fillStyle=l?r.getPattern(y,this,xi(s),xe.FILL,t):r,y.fillRect(0,0,h,f),y.restore(),s.save(),s.transform(...m),s.scale(1,-1),Gl(s,b.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,h,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const s=this.getObject(t,i);if(!s){pt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,i,s,r,l){if(!this.contentVisible)return;const c=this.getObject(t,i);if(!c){pt("Dependent image isn't ready yet");return}const u=c.width,h=c.height,f=[];for(let m=0,b=l.length;m<b;m+=2)f.push({transform:[s,0,0,r,l[m],l[m+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:r}=t,l=this.cachedCanvases.getCanvas("inlineImage",s,r),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(i,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const s=i.width,r=i.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/s,-1/r);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const m=this.cachedCanvases.getCanvas("inlineImage",s,r).context;am(m,i),u=this.applyTransferMapsToCanvas(m)}const h=this._scaleImage(u,xi(l));l.imageSmoothingEnabled=lm($t(l),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,s,-r,0).recordDependencies(t,ci.imageXObject).recordOperation(t),Gl(l,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,s,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,s){if(!this.contentVisible)return;const r=this.ctx;let l;if(i.bitmap)l=i.bitmap;else{const c=i.width,u=i.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;am(f,i),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of s)r.save(),r.transform(...c.transform),r.scale(1,-1),Gl(r,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,ci.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,s){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,s){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,s){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const l=this.ctx;this.pendingClip?(r||(this.pendingClip===om?l.clip(i,"evenodd"):l.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=$t(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:r,d:l}=this.ctx.getTransform();let c,u;if(s===0&&r===0){const h=Math.abs(i),f=Math.abs(l);if(h===f)if(t===0)c=u=1/h;else{const m=h*t;c=u=m<1?1/m:1}else if(t===0)c=1/h,u=1/f;else{const m=h*t,b=f*t;c=m<1?1/m:1,u=b<1?1/b:1}}else{const h=Math.abs(i*l-s*r),f=Math.hypot(i,s),m=Math.hypot(r,l);if(t===0)c=m/h,u=f/h;else{const b=t*h;c=m>b?m/b:1,u=f>b?f/b:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:s,current:{lineWidth:r}}=this,[l,c]=this.getScaleForStroking();if(l===c){s.lineWidth=(r||1)*l,s.stroke(t);return}const u=s.getLineDash();i&&s.save(),s.scale(l,c),Fu.a=1/l,Fu.d=1/c;const h=new Path2D;if(h.addPath(t,Fu),u.length>0){const f=Math.max(l,c);s.setLineDash(u.map(m=>m/f)),s.lineDashOffset/=f}s.lineWidth=r||1,s.stroke(h),i&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const p in cr)Js.prototype[p]!==void 0&&(Js.prototype[cr[p]]=Js.prototype[p]);class ta{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class cA{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const qs=Symbol("INTERNAL");class uA{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:i,intent:s,usage:r,rbGroups:l}){this.#t=!!(t&We.DISPLAY),this.#e=!!(t&We.PRINT),this.name=i,this.intent=s,this.usage=r,this.rbGroups=l}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,s=!1){t!==qs&&Ht("Internal method `_setVisible` called."),this.#n=s,this.#i=i}}class hA{#t=null;#e=new Map;#n=null;#i=null;constructor(t,i=We.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new uA(i,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(qs,!1);for(const s of t.on)this.#e.get(s)._setVisible(qs,!0);for(const s of t.off)this.#e.get(s)._setVisible(qs,!1);this.#n=this.getHash()}}#r(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let r=1;r<i;r++){const l=t[r];let c;if(Array.isArray(l))c=this.#r(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return pt(`Optional content group not found: ${l}`),!0;switch(s){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return io("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(pt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return pt(`Unknown optional content policy ${t.policy}.`),!0}return pt(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){const r=this.#e.get(t);if(!r){pt(`Optional content group not found: ${t}`);return}if(s&&i&&r.rbGroups.length)for(const l of r.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(qs,!1,!0);r._setVisible(qs,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let s;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const l=this.#e.get(r);if(l)switch(s){case"ON":this.setVisibility(r,!0,i);break;case"OFF":this.setVisibility(r,!1,i);break;case"Toggle":this.setVisibility(r,!l.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Nm;for(const[i,s]of this.#e)t.update(`${i}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class dA{constructor(t,{disableRange:i=!1,disableStream:s=!1}){Mt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:l,progressiveDone:c,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,l?.length>0){const h=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!i,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const s=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(s),!0)});Mt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){Mt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new fA(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new pA(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class fA{constructor(t,i,s=!1,r=null){this._stream=t,this._done=s||!1,this._filename=lh(r)?r:null,this._queuedChunks=i||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class pA{constructor(t,i,s){this._stream=t,this._begin=i,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function gA(p){let t=!0,i=s("filename\\*","i").exec(p);if(i){i=i[1];let m=u(i);return m=unescape(m),m=h(m),m=f(m),l(m)}if(i=c(p),i){const m=f(i);return l(m)}if(i=s("filename","i").exec(p),i){i=i[1];let m=u(i);return m=f(m),l(m)}function s(m,b){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function r(m,b){if(m){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const y=new TextDecoder(m,{fatal:!0}),A=pr(b);b=y.decode(A),t=!1}catch{}}return b}function l(m){return t&&/[\x80-\xff]/.test(m)&&(m=r("utf-8",m),t&&(m=r("iso-8859-1",m))),m}function c(m){const b=[];let y;const A=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=A.exec(m))!==null;){let[,S,E,w]=y;if(S=parseInt(S,10),S in b){if(S===0)break;continue}b[S]=[E,w]}const x=[];for(let S=0;S<b.length&&S in b;++S){let[E,w]=b[S];w=u(w),E&&(w=unescape(w),S===0&&(w=h(w))),x.push(w)}return x.join("")}function u(m){if(m.startsWith('"')){const b=m.slice(1).split('\\"');for(let y=0;y<b.length;++y){const A=b[y].indexOf('"');A!==-1&&(b[y]=b[y].slice(0,A),b.length=y+1),b[y]=b[y].replaceAll(/\\(.)/g,"$1")}m=b.join('"')}return m}function h(m){const b=m.indexOf("'");if(b===-1)return m;const y=m.slice(0,b),x=m.slice(b+1).replace(/^[^']*'/,"");return r(y,x)}function f(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,y,A,x){if(A==="q"||A==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,E){return String.fromCharCode(parseInt(E,16))}),r(y,x);try{x=atob(x)}catch{}return r(y,x)})}return""}function Fm(p,t){const i=new Headers;if(!p||!t||typeof t!="object")return i;for(const s in t){const r=t[s];r!==void 0&&i.append(s,r)}return i}function ao(p){return URL.parse(p)?.origin??null}function Um({responseHeaders:p,isHttp:t,rangeChunkSize:i,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(p.get("Content-Length"),10);return!Number.isInteger(l)||(r.suggestedLength=l,l<=2*i)||s||!t||p.get("Accept-Ranges")!=="bytes"||(p.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function jm(p){const t=p.get("Content-Disposition");if(t){let i=gA(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(lh(i))return i}return null}function vr(p,t){return new Wl(`Unexpected server response (${p}) while retrieving PDF "${t}".`,p,p===404||p===0&&t.startsWith("file:"))}function Im(p){return p===200||p===206}function Hm(p,t,i){return{method:"GET",headers:p,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Gm(p){return p instanceof Uint8Array?p.buffer:p instanceof ArrayBuffer?p:(pt(`getArrayBuffer - unexpected data format: ${p}`),new Uint8Array(p).buffer)}class mA{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Fm(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Mt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new bA(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new yA(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class bA{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const s=new Headers(t.headers),r=i.url;fetch(r,Hm(s,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=ao(l.url),!Im(l.status))throw vr(l.status,r);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:u,suggestedLength:h}=Um({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=jm(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Cn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Gm(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class yA{constructor(t,i,s){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${i}-${s-1}`);const c=r.url;fetch(c,Hm(l,this._withCredentials,this._abortController)).then(u=>{const h=ao(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!Im(u.status))throw vr(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Gm(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Uu=200,ju=206;function vA(p){const t=p.response;return typeof t!="string"?t:pr(t).buffer}class AA{_responseOrigin=null;constructor({url:t,httpHeaders:i,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Fm(this.isHttp,i),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const i=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[l,c]of this.headers)i.setRequestHeader(l,c);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=ju):r.expectedStatus=Uu,i.responseType="arraybuffer",Mt(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>{t.onError(i.status)},i.onreadystatechange=this.onStateChange.bind(this,s),i.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,i.send(null),s}onProgress(t,i){const s=this.pendingRequests[t];s&&s.onProgress?.(i)}onStateChange(t,i){const s=this.pendingRequests[t];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){s.onError(r.status);return}const l=r.status||Uu;if(!(l===Uu&&s.expectedStatus===ju)&&l!==s.expectedStatus){s.onError(r.status);return}const u=vA(r);if(l===ju){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?s.onDone({begin:parseInt(f[1],10),chunk:u}):(pt('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class SA{constructor(t){this._source=t,this._manager=new AA(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return Mt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new xA(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const s=new wA(this._manager,t,i);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class xA{constructor(t,i){this._manager=t,this._url=i.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t);this._manager._responseOrigin=ao(i.responseURL);const s=i.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=Um({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=jm(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=vr(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class wA{constructor(t,i,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:i,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=ao(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=vr(t,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const _A=/^[a-z][a-z0-9\-+.]+:/i;function EA(p){if(_A.test(p))return new URL(p);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(p))}class TA{constructor(t){this.source=t,this.url=EA(t.url),Mt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Mt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new CA(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new MA(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class CA{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=vr(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Cn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class MA{constructor(t,i,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:i,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const tr=Symbol("INITIAL_DATA");class Vm{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:tr}}get(t,i=null){if(i){const r=this.#e(t);return r.promise.then(()=>i(r.data)),null}const s=this.#t[t];if(!s||s.data===tr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=this.#t[t];return!!i&&i.data!==tr}delete(t){const i=this.#t[t];return!i||i.data===tr?!1:(delete this.#t[t],!0)}resolve(t,i=null){const s=this.#e(t);s.data=i,s.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==tr&&(yield[t,i])}}}const RA=1e5,cm=30;class Te{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#a=null;#s=0;#l=0;#c=null;#o=null;#d=0;#h=0;#f=Object.create(null);#m=[];#g=null;#u=[];#p=new WeakMap;#b=null;static#v=new Map;static#y=new Map;static#E=new WeakMap;static#w=null;static#S=new Set;constructor({textContentSource:t,container:i,viewport:s}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#o=i,this.#h=s.scale*Ti.pixelRatio,this.#d=s.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:l,pageX:c,pageY:u}=s.rawDims;this.#b=[1,0,0,-1,-c,u+l],this.#l=r,this.#s=l,Te.#R(),ts(i,s),this.#t.promise.finally(()=>{Te.#S.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=we.platform;return gt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:s})=>{if(s){this.#t.resolve();return}this.#r??=i.lang,Object.assign(this.#f,i.styles),this.#C(i.items),t()},this.#t.reject)};return this.#c=this.#g.getReader(),Te.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const s=t.scale*Ti.pixelRatio,r=t.rotation;if(r!==this.#d&&(i?.(),this.#d=r,ts(this.#o,{rotation:r})),s!==this.#h){i?.(),this.#h=s;const l={div:null,properties:null,ctx:Te.#D(this.#r)};for(const c of this.#u)l.properties=this.#p.get(c),l.div=c,this.#_(l)}}cancel(){const t=new Cn("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(t){if(this.#n)return;this.#a.ctx??=Te.#D(this.#r);const i=this.#u,s=this.#m;for(const r of t){if(i.length>RA){pt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),l.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(r.str),this.#A(r)}}#A(t){const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const r=nt.transform(this.#b,t.transform);let l=Math.atan2(r[1],r[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#i&&c.fontSubstitution||c.fontFamily;u=Te.fontFamilyMap.get(u)||u;const h=Math.hypot(r[2],r[3]),f=h*Te.#P(u,c,this.#r);let m,b;l===0?(m=r[4],b=r[5]-f):(m=r[4]+f*Math.sin(l),b=r[5]-f*Math.cos(l));const y="calc(var(--total-scale-factor) *",A=i.style;this.#e===this.#o?(A.left=`${(100*m/this.#l).toFixed(2)}%`,A.top=`${(100*b/this.#s).toFixed(2)}%`):(A.left=`${y}${m.toFixed(2)}px)`,A.top=`${y}${b.toFixed(2)}px)`),A.fontSize=`${y}${(Te.#w*h).toFixed(2)}px)`,A.fontFamily=u,s.fontSize=h,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(s.angle=l*(180/Math.PI));let x=!1;if(t.str.length>1)x=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),E=Math.abs(t.transform[3]);S!==E&&Math.max(S,E)/Math.min(S,E)>1.5&&(x=!0)}if(x&&(s.canvasWidth=c.vertical?t.height:t.width),this.#p.set(i,s),this.#a.div=i,this.#a.properties=s,this.#_(this.#a),s.hasText&&this.#e.append(i),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#_(t){const{div:i,properties:s,ctx:r}=t,{style:l}=i;let c="";if(Te.#w>1&&(c=`scale(${1/Te.#w})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=l,{canvasWidth:h,fontSize:f}=s;Te.#M(r,f*this.#h,u);const{width:m}=r.measureText(i.textContent);m>0&&(c=`scaleX(${h*this.#h/m}) ${c}`)}s.angle!==0&&(c=`rotate(${s.angle}deg) ${c}`),c.length>0&&(l.transform=c)}static cleanup(){if(!(this.#S.size>0)){this.#v.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#D(t=null){let i=this.#y.get(t||="");if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,i),this.#E.set(i,{size:0,family:""})}return i}static#M(t,i,s){const r=this.#E.get(t);i===r.size&&s===r.family||(t.font=`${i}px ${s}`,r.size=i,r.family=s)}static#R(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#P(t,i,s){const r=this.#v.get(t);if(r)return r;const l=this.#D(s);l.canvas.width=l.canvas.height=cm,this.#M(l,cm,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,h=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+h):(we.platform.isFirefox&&pt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?f=i.ascent:i.descent&&(f=1+i.descent)),this.#v.set(t,f),f}}const DA=100;function qm(p={}){typeof p=="string"||p instanceof URL?p={url:p}:(p instanceof ArrayBuffer||ArrayBuffer.isView(p))&&(p={data:p});const t=new ph,{docId:i}=t,s=p.url?Pv(p.url):null,r=p.data?Fv(p.data):null,l=p.httpHeaders||null,c=p.withCredentials===!0,u=p.password??null,h=p.range instanceof Ym?p.range:null,f=Number.isInteger(p.rangeChunkSize)&&p.rangeChunkSize>0?p.rangeChunkSize:2**16;let m=p.worker instanceof hr?p.worker:null;const b=p.verbosity,y=typeof p.docBaseUrl=="string"&&!no(p.docBaseUrl)?p.docBaseUrl:null,A=Ul(p.cMapUrl),x=p.cMapPacked!==!1,S=p.CMapReaderFactory||(Ce?Yv:Kg),E=Ul(p.iccUrl),w=Ul(p.standardFontDataUrl),R=p.StandardFontDataFactory||(Ce?Xv:Wg),C=Ul(p.wasmUrl),k=p.WasmFactory||(Ce?$v:Qg),L=p.stopAtErrors!==!0,O=Number.isInteger(p.maxImageSize)&&p.maxImageSize>-1?p.maxImageSize:-1,P=p.isEvalSupported!==!1,q=typeof p.isOffscreenCanvasSupported=="boolean"?p.isOffscreenCanvasSupported:!Ce,K=typeof p.isImageDecoderSupported=="boolean"?p.isImageDecoderSupported:!Ce&&(we.platform.isFirefox||!globalThis.chrome),J=Number.isInteger(p.canvasMaxAreaInBytes)?p.canvasMaxAreaInBytes:-1,Q=typeof p.disableFontFace=="boolean"?p.disableFontFace:Ce,Z=p.fontExtraProperties===!0,ht=p.enableXfa===!0,vt=p.ownerDocument||globalThis.document,At=p.disableRange===!0,z=p.disableStream===!0,V=p.disableAutoFetch===!0,W=p.pdfBug===!0,dt=p.CanvasFactory||(Ce?qv:Hv),St=p.FilterFactory||(Ce?Vv:Gv),D=p.enableHWA===!0,H=p.useWasm!==!1,$=h?h.length:p.length??NaN,tt=typeof p.useSystemFonts=="boolean"?p.useSystemFonts:!Ce&&!Q,lt=typeof p.useWorkerFetch=="boolean"?p.useWorkerFetch:!!(S===Kg&&R===Wg&&k===Qg&&A&&w&&C&&sr(A,document.baseURI)&&sr(w,document.baseURI)&&sr(C,document.baseURI)),ut=null;hv(b);const ot={canvasFactory:new dt({ownerDocument:vt,enableHWA:D}),filterFactory:new St({docId:i,ownerDocument:vt}),cMapReaderFactory:lt?null:new S({baseUrl:A,isCompressed:x}),standardFontDataFactory:lt?null:new R({baseUrl:w}),wasmFactory:lt?null:new k({baseUrl:C})};m||(m=hr.create({verbosity:b,port:ta.workerPort}),t._worker=m);const te={docId:i,apiVersion:"5.4.449",data:r,password:u,disableAutoFetch:V,rangeChunkSize:f,length:$,docBaseUrl:y,enableXfa:ht,evaluatorOptions:{maxImageSize:O,disableFontFace:Q,ignoreErrors:L,isEvalSupported:P,isOffscreenCanvasSupported:q,isImageDecoderSupported:K,canvasMaxAreaInBytes:J,fontExtraProperties:Z,useSystemFonts:tt,useWasm:H,useWorkerFetch:lt,cMapUrl:A,iccUrl:E,standardFontDataUrl:w,wasmUrl:C}},jt={ownerDocument:vt,pdfBug:W,styleElement:ut,loadingParams:{disableAutoFetch:V,enableXfa:ht}};return m.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const Rn=m.messageHandler.sendWithPromise("GetDocRequest",te,r?[r.buffer]:null);let Ki;if(h)Ki=new dA(h,{disableRange:At,disableStream:z});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Dn=sr(s)?mA:Ce?TA:SA;Ki=new Dn({url:s,length:$,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:At,disableStream:z})}return Rn.then(Dn=>{if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const na=new ar(i,Dn,m.port),Ci=new OA(na,t,Ki,jt,ot,D);t._transport=Ci,na.send("Ready",null)})}).catch(t._capability.reject),t}class ph{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${ph.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Ym{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#r=[];constructor(t,i,s=!1,r=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const s of this.#r)s(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const s of this.#i)s(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#n)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){Ht("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class NA{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return gt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class LA{#t=!1;constructor(t,i,s,r=!1){this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=r?new Hg:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new Vm,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:l=!1}={}){return new mr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return gt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:s,intent:r="display",annotationMode:l=wn.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:m=null,printAnnotationStorage:b=null,isEditing:y=!1,recordOperations:A=!1,operationsFilter:x=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(r,l,b,y),{renderingIntent:E,cacheKey:w}=S;this.#t=!1,h||=this._transport.getOptionalContentConfig(E);let R=this._intentStates.get(w);R||(R=Object.create(null),this._intentStates.set(w,R)),R.streamReaderCancelTimeout&&(clearTimeout(R.streamReaderCancelTimeout),R.streamReaderCancelTimeout=null);const C=!!(E&We.PRINT);R.displayReadyCapability||(R.displayReadyCapability=Promise.withResolvers(),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const k=!!(this._pdfBug&&globalThis.StepperManager?.enabled),L=!this.recordedBBoxes&&(A||k),O=K=>{if(R.renderTasks.delete(P),L){const J=P.gfx?.dependencyTracker.take();J&&(P.stepper&&P.stepper.setOperatorBBoxes(J,P.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=J))}C&&(this.#t=!0),this.#e(),K?(P.capability.reject(K),this._abortOperatorList({intentState:R,reason:K instanceof Error?K:new Error(K)})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},P=new Ks({callback:O,params:{canvas:i,canvasContext:t,dependencyTracker:L?new Wv(i,R.operatorList.length,k):null,viewport:s,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:R.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:m,enableHWA:this._transport.enableHWA,operationsFilter:x});(R.renderTasks||=new Set).add(P);const q=P.task;return Promise.all([R.displayReadyCapability.promise,h]).then(([K,J])=>{if(this.destroyed){O();return}if(this._stats?.time("Rendering"),!(J.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");P.initializeGraphics({transparency:K,optionalContentConfig:J}),P.operatorListChanged()}).catch(O),q}getOperatorList({intent:t="display",annotationMode:i=wn.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const c=this._transport.getRenderingIntent(t,i,s,r,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>ur.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,r){function l(){c.read().then(function({value:h,done:f}){if(f){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),l()},r)}const c=i.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#e();return t&&i&&(this._stats&&=new Hg),i}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const s=this._intentStates.get(i);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let s=0,r=t.length;s<r;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:r}){const{map:l,transfer:c}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:l,modifiedIds:r},c).getReader(),f=this._intentStates.get(i);f.streamReader=h;const m=()=>{h.read().then(({value:b,done:y})=>{if(y){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(b,f),m())},b=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const y of f.renderTasks)y.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(b);else if(f.opListReadCapability)f.opListReadCapability.reject(b);else throw b}})};m()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof rh){let r=DA;i.extraDelay>0&&i.extraDelay<1e3&&(r+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},r);return}}if(t.streamReader.cancel(new Cn(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,l]of this._intentStates)if(l===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var En,gi,$i,Qn,Jl,Zn,Jn,Re,$l,Xm,$m,rr,ea,Kl;const Xt=class Xt{constructor({name:t=null,port:i=null,verbosity:s=dv()}={}){Ai(this,Re);Ai(this,En,Promise.withResolvers());Ai(this,gi,null);Ai(this,$i,null);Ai(this,Qn,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,i){if(Yt(Xt,Jn).has(i))throw new Error("Cannot use more than one PDFWorker per port.");Yt(Xt,Jn).set(i,this),Si(this,Re,Xm).call(this,i)}else Si(this,Re,$m).call(this)}get promise(){return Yt(this,En).promise}get port(){return Yt(this,$i)}get messageHandler(){return Yt(this,gi)}destroy(){this.destroyed=!0,Yt(this,Qn)?.terminate(),Pe(this,Qn,null),Yt(Xt,Jn).delete(Yt(this,$i)),Pe(this,$i,null),Yt(this,gi)?.destroy(),Pe(this,gi,null)}static create(t){const i=Yt(this,Jn).get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new Xt(t)}static get workerSrc(){if(ta.workerSrc)return ta.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return gt(this,"_setupFakeWorkerGlobal",(async()=>Yt(this,ea,Kl)?Yt(this,ea,Kl):(await import(this.workerSrc)).WorkerMessageHandler)())}};En=new WeakMap,gi=new WeakMap,$i=new WeakMap,Qn=new WeakMap,Jl=new WeakMap,Zn=new WeakMap,Jn=new WeakMap,Re=new WeakSet,$l=function(){Yt(this,En).resolve(),Yt(this,gi).send("configure",{verbosity:this.verbosity})},Xm=function(t){Pe(this,$i,t),Pe(this,gi,new ar("main","worker",t)),Yt(this,gi).on("ready",()=>{}),Si(this,Re,$l).call(this)},$m=function(){if(Yt(Xt,Zn)||Yt(Xt,ea,Kl)){Si(this,Re,rr).call(this);return}let{workerSrc:t}=Xt;try{Xt._isSameOrigin(window.location,t)||(t=Xt._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new ar("main","worker",i),r=()=>{l.abort(),s.destroy(),i.terminate(),this.destroyed?Yt(this,En).reject(new Error("Worker was destroyed")):Si(this,Re,rr).call(this)},l=new AbortController;i.addEventListener("error",()=>{Yt(this,Qn)||r()},{signal:l.signal}),s.on("test",u=>{if(l.abort(),this.destroyed||!u){r();return}Pe(this,gi,s),Pe(this,$i,i),Pe(this,Qn,i),Si(this,Re,$l).call(this)}),s.on("ready",u=>{if(l.abort(),this.destroyed){r();return}try{c()}catch{Si(this,Re,rr).call(this)}});const c=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};c();return}catch{io("The worker has been disabled.")}Si(this,Re,rr).call(this)},rr=function(){Yt(Xt,Zn)||(pt("Setting up fake worker."),Pe(Xt,Zn,!0)),Xt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Yt(this,En).reject(new Error("Worker was destroyed"));return}const i=new Iv;Pe(this,$i,i);const s=`fake${_g(Xt,Jl)._++}`,r=new ar(s+"_worker",s,i);t.setup(r,i),Pe(this,gi,new ar(s,s+"_worker",i)),Si(this,Re,$l).call(this)}).catch(t=>{Yt(this,En).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},ea=new WeakSet,Kl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ai(Xt,ea),Ai(Xt,Jl,0),Ai(Xt,Zn,!1),Ai(Xt,Jn,new WeakMap),Ce&&(Pe(Xt,Zn,!0),ta.workerSrc||="./pdf.worker.mjs"),Xt._isSameOrigin=(t,i)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const r=new URL(i,s);return s.origin===r.origin},Xt._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},Xt.fromPort=t=>{if(_v("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Xt.create(t)};let hr=Xt;class OA{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,i,s,r,l,c){this.messageHandler=t,this.loadingTask=i,this.commonObjs=new Vm,this.fontLoader=new Bv({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=c,this.setupMessageHandler()}#a(t,i=null){const s=this.#t.get(t);if(s)return s;const r=this.messageHandler.sendWithPromise(t,i);return this.#t.set(t,r),r}get annotationStorage(){return gt(this,"annotationStorage",new uh)}getRenderingIntent(t,i=wn.ENABLE,s=null,r=!1,l=!1){let c=We.DISPLAY,u=Qu;switch(t){case"any":c=We.ANY;break;case"display":break;case"print":c=We.PRINT;break;default:pt(`getRenderingIntent - invalid intent: ${t}`)}const h=c&We.PRINT&&s instanceof Lm?s:this.annotationStorage;switch(i){case wn.DISABLE:c+=We.ANNOTATIONS_DISABLE;break;case wn.ENABLE:break;case wn.ENABLE_FORMS:c+=We.ANNOTATIONS_FORMS;break;case wn.ENABLE_STORAGE:c+=We.ANNOTATIONS_STORAGE,u=h.serializable;break;default:pt(`getRenderingIntent - invalid annotationMode: ${i}`)}r&&(c+=We.IS_EDITING),l&&(c+=We.OPLIST);const{ids:f,hash:m}=h.modifiedIds,b=[c,u.hash,m];return{renderingIntent:c,cacheKey:b.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Te.cleanup(),this._networkStream?.cancelAllRequests(new Cn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,r)=>{Mt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},r.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){r.close();return}Mt(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{this._fullReader.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:l,contentLength:c}=this._fullReader;return(!r||!l)&&(this._lastProgress&&i.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{i.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(s,r)=>{Mt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(s.begin,s.end);if(!l){r.close();return}r.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){r.close();return}Mt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{r.error(c)})},r.onCancel=c=>{l.cancel(c),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new NA(s,this))}),t.on("DocException",s=>{i._capability.reject(Fe(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!i.onPassword)throw Fe(s);const r=l=>{l instanceof Error?this.#r.reject(l):this.#r.resolve({password:l})};i.onPassword(r,s.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),t.on("DataLoaded",s=>{i.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,r,l])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in l){const b=l.error;pt(`Error during font loading: ${b}`),this.commonObjs.resolve(s,b);break}const c=new Ut(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(b,y)=>globalThis.FontInspector.fontAdded(b,y):null,h=new zv(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:f}=l;Mt(f,"The imageRef must be defined.");for(const b of this.#e.values())for(const[,y]of b.objs)if(y?.ref===f)return y.dataLen?(this.commonObjs.resolve(s,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(s,l);break;case"Pattern":const m=new fe(l);this.commonObjs.resolve(s,m.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([s,r,l,c])=>{if(this.destroyed)return;const u=this.#e.get(r);if(!u.objs.has(s)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(s,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",s=>{this.destroyed||i.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&pt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=this.#n.get(i);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#i.set(l.refStr,t);const c=new LA(i,l,this,this._params.pdfBug);return this.#e.set(i,c),c});return this.#n.set(i,r),r}getPageIndex(t){return Zu(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#a("GetOptionalContentConfig").then(i=>new hA(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new cA(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:r[2]}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#e.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Te.cleanup()}}cachedPageNumber(t){if(!Zu(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(i)??null}}class kA{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this.#t;return t.form||t.canvas&&i?.size>0}}class Ks{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:s,commonObjs:r,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:m=!1,pdfBug:b=!1,pageColors:y=null,enableHWA:A=!1,operationsFilter:x=null}){this.callback=t,this.params=i,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=b,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new kA(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=A,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=x}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(Ks.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Ks.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:r,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Js(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:r,viewport:s,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Ks.#e.delete(this._canvas),t||=new rh(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Ks.#e.delete(this._canvas),this.callback())))}}const BA="5.4.449",zA="f44e5f0e6";class ui{#t=null;#e=null;#n;#i=null;#r=!1;#a=!1;#s=null;#l;#c=null;#o=null;static#d=null;static get _keyboardManager(){return gt(this,"_keyboardManager",new yr([[["Escape","mac+Escape"],ui.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ui.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ui.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ui.prototype._moveToPrevious],[["Home","mac+Home"],ui.prototype._moveToBeginning],[["End","mac+End"],ui.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#a=!1,this.#s=t):this.#a=!0,this.#o=t?._uiManager||i,this.#l=this.#o._eventBus,this.#n=t?.color?.toUpperCase()||this.#o?.highlightColors.values().next().value||"#FFFF98",ui.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const i=this.#o._signal;t.addEventListener("click",this.#g.bind(this),{signal:i}),t.addEventListener("keydown",this.#m.bind(this),{signal:i});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#o._signal;t.addEventListener("contextmenu",hi,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[s,r]of this.#o.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",r),l.title=s,l.setAttribute("data-l10n-id",ui.#d[s]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=r,l.ariaSelected=r===this.#n,l.addEventListener("click",this.#f.bind(this,r),{signal:i}),t.append(l)}return t.addEventListener("keydown",this.#m.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:Ct.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#p){this.#g(t);return}if(t.target===this.#t){this.#i.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#g(t);return}this.#i.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#g(t);return}this.#i.lastElementChild?.focus()}#m(t){ui._keyboardManager.exec(this,t)}#g(t){if(this.#p){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#o.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#o.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class dr{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,dr.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,color:s}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=s||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",dr.#i[t]),r.addEventListener("input",()=>{this.#n.updateParams(i,r.value)},{signal:this.#n._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function um(p){return Math.floor(Math.max(0,Math.min(1,p))*255).toString(16).padStart(2,"0")}function er(p){return Math.max(0,Math.min(255,255*p))}class hm{static CMYK_G([t,i,s,r]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=er(t),[t,t,t]}static G_HTML([t]){const i=um(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(er)}static RGB_HTML(t){return`#${t.map(um).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,s+r),1-Math.min(1,i+r)]}static CMYK_rgb([t,i,s,r]){return[er(1-Math.min(1,t+r)),er(1-Math.min(1,s+r)),er(1-Math.min(1,i+r))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const r=1-t,l=1-i,c=1-s,u=Math.min(r,l,c);return["CMYK",r,l,c,u]}}class PA{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${i}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${i}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ht("Abstract method `_createSVG` called.")}}class Zl extends PA{_createSVG(t){return document.createElementNS(Yi,t)}}const FA=9,es=new WeakSet,UA=new Date().getTimezoneOffset()*60*1e3;class Iu{static create(t){switch(t.data.annotationType){case ce.LINK:return new gh(t);case ce.TEXT:return new IA(t);case ce.WIDGET:switch(t.data.fieldType){case"Tx":return new HA(t);case"Btn":return t.data.radioButton?new Km(t):t.data.checkBox?new VA(t):new qA(t);case"Ch":return new YA(t);case"Sig":return new GA(t)}return new ns(t);case ce.POPUP:return new eh(t);case ce.FREETEXT:return new Wm(t);case ce.LINE:return new $A(t);case ce.SQUARE:return new KA(t);case ce.CIRCLE:return new WA(t);case ce.POLYLINE:return new Qm(t);case ce.CARET:return new ZA(t);case ce.INK:return new mh(t);case ce.POLYGON:return new QA(t);case ce.HIGHLIGHT:return new Zm(t);case ce.UNDERLINE:return new JA(t);case ce.SQUIGGLY:return new t1(t);case ce.STRIKEOUT:return new e1(t);case ce.STAMP:return new Jm(t);case ce.FILEATTACHMENT:return new i1(t);default:return new Kt(t)}}}class Kt{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,i&&(this.contentElement=this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Kt._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:s,rect:r}=this.data;let l=-1/0,c=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>c?(c=i[u+1],l=i[u+2]):i[u+1]===c&&(l=Math.max(l,i[u+2]));return[l,c]}if(s?.length>=1){for(const u of s)for(let h=0,f=u.length;h<f;h+=2)u[h+1]>c?(c=u[h+1],l=u[h]):u[h+1]===c&&(l=Math.max(l,u[h]));if(l!==1/0)return[l,c]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:l,pageY:c}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-l)/s,t[1]=100*(t[1]-c)/r,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${or}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:s})||this.annotationStorage.setValue(`${or}${i.id}`,{id:i.id,annotationType:i.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:s}=t;i&&this.#i(i);let r=this.#n?.popup||this.popup;!r&&s?.text&&(this._createPopup(s),r=this.#n.popup),r&&(r.updateEdited(t),s?.deleted&&(r.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...t),i.left=`${100*(t[0]-u)/l}%`,i.top=`${100*(c-t[3]+h)/c}%`,r===0?(i.width=`${100*(t[2]-t[0])/l}%`,i.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(r)}_createContainer(t){const{data:i,parent:{page:s,viewport:r}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",i.id),!(this instanceof ns)&&!(this instanceof gh)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(l.title=i.alternativeText),i.noRotate&&l.classList.add("norotate"),!i.rect||this instanceof eh){const{rotation:S}=i;return!i.hasOwnCanvas&&S!==0&&this.setRotation(S,l),l}const{width:u,height:h}=this;if(!t&&i.borderStyle.width>0){c.borderWidth=`${i.borderStyle.width}px`;const S=i.borderStyle.horizontalCornerRadius,E=i.borderStyle.verticalCornerRadius;if(S>0||E>0){const R=`calc(${S}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;c.borderRadius=R}else if(this instanceof Km){const R=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;c.borderRadius=R}switch(i.borderStyle.style){case Vs.SOLID:c.borderStyle="solid";break;case Vs.DASHED:c.borderStyle="dashed";break;case Vs.BEVELED:pt("Unimplemented border style: beveled");break;case Vs.INSET:pt("Unimplemented border style: inset");break;case Vs.UNDERLINE:c.borderBottomStyle="solid";break}const w=i.borderColor||null;w?(this.#e=!0,c.borderColor=nt.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):c.borderWidth=0}const f=nt.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:m,pageHeight:b,pageX:y,pageY:A}=r.rawDims;c.left=`${100*(f[0]-y)/m}%`,c.top=`${100*(f[1]-A)/b}%`;const{rotation:x}=i;return i.hasOwnCanvas||x===0?(c.width=`${100*u/m}%`,c.height=`${100*h/b}%`):this.setRotation(x,l),l}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),i.style.width=`${100*l/s}%`,i.style.height=`${100*c/r}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,r)=>{const l=r.detail[i],c=l[0],u=l.slice(1);r.target.style[s]=hm[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:hm[`${c}_rgb`](u)})};return gt(this,"_commonActions",{display:i=>{const{display:s}=i.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const r of Object.keys(i.detail))(t[r]||s[r])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[r,l]of Object.entries(i)){const c=s[r];if(c){const u={detail:{[r]:l},target:t};c(u),delete i[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,r,l]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,E,w,R]=t.subarray(2,6);if(r===S&&l===E&&i===w&&s===R)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:E}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const h=r-i,f=l-s,{svgFactory:m}=this,b=m.createElement("svg");b.classList.add("quadrilateralsContainer"),b.setAttribute("width",0),b.setAttribute("height",0),b.role="none";const y=m.createElement("defs");b.append(y);const A=m.createElement("clipPath"),x=`clippath_${this.data.id}`;A.setAttribute("id",x),A.setAttribute("clipPathUnits","objectBoundingBox"),y.append(A);for(let S=2,E=t.length;S<E;S+=8){const w=t[S],R=t[S+1],C=t[S+2],k=t[S+3],L=m.createElement("rect"),O=(C-i)/h,P=(l-R)/f,q=(w-C)/h,K=(R-k)/f;L.setAttribute("x",O),L.setAttribute("y",P),L.setAttribute("width",q),L.setAttribute("height",K),A.append(L),u?.push(`<rect vector-effect="non-scaling-stroke" x="${O}" y="${P}" width="${q}" height="${K}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(b),this.container.style.clipPath=`url(#${x})`}_createPopup(t=null){const{data:i}=this;let s,r;t?(s={str:t.text},r=t.date):(s=i.contentsObj,r=i.modificationDate),this.#n=new eh({data:{color:i.color,titleObj:i.titleObj,modificationDate:r,contentsObj:s,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){Ht("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:l,id:c,exportValues:u}of r){if(l===-1||c===i)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!es.has(f)){pt(`_getElementsByName - element not allowed: ${c}`);continue}s.push({id:c,exportValue:h,domElement:f})}return s}for(const r of document.getElementsByName(t)){const{exportValue:l}=r,c=r.getAttribute("data-element-id");c!==i&&es.has(r)&&s.push({id:c,exportValue:l,domElement:r})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class jA extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class gh extends Kt{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#n(s,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=s,this.container.append(s)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),this.#t()}#e(t,i,s="",r=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,r),!1),this.#t()}#n(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const l=s.get(r);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){pt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:r,refs:l,include:c}=i,u=[];if(r.length!==0||l.length!==0){const m=new Set(l);for(const b of r){const y=this._fieldObjects[b]||[];for(const{id:A}of y)m.add(A)}for(const b of Object.values(this._fieldObjects))for(const y of b)m.has(y.id)===c&&u.push(y)}else for(const m of Object.values(this._fieldObjects))u.push(...m);const h=this.annotationStorage,f=[];for(const m of u){const{id:b}=m;switch(f.push(b),m.type){case"text":{const A=m.defaultValue||"";h.setValue(b,{value:A});break}case"checkbox":case"radiobutton":{const A=m.defaultValue===m.exportValues;h.setValue(b,{value:A});break}case"combobox":case"listbox":{const A=m.defaultValue||"";h.setValue(b,{value:A});break}default:continue}const y=document.querySelector(`[data-element-id="${b}"]`);if(y){if(!es.has(y)){pt(`_bindResetFormAction - element not allowed: ${b}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class IA extends Kt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class ns extends Kt{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return we.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,r,l){s.includes("mouse")?t.addEventListener(s,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(s,c=>{if(s==="blur"){if(!i.focused||!c.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c)}})})}_setEventListeners(t,i,s,r){for(const[l,c]of s)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,l,c,r),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":nt.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||FA,l=t.style;let c;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),m=Math.round(f/(Ou*r))||1,b=f/m;c=Math.min(r,h(b/Ou))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(r,h(f/Ou))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=nt.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(l.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class HA extends ns{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,r){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[i]=s),l.setValue(c.id,{[r]:s})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=t.getValue(i,{value:this.data.fieldValue});let l=r.value||"";const c=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),es.add(s),this.contentElement=s,s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:m,timeStep:b}=this.data,y=!!m&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",x=>{t.setValue(i,{value:x.target.value}),this.setPropertyOnSiblings(s,"value",x.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",x=>{const S=this.data.defaultFieldValue??"";s.value=h.userValue=S,h.formattedValue=null});let A=x=>{const{formattedValue:S}=h;S!=null&&(x.target.value=S),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",S=>{if(h.focused)return;const{target:E}=S;if(y&&(E.type=m,b&&(E.step=b)),h.userValue){const w=h.userValue;if(y)if(m==="time"){const R=new Date(w),C=[R.getHours(),R.getMinutes(),R.getSeconds()];E.value=C.map(k=>k.toString().padStart(2,"0")).join(":")}else E.value=new Date(w-UA).toISOString().split(m==="date"?"T":".",1)[0];else E.value=w}h.lastCommittedValue=E.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const E={value(w){h.userValue=w.detail.value??"",y||t.setValue(i,{value:h.userValue.toString()}),w.target.value=h.userValue},formattedValue(w){const{formattedValue:R}=w.detail;h.formattedValue=R,R!=null&&w.target!==document.activeElement&&(w.target.value=R);const C={formattedValue:R};y&&(C.value=R),t.setValue(i,C)},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{const{charLimit:R}=w.detail,{target:C}=w;if(R===0){C.removeAttribute("maxLength");return}C.setAttribute("maxLength",R);let k=h.userValue;!k||k.length<=R||(k=k.slice(0,R),C.value=h.userValue=k,t.setValue(i,{value:k}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:k,willCommit:!0,commitKey:1,selStart:C.selectionStart,selEnd:C.selectionEnd}}))}};this._dispatchEventFromSandbox(E,S)}),s.addEventListener("keydown",S=>{h.commitKey=1;let E=-1;if(S.key==="Escape"?E=0:S.key==="Enter"&&!this.data.multiLine?E=2:S.key==="Tab"&&(h.commitKey=3),E===-1)return;const{value:w}=S.target;h.lastCommittedValue!==w&&(h.lastCommittedValue=w,h.userValue=w,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:w,willCommit:!0,commitKey:E,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const x=A;A=null,s.addEventListener("blur",S=>{if(!h.focused||!S.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:E}=S;let{value:w}=E;if(y){if(w&&m==="time"){const R=w.split(":").map(C=>parseInt(C,10));w=new Date(2e3,0,1,R[0],R[1],R[2]||0).valueOf(),E.step=""}else w.includes("T")||(w=`${w}T00:00`),w=new Date(w).valueOf();E.type="text"}h.userValue=w,h.lastCommittedValue!==w&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:w,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),x(S)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",S=>{h.lastCommittedValue=null;const{data:E,target:w}=S,{value:R,selectionStart:C,selectionEnd:k}=w;let L=C,O=k;switch(S.inputType){case"deleteWordBackward":{const P=R.substring(0,C).match(/\w*[^\w]*$/);P&&(L-=P[0].length);break}case"deleteWordForward":{const P=R.substring(C).match(/^[^\w]*\w*/);P&&(O+=P[0].length);break}case"deleteContentBackward":C===k&&(L-=1);break;case"deleteContentForward":C===k&&(O+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:R,change:E||"",willCommit:!1,selStart:L,selEnd:O}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(A&&s.addEventListener("blur",A),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class GA extends ns{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class VA extends ns{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return es.add(l),l.setAttribute("data-element-id",s),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.setAttribute("exportValue",i.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s)){const m=h&&f.exportValue===i.exportValue;f.domElement&&(f.domElement.checked=m),t.setValue(f.id,{value:m})}t.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue||"Off";c.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class Km extends ns{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof r=="string"&&(r=r!==i.buttonValue,t.setValue(s,{value:r})),r)for(const c of this._getElementsByName(i.fieldName,s))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(es.add(l),l.setAttribute("data-element-id",s),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue;c.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const c=i.buttonValue;l.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const m=c===f.detail.value;for(const b of this._getElementsByName(f.target.name)){const y=m&&b.id===s;b.domElement&&(b.domElement.checked=y),t.setValue(b.id,{value:y})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class qA extends gh{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class YA extends ns{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),r=document.createElement("select");es.add(r),r.setAttribute("data-element-id",i),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",m=>{const b=this.data.defaultFieldValue;for(const y of r.options)y.selected=y.value===b});for(const m of this.data.options){const b=document.createElement("option");b.textContent=m.displayValue,b.value=m.exportValue,s.value.includes(m.exportValue)&&(b.setAttribute("selected",!0),l=!1),r.append(b)}let c=null;if(l){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),r.prepend(m),c=()=>{m.remove(),r.removeEventListener("input",c),c=null},r.addEventListener("input",c)}const u=m=>{const b=m?"value":"textContent",{options:y,multiple:A}=r;return A?Array.prototype.filter.call(y,x=>x.selected).map(x=>x[b]):y.selectedIndex===-1?null:y[y.selectedIndex][b]};let h=u(!1);const f=m=>{const b=m.target.options;return Array.prototype.map.call(b,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",m=>{const b={value(y){c?.();const A=y.detail.value,x=new Set(Array.isArray(A)?A:[A]);for(const S of r.options)S.selected=x.has(S.value);t.setValue(i,{value:u(!0)}),h=u(!1)},multipleSelection(y){r.multiple=!0},remove(y){const A=r.options,x=y.detail.remove;A[x].selected=!1,r.remove(x),A.length>0&&Array.prototype.findIndex.call(A,E=>E.selected)===-1&&(A[0].selected=!0),t.setValue(i,{value:u(!0),items:f(y)}),h=u(!1)},clear(y){for(;r.length!==0;)r.remove(0);t.setValue(i,{value:null,items:[]}),h=u(!1)},insert(y){const{index:A,displayValue:x,exportValue:S}=y.detail.insert,E=r.children[A],w=document.createElement("option");w.textContent=x,w.value=S,E?E.before(w):r.append(w),t.setValue(i,{value:u(!0),items:f(y)}),h=u(!1)},items(y){const{items:A}=y.detail;for(;r.length!==0;)r.remove(0);for(const x of A){const{displayValue:S,exportValue:E}=x,w=document.createElement("option");w.textContent=S,w.value=E,r.append(w)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(i,{value:u(!0),items:f(y)}),h=u(!1)},indices(y){const A=new Set(y.detail.indices);for(const x of y.target.options)x.selected=A.has(x.index);t.setValue(i,{value:u(!0)}),h=u(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(b,m)}),r.addEventListener("input",m=>{const b=u(!0),y=u(!1);t.setValue(i,{value:b}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:h,change:y,changeEx:b,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):r.addEventListener("input",function(m){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class eh extends Kt{constructor(t){const{data:i,elements:s,parent:r}=t,l=!!r._commentManager;if(super(t,{isRenderable:!l&&Kt._hasPopupData(i)}),this.elements=s,l&&Kt._hasPopupData(i)){const c=this.popup=this.#t();for(const u of s)u.popup=c}else this.popup=null}#t(){return new XA({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),s=[];for(const r of this.elements)r.popup=i,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${Xs}${r}`).join(",")),this.container}}class XA{#t=null;#e=this.#V.bind(this);#n=this.#U.bind(this);#i=this.#O.bind(this);#r=this.#x.bind(this);#a=null;#s=null;#l=null;#c=null;#o=null;#d=null;#h=null;#f=!1;#m=null;#g=null;#u=null;#p=null;#b=null;#v=null;#y=null;#E=null;#w=null;#S=null;#C=!1;#A=null;#_=null;constructor({container:t,color:i,elements:s,titleObj:r,modificationDate:l,contentsObj:c,richText:u,parent:h,rect:f,parentRect:m,open:b,commentManager:y=null}){this.#s=t,this.#w=r,this.#l=c,this.#E=u,this.#d=h,this.#a=i,this.#y=f,this.#h=m,this.#o=s,this.#t=y,this.#A=s[0],this.#c=$u.toDateObject(l),this.trigger=s.flatMap(A=>A.getElementsToTriggerPopup()),y||(this.#D(),this.#s.hidden=!0,b&&this.#x())}#D(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const i of this.trigger)i.addEventListener("click",this.#r,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#n,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#o)i.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#o.find(i=>i.hasCommentButton);t&&(this.#b=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#A.container.after(this.#p);return}if(this.#b||this.#M(),!this.#b)return;const{signal:t}=this.#g=new AbortController,i=this.#A.hasOwnCommentButton,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},r=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#p=this.#A.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#p=document.createElement("button");c.className="annotationCommentButton";const u=this.#A.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#P(),this.#R(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#R(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#p||this.renderCommentButton();const[t,i]=this.#b,{style:s}=this.#p;s.left=`calc(${t}%)`,s.top=`calc(${i}% - var(--comment-button-dim))`}#P(){this.#A.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:i,opacity:s,creationDate:r,modificationDate:l}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:s,creationDate:r,modificationDate:l}}get elementBeforePopup(){return this.#p}get comment(){return this.#_||=this.#A.commentText,this.#_}set comment(t){t!==this.comment&&(this.#A.commentText=this.#_=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=i)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:s}=this.#p.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#A.layer.getBoundingClientRect();return[(t-r)/c,(i+s-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#b}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,s]=this.#v||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:l,y:c,width:u,height:h}=r;this.#t.showDialog(null,this,l+i*u,c+s*h,{...t,parentDimensions:r})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#a){const s=t.style.outlineColor=nt.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#w?.str){const s=document.createElement("span");s.className="title",i.append(s),{dir:s.dir,str:s.textContent}=this.#w}if(t.append(i),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),i.append(s)}Mm({html:this.#L||this.#l.str,dir:this.#l?.dir,className:"popupContent"},t),this.#s.append(t)}get#L(){const t=this.#E,i=this.#l;return t?.str&&(!i?.str||i.str===t.str)&&this.#E.html||null}get#k(){return this.#L?.attributes?.style?.fontSize||0}get#F(){return this.#L?.attributes?.style?.color||null}#B(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},r={style:{color:this.#F,fontSize:this.#k?`calc(${this.#k}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))i.push({name:"span",value:l,attributes:r});return s}#V(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#x()}updateEdited({rect:t,popup:i,deleted:s}){if(this.#t){s?(this.remove(),this.#_=null):i&&(i.deleted?this.remove():(this.#P(),this.#_=i.text)),t&&(this.#b=null,this.#M(),this.#R());return}if(s||i?.deleted){this.remove();return}this.#D(),this.#S||={contentsObj:this.#l,richText:this.#E},t&&(this.#u=null),i&&i.text&&(this.#E=this.#B(i.text),this.#c=$u.toDateObject(i.date),this.#l=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#S&&({contentsObj:this.#l,richText:this.#E}=this.#S,this.#S=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#y;for(const x of this.#o)if(!u||nt.intersect(x.data.rect,u)!==null){u=x.data.rect,c=!0;break}const h=nt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),m=c?u[2]-u[0]+5:0,b=h[0]+m,y=h[1];this.#u=[100*(b-r)/i,100*(y-l)/s];const{style:A}=this.#s;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#x(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#O(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#U(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#O(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#T(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#U(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#D(),this.#C&&(this.#m||this.#O(),this.#C=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class Wm extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=mt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class $A extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class KA extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",i-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class WA extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",i/2),c.setAttribute("cy",s/2),c.setAttribute("rx",i/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Qm extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:l,height:c}=this;if(!i)return this.container;const u=this.svgFactory.create(l,c,!0);let h=[];for(let m=0,b=i.length;m<b;m+=2){const y=i[m]-t[0],A=t[3]-i[m+1];h.push(`${y},${A}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class QA extends Qm{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ZA extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class mh extends Kt{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?mt.HIGHLIGHT:mt.INK}#n(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:l}}=this,{transform:c,width:u,height:h}=this.#n(i,t),f=this.svgFactory.create(u,h,!0),m=this.#t=this.svgFactory.createElement("svg:g");f.append(m),m.setAttribute("stroke-width",r.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",c);for(let b=0,y=s.length;b<y;b++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",s[b].join(",")),m.append(A)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,l=this.#t;if(i>=0&&l.setAttribute("stroke-width",i||1),s)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",s[c].join(","));if(r){const{transform:c,width:u,height:h}=this.#n(this.data.rotation,r);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Zm extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=mt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class JA extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class t1 extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class e1 extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Jm extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=mt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class i1 extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:r}=we.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(r?l.metaKey:l.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class bh{#t=null;#e=null;#n=null;#i=new Map;#r=null;#a=null;#s=[];#l=!1;constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:r,page:l,viewport:c,structTreeLayer:u,commentManager:h,linkService:f,annotationStorage:m}){this.div=t,this.#t=i,this.#e=s,this.#r=u||null,this.#a=f||null,this.#n=m||new uh,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:i}=t,s=this.div;ts(s,this.viewport);const r=new Map,l=[],c={data:null,layer:s,linkService:this.#a,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Zl,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of i){if(u.noHTML)continue;const h=u.annotationType===ce.POPUP;if(h){const b=r.get(u.id);if(!b)continue;if(!this._commentManager){l.push(u);continue}c.elements=b}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=Iu.create(c);if(!f.isRenderable)continue;if(!h&&(this.#s.push(f),u.popupRef)){const b=r.get(u.popupRef);b?b.push(f):r.set(u.popupRef,[f])}const m=f.render();u.hidden&&(m.style.visibility="hidden"),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const h=c.elements=r.get(u.id);c.data=u;const f=Iu.create(c);if(!f.isRenderable)continue;const m=f.render();f.contentElement.id=`${Xs}${u.id}`,u.hidden&&(m.style.visibility="hidden"),h.at(-1).container.after(m)}this.#o()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#l){this.#l=!0;for(const{contentElement:s,data:{id:r}}of this.#s){const l=s.id=`${Xs}${r}`;t.push(this.#r?.getAriaAttributes(l).then(c=>{if(c)for(const[u,h]of c)s.setAttribute(u,h)}))}}this.#s.sort(({data:{rect:[s,r,l,c]}},{data:{rect:[u,h,f,m]}})=>{if(s===l&&r===c)return 1;if(u===f&&h===m)return-1;const b=c,y=r,A=(r+c)/2,x=m,S=h,E=(h+m)/2;if(A>=x&&E<=y)return-1;if(E>=b&&A<=S)return 1;const w=(s+l)/2,R=(u+f)/2;return w-R});const i=document.createDocumentFragment();for(const s of this.#s)i.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&i.append(s.extraPopupElement.render());if(this.div.append(i),await Promise.all(t),this.#t)for(const s of this.#s)this.#t.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#a,svgFactory:new Zl,parent:this};for(const s of t){s.borderStyle||=bh._defaultBorderStyle,i.data=s;const r=Iu.create(i);r.isRenderable&&(r.render(),r.contentElement.id=`${Xs}${s.id}`,this.#s.push(r))}await this.#c()}update({viewport:t}){const i=this.div;this.viewport=t,ts(i,{rotation:t.rotation}),this.#o(),i.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[i,s]of this.#e){const r=t.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:l}=r;l?l.nodeName==="CANVAS"?l.replaceWith(s):l.classList.contains("annotationContent")?l.after(s):l.before(s):r.append(s);const c=this.#i.get(i);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,r.id,s),c._hasNoCanvas=!1):c.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:s,rotation:r}=t,l=new jA({data:{id:s,rect:t.getPDFRect(),rotation:r},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#n});return l.render(),l.contentElement.id=`${Xs}${s}`,l.createOrUpdatePopup(),this.#s.push(l),l}removeAnnotation(t){const i=this.#s.findIndex(r=>r.data.id===t);if(i<0)return;const[s]=this.#s.splice(i,1);this.#t?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const i of t)i.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return gt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Vs.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const ql=/\r\n?|\n/g;class pe extends rt{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=pe.prototype,i=l=>l.isEmpty(),s=Mn.TRANSLATE_SMALL,r=Mn.TRANSLATE_BIG;return gt(this,"_keyboardManager",new yr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static _type="freetext";static _editorType=mt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||pe._defaultColor||rt._defaultLineColor,this.#i=t.fontSize||pe._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,i){rt.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Ct.FREETEXT_SIZE:pe._defaultFontSize=i;break;case Ct.FREETEXT_COLOR:pe._defaultColor=i;break}}updateParams(t,i){switch(t){case Ct.FREETEXT_SIZE:this.#r(i);break;case Ct.FREETEXT_COLOR:this.#a(i);break}}static get defaultPropertiesToUpdate(){return[[Ct.FREETEXT_SIZE,pe._defaultFontSize],[Ct.FREETEXT_COLOR,pe._defaultColor||rt._defaultLineColor]]}get propertiesToUpdate(){return[[Ct.FREETEXT_SIZE,this.#i],[Ct.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new dr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ct.FREETEXT_COLOR}#r(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#i)*this.parentScale),this.#i=r,this.#l()},s=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(t){const i=r=>{this.color=r,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-pe._internalPadding*t,-(pe._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(pe.#c(s)),i=s);return t.join(`
`)}#l(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",r.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#s().trimEnd();if(t===i)return;const s=r=>{if(this.#t=r,!r){this.remove();return}this.#o(),this._uiManager.rebuild(this),this.#l()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),this.#l()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){pe._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[f,m]=this.pageDimensions,[b,y]=this.pageTranslation;let A,x;switch(this.rotation){case 0:A=t+(c[0]-b)/f,x=i+this.height-(c[1]-y)/m;break;case 90:A=t+(c[0]-b)/f,x=i-(c[1]-y)/m,[u,h]=[h,-u];break;case 180:A=t-this.width+(c[0]-b)/f,x=i-(c[1]-y)/m,[u,h]=[-u,-h];break;case 270:A=t+(c[0]-b-this.height*m)/f,x=i+(c[1]-y-this.width*f)/m,[u,h]=[-h,u];break}this.setAt(A*r,x*l,u,h)}else this._moveAfterPaste(t,i);this.#o(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ql,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=pe.#h(i.getData("text")||"").replaceAll(ql,`
`);if(!r)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:h}=c,f=[],m=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(m.push(u.nodeValue.slice(h).replaceAll(ql,"")),A!==this.editorDiv){let x=f;for(const S of this.editorDiv.childNodes){if(S===A){x=m;continue}x.push(pe.#c(S))}}f.push(u.nodeValue.slice(0,h).replaceAll(ql,""))}else if(u===this.editorDiv){let A=f,x=0;for(const S of this.editorDiv.childNodes)x++===h&&(A=m),A.push(pe.#c(S))}this.#t=`${f.join(`
`)}${r}${m.join(`
`)}`,this.#o();const b=new Range;let y=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const x=A.nodeValue.length;if(y<=x){b.setStart(A,y),b.setEnd(A,y);break}y-=x}l.removeAllRanges(),l.addRange(b)}#o(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=pe._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){let r=null;if(t instanceof Wm){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:f,id:m,popupRef:b,richText:y,contentsObj:A,creationDate:x,modificationDate:S},textContent:E,textPosition:w,parent:{page:{pageNumber:R}}}=t;if(!E||E.length===0)return null;r=t={annotationType:mt.FREETEXT,color:Array.from(u),fontSize:c,value:E.join(`
`),position:w,pageIndex:R-1,rect:h.slice(0),rotation:f,annotationElementId:m,id:m,deleted:!1,popupRef:b,comment:A?.str||null,richText:y,creationDate:x,modificationDate:S}}const l=await super.deserialize(t,i,s);return l.#i=t.fontSize,l.color=nt.makeHexColor(...t.color),l.#t=pe.#h(t.value),l._initialData=r,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=rt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:i,fontSize:s,color:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((c,u)=>c!==r[u])||t.pageIndex!==l}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const r of this.#t.split(`
`)){const l=document.createElement("div");l.append(r?document.createTextNode(r):document.createElement("br")),i.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class et{static PRECISION=1e-4;toSVGPath(){Ht("Abstract method `toSVGPath` must be implemented.")}get box(){Ht("Abstract getter `box` must be implemented.")}serialize(t,i){Ht("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u]*r,c[u+1]=s+t[u+1]*l;return c}static _rescaleAndSwap(t,i,s,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u+1]*r,c[u+1]=s+t[u]*l;return c}static _translate(t,i,s,r){r||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)r[l]=i+t[l],r[l+1]=s+t[l+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,r,l){switch(l){case 90:return[1-i/s,t/r];case 180:return[1-t/s,1-i/r];case 270:return[i/s,1-t/r];default:return[t/s,i/r]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,r,l,c){return[(t+5*s)/6,(i+5*r)/6,(5*s+l)/6,(5*r+c)/6,(s+l)/2,(r+c)/2]}}class Wn{#t;#e=[];#n;#i;#r=[];#a=new Float32Array(18);#s;#l;#c;#o;#d;#h;#f=[];static#m=8;static#g=2;static#u=Wn.#m+Wn.#g;constructor({x:t,y:i},s,r,l,c,u=0){this.#t=s,this.#h=l*r,this.#i=c,this.#a.set([NaN,NaN,NaN,NaN,t,i],6),this.#n=u,this.#o=Wn.#m*r,this.#c=Wn.#u*r,this.#d=r,this.#f.push(t,i)}isEmpty(){return isNaN(this.#a[8])}#p(){const t=this.#a.subarray(4,6),i=this.#a.subarray(16,18),[s,r,l,c]=this.#t;return[(this.#s+(t[0]-i[0])/2-s)/l,(this.#l+(t[1]-i[1])/2-r)/c,(this.#s+(i[0]-t[0])/2-s)/l,(this.#l+(i[1]-t[1])/2-r)/c]}add({x:t,y:i}){this.#s=t,this.#l=i;const[s,r,l,c]=this.#t;let[u,h,f,m]=this.#a.subarray(8,12);const b=t-f,y=i-m,A=Math.hypot(b,y);if(A<this.#c)return!1;const x=A-this.#o,S=x/A,E=S*b,w=S*y;let R=u,C=h;u=f,h=m,f+=E,m+=w,this.#f?.push(t,i);const k=-w/x,L=E/x,O=k*this.#h,P=L*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([f+O,m+P],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([f-O,m-P],16),isNaN(this.#a[6])?(this.#r.length===0&&(this.#a.set([u+O,h+P],2),this.#r.push(NaN,NaN,NaN,NaN,(u+O-s)/l,(h+P-r)/c),this.#a.set([u-O,h-P],14),this.#e.push(NaN,NaN,NaN,NaN,(u-O-s)/l,(h-P-r)/c)),this.#a.set([R,C,u,h,f,m],6),!this.isEmpty()):(this.#a.set([R,C,u,h,f,m],6),Math.abs(Math.atan2(C-h,R-u)-Math.atan2(w,E))<Math.PI/2?([u,h,f,m]=this.#a.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/l,((h+m)/2-r)/c),[u,h,R,C]=this.#a.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((R+u)/2-s)/l,((C+h)/2-r)/c),!0):([R,C,u,h,f,m]=this.#a.subarray(0,6),this.#r.push(((R+5*u)/6-s)/l,((C+5*h)/6-r)/c,((5*u+f)/6-s)/l,((5*h+m)/6-r)/c,((u+f)/2-s)/l,((h+m)/2-r)/c),[f,m,u,h,R,C]=this.#a.subarray(12,18),this.#e.push(((R+5*u)/6-s)/l,((C+5*h)/6-r)/c,((5*u+f)/6-s)/l,((5*h+m)/6-r)/c,((u+f)/2-s)/l,((h+m)/2-r)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,i=this.#e;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#b();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#y(s);for(let r=i.length-6;r>=6;r-=6)isNaN(i[r])?s.push(`L${i[r+4]} ${i[r+5]}`):s.push(`C${i[r]} ${i[r+1]} ${i[r+2]} ${i[r+3]} ${i[r+4]} ${i[r+5]}`);return this.#v(s),s.join(" ")}#b(){const[t,i,s,r]=this.#t,[l,c,u,h]=this.#p();return`M${(this.#a[2]-t)/s} ${(this.#a[3]-i)/r} L${(this.#a[4]-t)/s} ${(this.#a[5]-i)/r} L${l} ${c} L${u} ${h} L${(this.#a[16]-t)/s} ${(this.#a[17]-i)/r} L${(this.#a[14]-t)/s} ${(this.#a[15]-i)/r} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#y(t){const[i,s,r,l]=this.#t,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[h,f,m,b]=this.#p();t.push(`L${(c[0]-i)/r} ${(c[1]-s)/l} L${h} ${f} L${m} ${b} L${(u[0]-i)/r} ${(u[1]-s)/l}`)}newFreeDrawOutline(t,i,s,r,l,c){return new t0(t,i,s,r,l,c)}getOutlines(){const t=this.#r,i=this.#e,s=this.#a,[r,l,c,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let b=0,y=h.length-2;b<y;b+=2)h[b]=(this.#f[b]-r)/c,h[b+1]=(this.#f[b+1]-l)/u;if(h[h.length-2]=(this.#s-r)/c,h[h.length-1]=(this.#l-l)/u,isNaN(s[6])&&!this.isEmpty())return this.#E(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let m=t.length;for(let b=0;b<m;b+=2){if(isNaN(t[b])){f[b]=f[b+1]=NaN;continue}f[b]=t[b],f[b+1]=t[b+1]}m=this.#S(f,m);for(let b=i.length-6;b>=6;b-=6)for(let y=0;y<6;y+=2){if(isNaN(i[b+y])){f[m]=f[m+1]=NaN,m+=2;continue}f[m]=i[b+y],f[m+1]=i[b+y+1],m+=2}return this.#w(f,m),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#n,this.#i)}#E(t){const i=this.#a,[s,r,l,c]=this.#t,[u,h,f,m]=this.#p(),b=new Float32Array(36);return b.set([NaN,NaN,NaN,NaN,(i[2]-s)/l,(i[3]-r)/c,NaN,NaN,NaN,NaN,(i[4]-s)/l,(i[5]-r)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(i[16]-s)/l,(i[17]-r)/c,NaN,NaN,NaN,NaN,(i[14]-s)/l,(i[15]-r)/c],0),this.newFreeDrawOutline(b,t,this.#t,this.#d,this.#n,this.#i)}#w(t,i){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6}#S(t,i){const s=this.#a.subarray(4,6),r=this.#a.subarray(16,18),[l,c,u,h]=this.#t,[f,m,b,y]=this.#p();return t.set([NaN,NaN,NaN,NaN,(s[0]-l)/u,(s[1]-c)/h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,b,y,NaN,NaN,NaN,NaN,(r[0]-l)/u,(r[1]-c)/h],i),i+=24}}class t0 extends et{#t;#e=new Float32Array(4);#n;#i;#r;#a;#s;constructor(t,i,s,r,l,c){super(),this.#s=t,this.#r=i,this.#t=s,this.#a=r,this.#n=l,this.#i=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#l(c);const[u,h,f,m]=this.#e;for(let b=0,y=t.length;b<y;b+=2)t[b]=(t[b]-u)/f,t[b+1]=(t[b+1]-h)/m;for(let b=0,y=i.length;b<y;b+=2)i[b]=(i[b]-u)/f,i[b+1]=(i[b+1]-h)/m}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let i=6,s=this.#s.length;i<s;i+=6){if(isNaN(this.#s[i])){t.push(`L${this.#s[i+4]} ${this.#s[i+5]}`);continue}t.push(`C${this.#s[i]} ${this.#s[i+1]} ${this.#s[i+2]} ${this.#s[i+3]} ${this.#s[i+4]} ${this.#s[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],l){const c=s-t,u=r-i;let h,f;switch(l){case 0:h=et._rescale(this.#s,t,r,c,-u),f=et._rescale(this.#r,t,r,c,-u);break;case 90:h=et._rescaleAndSwap(this.#s,t,i,c,u),f=et._rescaleAndSwap(this.#r,t,i,c,u);break;case 180:h=et._rescale(this.#s,s,i,-c,u),f=et._rescale(this.#r,s,i,-c,u);break;case 270:h=et._rescaleAndSwap(this.#s,s,r,-c,-u),f=et._rescaleAndSwap(this.#r,s,r,-c,-u);break}return{outline:Array.from(h),points:[Array.from(f)]}}#l(t){const i=this.#s;let s=i[4],r=i[5];const l=[s,r,s,r];let c=s,u=r,h=s,f=r;const m=t?Math.max:Math.min,b=new Float32Array(4);for(let A=6,x=i.length;A<x;A+=6){const S=i[A+4],E=i[A+5];isNaN(i[A])?(nt.pointBoundingBox(S,E,l),u>E?(c=S,u=E):u===E&&(c=m(c,S)),f<E?(h=S,f=E):f===E&&(h=m(h,S))):(b[0]=b[1]=1/0,b[2]=b[3]=-1/0,nt.bezierBoundingBox(s,r,...i.slice(A,A+6),b),nt.rectBoundingBox(b[0],b[1],b[2],b[3],l),u>b[1]?(c=b[0],u=b[1]):u===b[1]&&(c=m(c,b[0])),f<b[3]?(h=b[2],f=b[3]):f===b[3]&&(h=m(h,b[2]))),s=S,r=E}const y=this.#e;y[0]=l[0]-this.#n,y[1]=l[1]-this.#n,y[2]=l[2]-l[0]+2*this.#n,y[3]=l[3]-l[1]+2*this.#n,this.firstPoint=[c,u],this.lastPoint=[h,f]}get box(){return this.#e}newOutliner(t,i,s,r,l,c=0){return new Wn(t,i,s,r,l,c)}getNewOutline(t,i){const[s,r,l,c]=this.#e,[u,h,f,m]=this.#t,b=l*f,y=c*m,A=s*f+u,x=r*m+h,S=this.newOutliner({x:this.#r[0]*b+A,y:this.#r[1]*y+x},this.#t,this.#a,t,this.#i,i??this.#n);for(let E=2;E<this.#r.length;E+=2)S.add({x:this.#r[E]*b+A,y:this.#r[E+1]*y+x});return S.getOutlines()}}class ih{#t;#e;#n;#i=[];#r=[];constructor(t,i=0,s=0,r=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:S,y:E,width:w,height:R}of t){const C=Math.floor((S-i)/c)*c,k=Math.ceil((S+w+i)/c)*c,L=Math.floor((E-i)/c)*c,O=Math.ceil((E+R+i)/c)*c,P=[C,L,O,!0],q=[k,L,O,!1];this.#i.push(P,q),nt.rectBoundingBox(C,L,k,O,l)}const u=l[2]-l[0]+2*s,h=l[3]-l[1]+2*s,f=l[0]-s,m=l[1]-s;let b=r?-1/0:1/0,y=1/0;const A=this.#i.at(r?-1:-2),x=[A[0],A[2]];for(const S of this.#i){const[E,w,R,C]=S;!C&&r?w<y?(y=w,b=E):w===y&&(b=Math.max(b,E)):C&&!r&&(w<y?(y=w,b=E):w===y&&(b=Math.min(b,E))),S[0]=(E-f)/u,S[1]=(w-m)/h,S[2]=(R-m)/h}this.#t=new Float32Array([f,m,u,h]),this.#e=[b,y],this.#n=x}getOutlines(){this.#i.sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#o(i)),this.#l(i)):(this.#c(i),t.push(...this.#o(i)));return this.#a(t)}#a(t){const i=[],s=new Set;for(const c of t){const[u,h,f]=c;i.push([u,h,c],[u,f,c])}i.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=i.length;c<u;c+=2){const h=i[c][2],f=i[c+1][2];h.push(f),f.push(h),s.add(h),s.add(f)}const r=[];let l;for(;s.size>0;){const c=s.values().next().value;let[u,h,f,m,b]=c;s.delete(c);let y=u,A=h;for(l=[u,f],r.push(l);;){let x;if(s.has(m))x=m;else if(s.has(b))x=b;else break;s.delete(x),[u,h,f,m,b]=x,y!==u&&(l.push(y,A,u,A===h?h:f),y=u),A=A===h?f:h}l.push(y,A)}return new n1(r,this.#t,this.#e,this.#n)}#s(t){const i=this.#r;let s=0,r=i.length-1;for(;s<=r;){const l=s+r>>1,c=i[l][0];if(c===t)return l;c<t?s=l+1:r=l-1}return r+1}#l([,t,i]){const s=this.#s(t);this.#r.splice(s,0,[t,i])}#c([,t,i]){const s=this.#s(t);for(let r=s;r<this.#r.length;r++){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}for(let r=s-1;r>=0;r--){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}}#o(t){const[i,s,r]=t,l=[[i,s,r]],c=this.#s(r);for(let u=0;u<c;u++){const[h,f]=this.#r[u];for(let m=0,b=l.length;m<b;m++){const[,y,A]=l[m];if(!(f<=y||A<=h)){if(y>=h){if(A>f)l[m][1]=f;else{if(b===1)return[];l.splice(m,1),m--,b--}continue}l[m][2]=h,A>f&&l.push([i,f,A])}}}return l}}class n1 extends et{#t;#e;constructor(t,i,s,r){super(),this.#e=t,this.#t=i,this.firstPoint=s,this.lastPoint=r}toSVGPath(){const t=[];for(const i of this.#e){let[s,r]=i;t.push(`M${s} ${r}`);for(let l=2;l<i.length;l+=2){const c=i[l],u=i[l+1];c===s?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],l){const c=[],u=s-t,h=r-i;for(const f of this.#e){const m=new Array(f.length);for(let b=0;b<f.length;b+=2)m[b]=t+f[b]*u,m[b+1]=r-f[b+1]*h;c.push(m)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class nh extends Wn{newFreeDrawOutline(t,i,s,r,l,c){return new s1(t,i,s,r,l,c)}}class s1 extends t0{newOutliner(t,i,s,r,l,c=0){return new nh(t,i,s,r,l,c)}}class ne extends rt{#t=null;#e=0;#n;#i=null;#r=null;#a=null;#s=null;#l=0;#c=null;#o=null;#d=null;#h=!1;#f=null;#m=null;#g=null;#u="";#p;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=mt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ne.prototype;return gt(this,"_keyboardManager",new yr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ne._defaultColor,this.#p=t.thickness||ne._defaultThickness,this.opacity=t.opacity||ne._defaultOpacity,this.#n=t.boxes||null,this.#b=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#y(t),this.#A()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#l=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new ih(this.#n,.001);this.#o=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#o.box;const i=new ih(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#a=i.getOutlines();const{firstPoint:s}=this.#o;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:r}=this.#a;this.#m=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:i,clipPathId:s}){this.#o=t;const r=1.5;if(this.#a=t.getNewOutline(this.#p/2+r,.0025),i>=0)this.#d=i,this.#i=s,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ne.#_(this.#o.box,(b-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:ne.#_(this.#a.box,b),path:{d:this.#a.toSVGPath()}})}const[l,c,u,h]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=h;break;case 90:{const[b,y]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*y/b,this.height=h*b/y;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=h;break;case 270:{const[b,y]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*y/b,this.height=h*b/y;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/h];const{lastPoint:m}=this.#a;this.#m=[(m[0]-l)/u,(m[1]-c)/h]}static initialize(t,i){rt.initialize(t,i),ne._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case Ct.HIGHLIGHT_COLOR:ne._defaultColor=i;break;case Ct.HIGHLIGHT_THICKNESS:ne._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case Ct.HIGHLIGHT_COLOR:this.#E(i);break;case Ct.HIGHLIGHT_THICKNESS:this.#w(i);break}}static get defaultPropertiesToUpdate(){return[[Ct.HIGHLIGHT_COLOR,ne._defaultColor],[Ct.HIGHLIGHT_THICKNESS,ne._defaultThickness]]}get propertiesToUpdate(){return[[Ct.HIGHLIGHT_COLOR,this.color||ne._defaultColor],[Ct.HIGHLIGHT_THICKNESS,this.#p||ne._defaultThickness],[Ct.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#E(t){const i=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},s=this.color,r=this.opacity;this.addCommands({cmd:i.bind(this,t,ne._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#w(t){const i=this.#p,s=r=>{this.#p=r,this.#S(r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new ui({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#R())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#C():t&&(this.#A(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#S(t){this.#h&&(this.#y({highlightOutlines:this.#o.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#o.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#o.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#_([t,i,s,r],l){switch(l){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]}rotate(t){const{drawLayer:i}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=ne.#_(this.#o.box,t)):s=ne.#_([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(this.#g,{bbox:ne.#_(this.#a.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(),Dm(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#D(t){ne._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#s,this.#l)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#R(){return this.#h?this.rotation:0}#P(){if(this.#h)return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,l=this.#n,c=new Float32Array(l.length*8);let u=0;for(const{x:h,y:f,width:m,height:b}of l){const y=h*t+s,A=(1-f)*i+r;c[u]=c[u+4]=y,c[u+1]=c[u+3]=A,c[u+2]=c[u+6]=y+m*t,c[u+5]=c[u+7]=A-b*i,u+=8}return c}#L(t){return this.#o.serialize(t,this.#R())}static startHighlighting(t,i,{target:s,x:r,y:l}){const{x:c,y:u,width:h,height:f}=s.getBoundingClientRect(),m=new AbortController,b=t.combinedSignal(m),y=A=>{m.abort(),this.#F(t,A)};window.addEventListener("blur",y,{signal:b}),window.addEventListener("pointerup",y,{signal:b}),window.addEventListener("pointerdown",Jt,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",hi,{signal:b}),s.addEventListener("pointermove",this.#k.bind(this,t),{signal:b}),this._freeHighlight=new nh({x:r,y:l},[c,u,h,f],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#k(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,s){let r=null;if(t instanceof Zm){const{data:{quadPoints:x,rect:S,rotation:E,id:w,color:R,opacity:C,popupRef:k,richText:L,contentsObj:O,creationDate:P,modificationDate:q},parent:{page:{pageNumber:K}}}=t;r=t={annotationType:mt.HIGHLIGHT,color:Array.from(R),opacity:C,quadPoints:x,boxes:null,pageIndex:K-1,rect:S.slice(0),rotation:E,annotationElementId:w,id:w,deleted:!1,popupRef:k,richText:L,comment:O?.str||null,creationDate:P,modificationDate:q}}else if(t instanceof mh){const{data:{inkLists:x,rect:S,rotation:E,id:w,color:R,borderStyle:{rawWidth:C},popupRef:k,richText:L,contentsObj:O,creationDate:P,modificationDate:q},parent:{page:{pageNumber:K}}}=t;r=t={annotationType:mt.HIGHLIGHT,color:Array.from(R),thickness:C,inkLists:x,boxes:null,pageIndex:K-1,rect:S.slice(0),rotation:E,annotationElementId:w,id:w,deleted:!1,popupRef:k,richText:L,comment:O?.str||null,creationDate:P,modificationDate:q}}const{color:l,quadPoints:c,inkLists:u,opacity:h}=t,f=await super.deserialize(t,i,s);f.color=nt.makeHexColor(...l),f.opacity=h||1,u&&(f.#p=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t);const[m,b]=f.pageDimensions,[y,A]=f.pageTranslation;if(c){const x=f.#n=[];for(let S=0;S<c.length;S+=8)x.push({x:(c[S]-y)/m,y:1-(c[S+1]-A)/b,width:(c[S+2]-c[S])/m,height:(c[S+1]-c[S+5])/b});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const x=u[0],S={x:x[0]-y,y:b-(x[1]-A)},E=new nh(S,[0,0,m,b],1,f.#p/2,!0,.001);for(let C=0,k=x.length;C<k;C+=2)S.x=x[C]-y,S.y=b-(x[C+1]-A),E.add(S);const{id:w,clipPathId:R}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);f.#y({highlightOutlines:E.getOutlines(),highlightId:w,clipPathId:R}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=rt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:this.#p,quadPoints:this.#P(),outlines:this.#L(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,r)=>s!==i[r])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class e0{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,s]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,s)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Ht("Not implemented")}}class Lt extends rt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#a(t),this.#c())}#a({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,i){const{id:s}=i.drawLayer.draw(Lt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,l]of Object.entries(i))s.has(r)?Object.assign(t[r],l):t[r]=l;return t}static getDefaultDrawingOptions(t){Ht("Not implemented")}static get typesMap(){Ht("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(Lt.#n.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,l=r[i],c=u=>{r.updateProperty(i,u);const h=this.#t.updateProperty(i,u);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Lt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Lt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Lt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#l(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#l()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#l(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#o([t,i,s,r]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[i,1-t,s*(c/l),r*(l/c)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(c/l),r*(l/c)];default:return[t,i,s,r]}}#d(){const{x:t,y:i,width:s,height:r,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-i,t,s*(l/c),r*(c/l)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(l/c),r*(c/l)];default:return[t,i,s,r]}}#h(t){[this.x,this.y,this.width,this.height]=this.#o(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:i,width:s,height:r,rotation:l,parentRotation:c,parentDimensions:[u,h]}=this;switch((l*4+c)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(u/h),r*(h/u),s*(u/h)];case 5:return[1-i,t,s*(u/h),r*(h/u)];case 6:return[1-t-r*(h/u),1-i,r*(h/u),s*(u/h)];case 7:return[i-s*(u/h),1-t-r*(h/u),s*(u/h),r*(h/u)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(h/u),i,r*(h/u),s*(u/h)];case 13:return[1-i-s*(u/h),t-r*(h/u),s*(u/h),r*(h/u)];case 14:return[1-t,1-i-s*(u/h),r*(h/u),s*(u/h)];case 15:return[i,1-t,s*(u/h),r*(h/u)];default:return[t,i,s,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Lt._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");return s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,l){Ht("Not implemented")}static startDrawing(t,i,s,r){const{target:l,offsetX:c,offsetY:u,pointerId:h,pointerType:f}=r;if(Ot.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:m}}=t,{width:b,height:y}=l.getBoundingClientRect(),A=Lt.#i=new AbortController,x=t.combinedSignal(A);if(Ot.setPointer(f,h),window.addEventListener("pointerup",S=>{Ot.isSamePointerIdOrRemove(S.pointerId)&&this._endDraw(S)},{signal:x}),window.addEventListener("pointercancel",S=>{Ot.isSamePointerIdOrRemove(S.pointerId)&&this._currentParent.endDrawingSession()},{signal:x}),window.addEventListener("pointerdown",S=>{Ot.isSamePointerType(S.pointerType)&&(Ot.initializeAndAddPointerId(S.pointerId),Lt.#n.isCancellable()&&(Lt.#n.removeLastElement(),Lt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",hi,{signal:x}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),l.addEventListener("touchmove",S=>{Ot.isSameTimeStamp(S.timeStamp)&&Jt(S)},{signal:x}),t.toggleDrawing(),i._editorUndoBar?.hide(),Lt.#n){t.drawLayer.updateProperties(this._currentDrawId,Lt.#n.startNew(c,u,b,y,m));return}i.updateUIForDefaultProperties(this),Lt.#n=this.createDrawerInstance(c,u,b,y,m),Lt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Lt.#r.toSVGProperties(),Lt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Ot.isSameTimeStamp(t.timeStamp),!Lt.#n)return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(Ot.isSamePointerId(r)){if(Ot.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Lt.#n.add(i,s)),Ot.setTimeStamp(t.timeStamp),Jt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Lt.#n=null,Lt.#r=null,Ot.clearPointerType(),Ot.clearTimeStamp()),Lt.#i&&(Lt.#i.abort(),Lt.#i=null,Ot.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,Lt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=Lt.#n,r=this._currentDrawId,l=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(l))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Ct.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Ct.DRAW_STEP),!Lt.#n.isEmpty()){const{pageDimensions:[s,r],scale:l}=i,c=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Lt.#n.getOutlines(s*l,r*l,l,this._INNER_MARGIN),drawingOptions:Lt.#r,mustBeCommitted:!t});return this._cleanup(!0),c}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,l,c){Ht("Not implemented")}static async deserialize(t,i,s){const{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:u}}=i.viewport,h=this.deserializeDraw(c,u,r,l,this._INNER_MARGIN,t),f=await super.deserialize(t,i,s);return f.createDrawingOptions(t),f.#a({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[i,s]=this.pageTranslation,[r,l]=this.pageDimensions;return this.#t.serialize([i,s,r,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class a1{#t=new Float64Array(6);#e;#n;#i;#r;#a;#s="";#l=0;#c=new Ar;#o;#d;constructor(t,i,s,r,l,c){this.#o=s,this.#d=r,this.#i=l,this.#r=c,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i],this.#n=[{line:u,points:this.#a}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#r=i)}#h(t,i){return et._normalizePoint(t,i,this.#o,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#a.length<=10}add(t,i){[t,i]=this.#h(t,i);const[s,r,l,c]=this.#t.subarray(2,6),u=t-l,h=i-c;return Math.hypot(this.#o*u,this.#d*h)<=2?null:(this.#a.push(t,i),isNaN(s)?(this.#t.set([l,c,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,r,l,c,t,i],0),this.#e.push(...et.createBezierPoints(s,r,l,c,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const s=this.add(t,i);return s||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,s,r,l){this.#o=s,this.#d=r,this.#i=l,[t,i]=this.#h(t,i);const c=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:c,points:this.#a}),this.#t.set(c,0),this.#l=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#a=t.points,this.#l=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#s="";for(let t=0,i=this.#n.length;t<i;t++){const{line:s,points:r}=this.#n[t];this.#e=s,this.#a=r,this.#l=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=et.svgRound(this.#e[4]),i=et.svgRound(this.#e[5]);if(this.#a.length===2)return this.#s=`${this.#s} M ${t} ${i} Z`,this.#s;if(this.#a.length<=6){const r=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,r)} M ${t} ${i}`,this.#l=6}if(this.#a.length===4){const r=et.svgRound(this.#e[10]),l=et.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${r} ${l}`,this.#l=12,this.#s}const s=[];this.#l===0&&(s.push(`M ${t} ${i}`),this.#l=6);for(let r=this.#l,l=this.#e.length;r<l;r+=6){const[c,u,h,f,m,b]=this.#e.slice(r,r+6).map(et.svgRound);s.push(`C${c} ${u} ${h} ${f} ${m} ${b}`)}return this.#s+=s.join(" "),this.#l=this.#e.length,this.#s}getOutlines(t,i,s,r){const l=this.#n.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#n,t,i,s,this.#i,this.#r,r),this.#t=null,this.#e=null,this.#n=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Ar extends et{#t;#e=0;#n;#i;#r;#a;#s;#l;#c;build(t,i,s,r,l,c,u){this.#r=i,this.#a=s,this.#s=r,this.#l=l,this.#c=c,this.#n=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${et.svgRound(i[4])} ${et.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${et.svgRound(i[10])} ${et.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[l,c,u,h,f,m]=i.subarray(s,s+6).map(et.svgRound);t.push(`C${l} ${c} ${u} ${h} ${f} ${m}`)}}return t.join("")}serialize([t,i,s,r],l){const c=[],u=[],[h,f,m,b]=this.#d();let y,A,x,S,E,w,R,C,k;switch(this.#l){case 0:k=et._rescale,y=t,A=i+r,x=s,S=-r,E=t+h*s,w=i+(1-f-b)*r,R=t+(h+m)*s,C=i+(1-f)*r;break;case 90:k=et._rescaleAndSwap,y=t,A=i,x=s,S=r,E=t+f*s,w=i+h*r,R=t+(f+b)*s,C=i+(h+m)*r;break;case 180:k=et._rescale,y=t+s,A=i,x=-s,S=r,E=t+(1-h-m)*s,w=i+f*r,R=t+(1-h)*s,C=i+(f+b)*r;break;case 270:k=et._rescaleAndSwap,y=t+s,A=i+r,x=-s,S=-r,E=t+(1-f-b)*s,w=i+(1-h-m)*r,R=t+(1-f)*s,C=i+(1-h)*r;break}for(const{line:L,points:O}of this.#i)c.push(k(L,y,A,x,S,l?new Array(L.length):null)),u.push(k(O,y,A,x,S,l?new Array(O.length):null));return{lines:c,points:u,rect:[E,w,R,C]}}static deserialize(t,i,s,r,l,{paths:{lines:c,points:u},rotation:h,thickness:f}){const m=[];let b,y,A,x,S;switch(h){case 0:S=et._rescale,b=-t/s,y=i/r+1,A=1/s,x=-1/r;break;case 90:S=et._rescaleAndSwap,b=-i/r,y=-t/s,A=1/r,x=1/s;break;case 180:S=et._rescale,b=t/s+1,y=-i/r,A=-1/s,x=1/r;break;case 270:S=et._rescaleAndSwap,b=i/r+1,y=t/s+1,A=-1/r,x=-1/s;break}if(!c){c=[];for(const w of u){const R=w.length;if(R===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(R===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const C=new Float32Array(3*(R-2));c.push(C);let[k,L,O,P]=w.subarray(0,4);C.set([NaN,NaN,NaN,NaN,k,L],0);for(let q=4;q<R;q+=2){const K=w[q],J=w[q+1];C.set(et.createBezierPoints(k,L,O,P,K,J),(q-2)*3),[k,L,O,P]=[O,P,K,J]}}}for(let w=0,R=c.length;w<R;w++)m.push({line:S(c[w].map(C=>C??NaN),b,y,A,x),points:S(u[w].map(C=>C??NaN),b,y,A,x)});const E=new this.prototype.constructor;return E.build(m,s,r,1,h,f,l),E}#o(t=this.#c){const i=this.#n+t/2*this.#s;return this.#l%180===0?[i/this.#r,i/this.#a]:[i/this.#a,i/this.#r]}#d(){const[t,i,s,r]=this.#t,[l,c]=this.#o(0);return[t+l,i+c,s-2*l,r-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let u=4,h=r.length;u<h;u+=6)nt.pointBoundingBox(r[u],r[u+1],t);continue}let l=r[4],c=r[5];for(let u=6,h=r.length;u<h;u+=6){const[f,m,b,y,A,x]=r.subarray(u,u+6);nt.bezierBoundingBox(l,c,f,m,b,y,A,x,t),l=A,c=x}}const[i,s]=this.#o();t[0]=Me(t[0]-i,0,1),t[1]=Me(t[1]-s,0,1),t[2]=Me(t[2]+i,0,1),t[3]=Me(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,s]=this.#o();this.#c=t;const[r,l]=this.#o(),[c,u]=[r-i,l-s],h=this.#t;return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateParentDimensions([t,i],s){const[r,l]=this.#o();this.#r=t,this.#a=i,this.#s=s;const[c,u]=this.#o(),h=c-r,f=u-l,m=this.#t;return m[0]-=h,m[1]-=f,m[2]+=2*h,m[3]+=2*f,m}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(et.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let s=0,r=0,l=0,c=0,u=0,h=0;switch(this.#e){case 90:r=i/t,l=-t/i,u=t;break;case 180:s=-1,c=-1,u=t,h=i;break;case 270:r=-i/t,l=t/i,h=i;break;default:return""}return`matrix(${s} ${r} ${l} ${c} ${et.svgRound(u)} ${et.svgRound(h)})`}getPathResizingSVGProperties([t,i,s,r]){const[l,c]=this.#o(),[u,h,f,m]=this.#t;if(Math.abs(f-l)<=et.PRECISION||Math.abs(m-c)<=et.PRECISION){const S=t+s/2-(u+f/2),E=i+r/2-(h+m/2);return{path:{"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`,transform:`${this.rotationTransform} translate(${S} ${E})`}}}const b=(s-2*l)/(f-2*l),y=(r-2*c)/(m-2*c),A=f/s,x=m/r;return{path:{"transform-origin":`${et.svgRound(u)} ${et.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${x}) translate(${et.svgRound(l)} ${et.svgRound(c)}) scale(${b} ${y}) translate(${et.svgRound(-l)} ${et.svgRound(-c)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[l,c]=this.#o(),u=this.#t,[h,f,m,b]=u;if(u[0]=t,u[1]=i,u[2]=s,u[3]=r,Math.abs(m-l)<=et.PRECISION||Math.abs(b-c)<=et.PRECISION){const E=t+s/2-(h+m/2),w=i+r/2-(f+b/2);for(const{line:R,points:C}of this.#i)et._translate(R,E,w,R),et._translate(C,E,w,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(s-2*l)/(m-2*l),A=(r-2*c)/(b-2*c),x=-y*(h+l)+t+l,S=-A*(f+c)+i+c;if(y!==1||A!==1||x!==0||S!==0)for(const{line:E,points:w}of this.#i)et._rescale(E,x,S,y,A,E),et._rescale(w,x,S,y,A,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,l]=s,c=this.#t,u=t-c[0],h=i-c[1];if(this.#r===r&&this.#a===l)for(const{line:f,points:m}of this.#i)et._translate(f,u,h,f),et._translate(m,u,h,m);else{const f=this.#r/r,m=this.#a/l;this.#r=r,this.#a=l;for(const{line:b,points:y}of this.#i)et._rescale(b,u,h,f,m,b),et._rescale(y,u,h,f,m,y);c[2]*=f,c[3]*=m}return c[0]=t,c[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${et.svgRound(t[0])} ${et.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class ro extends e0{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:rt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new ro(this._viewParameters);return t.updateAll(this),t}}class yh extends Lt{static _type="ink";static _editorType=mt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){rt.initialize(t,i),this._defaultDrawingOptions=new ro(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return gt(this,"typesMap",new Map([[Ct.INK_THICKNESS,"stroke-width"],[Ct.INK_COLOR,"stroke"],[Ct.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,l){return new a1(t,i,s,r,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,l,c){return Ar.deserialize(t,i,s,r,l,c)}static async deserialize(t,i,s){let r=null;if(t instanceof mh){const{data:{inkLists:c,rect:u,rotation:h,id:f,color:m,opacity:b,borderStyle:{rawWidth:y},popupRef:A,richText:x,contentsObj:S,creationDate:E,modificationDate:w},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:mt.INK,color:Array.from(m),thickness:y,opacity:b,paths:{points:c},boxes:null,pageIndex:R-1,rect:u.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:x,comment:S?.str||null,creationDate:E,modificationDate:w}}const l=await super.deserialize(t,i,s);return l._initialData=r,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new dr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ct.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=yh.getDefaultDrawingOptions({stroke:nt.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:rt._colorManager.convert(r),opacity:l,thickness:c,paths:{lines:i,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:s,opacity:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==i[u])||t.thickness!==s||t.opacity!==r||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class sh extends Ar{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Yl=8,ir=3;class Ys{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,s,r){return s-=t,r-=i,s===0?r>0?0:4:s===1?r+6:2-r}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,s,r,l,c,u){const h=this.#e(s,r,l,c);for(let f=0;f<8;f++){const m=(-f+h-u+16)%8,b=this.#n[2*m],y=this.#n[2*m+1];if(t[(s+b)*i+(r+y)]!==0)return m}return-1}static#r(t,i,s,r,l,c,u){const h=this.#e(s,r,l,c);for(let f=0;f<8;f++){const m=(f+h+u+16)%8,b=this.#n[2*m],y=this.#n[2*m+1];if(t[(s+b)*i+(r+y)]!==0)return m}return-1}static#a(t,i,s,r){const l=t.length,c=new Int32Array(l);for(let m=0;m<l;m++)c[m]=t[m]<=r?1:0;for(let m=1;m<s-1;m++)c[m*i]=c[m*i+i-1]=0;for(let m=0;m<i;m++)c[m]=c[i*s-1-m]=0;let u=1,h;const f=[];for(let m=1;m<s-1;m++){h=1;for(let b=1;b<i-1;b++){const y=m*i+b,A=c[y];if(A===0)continue;let x=m,S=b;if(A===1&&c[y-1]===0)u+=1,S-=1;else if(A>=1&&c[y+1]===0)u+=1,S+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const E=[b,m],w=S===b+1,R={isHole:w,points:E,id:u,parent:0};f.push(R);let C;for(const Q of f)if(Q.id===h){C=Q;break}C?C.isHole?R.parent=w?C.parent:h:R.parent=w?h:C.parent:R.parent=w?h:0;const k=this.#i(c,i,m,b,x,S,0);if(k===-1){c[y]=-u,c[y]!==1&&(h=Math.abs(c[y]));continue}let L=this.#n[2*k],O=this.#n[2*k+1];const P=m+L,q=b+O;x=P,S=q;let K=m,J=b;for(;;){const Q=this.#r(c,i,K,J,x,S,1);L=this.#n[2*Q],O=this.#n[2*Q+1];const Z=K+L,ht=J+O;E.push(ht,Z);const vt=K*i+J;if(c[vt+1]===0?c[vt]=-u:c[vt]===1&&(c[vt]=u),Z===m&&ht===b&&K===P&&J===q){c[y]!==1&&(h=Math.abs(c[y]));break}else x=K,S=J,K=Z,J=ht}}}return f}static#s(t,i,s,r){if(s-i<=4){for(let P=i;P<s-2;P+=2)r.push(t[P],t[P+1]);return}const l=t[i],c=t[i+1],u=t[s-4]-l,h=t[s-3]-c,f=Math.hypot(u,h),m=u/f,b=h/f,y=m*c-b*l,A=h/u,x=1/f,S=Math.atan(A),E=Math.cos(S),w=Math.sin(S),R=x*(Math.abs(E)+Math.abs(w)),C=x*(1-R+R**2),k=Math.max(Math.atan(Math.abs(w+E)*C),Math.atan(Math.abs(w-E)*C));let L=0,O=i;for(let P=i+2;P<s-2;P+=2){const q=Math.abs(y-m*t[P+1]+b*t[P]);q>L&&(O=P,L=q)}L>(f*k)**2?(this.#s(t,i,O+2,r),this.#s(t,O,s,r)):r.push(l,c)}static#l(t){const i=[],s=t.length;return this.#s(t,0,s,i),i.push(t[s-2],t[s-1]),i.length<=4?null:i}static#c(t,i,s,r,l,c){const u=new Float32Array(c**2),h=-2*r**2,f=c>>1;for(let S=0;S<c;S++){const E=(S-f)**2;for(let w=0;w<c;w++)u[S*c+w]=Math.exp((E+(w-f)**2)/h)}const m=new Float32Array(256),b=-2*l**2;for(let S=0;S<256;S++)m[S]=Math.exp(S**2/b);const y=t.length,A=new Uint8Array(y),x=new Uint32Array(256);for(let S=0;S<s;S++)for(let E=0;E<i;E++){const w=S*i+E,R=t[w];let C=0,k=0;for(let O=0;O<c;O++){const P=S+O-f;if(!(P<0||P>=s))for(let q=0;q<c;q++){const K=E+q-f;if(K<0||K>=i)continue;const J=t[P*i+K],Q=u[O*c+q]*m[Math.abs(J-R)];C+=J*Q,k+=Q}}const L=A[w]=Math.round(C/k);x[L]++}return[A,x]}static#o(t){const i=new Uint32Array(256);for(const s of t)i[s]++;return i}static#d(t){const i=t.length,s=new Uint8ClampedArray(i>>2);let r=-1/0,l=1/0;for(let u=0,h=s.length;u<h;u++){const f=s[u]=t[u<<2];r=Math.max(r,f),l=Math.min(l,f)}const c=255/(r-l);for(let u=0,h=s.length;u<h;u++)s[u]=(s[u]-l)*c;return s}static#h(t){let i,s=-1/0,r=-1/0;const l=t.findIndex(h=>h!==0);let c=l,u=l;for(i=l;i<256;i++){const h=t[i];h>s&&(i-c>r&&(r=i-c,u=i-1),s=h,c=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:s,height:r}=t,{maxDim:l}=this.#t;let c=s,u=r;if(s>l||r>l){let y=s,A=r,x=Math.log2(Math.max(s,r)/l);const S=Math.floor(x);x=x===S?S-1:S;for(let w=0;w<x;w++){c=Math.ceil(y/2),u=Math.ceil(A/2);const R=new OffscreenCanvas(c,u);R.getContext("2d").drawImage(t,0,0,y,A,0,0,c,u),y=c,A=u,t!==i&&t.close(),t=R.transferToImageBitmap()}const E=Math.min(l/c,l/u);c=Math.round(c*E),u=Math.round(u*E)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const m=f.getImageData(0,0,c,u).data;return[this.#d(m),c,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:s,fontWeight:r},l,c,u,h){let f=new OffscreenCanvas(1,1),m=f.getContext("2d",{alpha:!1});const b=200,y=m.font=`${s} ${r} ${b}px ${i}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:x,actualBoundingBoxAscent:S,actualBoundingBoxDescent:E,fontBoundingBoxAscent:w,fontBoundingBoxDescent:R,width:C}=m.measureText(t),k=1.5,L=Math.ceil(Math.max(Math.abs(A)+Math.abs(x)||0,C)*k),O=Math.ceil(Math.max(Math.abs(S)+Math.abs(E)||b,Math.abs(w)+Math.abs(R)||b)*k);f=new OffscreenCanvas(L,O),m=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),m.font=y,m.filter="grayscale(1)",m.fillStyle="white",m.fillRect(0,0,L,O),m.fillStyle="black",m.fillText(t,L*(k-1)/2,O*(3-k)/2);const P=this.#d(m.getImageData(0,0,L,O).data),q=this.#o(P),K=this.#h(q),J=this.#a(P,L,O,K);return this.processDrawnLines({lines:{curves:J,width:L,height:O},pageWidth:l,pageHeight:c,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,i,s,r,l){const[c,u,h]=this.#f(t),[f,m]=this.#c(c,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),b=this.#h(m),y=this.#a(f,u,h,b);return this.processDrawnLines({lines:{curves:y,width:u,height:h},pageWidth:i,pageHeight:s,rotation:r,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:l,mustSmooth:c,areContours:u}){r%180!==0&&([i,s]=[s,i]);const{curves:h,width:f,height:m}=t,b=t.thickness??0,y=[],A=Math.min(i/f,s/m),x=A/i,S=A/s,E=[];for(const{points:R}of h){const C=c?this.#l(R):R;if(!C)continue;E.push(C);const k=C.length,L=new Float32Array(k),O=new Float32Array(3*(k===2?2:k-2));if(y.push({line:O,points:L}),k===2){L[0]=C[0]*x,L[1]=C[1]*S,O.set([NaN,NaN,NaN,NaN,L[0],L[1]],0);continue}let[P,q,K,J]=C;P*=x,q*=S,K*=x,J*=S,L.set([P,q,K,J],0),O.set([NaN,NaN,NaN,NaN,P,q],0);for(let Q=4;Q<k;Q+=2){const Z=L[Q]=C[Q]*x,ht=L[Q+1]=C[Q+1]*S;O.set(et.createBezierPoints(P,q,K,J,Z,ht),(Q-2)*3),[P,q,K,J]=[K,J,Z,ht]}}if(y.length===0)return null;const w=u?new sh:new Ar;return w.build(y,i,s,1,r,u?0:b,l),{outline:w,newCurves:E,areContours:u,thickness:b,width:f,height:m}}static async compressSignature({outlines:t,areContours:i,thickness:s,width:r,height:l}){let c=1/0,u=-1/0,h=0;for(const C of t){h+=C.length;for(let k=2,L=C.length;k<L;k++){const O=C[k]-C[k-2];c=Math.min(c,O),u=Math.max(u,O)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const m=t.length,b=Yl+ir*m,y=new Uint32Array(b);let A=0;y[A++]=b*Uint32Array.BYTES_PER_ELEMENT+(h-2*m)*f.BYTES_PER_ELEMENT,y[A++]=0,y[A++]=r,y[A++]=l,y[A++]=i?0:1,y[A++]=Math.max(0,Math.floor(s??0)),y[A++]=m,y[A++]=f.BYTES_PER_ELEMENT;for(const C of t)y[A++]=C.length-2,y[A++]=C[0],y[A++]=C[1];const x=new CompressionStream("deflate-raw"),S=x.writable.getWriter();await S.ready,S.write(y);const E=f.prototype.constructor;for(const C of t){const k=new E(C.length-2);for(let L=2,O=C.length;L<O;L++)k[L-2]=C[L]-C[L-2];S.write(k)}S.close();const w=await new Response(x.readable).arrayBuffer(),R=new Uint8Array(w);return Tm(R)}static async decompressSignature(t){try{const i=Sv(t),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),l=r.getWriter();await l.ready,l.write(i).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const C of s)c||=new Uint8Array(new Uint32Array(C.buffer,0,4)[0]),c.set(C,u),u+=C.length;const h=new Uint32Array(c.buffer,0,c.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const m=h[2],b=h[3],y=h[4]===0,A=h[5],x=h[6],S=h[7],E=[],w=(Yl+ir*x)*Uint32Array.BYTES_PER_ELEMENT;let R;switch(S){case Int8Array.BYTES_PER_ELEMENT:R=new Int8Array(c.buffer,w);break;case Int16Array.BYTES_PER_ELEMENT:R=new Int16Array(c.buffer,w);break;case Int32Array.BYTES_PER_ELEMENT:R=new Int32Array(c.buffer,w);break}u=0;for(let C=0;C<x;C++){const k=h[ir*C+Yl],L=new Float32Array(k+2);E.push(L);for(let O=0;O<ir-1;O++)L[O]=h[ir*C+Yl+O+1];for(let O=0;O<k;O++)L[O+2]=L[O]+R[u++]}return{areContours:y,thickness:A,outlines:E,width:m,height:b}}catch(i){return pt(`decompressSignature: ${i}`),null}}}class vh extends e0{constructor(){super(),super.updateProperties({fill:rt._defaultLineColor,"stroke-width":0})}clone(){const t=new vh;return t.updateAll(this),t}}class Ah extends ro{constructor(t){super(t),super.updateProperties({stroke:rt._defaultLineColor,"stroke-width":1})}clone(){const t=new Ah(this._viewParameters);return t.updateAll(this),t}}class _i extends Lt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=mt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){rt.initialize(t,i),this._defaultDrawingOptions=new vh,this._defaultDrawnSignatureOptions=new Ah(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return gt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:r,mustSmooth:l,areContours:c,description:u,uuid:h,heightInPage:f}=this.#n,{rawDims:{pageWidth:m,pageHeight:b},rotation:y}=this.parent.viewport,A=Ys.processDrawnLines({lines:r,pageWidth:m,pageHeight:b,rotation:y,innerMargin:_i._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(A,f,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:l}=this.#n,c=Math.max(r,l),u=Ys.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:s,width:r,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:l,y:c}=this,{outline:u}=this.#n=t;this.#t=u instanceof sh,this.description=s;let h;this.#t?h=_i.getDefaultDrawingOptions():(h=_i._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[,f]=this.pageDimensions;let m=i/f;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return Ys.process(t,i,s,r,_i._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:l}=this.parent.viewport;return Ys.extractContoursFromText(t,i,s,r,l,_i._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return Ys.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:_i._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=_i.getDefaultDrawingOptions():(this._drawingOptions=_i._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:r});return this.addComment(l),t?(l.paths={lines:i,points:s},l.uuid=this.#i,l.isCopy=!0):l.lines=i,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,i,s,r,l,c){return c.areContours?sh.deserialize(t,i,s,r,l,c):Ar.deserialize(t,i,s,r,l,c)}static async deserialize(t,i,s){const r=await super.deserialize(t,i,s);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#i=t.uuid,r}}class r1 extends rt{#t=null;#e=null;#n=null;#i=null;#r=null;#a="";#s=null;#l=!1;#c=null;#o=!1;#d=!1;static _type="stamp";static _editorType=mt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){rt.initialize(t,i)}static isHandlingMimeForPasting(t){return Ku.includes(t)}static paste(t,i){i.pasteEditor({mode:mt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#o=t.isSvg),t.file&&(this.#a=t.file.name),this.#g()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:r,width:l,height:c,channels:r.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#h(r)).finally(()=>this.#f());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(r=>this.#h(r)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Ku.join(",");const i=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e||this.#l)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#l||(this.#t?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,r&&(this.#t=r),this.#l=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#g(){const{div:t}=this;let{width:i,height:s}=this.#t;const[r,l]=this.pageDimensions,c=.75;if(this.width)i=this.width*r,s=this.height*l;else if(i>c*r||s>c*l){const h=Math.min(c*r/i,c*l/s);i*=h,s*=h}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/r,this.height=s/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,s=!1){t||(t=224);const{width:r,height:l}=this.#t,c=new Ti;let u=this.#t,h=r,f=l,m=null;if(i){if(r>i||l>i){const O=Math.min(i/r,i/l);h=Math.floor(r*O),f=Math.floor(l*O)}m=document.createElement("canvas");const y=m.width=Math.ceil(h*c.sx),A=m.height=Math.ceil(f*c.sy);this.#o||(u=this.#u(y,A));const x=m.getContext("2d");x.filter=this._uiManager.hcmFilter;let S="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":Cv.isDarkMode&&(S="#8f8f9d",E="#42414d");const w=15,R=w*c.sx,C=w*c.sy,k=new OffscreenCanvas(R*2,C*2),L=k.getContext("2d");L.fillStyle=S,L.fillRect(0,0,R*2,C*2),L.fillStyle=E,L.fillRect(0,0,R,C),L.fillRect(R,C,R,C),x.fillStyle=x.createPattern(k,"repeat"),x.fillRect(0,0,y,A),x.drawImage(u,0,0,u.width,u.height,0,0,y,A)}let b=null;if(s){let y,A;if(c.symmetric&&u.width<t&&u.height<t)y=u.width,A=u.height;else if(u=this.#t,r>t||l>t){const E=Math.min(t/r,t/l);y=Math.floor(r*E),A=Math.floor(l*E),this.#o||(u=this.#u(y,A))}const S=new OffscreenCanvas(y,A).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,y,A),b={width:y,height:A,data:S.getImageData(0,0,y,A).data}}return{canvas:m,width:h,height:f,imageData:b}}#u(t,i){const{width:s,height:r}=this.#t;let l=s,c=r,u=this.#t;for(;l>2*t||c>2*i;){const h=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*i&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const m=new OffscreenCanvas(l,c);m.getContext("2d").drawImage(u,0,0,h,f,0,0,l,c),u=m.transferToImageBitmap()}return u}#p(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,l=new Ti,c=Math.ceil(s*t*l.sx),u=Math.ceil(r*i*l.sy),h=this.#s;if(!h||h.width===c&&h.height===u)return;h.width=c,h.height=u;const f=this.#o?this.#t:this.#u(c,u),m=h.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#b(t){if(t){if(this.#o){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#o){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*ia.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*ia.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,s){let r=null,l=!1;if(t instanceof Jm){const{data:{rect:S,rotation:E,id:w,structParent:R,popupRef:C,richText:k,contentsObj:L,creationDate:O,modificationDate:P},container:q,parent:{page:{pageNumber:K}},canvas:J}=t;let Q,Z;J?(delete t.canvas,{id:Q,bitmap:Z}=s.imageManager.getFromCanvas(q.id,J),J.remove()):(l=!0,t._hasNoCanvas=!0);const ht=(await i._structTree.getAriaAttributes(`${Xs}${w}`))?.get("aria-label")||"";r=t={annotationType:mt.STAMP,bitmapId:Q,bitmap:Z,pageIndex:K-1,rect:S.slice(0),rotation:E,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:ht},isSvg:!1,structParent:R,popupRef:C,richText:k,comment:L?.str||null,creationDate:O,modificationDate:P}}const c=await super.deserialize(t,i,s),{rect:u,bitmap:h,bitmapUrl:f,bitmapId:m,isSvg:b,accessibilityData:y}=t;l?(s.addMissingCanvas(t.id,c),c.#l=!0):m&&s.imageManager.isValidId(m)?(c.#e=m,h&&(c.#t=h)):c.#i=f,c.#o=b;const[A,x]=c.pageDimensions;return c.width=(u[2]-u[0])/A,c.height=(u[3]-u[1])/x,y&&(c.altTextData=y),c._initialData=r,t.comment&&c.setCommentData(t),c.#d=!!r,c}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#o});if(this.addComment(s),t)return s.bitmapUrl=this.#b(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:l}=this.serializeAltText(!1);if(!r&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||=new Map;const c=this.#o?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:c,serialized:s}),s.bitmap=this.#b(!1);else if(this.#o){const u=i.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#b(!1))}return s}#v(t){const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,l=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Xi{#t;#e=!1;#n=null;#i=null;#r=null;#a=new Map;#s=!1;#l=!1;#c=!1;#o=null;#d=null;#h=null;#f=null;#m=null;#g=-1;#u;static _initialized=!1;static#p=new Map([pe,yh,r1,ne,_i].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:r,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:h,viewport:f,l10n:m}){const b=[...Xi.#p.values()];if(!Xi._initialized){Xi._initialized=!0;for(const y of b)y.initialize(m,t)}t.registerEditorTypes(b),this.#u=t,this.pageIndex=i,this.div=s,this.#t=l,this.#n=c,this.viewport=f,this.#h=h,this.drawLayer=u,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===mt.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#S(),t){case mt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case mt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case mt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===mt.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const s of Xi.#p.values())i.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.togglePointerEvents(t)}get#b(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const s of this.#b)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const i=this.#n;if(i)for(const s of i.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#l=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const r=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:h,timeStamp:f}=l,m=this.#g;if(f-m>500){this.#g=f;return}this.#g=-1;const{classList:b}=this.div;b.toggle("getElements",!0);const y=document.elementsFromPoint(u,h);if(b.toggle("getElements",!1),!this.div.contains(y[0]))return;let A;const x=new RegExp(`^${or}[0-9]+$`);for(const E of y)if(x.test(E.id)){A=E.id;break}if(!A)return;const S=this.#a.get(A);S?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),S.dblclick(l))},{signal:r,capture:!0})}const t=this.#n,i=[];if(t){const r=new Map,l=new Map;for(const u of this.#b){if(u.disableEditing(),!u.annotationElementId){i.push(u);continue}if(u.serialize()!==null){r.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:h}=u.data;if(this.#u.isDeletedAnnotationElement(h)){u.updateEdited({deleted:!0});continue}let f=l.get(h);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=r.get(h),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#S(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of Xi.#p.values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(i),this.#l=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:s}=we.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ne.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#a.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#a.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#l&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),rt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getEditorByUID(t){for(const i of this.#a.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#y(){return Xi.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const i=this.#y;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:r}=this.#w(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:s,y:r,uiManager:this.#u,isCentered:!0,...i});c&&this.add(c)}async deserialize(t){return await Xi.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,s={}){const r=this.getNextId(),l=this.#E({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...s});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:t,y:i,width:s,height:r}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,i),u=Math.min(window.innerWidth,t+s),h=Math.min(window.innerHeight,i+r),f=(l+u)/2-t,m=(c+h)/2-i,[b,y]=this.viewport.rotation%180===0?[f,m]:[m,f];return{offsetX:b,offsetY:y}}addNewEditor(t={}){this.createAndAddNewEditor(this.#w(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=we.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#s||(this.#s=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===mt.STAMP||s===mt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===mt.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:i}=we.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#s=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#o){this.#y.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#o=new AbortController;const i=this.#u.combinedSignal(this.#o);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#y.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#o?(this.#u.setCurrentDrawingSession(null),this.#o.abort(),this.#o=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,i,s){const r=this.#u.findParent(i,s);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#o?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#o&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#a.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#S(){for(const t of this.#a.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ts(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#S();const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,ts(this.div,{rotation:s}),i!==s)for(const r of this.#a.values())r.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class Se{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return gt(this,"_svgFactory",new Zl)}static#r(t,[i,s,r,l]){const{style:c}=t;c.top=`${100*s}%`,c.left=`${100*i}%`,c.width=`${100*r}%`,c.height=`${100*l}%`}#a(){const t=Se._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,i){const s=Se._svgFactory.createElement("clipPath");t.append(s);const r=`clip_${i}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const l=Se._svgFactory.createElement("use");return s.append(l),l.setAttribute("href",`#${i}`),l.classList.add("clip"),r}#l(t,i){for(const[s,r]of Object.entries(i))r===null?t.removeAttribute(s):t.setAttribute(s,r)}draw(t,i=!1,s=!1){const r=Se.#i++,l=this.#a(),c=Se._svgFactory.createElement("defs");l.append(c);const u=Se._svgFactory.createElement("path");c.append(u);const h=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#n.set(r,u);const f=s?this.#s(c,h):null,m=Se._svgFactory.createElement("use");return l.append(m),m.setAttribute("href",`#${h}`),this.updateProperties(l,t),this.#e.set(r,l),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,i){const s=Se.#i++,r=this.#a(),l=Se._svgFactory.createElement("defs");r.append(l);const c=Se._svgFactory.createElement("path");l.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let h;if(i){const b=Se._svgFactory.createElement("mask");l.append(b),h=`mask_p${this.pageIndex}_${s}`,b.setAttribute("id",h),b.setAttribute("maskUnits","objectBoundingBox");const y=Se._svgFactory.createElement("rect");b.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const A=Se._svgFactory.createElement("use");b.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=Se._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const m=f.cloneNode();return r.append(m),f.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(s,r),s}finalizeDraw(t,i){this.#n.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:s,bbox:r,rootClass:l,path:c}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#l(u,s),r&&Se.#r(u,r),l){const{classList:h}=u;for(const[f,m]of Object.entries(l))h.toggle(f,m)}if(c){const f=u.firstElementChild.firstElementChild;this.#l(f,c)}}}updateParent(t,i){if(i===this)return;const s=this.#e.get(t);s&&(i.#t.append(s),this.#e.delete(t),i.#e.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:ih};globalThis.pdfjsLib={AbortException:Cn,AnnotationEditorLayer:Xi,AnnotationEditorParamsType:Ct,AnnotationEditorType:mt,AnnotationEditorUIManager:Mn,AnnotationLayer:bh,AnnotationMode:wn,AnnotationType:ce,applyOpacity:Rv,build:zA,ColorPicker:ui,createValidAbsoluteUrl:xm,CSSConstants:Mv,DOMSVGFactory:Zl,DrawLayer:Se,FeatureTest:we,fetchData:gr,findContrastColor:Dv,getDocument:qm,getFilenameFromUrl:xv,getPdfFilenameFromUrl:wv,getRGB:br,getUuid:Em,getXfaPageViewport:Ev,GlobalWorkerOptions:ta,ImageKind:Xl,InvalidPDFException:Xu,isDataScheme:no,isPdfFile:lh,isValidExplicitDest:jv,MathClamp:Me,noContextMenu:hi,normalizeUnicode:vv,OPS:cr,OutputScale:Ti,PasswordResponses:uv,PDFDataRangeTransport:Ym,PDFDateString:$u,PDFWorker:hr,PermissionFlag:cv,PixelsPerInch:ia,RenderingCancelledException:rh,renderRichText:Mm,ResponseException:Wl,setLayerDimensions:ts,shadow:gt,SignatureExtractor:Ys,stopEvent:Jt,SupportedImageMimeTypes:Ku,TextLayer:Te,TouchManager:so,updateUrlHash:wm,Util:nt,VerbosityLevel:to,version:BA,XfaLayer:Cm};ta.workerSrc=new URL("/smsf-allocation-performance/assets/pdf.worker.min-CXgfMxHN.mjs",import.meta.url).toString();async function l1(p){try{let t;if(p instanceof File)t=await p.arrayBuffer();else if(p instanceof ArrayBuffer)t=p;else throw new Error("Input must be a File or ArrayBuffer");const i=await qm({data:t}).promise,s=[];let r="";for(let l=1;l<=i.numPages;l++){const h=(await(await i.getPage(l)).getTextContent()).items.filter(A=>A.str&&A.str.trim()).map(A=>({text:A.str,x:A.transform[4],y:A.transform[5],width:A.width,height:A.height}));h.sort((A,x)=>{const S=x.y-A.y;return Math.abs(S)>5?S:A.x-x.x});const f=[];let m=[],b=null;for(const A of h)b!==null&&Math.abs(b-A.y)>5&&(m.length>0&&f.push(m.map(x=>x.text).join(" ")),m=[]),m.push(A),b=A.y;m.length>0&&f.push(m.map(A=>A.text).join(" "));const y=f.join(`
`);s.push({pageNumber:l,lines:f,rawText:y}),r+=y+`

`}return{pages:s,fullText:r.trim(),numPages:i.numPages}}catch(t){throw console.error("PDF extraction error:",t),new Error(`Failed to extract text from PDF: ${t.message}`)}}const dm={DEFENSIVE_MAX:30,GROWTH_MIN:70},o1=["Australian Equities","International Equities","Listed Property","Direct Property"],c1=["Australian Fixed Interest","International Fixed Interest","Cash","Foreign Cash","Mortgages"],fm={defensive:{name:"Conservative Benchmark",description:"Weighted average of defensive asset indices",composition:"70% Fixed Interest, 20% Cash, 10% Equities",returns:{oneYear:5.5,threeYears:4.2,fiveYears:3.8,sinceInception:4},riskLevel:"Low",volatility:3.5},balanced:{name:"Balanced Benchmark",description:"Diversified multi-asset benchmark",composition:"50% Equities, 30% Fixed Interest, 15% Property, 5% Cash",returns:{oneYear:8.5,threeYears:6.8,fiveYears:7.2,sinceInception:7},riskLevel:"Medium",volatility:8.5},growth:{name:"Growth Benchmark",description:"High equity exposure benchmark",composition:"80% Equities, 10% Property, 10% Other",returns:{oneYear:11.5,threeYears:9.2,fiveYears:10.5,sinceInception:9.8},riskLevel:"High",volatility:14}},Tn={STRONG_OUTPERFORMANCE:2,SLIGHT_OUTPERFORMANCE:.5,SLIGHT_UNDERPERFORMANCE:-.5,STRONG_UNDERPERFORMANCE:-2,EXCELLENT_RETURN:15,GOOD_RETURN:8,MODERATE_RETURN:4,POOR_RETURN:0},pm={ASSET_ALLOCATION:["investment allocation","asset allocation","allocation as at","current allocation","australian equities","international equities","fixed interest","listed property","cash"],PERFORMANCE:["investment movement","movement and returns","time weighted","time weighted return","twr","opening balance","closing balance","net return"]};function Ws(p){if(!p)return null;const t=p.toString().trim(),i=new Date(t);return isNaN(i)?null:i.toISOString().split("T")[0]}function Sh(p){if(!p)return null;const t=p.toString().replace(/[\$,]/g,"").replace(/\((.*?)\)/,"-$1").trim(),i=parseFloat(t);return isNaN(i)?null:i}function nr(p){if(!p)return null;const t=p.toString().replace("%","").trim(),i=parseFloat(t);return isNaN(i)?null:i}function u1(p,t){console.log("[PerformanceParser] Starting parse...");const i=t.flatMap(h=>h.lines),s=h1(p),r=d1(i),l=f1(i),c=p1(i),u={reportType:"performance",period:s,startingMarketValue:r.startingMarketValue,endingMarketValue:r.endingMarketValue,movementInValue:r.movementInValue,dollarReturnBeforeExpenses:l.totalBeforeExpenses,dollarReturnAfterExpenses:l.totalAfterExpenses,investmentExpenses:l.expenses,twr:c,details:{movementInValue:r,portfolioReturn:l}};return console.log("[PerformanceParser] Parsed result:",u),u}function h1(p){const t=/for\s+the\s+period\s+from\s+(\d{1,2}\s+\w+\s+\d{4})\s+to\s+(\d{1,2}\s+\w+\s+\d{4})/i,i=p.match(t);if(i)return{from:Ws(i[1]),to:Ws(i[2]),rawFrom:i[1],rawTo:i[2]};const s=/period\s+from\s+(\d{1,2}\/\d{1,2}\/\d{4})\s+to\s+(\d{1,2}\/\d{1,2}\/\d{4})/i,r=p.match(s);return r?{from:Ws(r[1]),to:Ws(r[2]),rawFrom:r[1],rawTo:r[2]}:(console.warn("[PerformanceParser] Could not extract period dates"),{from:null,to:null})}function d1(p){const t={startingMarketValue:null,netAddition:null,realisedGainsLosses:null,investmentIncome:null,other:null,endingMarketValue:null,movementInValue:null};let i=!1,s=[];for(const r of p){const l=r.toLowerCase();if(l.includes("movement in value")&&!l.includes("portfolio")){i=!0;continue}if(i&&(l.includes("portfolio value versus")||l.includes("portfolio return")))break;i&&s.push(r)}for(const r of s){const l=r.toLowerCase(),c=r.match(/([0-9,]+\.[0-9]{2}|\([0-9,]+\.[0-9]{2}\))\s*$/),u=c?Sh(c[1]):null;l.includes("starting market value")&&u!==null?t.startingMarketValue=u:(l.includes("net addition")||l.includes("net withdrawal"))&&u!==null?t.netAddition=u:l.includes("realised")&&l.includes("gains")&&u!==null?t.realisedGainsLosses=u:l.includes("investment income")&&u!==null?t.investmentIncome=u:l.includes("other")&&u!==null?t.other=u:l.includes("ending market value")&&u!==null?t.endingMarketValue=u:l.match(/^movement\s+in\s+value/)&&u!==null&&(t.movementInValue=u)}return t}function f1(p){const t={realisedGainsLosses:null,investmentIncome:null,credits:null,totalBeforeExpenses:null,expenses:null,totalAfterExpenses:null};let i=!1,s=[];for(const r of p){const l=r.toLowerCase();if(l.includes("portfolio return")&&!l.includes("investment return")){i=!0;continue}if(i&&(l.includes("return over time")||l.includes("1 year")||l.includes("investment return before expenses")))break;i&&s.push(r)}for(const r of s){const l=r.toLowerCase(),c=r.match(/([0-9,]+\.[0-9]{2}|\([0-9,]+\.[0-9]{2}\))\s*$/),u=c?Sh(c[1]):null;l.includes("realised")&&l.includes("gains")&&u!==null?t.realisedGainsLosses=u:l.includes("investment income")&&u!==null?t.investmentIncome=u:l.includes("credits")&&!l.includes("excluding")&&u!==null?t.credits=u:l.includes("total dollar return before expenses")&&u!==null?t.totalBeforeExpenses=u:l.includes("investment expenses")&&u!==null?t.expenses=u:l.includes("total dollar return after expenses")&&u!==null&&(t.totalAfterExpenses=u)}return t}function p1(p){const t={oneYear:null,threeYears:null,sinceStart:null,sincePeriodStart:null,sinceDates:[]};let i=null,s=null;for(let l=0;l<p.length;l++){const c=p[l],u=c.toLowerCase();if(u.includes("1 year")||u.includes("3 year")){i=c;continue}if(u.includes("investment return before expenses")&&u.includes("twr")){s=c;break}}if(!s)return console.warn("[PerformanceParser] Could not find TWR row"),t;const r=s.match(/(-?\d+\.?\d*%|-)/g);if(r&&r.length>0&&(t.oneYear=nr(r[0]),r.length>1&&(t.threeYears=nr(r[1])),r.length>2&&(t.sinceStart=nr(r[2])),r.length>3&&(t.sincePeriodStart=nr(r[3]))),i){const l=/since\s+(\d{2}\/\d{2}\/\d{4})/gi;let c,u=2;for(;(c=l.exec(i))!==null;)r&&r[u]&&t.sinceDates.push({date:Ws(c[1]),rawDate:c[1],value:nr(r[u])}),u++}return t}const gm=["Australian Equities","Australian Fixed Interest","Cash","International Equities","Listed Property","Other","Unknown"];function g1(p,t){console.log("[AssetAllocationParser] Parsing TOTAL allocation row");const i=y1(p),s=m1(t);if(!s)return console.warn("[AssetAllocationParser] TOTAL row not found"),{reportType:"asset_allocation",asAtDate:i,totalValue:null,assetClasses:[],holdings:[],holdingsCount:0};const r=b1(s),l=r.reduce((c,u)=>c+(u.value||0),0);return{reportType:"asset_allocation",asAtDate:i,totalValue:l,assetClasses:r,holdings:[],holdingsCount:0}}function m1(p){for(const t of p)for(const i of t.lines)if(i.toLowerCase().startsWith("total"))return i;return null}function b1(p){const t=p.match(/\$?[0-9,]+\.\d{2}/g)||[],i=p.match(/\d+\.?\d*%/g)||[],s=[];for(let r=0;r<gm.length;r++){const l=t[r]?Sh(t[r]):null,c=i[r]?Number(i[r].replace("%","")):null;(l!=null||c!=null)&&s.push({name:gm[r],value:l,percent:c,source:"total_row"})}return s}function y1(p){const t=[/as\s+at\s+(\d{1,2}\s+\w+\s+\d{4})/i,/as\s+at\s+(\d{1,2}\/\d{1,2}\/\d{4})/i];for(const i of t){const s=p.match(i);if(s)return Ws(s[1])}return null}const i0={performance:{name:"Investment Movement and Returns Report",fingerprints:pm.PERFORMANCE,parser:u1,minMatchCount:1},asset_allocation:{name:"Investment Allocation Report",fingerprints:pm.ASSET_ALLOCATION,parser:g1,minMatchCount:1}};function n0(p){const t=p.toLowerCase();let i=null,s=0;for(const[r,l]of Object.entries(i0)){const c=l.fingerprints.filter(h=>t.includes(h.toLowerCase())).length,u=c/l.fingerprints.length*100;c>=l.minMatchCount&&u>s&&(s=u,i={type:r,confidence:u,name:l.name,matchCount:c,totalFingerprints:l.fingerprints.length})}return i}async function v1(p){const{fullText:t,pages:i}=p,s=n0(t);if(!s)throw new Error("Could not identify report type. Please ensure this is a supported CLASS Super report (Investment Allocation or Movement and Returns).");console.log(`[Registry] Identified report as: ${s.name} (${s.confidence.toFixed(1)}% confidence)`);const r=i0[s.type];if(!r||!r.parser)throw new Error(`No parser registered for report type: ${s.type}`);const l=await r.parser(t,i);return{reportType:s.type,reportName:s.name,confidence:s.confidence,data:l}}const Gs=[{id:1,key:"asset_allocation",title:"Asset Allocation Report",description:"Upload the Investment Allocation PDF",expectedType:"asset_allocation"},{id:2,key:"performance",title:"Performance Report",description:"Upload the Investment Movement and Returns PDF",expectedType:"performance"}];function A1({hasAnyUpload:p}){return p?null:T.jsxs("div",{className:"mb-8",children:[T.jsxs("div",{className:"relative overflow-hidden rounded-xl bg-[#1a1f2e] border border-slate-700/50 p-8 md:p-10",children:[T.jsx("div",{className:"absolute inset-0 opacity-[0.02]",style:{backgroundImage:"linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px)",backgroundSize:"32px 32px"}}),T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"inline-flex items-center gap-2 mb-6",children:T.jsx("span",{className:"text-[10px] font-semibold text-slate-400 tracking-[0.2em] uppercase",children:"Document Upload"})}),T.jsx("h1",{className:"text-2xl md:text-3xl font-semibold text-white mb-2 tracking-tight",children:"Portfolio Report Intake"}),T.jsx("p",{className:"text-slate-400 text-sm md:text-base max-w-xl leading-relaxed mb-8",children:"Upload your portfolio documents to generate consolidated analysis and performance metrics."}),T.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[T.jsx(mm,{number:"1",title:"Asset Allocation",description:"Current holdings breakdown by asset class",icon:T.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]})}),T.jsx(mm,{number:"2",title:"Performance Report",description:"Time-weighted returns and movement history",icon:T.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})]})]})]}),T.jsxs("div",{className:"mt-4 flex items-start gap-2 px-1",children:[T.jsx("svg",{className:"w-3.5 h-3.5 text-slate-500 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m0 0v2m0-2h2m-2 0H10m2-10V5m0 0V3m0 2h2m-2 0H10"})}),T.jsx("p",{className:"text-[11px] text-slate-500 leading-relaxed",children:"Documents are processed locally and not stored externally."})]})]})}function mm({number:p,title:t,description:i,icon:s}){return T.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg bg-slate-800/30 border border-slate-700/30",children:[T.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-md bg-slate-700/50 flex items-center justify-center text-slate-400",children:s}),T.jsxs("div",{className:"min-w-0",children:[T.jsx("div",{className:"flex items-center gap-2 mb-0.5",children:T.jsxs("span",{className:"text-[9px] font-semibold text-emerald-400/80 uppercase tracking-wider",children:["Step ",p]})}),T.jsx("h3",{className:"font-medium text-white text-sm mb-0.5",children:t}),T.jsx("p",{className:"text-[11px] text-slate-500 leading-relaxed",children:i})]})]})}function S1({hasAnyUpload:p}){return p?T.jsx("div",{className:"mb-6 flex items-center justify-between",children:T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"w-9 h-9 rounded-lg bg-slate-800/80 border border-slate-700/50 flex items-center justify-center",children:T.jsx("svg",{className:"w-4 h-4 text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),T.jsxs("div",{children:[T.jsx("h2",{className:"font-medium text-white text-base",children:"Portfolio Report Intake"}),T.jsx("p",{className:"text-[11px] text-slate-500",children:"Upload both reports to generate analysis"})]})]})}):null}function x1({onComplete:p,onPartialData:t}){const[i,s]=Zt.useState(1),[r,l]=Zt.useState({asset_allocation:"idle",performance:"idle"}),[c,u]=Zt.useState({asset_allocation:null,performance:null}),[h,f]=Zt.useState({asset_allocation:null,performance:null}),m=Zt.useCallback(async(x,S,E)=>{if(S){f(w=>({...w,[E]:S})),l(w=>({...w,[E]:"error"}));return}if(x){l(w=>({...w,[E]:"processing"})),f(w=>({...w,[E]:null}));try{console.log(`[UploadWizard] Extracting text from ${x.name}...`);const w=await l1(x);if(!w.fullText||w.fullText.length<100)throw new Error("Could not extract text from PDF. The file may be image-based or corrupted.");const R=n0(w.fullText);console.log(`[UploadWizard] Identified as: ${R?.type||"unknown"}`);const C=Gs.find(O=>O.key===E);if(R?.type!==C.expectedType){const O=C.title,P=R?.name||"Unknown report type";throw new Error(`This appears to be a ${P}. Please upload a ${O} for this step.`)}const k=await v1(w);console.log(`[UploadWizard] Parsed ${E}:`,k);const L={...c,[E]:k.data};u(L),l(O=>({...O,[E]:"success"})),t&&t(E,k.data),i<Gs.length&&setTimeout(()=>s(i+1),500),E==="performance"&&L.asset_allocation?p&&p(L):E==="asset_allocation"&&L.performance&&p&&p(L)}catch(w){console.error(`[UploadWizard] Error processing ${E}:`,w),f(R=>({...R,[E]:w.message})),l(R=>({...R,[E]:"error"}))}}},[i,c,p,t]),b=Zt.useCallback(x=>{u(S=>({...S,[x]:null})),l(S=>({...S,[x]:null})),f(S=>({...S,[x]:null}))},[]),y=c.asset_allocation&&c.performance,A=r.asset_allocation!=="idle"||r.performance!=="idle";return T.jsxs("div",{className:"max-w-4xl mx-auto",children:[T.jsx(A1,{hasAnyUpload:A}),T.jsx(S1,{hasAnyUpload:A}),T.jsxs("div",{className:"space-y-6",children:[T.jsx("div",{className:"flex items-center justify-center py-2",children:T.jsx("div",{className:"flex items-center gap-3",children:Gs.map((x,S)=>T.jsxs(Ly.Fragment,{children:[T.jsx(w1,{step:x,isActive:i===x.id,isComplete:r[x.key]==="success",hasError:r[x.key]==="error",onClick:()=>s(x.id)}),S<Gs.length-1&&T.jsx("div",{className:`w-12 md:w-20 h-[2px] rounded-full transition-all duration-500 ${r[Gs[S].key]==="success"?"bg-emerald-500":"bg-slate-700"}`})]},x.id))})}),T.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:Gs.map(x=>T.jsx(_1,{step:x,status:r[x.key],error:h[x.key],isActive:i===x.id,parsedData:c[x.key],onFileUpload:(S,E)=>m(S,E,x.key),onReset:()=>b(x.key)},x.key))}),y&&T.jsxs("div",{className:"text-center p-6 bg-[#1a1f2e] rounded-xl border border-emerald-500/20",children:[T.jsx("div",{className:"w-12 h-12 rounded-full bg-emerald-500/10 border border-emerald-500/30 flex items-center justify-center mx-auto mb-3",children:T.jsx("svg",{className:"w-5 h-5 text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),T.jsx("p",{className:"text-white font-medium text-sm",children:"Reports Uploaded Successfully"}),T.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Analysis is ready below"})]})]})]})}function w1({step:p,isActive:t,isComplete:i,hasError:s,onClick:r}){let l="bg-slate-800 text-slate-500 border-slate-700";return i?l="bg-emerald-500/20 text-emerald-400 border-emerald-500/50":s?l="bg-red-500/20 text-red-400 border-red-500/50":t&&(l="bg-slate-700 text-white border-slate-500"),T.jsxs("div",{className:"flex flex-col items-center gap-2",children:[T.jsx("button",{onClick:r,className:`
          flex items-center justify-center w-10 h-10 rounded-lg border
          ${l}
          font-medium text-sm transition-all duration-200 cursor-pointer
          hover:scale-105 active:scale-95
        `,children:i?T.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}):p.id}),T.jsx("span",{className:`text-[10px] font-medium tracking-wide transition-colors ${t||i?"text-slate-300":"text-slate-600"}`,children:p.key==="asset_allocation"?"Allocation":"Performance"})]})}function _1({step:p,status:t,error:i,isActive:s,parsedData:r,onFileUpload:l,onReset:c}){const u=t==="success",h=t==="error";return T.jsxs("div",{className:`
      rounded-xl border transition-all duration-300 overflow-hidden
      ${s&&!u?"border-slate-600 bg-[#1a1f2e]":""}
      ${u?"border-emerald-500/30 bg-[#1a1f2e]":""}
      ${h?"border-red-500/30 bg-[#1a1f2e]":""}
      ${!s&&!u&&!h?"border-slate-700/50 bg-[#141820]":""}
    `,children:[T.jsxs("div",{className:`
        px-4 py-3 border-b flex items-center justify-between transition-colors
        ${u?"bg-emerald-500/5 border-emerald-500/20":"bg-slate-800/30 border-slate-700/50"}
      `,children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:`
            w-8 h-8 rounded-md flex items-center justify-center
            ${u?"bg-emerald-500/20":"bg-slate-700/50"}
          `,children:p.key==="asset_allocation"?T.jsxs("svg",{className:`w-4 h-4 ${u?"text-emerald-400":"text-slate-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}):T.jsx("svg",{className:`w-4 h-4 ${u?"text-emerald-400":"text-slate-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),T.jsxs("div",{children:[T.jsx("h3",{className:"font-medium text-white text-sm",children:p.title}),T.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-wider",children:p.description})]})]}),u&&T.jsx("button",{onClick:c,className:"p-1.5 text-slate-500 hover:text-slate-300 hover:bg-slate-700/50 rounded-md transition-colors",title:"Upload different file",children:T.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),T.jsxs("div",{className:"p-4",children:[T.jsx(ov,{onFileSelect:l,status:t,label:null,description:"PDF files only",errorMessage:i,acceptedFileName:u?`${p.title} loaded`:null}),u&&r&&T.jsx(E1,{type:p.key,data:r})]})]})}function E1({type:p,data:t}){const i=s=>s==null?"":new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s);return p==="asset_allocation"&&t?T.jsxs("div",{className:"mt-4 p-3 bg-slate-800/30 rounded-lg border border-slate-700/30",children:[T.jsxs("div",{className:"flex items-center gap-2 text-emerald-400 mb-3",children:[T.jsx("div",{className:"w-4 h-4 rounded bg-emerald-500/20 flex items-center justify-center",children:T.jsx("svg",{className:"w-2.5 h-2.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})}),T.jsx("span",{className:"font-medium text-xs",children:"Extracted Data"})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsx(xn,{label:"Asset Classes",value:t.assetClasses?.length||0}),T.jsx(xn,{label:"Holdings",value:t.holdings?.length||0}),T.jsx(xn,{label:"Total Value",value:i(t.totalValue),highlight:!0}),T.jsx(xn,{label:"As At Date",value:t.asAtDate||"N/A"})]})]}):p==="performance"&&t?T.jsxs("div",{className:"mt-4 p-3 bg-slate-800/30 rounded-lg border border-slate-700/30",children:[T.jsxs("div",{className:"flex items-center gap-2 text-emerald-400 mb-3",children:[T.jsx("div",{className:"w-4 h-4 rounded bg-emerald-500/20 flex items-center justify-center",children:T.jsx("svg",{className:"w-2.5 h-2.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})}),T.jsx("span",{className:"font-medium text-xs",children:"Extracted Data"})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsx(xn,{label:"Period",value:`${t.period?.from||"N/A"}  ${t.period?.to||"N/A"}`,fullWidth:!0}),T.jsx(xn,{label:"1Y TWR",value:t.twr?.oneYear!=null?`${t.twr.oneYear}%`:"N/A",highlight:!0}),T.jsx(xn,{label:"Ending Value",value:i(t.endingMarketValue)}),T.jsx(xn,{label:"Net Return",value:i(t.dollarReturnAfterExpenses),fullWidth:!0})]})]}):null}function xn({label:p,value:t,highlight:i,fullWidth:s}){return T.jsxs("div",{className:s?"col-span-2":"",children:[T.jsx("p",{className:"text-[9px] text-slate-500 uppercase tracking-wider mb-0.5",children:p}),T.jsx("p",{className:`text-xs font-medium tabular-nums ${i?"text-emerald-400":"text-white"}`,children:t})]})}function _n(p){const t=typeof p=="number"?p:Number(p);return Number.isFinite(t)?t:0}function Hu(p){return Number.isFinite(p)?p:0}function Gu(p){return Math.round(p*10)/10}function s0(p=[]){if(!Array.isArray(p)||p.length===0)return{classification:"unknown",growthPercent:0,defensivePercent:0,otherPercent:0};const t=p.reduce((h,f)=>h+_n(f?.value),0);if(t<=0)return{classification:"unknown",growthPercent:0,defensivePercent:0,otherPercent:0};const i=p.filter(h=>o1.includes(h?.name)).reduce((h,f)=>h+_n(f?.value),0),s=p.filter(h=>c1.includes(h?.name)).reduce((h,f)=>h+_n(f?.value),0),r=i/t*100,l=s/t*100,c=Math.max(0,100-r-l);let u="balanced";return r<dm.DEFENSIVE_MAX?u="defensive":r>dm.GROWTH_MIN&&(u="growth"),{classification:u,growthPercent:Gu(Hu(r)),defensivePercent:Gu(Hu(l)),otherPercent:Gu(Hu(c))}}function T1(p){return fm[typeof p=="string"?p:"balanced"]??fm.balanced}function C1(p,t){const i={oneYear:null,threeYears:null,sinceInception:null};if(!p||!t?.returns)return i;const s=p.oneYear,r=p.threeYears,l=p.sinceStart;if(s!=null&&t.returns.oneYear!==void 0){const c=s-t.returns.oneYear;i.oneYear={fundReturn:s,benchmarkReturn:t.returns.oneYear,difference:c,status:Vu(c)}}if(r!=null&&t.returns.threeYears!==void 0){const c=r-t.returns.threeYears;i.threeYears={fundReturn:r,benchmarkReturn:t.returns.threeYears,difference:c,status:Vu(c)}}if(l!=null&&t.returns.sinceInception!==void 0){const c=l-t.returns.sinceInception;i.sinceInception={fundReturn:l,benchmarkReturn:t.returns.sinceInception,difference:c,status:Vu(c)}}return i}function Vu(p){return p>=Tn.STRONG_OUTPERFORMANCE?"strong_outperformance":p>=Tn.SLIGHT_OUTPERFORMANCE?"slight_outperformance":p>=Tn.SLIGHT_UNDERPERFORMANCE?"inline":p>=Tn.STRONG_UNDERPERFORMANCE?"slight_underperformance":"strong_underperformance"}function M1(p,t){const i=!!p&&Array.isArray(p.assetClasses)&&p.assetClasses.length>0,s=!!t&&!!t.twr,r=i?s0(p.assetClasses):{classification:"unknown",growthPercent:0,defensivePercent:0,otherPercent:0},l=T1(r.classification),c=s?{oneYear:t.twr.oneYear??null,threeYears:t.twr.threeYears??null,sinceStart:t.twr.sinceStart??null}:null,u=c?C1(c,l):null,h=R1(t,u),f=D1(p,t,r,u,{hasAllocation:i});return{classification:r,benchmark:{name:l.name,description:l.description,composition:l.composition,riskLevel:l.riskLevel},benchmarkComparison:u,performanceScore:h,insights:f,status:i&&s?"complete":"partial",message:i&&s?null:"Upload both reports for complete analysis. Cannot classify fund without asset allocation data."}}function R1(p,t){if(!p||!t)return null;let i=50;if(t.oneYear){const r=t.oneYear.difference;i+=Math.min(Math.max(r*5,-25),25)}const s=p.twr?.oneYear;return s!=null&&(s>=Tn.EXCELLENT_RETURN?i+=15:s>=Tn.GOOD_RETURN?i+=10:s>=Tn.MODERATE_RETURN?i+=5:s<Tn.POOR_RETURN&&(i-=10)),Math.min(Math.max(Math.round(i),0),100)}function D1(p,t,i,s,r){const l=[];if(r?.hasAllocation||l.push({type:"data",title:"Asset Allocation Missing",description:"Asset allocation data was not detected. Please upload the Investment Allocation report to enable classification and allocation insights.",importance:"high"}),i?.classification&&i.classification!=="unknown"){const u=i.classification.charAt(0).toUpperCase()+i.classification.slice(1),h=typeof i.growthPercent=="number"&&Number.isFinite(i.growthPercent)?`${i.growthPercent.toFixed(1)}%`:"N/A";l.push({type:"classification",title:`${u} Investment Profile`,description:`With ${h} in growth assets, this fund follows a ${i.classification} strategy.`,importance:"high"})}if(s?.oneYear){const u=s.oneYear.difference,h=s.oneYear.status;let f;h.includes("outperformance")?f=`The fund outperformed its benchmark by ${Math.abs(u).toFixed(2)}% over the past year.`:h==="inline"?f="The fund performed in line with its benchmark over the past year.":f=`The fund underperformed its benchmark by ${Math.abs(u).toFixed(2)}% over the past year.`,l.push({type:"performance",title:"Benchmark Comparison",description:f,importance:h.includes("strong")?"high":"medium"})}if(p?.holdings&&Array.isArray(p.holdings)){const u=[...p.holdings].sort((h,f)=>_n(f?.value)-_n(h?.value)).slice(0,5);if(u.length>0&&_n(p.totalValue)>0){const f=u.reduce((m,b)=>m+_n(b?.value),0)/_n(p.totalValue)*100;f>40&&l.push({type:"concentration",title:"Portfolio Concentration",description:`The top 5 holdings represent ${f.toFixed(1)}% of the portfolio. Consider reviewing diversification.`,importance:"medium"})}}const c=t?.dollarReturnAfterExpenses??t?.dollarReturn??null;if(c!=null){const u=c>0;l.push({type:"return",title:"Total Dollar Return",description:`The fund ${u?"gained":"lost"} $${Math.abs(c).toLocaleString()} during the reporting period.`,importance:"high"})}return l}function N1(p){const t={defensive:{bgColor:"bg-green-100",textColor:"text-green-800",borderColor:"border-green-200",icon:""},balanced:{bgColor:"bg-amber-100",textColor:"text-amber-800",borderColor:"border-amber-200",icon:""},growth:{bgColor:"bg-red-100",textColor:"text-red-800",borderColor:"border-red-200",icon:""},unknown:{bgColor:"bg-gray-100",textColor:"text-gray-800",borderColor:"border-gray-200",icon:""}};return t[p]||t.unknown}function bm(p,{assetAllocation:t,performance:i}){const s=M1(t,i),r=k1(i?.twr);return{fundId:p,lastUpdated:new Date().toISOString(),assetAllocation:t?{asAtDate:t.asAtDate,totalValue:t.totalValue,assetClasses:L1(t.assetClasses,t.totalValue),holdings:t.holdings||[],holdingsCount:t.holdingsCount||t.holdings?.length||0}:null,performance:i?{period:O1(i.period),startingValue:i.startingMarketValue??i.startingValue??null,endingValue:i.endingMarketValue??i.endingValue??null,dollarReturn:i.dollarReturnAfterExpenses??i.dollarReturn??null,twr:r}:null,classification:{classification:s.classification?.classification||"unknown",growthPercent:s.classification?.growthPercent??0,defensivePercent:s.classification?.defensivePercent??0,otherPercent:s.classification?.otherPercent??0},benchmark:s.benchmark?{name:s.benchmark.name||"Benchmark",description:s.benchmark.description||"",composition:s.benchmark.composition||null,riskLevel:s.benchmark.riskLevel||null}:null,benchmarkComparison:s.benchmarkComparison||null,performanceScore:s.performanceScore,derivedInsights:s.insights||[],analysisStatus:s.status||"unknown",analysisMessage:s.message||null}}function L1(p,t){return!Array.isArray(p)||p.length===0?[]:p.map(i=>{const s=i.value??0;let r=i.percent;return r==null&&t>0&&(r=s/t*100),{name:i.name||"Unknown",value:s,percent:r??0,source:i.source||"parsed"}})}function O1(p){return p?{start:p.start||p.startDate||null,end:p.end||p.endDate||null}:{start:null,end:null}}function k1(p){return p?{oneYear:p.oneYear??p["1year"]??p["1Year"]??null,threeYears:p.threeYears??p["3years"]??p["3Years"]??null,fiveYears:p.fiveYears??p["5years"]??p["5Years"]??null,sinceStart:p.sinceStart??p.sinceInception??p.inception??null}:null}function ym(p){const t=Date.now(),i=B1(JSON.stringify(p));return`FUND-${t}-${i}`}function B1(p){let t=0;for(let i=0;i<p.length;i++){const s=p.charCodeAt(i);t=(t<<5)-t+s,t=t&t}return Math.abs(t).toString(16).substring(0,8)}function vm(p){const t=[],i=[];return!p.assetAllocation&&!p.performance&&t.push("Fund must have at least one report type parsed"),(!p.classification||p.classification.classification==="unknown")&&(p.assetAllocation?i.push("Fund classification could not be determined"):i.push("Cannot classify fund without asset allocation data")),p.performance&&!p.benchmarkComparison&&i.push("Benchmark comparison not available"),p.assetAllocation&&((!p.assetAllocation.totalValue||p.assetAllocation.totalValue<=0)&&i.push("Total portfolio value is missing or zero"),(!p.assetAllocation.assetClasses||p.assetAllocation.assetClasses.length===0)&&i.push("Asset class breakdown is missing")),p.performance&&(p.performance.dollarReturn===null&&i.push("Dollar return figure is missing"),(!p.performance.twr||p.performance.twr.oneYear===null)&&i.push("1-year TWR is missing")),{valid:t.length===0,errors:t,warnings:i,hasAssetAllocation:!!p.assetAllocation,hasPerformance:!!p.performance,isComplete:!!p.assetAllocation&&!!p.performance}}function z1(p=[]){return s0(p)}function P1(){const[p,t]=Zt.useState(null),[i,s]=Zt.useState(null),[r,l]=Zt.useState(!1),[c,u]=Zt.useState(!1),[h,f]=Zt.useState(!1),m=Zt.useCallback(x=>{const S=ym(x),E=bm(S,{assetAllocation:x.asset_allocation,performance:x.performance});E.assetAllocation?.assetClasses?.length&&(E.classification=z1(E.assetAllocation.assetClasses));const w=vm(E);t(E),s(w),w.isComplete&&(l(!0),f(!0))},[]),b=Zt.useCallback((x,S)=>{console.log(`[App] Partial data received: ${x}`);const E=ym({[x]:S}),w=bm(E,{assetAllocation:x==="asset_allocation"?S:null,performance:x==="performance"?S:null}),R=vm(w);t(w),s(R)},[]),y=Zt.useCallback(()=>{t(null),s(null),l(!1),u(!1)},[]),A=Zt.useCallback(()=>{if(!p)return;const x=JSON.stringify(p,null,2),S=new Blob([x],{type:"application/json"}),E=URL.createObjectURL(S),w=document.createElement("a");w.href=E,w.download=`fund-analysis-${p.fundId}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(E)},[p]);return p&&N1(p.classification?.classification),h&&p&&i?.isComplete?T.jsx(qy,{fund:p,onReset:()=>{f(!1),t(null),s(null),l(!1),u(!1)}}):T.jsxs("div",{className:"min-h-screen bg-gray-50",children:[T.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-50",children:T.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4",children:T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:T.jsx(Ug,{className:"w-6 h-6 text-blue-600"})}),T.jsxs("div",{children:[T.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"SMSF Intelligence Platform"}),T.jsx("p",{className:"text-sm text-gray-500",children:"PDF Report Analysis"})]})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[p&&T.jsxs(T.Fragment,{children:[T.jsx("button",{onClick:()=>u(!c),className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:c?"Hide JSON":"View JSON"}),T.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[T.jsx(sv,{className:"w-4 h-4"}),"Export"]})]}),T.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-3 py-2 text-sm text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:[T.jsx(lv,{className:"w-4 h-4"}),"New Analysis"]})]})]})})}),T.jsxs("main",{className:"max-w-6xl mx-auto px-4 py-8",children:[T.jsx("section",{className:"mb-8 transition-all duration-300 ",children:T.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[T.jsxs("button",{onClick:()=>l(!r),className:"w-full px-6 py-4 flex items-center justify-between bg-gray-50 border-b border-gray-200 hover:bg-gray-100 transition-colors",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Upload Reports"}),i?.isComplete&&T.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"Complete"})]}),r?T.jsx(tv,{className:"w-5 h-5 text-gray-500"}):T.jsx(iv,{className:"w-5 h-5 text-gray-500"})]}),!r&&T.jsx("div",{className:"p-6",children:T.jsx(x1,{onComplete:m,onPartialData:b})})]})}),!p&&T.jsxs("div",{className:"text-center py-12 text-gray-500",children:[T.jsx(Ug,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),T.jsx("p",{className:"text-lg",children:"Upload your SMSF reports to begin analysis"}),T.jsx("p",{className:"text-sm mt-2",children:"Start with the Asset Allocation report, then upload the Performance report"})]})]}),T.jsx("footer",{className:"border-t border-gray-200 bg-white mt-12",children:T.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6",children:T.jsx("p",{className:"text-center text-sm text-gray-500",children:"SMSF Intelligence Platform  Local PDF Processing  No Cloud Services"})})})]})}Uy.createRoot(document.getElementById("root")).render(T.jsx(Zt.StrictMode,{children:T.jsx(P1,{})}));
