var xg=p=>{throw TypeError(p)};var wu=(p,t,i)=>t.has(p)||xg("Cannot "+i);var Yt=(p,t,i)=>(wu(p,t,"read from private field"),i?i.call(p):t.get(p)),Ai=(p,t,i)=>t.has(p)?xg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(p):t.set(p,i),ze=(p,t,i,s)=>(wu(p,t,"write to private field"),s?s.call(p,i):t.set(p,i),i),Si=(p,t,i)=>(wu(p,t,"access private method"),i);var _g=(p,t,i,s)=>({set _(r){ze(p,t,r,i)},get _(){return Yt(p,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=i(r);fetch(r.href,l)}})();function Ty(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var Eu={exports:{}},$a={};var wg;function Cy(){if(wg)return $a;wg=1;var p=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var u in r)u!=="key"&&(l[u]=r[u])}else l=r;return r=l.ref,{$$typeof:p,type:s,key:c,ref:r!==void 0?r:null,props:l}}return $a.Fragment=t,$a.jsx=i,$a.jsxs=i,$a}var Eg;function My(){return Eg||(Eg=1,Eu.exports=Cy()),Eu.exports}var R=My(),Tu={exports:{}},ft={};var Tg;function Ry(){if(Tg)return ft;Tg=1;var p=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),y=Symbol.iterator;function A(D){return D===null||typeof D!="object"?null:(D=y&&D[y]||D["@@iterator"],typeof D=="function"?D:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function w(D,H,$){this.props=D,this.context=H,this.refs=E,this.updater=$||x}w.prototype.isReactComponent={},w.prototype.setState=function(D,H){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,H,"setState")},w.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function M(){}M.prototype=w.prototype;function T(D,H,$){this.props=D,this.context=H,this.refs=E,this.updater=$||x}var L=T.prototype=new M;L.constructor=T,S(L,w.prototype),L.isPureReactComponent=!0;var O=Array.isArray;function k(){}var z={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function K(D,H,$){var tt=$.ref;return{$$typeof:p,type:D,key:H,ref:tt!==void 0?tt:null,props:$}}function J(D,H){return K(D.type,H,D.props)}function W(D){return typeof D=="object"&&D!==null&&D.$$typeof===p}function Z(D){var H={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function($){return H[$]})}var ht=/\/+/g;function vt(D,H){return typeof D=="object"&&D!==null&&D.key!=null?Z(""+D.key):H.toString(36)}function At(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(k,k):(D.status="pending",D.then(function(H){D.status==="pending"&&(D.status="fulfilled",D.value=H)},function(H){D.status==="pending"&&(D.status="rejected",D.reason=H)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function P(D,H,$,tt,lt){var ut=typeof D;(ut==="undefined"||ut==="boolean")&&(D=null);var ot=!1;if(D===null)ot=!0;else switch(ut){case"bigint":case"string":case"number":ot=!0;break;case"object":switch(D.$$typeof){case p:case t:ot=!0;break;case m:return ot=D._init,P(ot(D._payload),H,$,tt,lt)}}if(ot)return lt=lt(D),ot=tt===""?"."+vt(D,0):tt,O(lt)?($="",ot!=null&&($=ot.replace(ht,"$&/")+"/"),P(lt,H,$,"",function(Mn){return Mn})):lt!=null&&(W(lt)&&(lt=J(lt,$+(lt.key==null||D&&D.key===lt.key?"":(""+lt.key).replace(ht,"$&/")+"/")+ot)),H.push(lt)),1;ot=0;var te=tt===""?".":tt+":";if(O(D))for(var jt=0;jt<D.length;jt++)tt=D[jt],ut=te+vt(tt,jt),ot+=P(tt,H,$,ut,lt);else if(jt=A(D),typeof jt=="function")for(D=jt.call(D),jt=0;!(tt=D.next()).done;)tt=tt.value,ut=te+vt(tt,jt++),ot+=P(tt,H,$,ut,lt);else if(ut==="object"){if(typeof D.then=="function")return P(At(D),H,$,tt,lt);throw H=String(D),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return ot}function V(D,H,$){if(D==null)return D;var tt=[],lt=0;return P(D,tt,"","",function(ut){return H.call($,ut,lt++)}),tt}function Q(D){if(D._status===-1){var H=D._result;H=H(),H.then(function($){(D._status===0||D._status===-1)&&(D._status=1,D._result=$)},function($){(D._status===0||D._status===-1)&&(D._status=2,D._result=$)}),D._status===-1&&(D._status=0,D._result=H)}if(D._status===1)return D._result.default;throw D._result}var dt=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},St={map:V,forEach:function(D,H,$){V(D,function(){H.apply(this,arguments)},$)},count:function(D){var H=0;return V(D,function(){H++}),H},toArray:function(D){return V(D,function(H){return H})||[]},only:function(D){if(!W(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return ft.Activity=b,ft.Children=St,ft.Component=w,ft.Fragment=i,ft.Profiler=r,ft.PureComponent=T,ft.StrictMode=s,ft.Suspense=h,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=z,ft.__COMPILER_RUNTIME={__proto__:null,c:function(D){return z.H.useMemoCache(D)}},ft.cache=function(D){return function(){return D.apply(null,arguments)}},ft.cacheSignal=function(){return null},ft.cloneElement=function(D,H,$){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var tt=S({},D.props),lt=D.key;if(H!=null)for(ut in H.key!==void 0&&(lt=""+H.key),H)!q.call(H,ut)||ut==="key"||ut==="__self"||ut==="__source"||ut==="ref"&&H.ref===void 0||(tt[ut]=H[ut]);var ut=arguments.length-2;if(ut===1)tt.children=$;else if(1<ut){for(var ot=Array(ut),te=0;te<ut;te++)ot[te]=arguments[te+2];tt.children=ot}return K(D.type,lt,tt)},ft.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:l,_context:D},D},ft.createElement=function(D,H,$){var tt,lt={},ut=null;if(H!=null)for(tt in H.key!==void 0&&(ut=""+H.key),H)q.call(H,tt)&&tt!=="key"&&tt!=="__self"&&tt!=="__source"&&(lt[tt]=H[tt]);var ot=arguments.length-2;if(ot===1)lt.children=$;else if(1<ot){for(var te=Array(ot),jt=0;jt<ot;jt++)te[jt]=arguments[jt+2];lt.children=te}if(D&&D.defaultProps)for(tt in ot=D.defaultProps,ot)lt[tt]===void 0&&(lt[tt]=ot[tt]);return K(D,ut,lt)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(D){return{$$typeof:u,render:D}},ft.isValidElement=W,ft.lazy=function(D){return{$$typeof:m,_payload:{_status:-1,_result:D},_init:Q}},ft.memo=function(D,H){return{$$typeof:f,type:D,compare:H===void 0?null:H}},ft.startTransition=function(D){var H=z.T,$={};z.T=$;try{var tt=D(),lt=z.S;lt!==null&&lt($,tt),typeof tt=="object"&&tt!==null&&typeof tt.then=="function"&&tt.then(k,dt)}catch(ut){dt(ut)}finally{H!==null&&$.types!==null&&(H.types=$.types),z.T=H}},ft.unstable_useCacheRefresh=function(){return z.H.useCacheRefresh()},ft.use=function(D){return z.H.use(D)},ft.useActionState=function(D,H,$){return z.H.useActionState(D,H,$)},ft.useCallback=function(D,H){return z.H.useCallback(D,H)},ft.useContext=function(D){return z.H.useContext(D)},ft.useDebugValue=function(){},ft.useDeferredValue=function(D,H){return z.H.useDeferredValue(D,H)},ft.useEffect=function(D,H){return z.H.useEffect(D,H)},ft.useEffectEvent=function(D){return z.H.useEffectEvent(D)},ft.useId=function(){return z.H.useId()},ft.useImperativeHandle=function(D,H,$){return z.H.useImperativeHandle(D,H,$)},ft.useInsertionEffect=function(D,H){return z.H.useInsertionEffect(D,H)},ft.useLayoutEffect=function(D,H){return z.H.useLayoutEffect(D,H)},ft.useMemo=function(D,H){return z.H.useMemo(D,H)},ft.useOptimistic=function(D,H){return z.H.useOptimistic(D,H)},ft.useReducer=function(D,H,$){return z.H.useReducer(D,H,$)},ft.useRef=function(D){return z.H.useRef(D)},ft.useState=function(D){return z.H.useState(D)},ft.useSyncExternalStore=function(D,H,$){return z.H.useSyncExternalStore(D,H,$)},ft.useTransition=function(){return z.H.useTransition()},ft.version="19.2.3",ft}var Cg;function sh(){return Cg||(Cg=1,Tu.exports=Ry()),Tu.exports}var Zt=sh();const Dy=Ty(Zt);var Cu={exports:{}},Ka={},Mu={exports:{}},Ru={};var Mg;function Ny(){return Mg||(Mg=1,(function(p){function t(P,V){var Q=P.length;P.push(V);t:for(;0<Q;){var dt=Q-1>>>1,St=P[dt];if(0<r(St,V))P[dt]=V,P[Q]=St,Q=dt;else break t}}function i(P){return P.length===0?null:P[0]}function s(P){if(P.length===0)return null;var V=P[0],Q=P.pop();if(Q!==V){P[0]=Q;t:for(var dt=0,St=P.length,D=St>>>1;dt<D;){var H=2*(dt+1)-1,$=P[H],tt=H+1,lt=P[tt];if(0>r($,Q))tt<St&&0>r(lt,$)?(P[dt]=lt,P[tt]=Q,dt=tt):(P[dt]=$,P[H]=Q,dt=H);else if(tt<St&&0>r(lt,Q))P[dt]=lt,P[tt]=Q,dt=tt;else break t}}return V}function r(P,V){var Q=P.sortIndex-V.sortIndex;return Q!==0?Q:P.id-V.id}if(p.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;p.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();p.unstable_now=function(){return c.now()-u}}var h=[],f=[],m=1,b=null,y=3,A=!1,x=!1,S=!1,E=!1,w=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function L(P){for(var V=i(f);V!==null;){if(V.callback===null)s(f);else if(V.startTime<=P)s(f),V.sortIndex=V.expirationTime,t(h,V);else break;V=i(f)}}function O(P){if(S=!1,L(P),!x)if(i(h)!==null)x=!0,k||(k=!0,Z());else{var V=i(f);V!==null&&At(O,V.startTime-P)}}var k=!1,z=-1,q=5,K=-1;function J(){return E?!0:!(p.unstable_now()-K<q)}function W(){if(E=!1,k){var P=p.unstable_now();K=P;var V=!0;try{t:{x=!1,S&&(S=!1,M(z),z=-1),A=!0;var Q=y;try{e:{for(L(P),b=i(h);b!==null&&!(b.expirationTime>P&&J());){var dt=b.callback;if(typeof dt=="function"){b.callback=null,y=b.priorityLevel;var St=dt(b.expirationTime<=P);if(P=p.unstable_now(),typeof St=="function"){b.callback=St,L(P),V=!0;break e}b===i(h)&&s(h),L(P)}else s(h);b=i(h)}if(b!==null)V=!0;else{var D=i(f);D!==null&&At(O,D.startTime-P),V=!1}}break t}finally{b=null,y=Q,A=!1}V=void 0}}finally{V?Z():k=!1}}}var Z;if(typeof T=="function")Z=function(){T(W)};else if(typeof MessageChannel<"u"){var ht=new MessageChannel,vt=ht.port2;ht.port1.onmessage=W,Z=function(){vt.postMessage(null)}}else Z=function(){w(W,0)};function At(P,V){z=w(function(){P(p.unstable_now())},V)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(P){P.callback=null},p.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<P?Math.floor(1e3/P):5},p.unstable_getCurrentPriorityLevel=function(){return y},p.unstable_next=function(P){switch(y){case 1:case 2:case 3:var V=3;break;default:V=y}var Q=y;y=V;try{return P()}finally{y=Q}},p.unstable_requestPaint=function(){E=!0},p.unstable_runWithPriority=function(P,V){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var Q=y;y=P;try{return V()}finally{y=Q}},p.unstable_scheduleCallback=function(P,V,Q){var dt=p.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?dt+Q:dt):Q=dt,P){case 1:var St=-1;break;case 2:St=250;break;case 5:St=1073741823;break;case 4:St=1e4;break;default:St=5e3}return St=Q+St,P={id:m++,callback:V,priorityLevel:P,startTime:Q,expirationTime:St,sortIndex:-1},Q>dt?(P.sortIndex=Q,t(f,P),i(h)===null&&P===i(f)&&(S?(M(z),z=-1):S=!0,At(O,Q-dt))):(P.sortIndex=St,t(h,P),x||A||(x=!0,k||(k=!0,Z()))),P},p.unstable_shouldYield=J,p.unstable_wrapCallback=function(P){var V=y;return function(){var Q=y;y=V;try{return P.apply(this,arguments)}finally{y=Q}}}})(Ru)),Ru}var Rg;function Oy(){return Rg||(Rg=1,Mu.exports=Ny()),Mu.exports}var Du={exports:{}},we={};var Dg;function Ly(){if(Dg)return we;Dg=1;var p=sh();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(h,f,m){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:b==null?null:""+b,children:h,containerInfo:f,implementation:m}}var c=p.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return we.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,we.createPortal=function(h,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(h,f,null,m)},we.flushSync=function(h){var f=c.T,m=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=f,s.p=m,s.d.f()}},we.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(h,f))},we.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},we.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var m=f.as,b=u(m,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?s.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:b,integrity:y,fetchPriority:A}):m==="script"&&s.d.X(h,{crossOrigin:b,integrity:y,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},we.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=u(f.as,f.crossOrigin);s.d.M(h,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(h)},we.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,b=u(m,f.crossOrigin);s.d.L(h,m,{crossOrigin:b,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},we.preloadModule=function(h,f){if(typeof h=="string")if(f){var m=u(f.as,f.crossOrigin);s.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(h)},we.requestFormReset=function(h){s.d.r(h)},we.unstable_batchedUpdates=function(h,f){return h(f)},we.useFormState=function(h,f,m){return c.H.useFormState(h,f,m)},we.useFormStatus=function(){return c.H.useHostTransitionStatus()},we.version="19.2.3",we}var Ng;function ky(){if(Ng)return Du.exports;Ng=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(t){console.error(t)}}return p(),Du.exports=Ly(),Du.exports}var Og;function By(){if(Og)return Ka;Og=1;var p=Oy(),t=sh(),i=ky();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function l(e){var n=e,a=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(a=n.return),e=n.return;while(e)}return n.tag===3?a:null}function c(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function u(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(s(188))}function f(e){var n=e.alternate;if(!n){if(n=l(e),n===null)throw Error(s(188));return n!==e?null:e}for(var a=e,o=n;;){var d=a.return;if(d===null)break;var g=d.alternate;if(g===null){if(o=d.return,o!==null){a=o;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===a)return h(d),e;if(g===o)return h(d),n;g=g.sibling}throw Error(s(188))}if(a.return!==o.return)a=d,o=g;else{for(var v=!1,_=d.child;_;){if(_===a){v=!0,a=d,o=g;break}if(_===o){v=!0,o=d,a=g;break}_=_.sibling}if(!v){for(_=g.child;_;){if(_===a){v=!0,a=g,o=d;break}if(_===o){v=!0,o=g,a=d;break}_=_.sibling}if(!v)throw Error(s(189))}}if(a.alternate!==o)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:n}function m(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=m(e),n!==null)return n;e=e.sibling}return null}var b=Object.assign,y=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),T=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function Z(e){return e===null||typeof e!="object"?null:(e=W&&e[W]||e["@@iterator"],typeof e=="function"?e:null)}var ht=Symbol.for("react.client.reference");function vt(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ht?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case w:return"Profiler";case E:return"StrictMode";case O:return"Suspense";case k:return"SuspenseList";case K:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case x:return"Portal";case T:return e.displayName||"Context";case M:return(e._context.displayName||"Context")+".Consumer";case L:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case z:return n=e.displayName||null,n!==null?n:vt(e.type)||"Memo";case q:n=e._payload,e=e._init;try{return vt(e(n))}catch{}}return null}var At=Array.isArray,P=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},dt=[],St=-1;function D(e){return{current:e}}function H(e){0>St||(e.current=dt[St],dt[St]=null,St--)}function $(e,n){St++,dt[St]=e.current,e.current=n}var tt=D(null),lt=D(null),ut=D(null),ot=D(null);function te(e,n){switch($(ut,n),$(lt,e),$(tt,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?qp(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=qp(n),e=Yp(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}H(tt),$(tt,e)}function jt(){H(tt),H(lt),H(ut)}function Mn(e){e.memoizedState!==null&&$(ot,e);var n=tt.current,a=Yp(n,e.type);n!==a&&($(lt,e),$(tt,a))}function Ki(e){lt.current===e&&(H(tt),H(lt)),ot.current===e&&(H(ot),Va._currentValue=Q)}var Rn,ea;function Ci(e){if(Rn===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);Rn=n&&n[1]||"",ea=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Rn+e+ea}var ro=!1;function lo(e,n){if(!e||ro)return"";ro=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(n){var X=function(){throw Error()};if(Object.defineProperty(X.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(X,[])}catch(I){var j=I}Reflect.construct(e,[],X)}else{try{X.call()}catch(I){j=I}e.call(X.prototype)}}else{try{throw Error()}catch(I){j=I}(X=e())&&typeof X.catch=="function"&&X.catch(function(){})}}catch(I){if(I&&j&&typeof I.stack=="string")return[I.stack,j.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=o.DetermineComponentFrameRoot(),v=g[0],_=g[1];if(v&&_){var C=v.split(`
`),U=_.split(`
`);for(d=o=0;o<C.length&&!C[o].includes("DetermineComponentFrameRoot");)o++;for(;d<U.length&&!U[d].includes("DetermineComponentFrameRoot");)d++;if(o===C.length||d===U.length)for(o=C.length-1,d=U.length-1;1<=o&&0<=d&&C[o]!==U[d];)d--;for(;1<=o&&0<=d;o--,d--)if(C[o]!==U[d]){if(o!==1||d!==1)do if(o--,d--,0>d||C[o]!==U[d]){var G=`
`+C[o].replace(" at new "," at ");return e.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",e.displayName)),G}while(1<=o&&0<=d);break}}}finally{ro=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Ci(a):""}function n0(e,n){switch(e.tag){case 26:case 27:case 5:return Ci(e.type);case 16:return Ci("Lazy");case 13:return e.child!==n&&n!==null?Ci("Suspense Fallback"):Ci("Suspense");case 19:return Ci("SuspenseList");case 0:case 15:return lo(e.type,!1);case 11:return lo(e.type.render,!1);case 1:return lo(e.type,!0);case 31:return Ci("Activity");default:return""}}function Sh(e){try{var n="",a=null;do n+=n0(e,a),a=e,e=e.return;while(e);return n}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}var oo=Object.prototype.hasOwnProperty,co=p.unstable_scheduleCallback,uo=p.unstable_cancelCallback,s0=p.unstable_shouldYield,a0=p.unstable_requestPaint,je=p.unstable_now,r0=p.unstable_getCurrentPriorityLevel,xh=p.unstable_ImmediatePriority,_h=p.unstable_UserBlockingPriority,Ar=p.unstable_NormalPriority,l0=p.unstable_LowPriority,wh=p.unstable_IdlePriority,o0=p.log,c0=p.unstable_setDisableYieldValue,ia=null,Ie=null;function Qi(e){if(typeof o0=="function"&&c0(e),Ie&&typeof Ie.setStrictMode=="function")try{Ie.setStrictMode(ia,e)}catch{}}var He=Math.clz32?Math.clz32:d0,u0=Math.log,h0=Math.LN2;function d0(e){return e>>>=0,e===0?32:31-(u0(e)/h0|0)|0}var Sr=256,xr=262144,_r=4194304;function Dn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function wr(e,n,a){var o=e.pendingLanes;if(o===0)return 0;var d=0,g=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var _=o&134217727;return _!==0?(o=_&~g,o!==0?d=Dn(o):(v&=_,v!==0?d=Dn(v):a||(a=_&~e,a!==0&&(d=Dn(a))))):(_=o&~g,_!==0?d=Dn(_):v!==0?d=Dn(v):a||(a=o&~e,a!==0&&(d=Dn(a)))),d===0?0:n!==0&&n!==d&&(n&g)===0&&(g=d&-d,a=n&-n,g>=a||g===32&&(a&4194048)!==0)?n:d}function na(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function f0(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Eh(){var e=_r;return _r<<=1,(_r&62914560)===0&&(_r=4194304),e}function ho(e){for(var n=[],a=0;31>a;a++)n.push(e);return n}function sa(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function p0(e,n,a,o,d,g){var v=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var _=e.entanglements,C=e.expirationTimes,U=e.hiddenUpdates;for(a=v&~a;0<a;){var G=31-He(a),X=1<<G;_[G]=0,C[G]=-1;var j=U[G];if(j!==null)for(U[G]=null,G=0;G<j.length;G++){var I=j[G];I!==null&&(I.lane&=-536870913)}a&=~X}o!==0&&Th(e,o,0),g!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=g&~(v&~n))}function Th(e,n,a){e.pendingLanes|=n,e.suspendedLanes&=~n;var o=31-He(n);e.entangledLanes|=n,e.entanglements[o]=e.entanglements[o]|1073741824|a&261930}function Ch(e,n){var a=e.entangledLanes|=n;for(e=e.entanglements;a;){var o=31-He(a),d=1<<o;d&n|e[o]&n&&(e[o]|=n),a&=~d}}function Mh(e,n){var a=n&-n;return a=(a&42)!==0?1:fo(a),(a&(e.suspendedLanes|n))!==0?0:a}function fo(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function po(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Rh(){var e=V.p;return e!==0?e:(e=window.event,e===void 0?32:gg(e.type))}function Dh(e,n){var a=V.p;try{return V.p=e,n()}finally{V.p=a}}var Wi=Math.random().toString(36).slice(2),ge="__reactFiber$"+Wi,De="__reactProps$"+Wi,ns="__reactContainer$"+Wi,go="__reactEvents$"+Wi,g0="__reactListeners$"+Wi,m0="__reactHandles$"+Wi,Nh="__reactResources$"+Wi,aa="__reactMarker$"+Wi;function mo(e){delete e[ge],delete e[De],delete e[go],delete e[g0],delete e[m0]}function ss(e){var n=e[ge];if(n)return n;for(var a=e.parentNode;a;){if(n=a[ns]||a[ge]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(e=Jp(e);e!==null;){if(a=e[ge])return a;e=Jp(e)}return n}e=a,a=e.parentNode}return null}function as(e){if(e=e[ge]||e[ns]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function ra(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function rs(e){var n=e[Nh];return n||(n=e[Nh]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function he(e){e[aa]=!0}var Oh=new Set,Lh={};function Nn(e,n){ls(e,n),ls(e+"Capture",n)}function ls(e,n){for(Lh[e]=n,e=0;e<n.length;e++)Oh.add(n[e])}var b0=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),kh={},Bh={};function y0(e){return oo.call(Bh,e)?!0:oo.call(kh,e)?!1:b0.test(e)?Bh[e]=!0:(kh[e]=!0,!1)}function Er(e,n,a){if(y0(n))if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var o=n.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+a)}}function Tr(e,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+a)}}function Mi(e,n,a,o){if(o===null)e.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(n,a,""+o)}}function Ze(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ph(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function v0(e,n,a){var o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var d=o.get,g=o.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return d.call(this)},set:function(v){a=""+v,g.call(this,v)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return a},setValue:function(v){a=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function bo(e){if(!e._valueTracker){var n=Ph(e)?"checked":"value";e._valueTracker=v0(e,n,""+e[n])}}function zh(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var a=n.getValue(),o="";return e&&(o=Ph(e)?e.checked?"true":"false":e.value),e=o,e!==a?(n.setValue(e),!0):!1}function Cr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var A0=/[\n"\\]/g;function Je(e){return e.replace(A0,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function yo(e,n,a,o,d,g,v,_){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),n!=null?v==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+Ze(n)):e.value!==""+Ze(n)&&(e.value=""+Ze(n)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),n!=null?vo(e,v,Ze(n)):a!=null?vo(e,v,Ze(a)):o!=null&&e.removeAttribute("value"),d==null&&g!=null&&(e.defaultChecked=!!g),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?e.name=""+Ze(_):e.removeAttribute("name")}function Fh(e,n,a,o,d,g,v,_){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(e.type=g),n!=null||a!=null){if(!(g!=="submit"&&g!=="reset"||n!=null)){bo(e);return}a=a!=null?""+Ze(a):"",n=n!=null?""+Ze(n):a,_||n===e.value||(e.value=n),e.defaultValue=n}o=o??d,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=_?e.checked:!!o,e.defaultChecked=!!o,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),bo(e)}function vo(e,n,a){n==="number"&&Cr(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function os(e,n,a,o){if(e=e.options,n){n={};for(var d=0;d<a.length;d++)n["$"+a[d]]=!0;for(a=0;a<e.length;a++)d=n.hasOwnProperty("$"+e[a].value),e[a].selected!==d&&(e[a].selected=d),d&&o&&(e[a].defaultSelected=!0)}else{for(a=""+Ze(a),n=null,d=0;d<e.length;d++){if(e[d].value===a){e[d].selected=!0,o&&(e[d].defaultSelected=!0);return}n!==null||e[d].disabled||(n=e[d])}n!==null&&(n.selected=!0)}}function Uh(e,n,a){if(n!=null&&(n=""+Ze(n),n!==e.value&&(e.value=n),a==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=a!=null?""+Ze(a):""}function jh(e,n,a,o){if(n==null){if(o!=null){if(a!=null)throw Error(s(92));if(At(o)){if(1<o.length)throw Error(s(93));o=o[0]}a=o}a==null&&(a=""),n=a}a=Ze(n),e.defaultValue=a,o=e.textContent,o===a&&o!==""&&o!==null&&(e.value=o),bo(e)}function cs(e,n){if(n){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=n;return}}e.textContent=n}var S0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ih(e,n,a){var o=n.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?o?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":o?e.setProperty(n,a):typeof a!="number"||a===0||S0.has(n)?n==="float"?e.cssFloat=a:e[n]=(""+a).trim():e[n]=a+"px"}function Hh(e,n,a){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,a!=null){for(var o in a)!a.hasOwnProperty(o)||n!=null&&n.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var d in n)o=n[d],n.hasOwnProperty(d)&&a[d]!==o&&Ih(e,d,o)}else for(var g in n)n.hasOwnProperty(g)&&Ih(e,g,n[g])}function Ao(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var x0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Mr(e){return _0.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ri(){}var So=null;function xo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var us=null,hs=null;function Gh(e){var n=as(e);if(n&&(e=n.stateNode)){var a=e[De]||null;t:switch(e=n.stateNode,n.type){case"input":if(yo(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),n=a.name,a.type==="radio"&&n!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Je(""+n)+'"][type="radio"]'),n=0;n<a.length;n++){var o=a[n];if(o!==e&&o.form===e.form){var d=o[De]||null;if(!d)throw Error(s(90));yo(o,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(n=0;n<a.length;n++)o=a[n],o.form===e.form&&zh(o)}break t;case"textarea":Uh(e,a.value,a.defaultValue);break t;case"select":n=a.value,n!=null&&os(e,!!a.multiple,n,!1)}}}var _o=!1;function Vh(e,n,a){if(_o)return e(n,a);_o=!0;try{var o=e(n);return o}finally{if(_o=!1,(us!==null||hs!==null)&&(gl(),us&&(n=us,e=hs,hs=us=null,Gh(n),e)))for(n=0;n<e.length;n++)Gh(e[n])}}function la(e,n){var a=e.stateNode;if(a===null)return null;var o=a[De]||null;if(o===null)return null;a=o[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break t;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,n,typeof a));return a}var Di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wo=!1;if(Di)try{var oa={};Object.defineProperty(oa,"passive",{get:function(){wo=!0}}),window.addEventListener("test",oa,oa),window.removeEventListener("test",oa,oa)}catch{wo=!1}var Zi=null,Eo=null,Rr=null;function qh(){if(Rr)return Rr;var e,n=Eo,a=n.length,o,d="value"in Zi?Zi.value:Zi.textContent,g=d.length;for(e=0;e<a&&n[e]===d[e];e++);var v=a-e;for(o=1;o<=v&&n[a-o]===d[g-o];o++);return Rr=d.slice(e,1<o?1-o:void 0)}function Dr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Nr(){return!0}function Yh(){return!1}function Ne(e){function n(a,o,d,g,v){this._reactName=a,this._targetInst=d,this.type=o,this.nativeEvent=g,this.target=v,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(a=e[_],this[_]=a?a(g):g[_]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Nr:Yh,this.isPropagationStopped=Yh,this}return b(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Nr)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Nr)},persist:function(){},isPersistent:Nr}),n}var On={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Or=Ne(On),ca=b({},On,{view:0,detail:0}),w0=Ne(ca),To,Co,ua,Lr=b({},ca,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ro,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ua&&(ua&&e.type==="mousemove"?(To=e.screenX-ua.screenX,Co=e.screenY-ua.screenY):Co=To=0,ua=e),To)},movementY:function(e){return"movementY"in e?e.movementY:Co}}),Xh=Ne(Lr),E0=b({},Lr,{dataTransfer:0}),T0=Ne(E0),C0=b({},ca,{relatedTarget:0}),Mo=Ne(C0),M0=b({},On,{animationName:0,elapsedTime:0,pseudoElement:0}),R0=Ne(M0),D0=b({},On,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),N0=Ne(D0),O0=b({},On,{data:0}),$h=Ne(O0),L0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},k0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},B0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function P0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=B0[e])?!!n[e]:!1}function Ro(){return P0}var z0=b({},ca,{key:function(e){if(e.key){var n=L0[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Dr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?k0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ro,charCode:function(e){return e.type==="keypress"?Dr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Dr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),F0=Ne(z0),U0=b({},Lr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kh=Ne(U0),j0=b({},ca,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ro}),I0=Ne(j0),H0=b({},On,{propertyName:0,elapsedTime:0,pseudoElement:0}),G0=Ne(H0),V0=b({},Lr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),q0=Ne(V0),Y0=b({},On,{newState:0,oldState:0}),X0=Ne(Y0),$0=[9,13,27,32],Do=Di&&"CompositionEvent"in window,ha=null;Di&&"documentMode"in document&&(ha=document.documentMode);var K0=Di&&"TextEvent"in window&&!ha,Qh=Di&&(!Do||ha&&8<ha&&11>=ha),Wh=" ",Zh=!1;function Jh(e,n){switch(e){case"keyup":return $0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function td(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ds=!1;function Q0(e,n){switch(e){case"compositionend":return td(n);case"keypress":return n.which!==32?null:(Zh=!0,Wh);case"textInput":return e=n.data,e===Wh&&Zh?null:e;default:return null}}function W0(e,n){if(ds)return e==="compositionend"||!Do&&Jh(e,n)?(e=qh(),Rr=Eo=Zi=null,ds=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Qh&&n.locale!=="ko"?null:n.data;default:return null}}var Z0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ed(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Z0[e.type]:n==="textarea"}function id(e,n,a,o){us?hs?hs.push(o):hs=[o]:us=o,n=xl(n,"onChange"),0<n.length&&(a=new Or("onChange","change",null,a,o),e.push({event:a,listeners:n}))}var da=null,fa=null;function J0(e){Up(e,0)}function kr(e){var n=ra(e);if(zh(n))return e}function nd(e,n){if(e==="change")return n}var sd=!1;if(Di){var No;if(Di){var Oo="oninput"in document;if(!Oo){var ad=document.createElement("div");ad.setAttribute("oninput","return;"),Oo=typeof ad.oninput=="function"}No=Oo}else No=!1;sd=No&&(!document.documentMode||9<document.documentMode)}function rd(){da&&(da.detachEvent("onpropertychange",ld),fa=da=null)}function ld(e){if(e.propertyName==="value"&&kr(fa)){var n=[];id(n,fa,e,xo(e)),Vh(J0,n)}}function tb(e,n,a){e==="focusin"?(rd(),da=n,fa=a,da.attachEvent("onpropertychange",ld)):e==="focusout"&&rd()}function eb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return kr(fa)}function ib(e,n){if(e==="click")return kr(n)}function nb(e,n){if(e==="input"||e==="change")return kr(n)}function sb(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Ge=typeof Object.is=="function"?Object.is:sb;function pa(e,n){if(Ge(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var a=Object.keys(e),o=Object.keys(n);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var d=a[o];if(!oo.call(n,d)||!Ge(e[d],n[d]))return!1}return!0}function od(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cd(e,n){var a=od(e);e=0;for(var o;a;){if(a.nodeType===3){if(o=e+a.textContent.length,e<=n&&o>=n)return{node:a,offset:n-e};e=o}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=od(a)}}function ud(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?ud(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function hd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=Cr(e.document);n instanceof e.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)e=n.contentWindow;else break;n=Cr(e.document)}return n}function Lo(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var ab=Di&&"documentMode"in document&&11>=document.documentMode,fs=null,ko=null,ga=null,Bo=!1;function dd(e,n,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Bo||fs==null||fs!==Cr(o)||(o=fs,"selectionStart"in o&&Lo(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),ga&&pa(ga,o)||(ga=o,o=xl(ko,"onSelect"),0<o.length&&(n=new Or("onSelect","select",null,n,a),e.push({event:n,listeners:o}),n.target=fs)))}function Ln(e,n){var a={};return a[e.toLowerCase()]=n.toLowerCase(),a["Webkit"+e]="webkit"+n,a["Moz"+e]="moz"+n,a}var ps={animationend:Ln("Animation","AnimationEnd"),animationiteration:Ln("Animation","AnimationIteration"),animationstart:Ln("Animation","AnimationStart"),transitionrun:Ln("Transition","TransitionRun"),transitionstart:Ln("Transition","TransitionStart"),transitioncancel:Ln("Transition","TransitionCancel"),transitionend:Ln("Transition","TransitionEnd")},Po={},fd={};Di&&(fd=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function kn(e){if(Po[e])return Po[e];if(!ps[e])return e;var n=ps[e],a;for(a in n)if(n.hasOwnProperty(a)&&a in fd)return Po[e]=n[a];return e}var pd=kn("animationend"),gd=kn("animationiteration"),md=kn("animationstart"),rb=kn("transitionrun"),lb=kn("transitionstart"),ob=kn("transitioncancel"),bd=kn("transitionend"),yd=new Map,zo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");zo.push("scrollEnd");function di(e,n){yd.set(e,n),Nn(n,[e])}var Br=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},ti=[],gs=0,Fo=0;function Pr(){for(var e=gs,n=Fo=gs=0;n<e;){var a=ti[n];ti[n++]=null;var o=ti[n];ti[n++]=null;var d=ti[n];ti[n++]=null;var g=ti[n];if(ti[n++]=null,o!==null&&d!==null){var v=o.pending;v===null?d.next=d:(d.next=v.next,v.next=d),o.pending=d}g!==0&&vd(a,d,g)}}function zr(e,n,a,o){ti[gs++]=e,ti[gs++]=n,ti[gs++]=a,ti[gs++]=o,Fo|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function Uo(e,n,a,o){return zr(e,n,a,o),Fr(e)}function Bn(e,n){return zr(e,null,null,n),Fr(e)}function vd(e,n,a){e.lanes|=a;var o=e.alternate;o!==null&&(o.lanes|=a);for(var d=!1,g=e.return;g!==null;)g.childLanes|=a,o=g.alternate,o!==null&&(o.childLanes|=a),g.tag===22&&(e=g.stateNode,e===null||e._visibility&1||(d=!0)),e=g,g=g.return;return e.tag===3?(g=e.stateNode,d&&n!==null&&(d=31-He(a),e=g.hiddenUpdates,o=e[d],o===null?e[d]=[n]:o.push(n),n.lane=a|536870912),g):null}function Fr(e){if(50<za)throw za=0,$c=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var ms={};function cb(e,n,a,o){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ve(e,n,a,o){return new cb(e,n,a,o)}function jo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ni(e,n){var a=e.alternate;return a===null?(a=Ve(e.tag,n,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=n,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,n=e.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Ad(e,n){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,n=a.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Ur(e,n,a,o,d,g){var v=0;if(o=e,typeof e=="function")jo(e)&&(v=1);else if(typeof e=="string")v=py(e,a,tt.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case K:return e=Ve(31,a,n,d),e.elementType=K,e.lanes=g,e;case S:return Pn(a.children,d,g,n);case E:v=8,d|=24;break;case w:return e=Ve(12,a,n,d|2),e.elementType=w,e.lanes=g,e;case O:return e=Ve(13,a,n,d),e.elementType=O,e.lanes=g,e;case k:return e=Ve(19,a,n,d),e.elementType=k,e.lanes=g,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case T:v=10;break t;case M:v=9;break t;case L:v=11;break t;case z:v=14;break t;case q:v=16,o=null;break t}v=29,a=Error(s(130,e===null?"null":typeof e,"")),o=null}return n=Ve(v,a,n,d),n.elementType=e,n.type=o,n.lanes=g,n}function Pn(e,n,a,o){return e=Ve(7,e,o,n),e.lanes=a,e}function Io(e,n,a){return e=Ve(6,e,null,n),e.lanes=a,e}function Sd(e){var n=Ve(18,null,null,0);return n.stateNode=e,n}function Ho(e,n,a){return n=Ve(4,e.children!==null?e.children:[],e.key,n),n.lanes=a,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var xd=new WeakMap;function ei(e,n){if(typeof e=="object"&&e!==null){var a=xd.get(e);return a!==void 0?a:(n={value:e,source:n,stack:Sh(n)},xd.set(e,n),n)}return{value:e,source:n,stack:Sh(n)}}var bs=[],ys=0,jr=null,ma=0,ii=[],ni=0,Ji=null,mi=1,bi="";function Oi(e,n){bs[ys++]=ma,bs[ys++]=jr,jr=e,ma=n}function _d(e,n,a){ii[ni++]=mi,ii[ni++]=bi,ii[ni++]=Ji,Ji=e;var o=mi;e=bi;var d=32-He(o)-1;o&=~(1<<d),a+=1;var g=32-He(n)+d;if(30<g){var v=d-d%5;g=(o&(1<<v)-1).toString(32),o>>=v,d-=v,mi=1<<32-He(n)+d|a<<d|o,bi=g+e}else mi=1<<g|a<<d|o,bi=e}function Go(e){e.return!==null&&(Oi(e,1),_d(e,1,0))}function Vo(e){for(;e===jr;)jr=bs[--ys],bs[ys]=null,ma=bs[--ys],bs[ys]=null;for(;e===Ji;)Ji=ii[--ni],ii[ni]=null,bi=ii[--ni],ii[ni]=null,mi=ii[--ni],ii[ni]=null}function wd(e,n){ii[ni++]=mi,ii[ni++]=bi,ii[ni++]=Ji,mi=n.id,bi=n.overflow,Ji=e}var me=null,Gt=null,Tt=!1,tn=null,si=!1,qo=Error(s(519));function en(e){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ba(ei(n,e)),qo}function Ed(e){var n=e.stateNode,a=e.type,o=e.memoizedProps;switch(n[ge]=e,n[De]=o,a){case"dialog":_t("cancel",n),_t("close",n);break;case"iframe":case"object":case"embed":_t("load",n);break;case"video":case"audio":for(a=0;a<Ua.length;a++)_t(Ua[a],n);break;case"source":_t("error",n);break;case"img":case"image":case"link":_t("error",n),_t("load",n);break;case"details":_t("toggle",n);break;case"input":_t("invalid",n),Fh(n,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0);break;case"select":_t("invalid",n);break;case"textarea":_t("invalid",n),jh(n,o.value,o.defaultValue,o.children)}a=o.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||n.textContent===""+a||o.suppressHydrationWarning===!0||Gp(n.textContent,a)?(o.popover!=null&&(_t("beforetoggle",n),_t("toggle",n)),o.onScroll!=null&&_t("scroll",n),o.onScrollEnd!=null&&_t("scrollend",n),o.onClick!=null&&(n.onclick=Ri),n=!0):n=!1,n||en(e,!0)}function Td(e){for(me=e.return;me;)switch(me.tag){case 5:case 31:case 13:si=!1;return;case 27:case 3:si=!0;return;default:me=me.return}}function vs(e){if(e!==me)return!1;if(!Tt)return Td(e),Tt=!0,!1;var n=e.tag,a;if((a=n!==3&&n!==27)&&((a=n===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||cu(e.type,e.memoizedProps)),a=!a),a&&Gt&&en(e),Td(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Gt=Zp(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Gt=Zp(e)}else n===27?(n=Gt,mn(e.type)?(e=pu,pu=null,Gt=e):Gt=n):Gt=me?ri(e.stateNode.nextSibling):null;return!0}function zn(){Gt=me=null,Tt=!1}function Yo(){var e=tn;return e!==null&&(Be===null?Be=e:Be.push.apply(Be,e),tn=null),e}function ba(e){tn===null?tn=[e]:tn.push(e)}var Xo=D(null),Fn=null,Li=null;function nn(e,n,a){$(Xo,n._currentValue),n._currentValue=a}function ki(e){e._currentValue=Xo.current,H(Xo)}function $o(e,n,a){for(;e!==null;){var o=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),e===a)break;e=e.return}}function Ko(e,n,a,o){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var g=d.dependencies;if(g!==null){var v=d.child;g=g.firstContext;t:for(;g!==null;){var _=g;g=d;for(var C=0;C<n.length;C++)if(_.context===n[C]){g.lanes|=a,_=g.alternate,_!==null&&(_.lanes|=a),$o(g.return,a,e),o||(v=null);break t}g=_.next}}else if(d.tag===18){if(v=d.return,v===null)throw Error(s(341));v.lanes|=a,g=v.alternate,g!==null&&(g.lanes|=a),$o(v,a,e),v=null}else v=d.child;if(v!==null)v.return=d;else for(v=d;v!==null;){if(v===e){v=null;break}if(d=v.sibling,d!==null){d.return=v.return,v=d;break}v=v.return}d=v}}function As(e,n,a,o){e=null;for(var d=n,g=!1;d!==null;){if(!g){if((d.flags&524288)!==0)g=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var v=d.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var _=d.type;Ge(d.pendingProps.value,v.value)||(e!==null?e.push(_):e=[_])}}else if(d===ot.current){if(v=d.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(Va):e=[Va])}d=d.return}e!==null&&Ko(n,e,a,o),n.flags|=262144}function Ir(e){for(e=e.firstContext;e!==null;){if(!Ge(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Un(e){Fn=e,Li=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function be(e){return Cd(Fn,e)}function Hr(e,n){return Fn===null&&Un(e),Cd(e,n)}function Cd(e,n){var a=n._currentValue;if(n={context:n,memoizedValue:a,next:null},Li===null){if(e===null)throw Error(s(308));Li=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Li=Li.next=n;return a}var ub=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(a,o){e.push(o)}};this.abort=function(){n.aborted=!0,e.forEach(function(a){return a()})}},hb=p.unstable_scheduleCallback,db=p.unstable_NormalPriority,se={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qo(){return{controller:new ub,data:new Map,refCount:0}}function ya(e){e.refCount--,e.refCount===0&&hb(db,function(){e.controller.abort()})}var va=null,Wo=0,Ss=0,xs=null;function fb(e,n){if(va===null){var a=va=[];Wo=0,Ss=tu(),xs={status:"pending",value:void 0,then:function(o){a.push(o)}}}return Wo++,n.then(Md,Md),n}function Md(){if(--Wo===0&&va!==null){xs!==null&&(xs.status="fulfilled");var e=va;va=null,Ss=0,xs=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function pb(e,n){var a=[],o={status:"pending",value:null,reason:null,then:function(d){a.push(d)}};return e.then(function(){o.status="fulfilled",o.value=n;for(var d=0;d<a.length;d++)(0,a[d])(n)},function(d){for(o.status="rejected",o.reason=d,d=0;d<a.length;d++)(0,a[d])(void 0)}),o}var Rd=P.S;P.S=function(e,n){fp=je(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&fb(e,n),Rd!==null&&Rd(e,n)};var jn=D(null);function Zo(){var e=jn.current;return e!==null?e:It.pooledCache}function Gr(e,n){n===null?$(jn,jn.current):$(jn,n.pool)}function Dd(){var e=Zo();return e===null?null:{parent:se._currentValue,pool:e}}var _s=Error(s(460)),Jo=Error(s(474)),Vr=Error(s(542)),qr={then:function(){}};function Nd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Od(e,n,a){switch(a=e[a],a===void 0?e.push(n):a!==n&&(n.then(Ri,Ri),n=a),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,kd(e),e;default:if(typeof n.status=="string")n.then(Ri,Ri);else{if(e=It,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(o){if(n.status==="pending"){var d=n;d.status="fulfilled",d.value=o}},function(o){if(n.status==="pending"){var d=n;d.status="rejected",d.reason=o}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,kd(e),e}throw Hn=n,_s}}function In(e){try{var n=e._init;return n(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(Hn=a,_s):a}}var Hn=null;function Ld(){if(Hn===null)throw Error(s(459));var e=Hn;return Hn=null,e}function kd(e){if(e===_s||e===Vr)throw Error(s(483))}var ws=null,Aa=0;function Yr(e){var n=Aa;return Aa+=1,ws===null&&(ws=[]),Od(ws,e,n)}function Sa(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function Xr(e,n){throw n.$$typeof===y?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Bd(e){function n(B,N){if(e){var F=B.deletions;F===null?(B.deletions=[N],B.flags|=16):F.push(N)}}function a(B,N){if(!e)return null;for(;N!==null;)n(B,N),N=N.sibling;return null}function o(B){for(var N=new Map;B!==null;)B.key!==null?N.set(B.key,B):N.set(B.index,B),B=B.sibling;return N}function d(B,N){return B=Ni(B,N),B.index=0,B.sibling=null,B}function g(B,N,F){return B.index=F,e?(F=B.alternate,F!==null?(F=F.index,F<N?(B.flags|=67108866,N):F):(B.flags|=67108866,N)):(B.flags|=1048576,N)}function v(B){return e&&B.alternate===null&&(B.flags|=67108866),B}function _(B,N,F,Y){return N===null||N.tag!==6?(N=Io(F,B.mode,Y),N.return=B,N):(N=d(N,F),N.return=B,N)}function C(B,N,F,Y){var at=F.type;return at===S?G(B,N,F.props.children,Y,F.key):N!==null&&(N.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===q&&In(at)===N.type)?(N=d(N,F.props),Sa(N,F),N.return=B,N):(N=Ur(F.type,F.key,F.props,null,B.mode,Y),Sa(N,F),N.return=B,N)}function U(B,N,F,Y){return N===null||N.tag!==4||N.stateNode.containerInfo!==F.containerInfo||N.stateNode.implementation!==F.implementation?(N=Ho(F,B.mode,Y),N.return=B,N):(N=d(N,F.children||[]),N.return=B,N)}function G(B,N,F,Y,at){return N===null||N.tag!==7?(N=Pn(F,B.mode,Y,at),N.return=B,N):(N=d(N,F),N.return=B,N)}function X(B,N,F){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=Io(""+N,B.mode,F),N.return=B,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case A:return F=Ur(N.type,N.key,N.props,null,B.mode,F),Sa(F,N),F.return=B,F;case x:return N=Ho(N,B.mode,F),N.return=B,N;case q:return N=In(N),X(B,N,F)}if(At(N)||Z(N))return N=Pn(N,B.mode,F,null),N.return=B,N;if(typeof N.then=="function")return X(B,Yr(N),F);if(N.$$typeof===T)return X(B,Hr(B,N),F);Xr(B,N)}return null}function j(B,N,F,Y){var at=N!==null?N.key:null;if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return at!==null?null:_(B,N,""+F,Y);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case A:return F.key===at?C(B,N,F,Y):null;case x:return F.key===at?U(B,N,F,Y):null;case q:return F=In(F),j(B,N,F,Y)}if(At(F)||Z(F))return at!==null?null:G(B,N,F,Y,null);if(typeof F.then=="function")return j(B,N,Yr(F),Y);if(F.$$typeof===T)return j(B,N,Hr(B,F),Y);Xr(B,F)}return null}function I(B,N,F,Y,at){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return B=B.get(F)||null,_(N,B,""+Y,at);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:return B=B.get(Y.key===null?F:Y.key)||null,C(N,B,Y,at);case x:return B=B.get(Y.key===null?F:Y.key)||null,U(N,B,Y,at);case q:return Y=In(Y),I(B,N,F,Y,at)}if(At(Y)||Z(Y))return B=B.get(F)||null,G(N,B,Y,at,null);if(typeof Y.then=="function")return I(B,N,F,Yr(Y),at);if(Y.$$typeof===T)return I(B,N,F,Hr(N,Y),at);Xr(N,Y)}return null}function it(B,N,F,Y){for(var at=null,Rt=null,st=N,yt=N=0,Et=null;st!==null&&yt<F.length;yt++){st.index>yt?(Et=st,st=null):Et=st.sibling;var Dt=j(B,st,F[yt],Y);if(Dt===null){st===null&&(st=Et);break}e&&st&&Dt.alternate===null&&n(B,st),N=g(Dt,N,yt),Rt===null?at=Dt:Rt.sibling=Dt,Rt=Dt,st=Et}if(yt===F.length)return a(B,st),Tt&&Oi(B,yt),at;if(st===null){for(;yt<F.length;yt++)st=X(B,F[yt],Y),st!==null&&(N=g(st,N,yt),Rt===null?at=st:Rt.sibling=st,Rt=st);return Tt&&Oi(B,yt),at}for(st=o(st);yt<F.length;yt++)Et=I(st,B,yt,F[yt],Y),Et!==null&&(e&&Et.alternate!==null&&st.delete(Et.key===null?yt:Et.key),N=g(Et,N,yt),Rt===null?at=Et:Rt.sibling=Et,Rt=Et);return e&&st.forEach(function(Sn){return n(B,Sn)}),Tt&&Oi(B,yt),at}function ct(B,N,F,Y){if(F==null)throw Error(s(151));for(var at=null,Rt=null,st=N,yt=N=0,Et=null,Dt=F.next();st!==null&&!Dt.done;yt++,Dt=F.next()){st.index>yt?(Et=st,st=null):Et=st.sibling;var Sn=j(B,st,Dt.value,Y);if(Sn===null){st===null&&(st=Et);break}e&&st&&Sn.alternate===null&&n(B,st),N=g(Sn,N,yt),Rt===null?at=Sn:Rt.sibling=Sn,Rt=Sn,st=Et}if(Dt.done)return a(B,st),Tt&&Oi(B,yt),at;if(st===null){for(;!Dt.done;yt++,Dt=F.next())Dt=X(B,Dt.value,Y),Dt!==null&&(N=g(Dt,N,yt),Rt===null?at=Dt:Rt.sibling=Dt,Rt=Dt);return Tt&&Oi(B,yt),at}for(st=o(st);!Dt.done;yt++,Dt=F.next())Dt=I(st,B,yt,Dt.value,Y),Dt!==null&&(e&&Dt.alternate!==null&&st.delete(Dt.key===null?yt:Dt.key),N=g(Dt,N,yt),Rt===null?at=Dt:Rt.sibling=Dt,Rt=Dt);return e&&st.forEach(function(Ey){return n(B,Ey)}),Tt&&Oi(B,yt),at}function Ft(B,N,F,Y){if(typeof F=="object"&&F!==null&&F.type===S&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case A:t:{for(var at=F.key;N!==null;){if(N.key===at){if(at=F.type,at===S){if(N.tag===7){a(B,N.sibling),Y=d(N,F.props.children),Y.return=B,B=Y;break t}}else if(N.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===q&&In(at)===N.type){a(B,N.sibling),Y=d(N,F.props),Sa(Y,F),Y.return=B,B=Y;break t}a(B,N);break}else n(B,N);N=N.sibling}F.type===S?(Y=Pn(F.props.children,B.mode,Y,F.key),Y.return=B,B=Y):(Y=Ur(F.type,F.key,F.props,null,B.mode,Y),Sa(Y,F),Y.return=B,B=Y)}return v(B);case x:t:{for(at=F.key;N!==null;){if(N.key===at)if(N.tag===4&&N.stateNode.containerInfo===F.containerInfo&&N.stateNode.implementation===F.implementation){a(B,N.sibling),Y=d(N,F.children||[]),Y.return=B,B=Y;break t}else{a(B,N);break}else n(B,N);N=N.sibling}Y=Ho(F,B.mode,Y),Y.return=B,B=Y}return v(B);case q:return F=In(F),Ft(B,N,F,Y)}if(At(F))return it(B,N,F,Y);if(Z(F)){if(at=Z(F),typeof at!="function")throw Error(s(150));return F=at.call(F),ct(B,N,F,Y)}if(typeof F.then=="function")return Ft(B,N,Yr(F),Y);if(F.$$typeof===T)return Ft(B,N,Hr(B,F),Y);Xr(B,F)}return typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint"?(F=""+F,N!==null&&N.tag===6?(a(B,N.sibling),Y=d(N,F),Y.return=B,B=Y):(a(B,N),Y=Io(F,B.mode,Y),Y.return=B,B=Y),v(B)):a(B,N)}return function(B,N,F,Y){try{Aa=0;var at=Ft(B,N,F,Y);return ws=null,at}catch(st){if(st===_s||st===Vr)throw st;var Rt=Ve(29,st,null,B.mode);return Rt.lanes=Y,Rt.return=B,Rt}finally{}}}var Gn=Bd(!0),Pd=Bd(!1),sn=!1;function tc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ec(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function an(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function rn(e,n,a){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(Nt&2)!==0){var d=o.pending;return d===null?n.next=n:(n.next=d.next,d.next=n),o.pending=n,n=Fr(e),vd(e,null,a),n}return zr(e,o,n,a),Fr(e)}function xa(e,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194048)!==0)){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Ch(e,a)}}function ic(e,n){var a=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var d=null,g=null;if(a=a.firstBaseUpdate,a!==null){do{var v={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};g===null?d=g=v:g=g.next=v,a=a.next}while(a!==null);g===null?d=g=n:g=g.next=n}else d=g=n;a={baseState:o.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:o.shared,callbacks:o.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=n:e.next=n,a.lastBaseUpdate=n}var nc=!1;function _a(){if(nc){var e=xs;if(e!==null)throw e}}function wa(e,n,a,o){nc=!1;var d=e.updateQueue;sn=!1;var g=d.firstBaseUpdate,v=d.lastBaseUpdate,_=d.shared.pending;if(_!==null){d.shared.pending=null;var C=_,U=C.next;C.next=null,v===null?g=U:v.next=U,v=C;var G=e.alternate;G!==null&&(G=G.updateQueue,_=G.lastBaseUpdate,_!==v&&(_===null?G.firstBaseUpdate=U:_.next=U,G.lastBaseUpdate=C))}if(g!==null){var X=d.baseState;v=0,G=U=C=null,_=g;do{var j=_.lane&-536870913,I=j!==_.lane;if(I?(wt&j)===j:(o&j)===j){j!==0&&j===Ss&&(nc=!0),G!==null&&(G=G.next={lane:0,tag:_.tag,payload:_.payload,callback:null,next:null});t:{var it=e,ct=_;j=n;var Ft=a;switch(ct.tag){case 1:if(it=ct.payload,typeof it=="function"){X=it.call(Ft,X,j);break t}X=it;break t;case 3:it.flags=it.flags&-65537|128;case 0:if(it=ct.payload,j=typeof it=="function"?it.call(Ft,X,j):it,j==null)break t;X=b({},X,j);break t;case 2:sn=!0}}j=_.callback,j!==null&&(e.flags|=64,I&&(e.flags|=8192),I=d.callbacks,I===null?d.callbacks=[j]:I.push(j))}else I={lane:j,tag:_.tag,payload:_.payload,callback:_.callback,next:null},G===null?(U=G=I,C=X):G=G.next=I,v|=j;if(_=_.next,_===null){if(_=d.shared.pending,_===null)break;I=_,_=I.next,I.next=null,d.lastBaseUpdate=I,d.shared.pending=null}}while(!0);G===null&&(C=X),d.baseState=C,d.firstBaseUpdate=U,d.lastBaseUpdate=G,g===null&&(d.shared.lanes=0),hn|=v,e.lanes=v,e.memoizedState=X}}function zd(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function Fd(e,n){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)zd(a[e],n)}var Es=D(null),$r=D(0);function Ud(e,n){e=Gi,$($r,e),$(Es,n),Gi=e|n.baseLanes}function sc(){$($r,Gi),$(Es,Es.current)}function ac(){Gi=$r.current,H(Es),H($r)}var qe=D(null),ai=null;function ln(e){var n=e.alternate;$(ee,ee.current&1),$(qe,e),ai===null&&(n===null||Es.current!==null||n.memoizedState!==null)&&(ai=e)}function rc(e){$(ee,ee.current),$(qe,e),ai===null&&(ai=e)}function jd(e){e.tag===22?($(ee,ee.current),$(qe,e),ai===null&&(ai=e)):on()}function on(){$(ee,ee.current),$(qe,qe.current)}function Ye(e){H(qe),ai===e&&(ai=null),H(ee)}var ee=D(0);function Kr(e){for(var n=e;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||du(a)||fu(a)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Bi=0,bt=null,Pt=null,ae=null,Qr=!1,Ts=!1,Vn=!1,Wr=0,Ea=0,Cs=null,gb=0;function Qt(){throw Error(s(321))}function lc(e,n){if(n===null)return!1;for(var a=0;a<n.length&&a<e.length;a++)if(!Ge(e[a],n[a]))return!1;return!0}function oc(e,n,a,o,d,g){return Bi=g,bt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,P.H=e===null||e.memoizedState===null?wf:_c,Vn=!1,g=a(o,d),Vn=!1,Ts&&(g=Hd(n,a,o,d)),Id(e),g}function Id(e){P.H=Ma;var n=Pt!==null&&Pt.next!==null;if(Bi=0,ae=Pt=bt=null,Qr=!1,Ea=0,Cs=null,n)throw Error(s(300));e===null||re||(e=e.dependencies,e!==null&&Ir(e)&&(re=!0))}function Hd(e,n,a,o){bt=e;var d=0;do{if(Ts&&(Cs=null),Ea=0,Ts=!1,25<=d)throw Error(s(301));if(d+=1,ae=Pt=null,e.updateQueue!=null){var g=e.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}P.H=Ef,g=n(a,o)}while(Ts);return g}function mb(){var e=P.H,n=e.useState()[0];return n=typeof n.then=="function"?Ta(n):n,e=e.useState()[0],(Pt!==null?Pt.memoizedState:null)!==e&&(bt.flags|=1024),n}function cc(){var e=Wr!==0;return Wr=0,e}function uc(e,n,a){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~a}function hc(e){if(Qr){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}Qr=!1}Bi=0,ae=Pt=bt=null,Ts=!1,Ea=Wr=0,Cs=null}function Ee(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ae===null?bt.memoizedState=ae=e:ae=ae.next=e,ae}function ie(){if(Pt===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Pt.next;var n=ae===null?bt.memoizedState:ae.next;if(n!==null)ae=n,Pt=e;else{if(e===null)throw bt.alternate===null?Error(s(467)):Error(s(310));Pt=e,e={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},ae===null?bt.memoizedState=ae=e:ae=ae.next=e}return ae}function Zr(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ta(e){var n=Ea;return Ea+=1,Cs===null&&(Cs=[]),e=Od(Cs,e,n),n=bt,(ae===null?n.memoizedState:ae.next)===null&&(n=n.alternate,P.H=n===null||n.memoizedState===null?wf:_c),e}function Jr(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ta(e);if(e.$$typeof===T)return be(e)}throw Error(s(438,String(e)))}function dc(e){var n=null,a=bt.updateQueue;if(a!==null&&(n=a.memoCache),n==null){var o=bt.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(n={data:o.data.map(function(d){return d.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),a===null&&(a=Zr(),bt.updateQueue=a),a.memoCache=n,a=n.data[n.index],a===void 0)for(a=n.data[n.index]=Array(e),o=0;o<e;o++)a[o]=J;return n.index++,a}function Pi(e,n){return typeof n=="function"?n(e):n}function tl(e){var n=ie();return fc(n,Pt,e)}function fc(e,n,a){var o=e.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=a;var d=e.baseQueue,g=o.pending;if(g!==null){if(d!==null){var v=d.next;d.next=g.next,g.next=v}n.baseQueue=d=g,o.pending=null}if(g=e.baseState,d===null)e.memoizedState=g;else{n=d.next;var _=v=null,C=null,U=n,G=!1;do{var X=U.lane&-536870913;if(X!==U.lane?(wt&X)===X:(Bi&X)===X){var j=U.revertLane;if(j===0)C!==null&&(C=C.next={lane:0,revertLane:0,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),X===Ss&&(G=!0);else if((Bi&j)===j){U=U.next,j===Ss&&(G=!0);continue}else X={lane:0,revertLane:U.revertLane,gesture:null,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},C===null?(_=C=X,v=g):C=C.next=X,bt.lanes|=j,hn|=j;X=U.action,Vn&&a(g,X),g=U.hasEagerState?U.eagerState:a(g,X)}else j={lane:X,revertLane:U.revertLane,gesture:U.gesture,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null},C===null?(_=C=j,v=g):C=C.next=j,bt.lanes|=X,hn|=X;U=U.next}while(U!==null&&U!==n);if(C===null?v=g:C.next=_,!Ge(g,e.memoizedState)&&(re=!0,G&&(a=xs,a!==null)))throw a;e.memoizedState=g,e.baseState=v,e.baseQueue=C,o.lastRenderedState=g}return d===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function pc(e){var n=ie(),a=n.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var o=a.dispatch,d=a.pending,g=n.memoizedState;if(d!==null){a.pending=null;var v=d=d.next;do g=e(g,v.action),v=v.next;while(v!==d);Ge(g,n.memoizedState)||(re=!0),n.memoizedState=g,n.baseQueue===null&&(n.baseState=g),a.lastRenderedState=g}return[g,o]}function Gd(e,n,a){var o=bt,d=ie(),g=Tt;if(g){if(a===void 0)throw Error(s(407));a=a()}else a=n();var v=!Ge((Pt||d).memoizedState,a);if(v&&(d.memoizedState=a,re=!0),d=d.queue,bc(Yd.bind(null,o,d,e),[e]),d.getSnapshot!==n||v||ae!==null&&ae.memoizedState.tag&1){if(o.flags|=2048,Ms(9,{destroy:void 0},qd.bind(null,o,d,a,n),null),It===null)throw Error(s(349));g||(Bi&127)!==0||Vd(o,n,a)}return a}function Vd(e,n,a){e.flags|=16384,e={getSnapshot:n,value:a},n=bt.updateQueue,n===null?(n=Zr(),bt.updateQueue=n,n.stores=[e]):(a=n.stores,a===null?n.stores=[e]:a.push(e))}function qd(e,n,a,o){n.value=a,n.getSnapshot=o,Xd(n)&&$d(e)}function Yd(e,n,a){return a(function(){Xd(n)&&$d(e)})}function Xd(e){var n=e.getSnapshot;e=e.value;try{var a=n();return!Ge(e,a)}catch{return!0}}function $d(e){var n=Bn(e,2);n!==null&&Pe(n,e,2)}function gc(e){var n=Ee();if(typeof e=="function"){var a=e;if(e=a(),Vn){Qi(!0);try{a()}finally{Qi(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pi,lastRenderedState:e},n}function Kd(e,n,a,o){return e.baseState=a,fc(e,Pt,typeof o=="function"?o:Pi)}function bb(e,n,a,o,d){if(nl(e))throw Error(s(485));if(e=n.action,e!==null){var g={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){g.listeners.push(v)}};P.T!==null?a(!0):g.isTransition=!1,o(g),a=n.pending,a===null?(g.next=n.pending=g,Qd(n,g)):(g.next=a.next,n.pending=a.next=g)}}function Qd(e,n){var a=n.action,o=n.payload,d=e.state;if(n.isTransition){var g=P.T,v={};P.T=v;try{var _=a(d,o),C=P.S;C!==null&&C(v,_),Wd(e,n,_)}catch(U){mc(e,n,U)}finally{g!==null&&v.types!==null&&(g.types=v.types),P.T=g}}else try{g=a(d,o),Wd(e,n,g)}catch(U){mc(e,n,U)}}function Wd(e,n,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(o){Zd(e,n,o)},function(o){return mc(e,n,o)}):Zd(e,n,a)}function Zd(e,n,a){n.status="fulfilled",n.value=a,Jd(n),e.state=a,n=e.pending,n!==null&&(a=n.next,a===n?e.pending=null:(a=a.next,n.next=a,Qd(e,a)))}function mc(e,n,a){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do n.status="rejected",n.reason=a,Jd(n),n=n.next;while(n!==o)}e.action=null}function Jd(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function tf(e,n){return n}function ef(e,n){if(Tt){var a=It.formState;if(a!==null){t:{var o=bt;if(Tt){if(Gt){e:{for(var d=Gt,g=si;d.nodeType!==8;){if(!g){d=null;break e}if(d=ri(d.nextSibling),d===null){d=null;break e}}g=d.data,d=g==="F!"||g==="F"?d:null}if(d){Gt=ri(d.nextSibling),o=d.data==="F!";break t}}en(o)}o=!1}o&&(n=a[0])}}return a=Ee(),a.memoizedState=a.baseState=n,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tf,lastRenderedState:n},a.queue=o,a=Sf.bind(null,bt,o),o.dispatch=a,o=gc(!1),g=xc.bind(null,bt,!1,o.queue),o=Ee(),d={state:n,dispatch:null,action:e,pending:null},o.queue=d,a=bb.bind(null,bt,d,g,a),d.dispatch=a,o.memoizedState=e,[n,a,!1]}function nf(e){var n=ie();return sf(n,Pt,e)}function sf(e,n,a){if(n=fc(e,n,tf)[0],e=tl(Pi)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var o=Ta(n)}catch(v){throw v===_s?Vr:v}else o=n;n=ie();var d=n.queue,g=d.dispatch;return a!==n.memoizedState&&(bt.flags|=2048,Ms(9,{destroy:void 0},yb.bind(null,d,a),null)),[o,g,e]}function yb(e,n){e.action=n}function af(e){var n=ie(),a=Pt;if(a!==null)return sf(n,a,e);ie(),n=n.memoizedState,a=ie();var o=a.queue.dispatch;return a.memoizedState=e,[n,o,!1]}function Ms(e,n,a,o){return e={tag:e,create:a,deps:o,inst:n,next:null},n=bt.updateQueue,n===null&&(n=Zr(),bt.updateQueue=n),a=n.lastEffect,a===null?n.lastEffect=e.next=e:(o=a.next,a.next=e,e.next=o,n.lastEffect=e),e}function rf(){return ie().memoizedState}function el(e,n,a,o){var d=Ee();bt.flags|=e,d.memoizedState=Ms(1|n,{destroy:void 0},a,o===void 0?null:o)}function il(e,n,a,o){var d=ie();o=o===void 0?null:o;var g=d.memoizedState.inst;Pt!==null&&o!==null&&lc(o,Pt.memoizedState.deps)?d.memoizedState=Ms(n,g,a,o):(bt.flags|=e,d.memoizedState=Ms(1|n,g,a,o))}function lf(e,n){el(8390656,8,e,n)}function bc(e,n){il(2048,8,e,n)}function vb(e){bt.flags|=4;var n=bt.updateQueue;if(n===null)n=Zr(),bt.updateQueue=n,n.events=[e];else{var a=n.events;a===null?n.events=[e]:a.push(e)}}function of(e){var n=ie().memoizedState;return vb({ref:n,nextImpl:e}),function(){if((Nt&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function cf(e,n){return il(4,2,e,n)}function uf(e,n){return il(4,4,e,n)}function hf(e,n){if(typeof n=="function"){e=e();var a=n(e);return function(){typeof a=="function"?a():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function df(e,n,a){a=a!=null?a.concat([e]):null,il(4,4,hf.bind(null,n,e),a)}function yc(){}function ff(e,n){var a=ie();n=n===void 0?null:n;var o=a.memoizedState;return n!==null&&lc(n,o[1])?o[0]:(a.memoizedState=[e,n],e)}function pf(e,n){var a=ie();n=n===void 0?null:n;var o=a.memoizedState;if(n!==null&&lc(n,o[1]))return o[0];if(o=e(),Vn){Qi(!0);try{e()}finally{Qi(!1)}}return a.memoizedState=[o,n],o}function vc(e,n,a){return a===void 0||(Bi&1073741824)!==0&&(wt&261930)===0?e.memoizedState=n:(e.memoizedState=a,e=gp(),bt.lanes|=e,hn|=e,a)}function gf(e,n,a,o){return Ge(a,n)?a:Es.current!==null?(e=vc(e,a,o),Ge(e,n)||(re=!0),e):(Bi&42)===0||(Bi&1073741824)!==0&&(wt&261930)===0?(re=!0,e.memoizedState=a):(e=gp(),bt.lanes|=e,hn|=e,n)}function mf(e,n,a,o,d){var g=V.p;V.p=g!==0&&8>g?g:8;var v=P.T,_={};P.T=_,xc(e,!1,n,a);try{var C=d(),U=P.S;if(U!==null&&U(_,C),C!==null&&typeof C=="object"&&typeof C.then=="function"){var G=pb(C,o);Ca(e,n,G,Ke(e))}else Ca(e,n,o,Ke(e))}catch(X){Ca(e,n,{then:function(){},status:"rejected",reason:X},Ke())}finally{V.p=g,v!==null&&_.types!==null&&(v.types=_.types),P.T=v}}function Ab(){}function Ac(e,n,a,o){if(e.tag!==5)throw Error(s(476));var d=bf(e).queue;mf(e,d,n,Q,a===null?Ab:function(){return yf(e),a(o)})}function bf(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pi,lastRenderedState:Q},next:null};var a={};return n.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pi,lastRenderedState:a},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function yf(e){var n=bf(e);n.next===null&&(n=e.alternate.memoizedState),Ca(e,n.next.queue,{},Ke())}function Sc(){return be(Va)}function vf(){return ie().memoizedState}function Af(){return ie().memoizedState}function Sb(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var a=Ke();e=an(a);var o=rn(n,e,a);o!==null&&(Pe(o,n,a),xa(o,n,a)),n={cache:Qo()},e.payload=n;return}n=n.return}}function xb(e,n,a){var o=Ke();a={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},nl(e)?xf(n,a):(a=Uo(e,n,a,o),a!==null&&(Pe(a,e,o),_f(a,n,o)))}function Sf(e,n,a){var o=Ke();Ca(e,n,a,o)}function Ca(e,n,a,o){var d={lane:o,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(nl(e))xf(n,d);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=n.lastRenderedReducer,g!==null))try{var v=n.lastRenderedState,_=g(v,a);if(d.hasEagerState=!0,d.eagerState=_,Ge(_,v))return zr(e,n,d,0),It===null&&Pr(),!1}catch{}finally{}if(a=Uo(e,n,d,o),a!==null)return Pe(a,e,o),_f(a,n,o),!0}return!1}function xc(e,n,a,o){if(o={lane:2,revertLane:tu(),gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},nl(e)){if(n)throw Error(s(479))}else n=Uo(e,a,o,2),n!==null&&Pe(n,e,2)}function nl(e){var n=e.alternate;return e===bt||n!==null&&n===bt}function xf(e,n){Ts=Qr=!0;var a=e.pending;a===null?n.next=n:(n.next=a.next,a.next=n),e.pending=n}function _f(e,n,a){if((a&4194048)!==0){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Ch(e,a)}}var Ma={readContext:be,use:Jr,useCallback:Qt,useContext:Qt,useEffect:Qt,useImperativeHandle:Qt,useLayoutEffect:Qt,useInsertionEffect:Qt,useMemo:Qt,useReducer:Qt,useRef:Qt,useState:Qt,useDebugValue:Qt,useDeferredValue:Qt,useTransition:Qt,useSyncExternalStore:Qt,useId:Qt,useHostTransitionStatus:Qt,useFormState:Qt,useActionState:Qt,useOptimistic:Qt,useMemoCache:Qt,useCacheRefresh:Qt};Ma.useEffectEvent=Qt;var wf={readContext:be,use:Jr,useCallback:function(e,n){return Ee().memoizedState=[e,n===void 0?null:n],e},useContext:be,useEffect:lf,useImperativeHandle:function(e,n,a){a=a!=null?a.concat([e]):null,el(4194308,4,hf.bind(null,n,e),a)},useLayoutEffect:function(e,n){return el(4194308,4,e,n)},useInsertionEffect:function(e,n){el(4,2,e,n)},useMemo:function(e,n){var a=Ee();n=n===void 0?null:n;var o=e();if(Vn){Qi(!0);try{e()}finally{Qi(!1)}}return a.memoizedState=[o,n],o},useReducer:function(e,n,a){var o=Ee();if(a!==void 0){var d=a(n);if(Vn){Qi(!0);try{a(n)}finally{Qi(!1)}}}else d=n;return o.memoizedState=o.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},o.queue=e,e=e.dispatch=xb.bind(null,bt,e),[o.memoizedState,e]},useRef:function(e){var n=Ee();return e={current:e},n.memoizedState=e},useState:function(e){e=gc(e);var n=e.queue,a=Sf.bind(null,bt,n);return n.dispatch=a,[e.memoizedState,a]},useDebugValue:yc,useDeferredValue:function(e,n){var a=Ee();return vc(a,e,n)},useTransition:function(){var e=gc(!1);return e=mf.bind(null,bt,e.queue,!0,!1),Ee().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,a){var o=bt,d=Ee();if(Tt){if(a===void 0)throw Error(s(407));a=a()}else{if(a=n(),It===null)throw Error(s(349));(wt&127)!==0||Vd(o,n,a)}d.memoizedState=a;var g={value:a,getSnapshot:n};return d.queue=g,lf(Yd.bind(null,o,g,e),[e]),o.flags|=2048,Ms(9,{destroy:void 0},qd.bind(null,o,g,a,n),null),a},useId:function(){var e=Ee(),n=It.identifierPrefix;if(Tt){var a=bi,o=mi;a=(o&~(1<<32-He(o)-1)).toString(32)+a,n="_"+n+"R_"+a,a=Wr++,0<a&&(n+="H"+a.toString(32)),n+="_"}else a=gb++,n="_"+n+"r_"+a.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:Sc,useFormState:ef,useActionState:ef,useOptimistic:function(e){var n=Ee();n.memoizedState=n.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=a,n=xc.bind(null,bt,!0,a),a.dispatch=n,[e,n]},useMemoCache:dc,useCacheRefresh:function(){return Ee().memoizedState=Sb.bind(null,bt)},useEffectEvent:function(e){var n=Ee(),a={impl:e};return n.memoizedState=a,function(){if((Nt&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},_c={readContext:be,use:Jr,useCallback:ff,useContext:be,useEffect:bc,useImperativeHandle:df,useInsertionEffect:cf,useLayoutEffect:uf,useMemo:pf,useReducer:tl,useRef:rf,useState:function(){return tl(Pi)},useDebugValue:yc,useDeferredValue:function(e,n){var a=ie();return gf(a,Pt.memoizedState,e,n)},useTransition:function(){var e=tl(Pi)[0],n=ie().memoizedState;return[typeof e=="boolean"?e:Ta(e),n]},useSyncExternalStore:Gd,useId:vf,useHostTransitionStatus:Sc,useFormState:nf,useActionState:nf,useOptimistic:function(e,n){var a=ie();return Kd(a,Pt,e,n)},useMemoCache:dc,useCacheRefresh:Af};_c.useEffectEvent=of;var Ef={readContext:be,use:Jr,useCallback:ff,useContext:be,useEffect:bc,useImperativeHandle:df,useInsertionEffect:cf,useLayoutEffect:uf,useMemo:pf,useReducer:pc,useRef:rf,useState:function(){return pc(Pi)},useDebugValue:yc,useDeferredValue:function(e,n){var a=ie();return Pt===null?vc(a,e,n):gf(a,Pt.memoizedState,e,n)},useTransition:function(){var e=pc(Pi)[0],n=ie().memoizedState;return[typeof e=="boolean"?e:Ta(e),n]},useSyncExternalStore:Gd,useId:vf,useHostTransitionStatus:Sc,useFormState:af,useActionState:af,useOptimistic:function(e,n){var a=ie();return Pt!==null?Kd(a,Pt,e,n):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:dc,useCacheRefresh:Af};Ef.useEffectEvent=of;function wc(e,n,a,o){n=e.memoizedState,a=a(o,n),a=a==null?n:b({},n,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Ec={enqueueSetState:function(e,n,a){e=e._reactInternals;var o=Ke(),d=an(o);d.payload=n,a!=null&&(d.callback=a),n=rn(e,d,o),n!==null&&(Pe(n,e,o),xa(n,e,o))},enqueueReplaceState:function(e,n,a){e=e._reactInternals;var o=Ke(),d=an(o);d.tag=1,d.payload=n,a!=null&&(d.callback=a),n=rn(e,d,o),n!==null&&(Pe(n,e,o),xa(n,e,o))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var a=Ke(),o=an(a);o.tag=2,n!=null&&(o.callback=n),n=rn(e,o,a),n!==null&&(Pe(n,e,a),xa(n,e,a))}};function Tf(e,n,a,o,d,g,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,g,v):n.prototype&&n.prototype.isPureReactComponent?!pa(a,o)||!pa(d,g):!0}function Cf(e,n,a,o){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,o),n.state!==e&&Ec.enqueueReplaceState(n,n.state,null)}function qn(e,n){var a=n;if("ref"in n){a={};for(var o in n)o!=="ref"&&(a[o]=n[o])}if(e=e.defaultProps){a===n&&(a=b({},a));for(var d in e)a[d]===void 0&&(a[d]=e[d])}return a}function Mf(e){Br(e)}function Rf(e){console.error(e)}function Df(e){Br(e)}function sl(e,n){try{var a=e.onUncaughtError;a(n.value,{componentStack:n.stack})}catch(o){setTimeout(function(){throw o})}}function Nf(e,n,a){try{var o=e.onCaughtError;o(a.value,{componentStack:a.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Tc(e,n,a){return a=an(a),a.tag=3,a.payload={element:null},a.callback=function(){sl(e,n)},a}function Of(e){return e=an(e),e.tag=3,e}function Lf(e,n,a,o){var d=a.type.getDerivedStateFromError;if(typeof d=="function"){var g=o.value;e.payload=function(){return d(g)},e.callback=function(){Nf(n,a,o)}}var v=a.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){Nf(n,a,o),typeof d!="function"&&(dn===null?dn=new Set([this]):dn.add(this));var _=o.stack;this.componentDidCatch(o.value,{componentStack:_!==null?_:""})})}function _b(e,n,a,o,d){if(a.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(n=a.alternate,n!==null&&As(n,a,d,!0),a=qe.current,a!==null){switch(a.tag){case 31:case 13:return ai===null?ml():a.alternate===null&&Wt===0&&(Wt=3),a.flags&=-257,a.flags|=65536,a.lanes=d,o===qr?a.flags|=16384:(n=a.updateQueue,n===null?a.updateQueue=new Set([o]):n.add(o),Wc(e,o,d)),!1;case 22:return a.flags|=65536,o===qr?a.flags|=16384:(n=a.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([o])},a.updateQueue=n):(a=n.retryQueue,a===null?n.retryQueue=new Set([o]):a.add(o)),Wc(e,o,d)),!1}throw Error(s(435,a.tag))}return Wc(e,o,d),ml(),!1}if(Tt)return n=qe.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=d,o!==qo&&(e=Error(s(422),{cause:o}),ba(ei(e,a)))):(o!==qo&&(n=Error(s(423),{cause:o}),ba(ei(n,a))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,o=ei(o,a),d=Tc(e.stateNode,o,d),ic(e,d),Wt!==4&&(Wt=2)),!1;var g=Error(s(520),{cause:o});if(g=ei(g,a),Pa===null?Pa=[g]:Pa.push(g),Wt!==4&&(Wt=2),n===null)return!0;o=ei(o,a),a=n;do{switch(a.tag){case 3:return a.flags|=65536,e=d&-d,a.lanes|=e,e=Tc(a.stateNode,o,e),ic(a,e),!1;case 1:if(n=a.type,g=a.stateNode,(a.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(dn===null||!dn.has(g))))return a.flags|=65536,d&=-d,a.lanes|=d,d=Of(d),Lf(d,e,a,o),ic(a,d),!1}a=a.return}while(a!==null);return!1}var Cc=Error(s(461)),re=!1;function ye(e,n,a,o){n.child=e===null?Pd(n,null,a,o):Gn(n,e.child,a,o)}function kf(e,n,a,o,d){a=a.render;var g=n.ref;if("ref"in o){var v={};for(var _ in o)_!=="ref"&&(v[_]=o[_])}else v=o;return Un(n),o=oc(e,n,a,v,g,d),_=cc(),e!==null&&!re?(uc(e,n,d),zi(e,n,d)):(Tt&&_&&Go(n),n.flags|=1,ye(e,n,o,d),n.child)}function Bf(e,n,a,o,d){if(e===null){var g=a.type;return typeof g=="function"&&!jo(g)&&g.defaultProps===void 0&&a.compare===null?(n.tag=15,n.type=g,Pf(e,n,g,o,d)):(e=Ur(a.type,null,o,n,n.mode,d),e.ref=n.ref,e.return=n,n.child=e)}if(g=e.child,!Bc(e,d)){var v=g.memoizedProps;if(a=a.compare,a=a!==null?a:pa,a(v,o)&&e.ref===n.ref)return zi(e,n,d)}return n.flags|=1,e=Ni(g,o),e.ref=n.ref,e.return=n,n.child=e}function Pf(e,n,a,o,d){if(e!==null){var g=e.memoizedProps;if(pa(g,o)&&e.ref===n.ref)if(re=!1,n.pendingProps=o=g,Bc(e,d))(e.flags&131072)!==0&&(re=!0);else return n.lanes=e.lanes,zi(e,n,d)}return Mc(e,n,a,o,d)}function zf(e,n,a,o){var d=o.children,g=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.mode==="hidden"){if((n.flags&128)!==0){if(g=g!==null?g.baseLanes|a:a,e!==null){for(o=n.child=e.child,d=0;o!==null;)d=d|o.lanes|o.childLanes,o=o.sibling;o=d&~g}else o=0,n.child=null;return Ff(e,n,g,a,o)}if((a&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&Gr(n,g!==null?g.cachePool:null),g!==null?Ud(n,g):sc(),jd(n);else return o=n.lanes=536870912,Ff(e,n,g!==null?g.baseLanes|a:a,a,o)}else g!==null?(Gr(n,g.cachePool),Ud(n,g),on(),n.memoizedState=null):(e!==null&&Gr(n,null),sc(),on());return ye(e,n,d,a),n.child}function Ra(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Ff(e,n,a,o,d){var g=Zo();return g=g===null?null:{parent:se._currentValue,pool:g},n.memoizedState={baseLanes:a,cachePool:g},e!==null&&Gr(n,null),sc(),jd(n),e!==null&&As(e,n,o,!0),n.childLanes=d,null}function al(e,n){return n=ll({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function Uf(e,n,a){return Gn(n,e.child,null,a),e=al(n,n.pendingProps),e.flags|=2,Ye(n),n.memoizedState=null,e}function wb(e,n,a){var o=n.pendingProps,d=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Tt){if(o.mode==="hidden")return e=al(n,o),n.lanes=536870912,Ra(null,e);if(rc(n),(e=Gt)?(e=Wp(e,si),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Ji!==null?{id:mi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},a=Sd(e),a.return=n,n.child=a,me=n,Gt=null)):e=null,e===null)throw en(n);return n.lanes=536870912,null}return al(n,o)}var g=e.memoizedState;if(g!==null){var v=g.dehydrated;if(rc(n),d)if(n.flags&256)n.flags&=-257,n=Uf(e,n,a);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(s(558));else if(re||As(e,n,a,!1),d=(a&e.childLanes)!==0,re||d){if(o=It,o!==null&&(v=Mh(o,a),v!==0&&v!==g.retryLane))throw g.retryLane=v,Bn(e,v),Pe(o,e,v),Cc;ml(),n=Uf(e,n,a)}else e=g.treeContext,Gt=ri(v.nextSibling),me=n,Tt=!0,tn=null,si=!1,e!==null&&wd(n,e),n=al(n,o),n.flags|=4096;return n}return e=Ni(e.child,{mode:o.mode,children:o.children}),e.ref=n.ref,n.child=e,e.return=n,e}function rl(e,n){var a=n.ref;if(a===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(n.flags|=4194816)}}function Mc(e,n,a,o,d){return Un(n),a=oc(e,n,a,o,void 0,d),o=cc(),e!==null&&!re?(uc(e,n,d),zi(e,n,d)):(Tt&&o&&Go(n),n.flags|=1,ye(e,n,a,d),n.child)}function jf(e,n,a,o,d,g){return Un(n),n.updateQueue=null,a=Hd(n,o,a,d),Id(e),o=cc(),e!==null&&!re?(uc(e,n,g),zi(e,n,g)):(Tt&&o&&Go(n),n.flags|=1,ye(e,n,a,g),n.child)}function If(e,n,a,o,d){if(Un(n),n.stateNode===null){var g=ms,v=a.contextType;typeof v=="object"&&v!==null&&(g=be(v)),g=new a(o,g),n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Ec,n.stateNode=g,g._reactInternals=n,g=n.stateNode,g.props=o,g.state=n.memoizedState,g.refs={},tc(n),v=a.contextType,g.context=typeof v=="object"&&v!==null?be(v):ms,g.state=n.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(wc(n,a,v,o),g.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(v=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),v!==g.state&&Ec.enqueueReplaceState(g,g.state,null),wa(n,o,g,d),_a(),g.state=n.memoizedState),typeof g.componentDidMount=="function"&&(n.flags|=4194308),o=!0}else if(e===null){g=n.stateNode;var _=n.memoizedProps,C=qn(a,_);g.props=C;var U=g.context,G=a.contextType;v=ms,typeof G=="object"&&G!==null&&(v=be(G));var X=a.getDerivedStateFromProps;G=typeof X=="function"||typeof g.getSnapshotBeforeUpdate=="function",_=n.pendingProps!==_,G||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(_||U!==v)&&Cf(n,g,o,v),sn=!1;var j=n.memoizedState;g.state=j,wa(n,o,g,d),_a(),U=n.memoizedState,_||j!==U||sn?(typeof X=="function"&&(wc(n,a,X,o),U=n.memoizedState),(C=sn||Tf(n,a,C,o,j,U,v))?(G||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(n.flags|=4194308)):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=U),g.props=o,g.state=U,g.context=v,o=C):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{g=n.stateNode,ec(e,n),v=n.memoizedProps,G=qn(a,v),g.props=G,X=n.pendingProps,j=g.context,U=a.contextType,C=ms,typeof U=="object"&&U!==null&&(C=be(U)),_=a.getDerivedStateFromProps,(U=typeof _=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(v!==X||j!==C)&&Cf(n,g,o,C),sn=!1,j=n.memoizedState,g.state=j,wa(n,o,g,d),_a();var I=n.memoizedState;v!==X||j!==I||sn||e!==null&&e.dependencies!==null&&Ir(e.dependencies)?(typeof _=="function"&&(wc(n,a,_,o),I=n.memoizedState),(G=sn||Tf(n,a,G,o,j,I,C)||e!==null&&e.dependencies!==null&&Ir(e.dependencies))?(U||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(o,I,C),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(o,I,C)),typeof g.componentDidUpdate=="function"&&(n.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof g.componentDidUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=I),g.props=o,g.state=I,g.context=C,o=G):(typeof g.componentDidUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&j===e.memoizedState||(n.flags|=1024),o=!1)}return g=o,rl(e,n),o=(n.flags&128)!==0,g||o?(g=n.stateNode,a=o&&typeof a.getDerivedStateFromError!="function"?null:g.render(),n.flags|=1,e!==null&&o?(n.child=Gn(n,e.child,null,d),n.child=Gn(n,null,a,d)):ye(e,n,a,d),n.memoizedState=g.state,e=n.child):e=zi(e,n,d),e}function Hf(e,n,a,o){return zn(),n.flags|=256,ye(e,n,a,o),n.child}var Rc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dc(e){return{baseLanes:e,cachePool:Dd()}}function Nc(e,n,a){return e=e!==null?e.childLanes&~a:0,n&&(e|=$e),e}function Gf(e,n,a){var o=n.pendingProps,d=!1,g=(n.flags&128)!==0,v;if((v=g)||(v=e!==null&&e.memoizedState===null?!1:(ee.current&2)!==0),v&&(d=!0,n.flags&=-129),v=(n.flags&32)!==0,n.flags&=-33,e===null){if(Tt){if(d?ln(n):on(),(e=Gt)?(e=Wp(e,si),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Ji!==null?{id:mi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},a=Sd(e),a.return=n,n.child=a,me=n,Gt=null)):e=null,e===null)throw en(n);return fu(e)?n.lanes=32:n.lanes=536870912,null}var _=o.children;return o=o.fallback,d?(on(),d=n.mode,_=ll({mode:"hidden",children:_},d),o=Pn(o,d,a,null),_.return=n,o.return=n,_.sibling=o,n.child=_,o=n.child,o.memoizedState=Dc(a),o.childLanes=Nc(e,v,a),n.memoizedState=Rc,Ra(null,o)):(ln(n),Oc(n,_))}var C=e.memoizedState;if(C!==null&&(_=C.dehydrated,_!==null)){if(g)n.flags&256?(ln(n),n.flags&=-257,n=Lc(e,n,a)):n.memoizedState!==null?(on(),n.child=e.child,n.flags|=128,n=null):(on(),_=o.fallback,d=n.mode,o=ll({mode:"visible",children:o.children},d),_=Pn(_,d,a,null),_.flags|=2,o.return=n,_.return=n,o.sibling=_,n.child=o,Gn(n,e.child,null,a),o=n.child,o.memoizedState=Dc(a),o.childLanes=Nc(e,v,a),n.memoizedState=Rc,n=Ra(null,o));else if(ln(n),fu(_)){if(v=_.nextSibling&&_.nextSibling.dataset,v)var U=v.dgst;v=U,o=Error(s(419)),o.stack="",o.digest=v,ba({value:o,source:null,stack:null}),n=Lc(e,n,a)}else if(re||As(e,n,a,!1),v=(a&e.childLanes)!==0,re||v){if(v=It,v!==null&&(o=Mh(v,a),o!==0&&o!==C.retryLane))throw C.retryLane=o,Bn(e,o),Pe(v,e,o),Cc;du(_)||ml(),n=Lc(e,n,a)}else du(_)?(n.flags|=192,n.child=e.child,n=null):(e=C.treeContext,Gt=ri(_.nextSibling),me=n,Tt=!0,tn=null,si=!1,e!==null&&wd(n,e),n=Oc(n,o.children),n.flags|=4096);return n}return d?(on(),_=o.fallback,d=n.mode,C=e.child,U=C.sibling,o=Ni(C,{mode:"hidden",children:o.children}),o.subtreeFlags=C.subtreeFlags&65011712,U!==null?_=Ni(U,_):(_=Pn(_,d,a,null),_.flags|=2),_.return=n,o.return=n,o.sibling=_,n.child=o,Ra(null,o),o=n.child,_=e.child.memoizedState,_===null?_=Dc(a):(d=_.cachePool,d!==null?(C=se._currentValue,d=d.parent!==C?{parent:C,pool:C}:d):d=Dd(),_={baseLanes:_.baseLanes|a,cachePool:d}),o.memoizedState=_,o.childLanes=Nc(e,v,a),n.memoizedState=Rc,Ra(e.child,o)):(ln(n),a=e.child,e=a.sibling,a=Ni(a,{mode:"visible",children:o.children}),a.return=n,a.sibling=null,e!==null&&(v=n.deletions,v===null?(n.deletions=[e],n.flags|=16):v.push(e)),n.child=a,n.memoizedState=null,a)}function Oc(e,n){return n=ll({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function ll(e,n){return e=Ve(22,e,null,n),e.lanes=0,e}function Lc(e,n,a){return Gn(n,e.child,null,a),e=Oc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Vf(e,n,a){e.lanes|=n;var o=e.alternate;o!==null&&(o.lanes|=n),$o(e.return,n,a)}function kc(e,n,a,o,d,g){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:d,treeForkCount:g}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=o,v.tail=a,v.tailMode=d,v.treeForkCount=g)}function qf(e,n,a){var o=n.pendingProps,d=o.revealOrder,g=o.tail;o=o.children;var v=ee.current,_=(v&2)!==0;if(_?(v=v&1|2,n.flags|=128):v&=1,$(ee,v),ye(e,n,o,a),o=Tt?ma:0,!_&&e!==null&&(e.flags&128)!==0)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vf(e,a,n);else if(e.tag===19)Vf(e,a,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(a=n.child,d=null;a!==null;)e=a.alternate,e!==null&&Kr(e)===null&&(d=a),a=a.sibling;a=d,a===null?(d=n.child,n.child=null):(d=a.sibling,a.sibling=null),kc(n,!1,d,a,g,o);break;case"backwards":case"unstable_legacy-backwards":for(a=null,d=n.child,n.child=null;d!==null;){if(e=d.alternate,e!==null&&Kr(e)===null){n.child=d;break}e=d.sibling,d.sibling=a,a=d,d=e}kc(n,!0,a,null,g,o);break;case"together":kc(n,!1,null,null,void 0,o);break;default:n.memoizedState=null}return n.child}function zi(e,n,a){if(e!==null&&(n.dependencies=e.dependencies),hn|=n.lanes,(a&n.childLanes)===0)if(e!==null){if(As(e,n,a,!1),(a&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,a=Ni(e,e.pendingProps),n.child=a,a.return=n;e.sibling!==null;)e=e.sibling,a=a.sibling=Ni(e,e.pendingProps),a.return=n;a.sibling=null}return n.child}function Bc(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&Ir(e)))}function Eb(e,n,a){switch(n.tag){case 3:te(n,n.stateNode.containerInfo),nn(n,se,e.memoizedState.cache),zn();break;case 27:case 5:Mn(n);break;case 4:te(n,n.stateNode.containerInfo);break;case 10:nn(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,rc(n),null;break;case 13:var o=n.memoizedState;if(o!==null)return o.dehydrated!==null?(ln(n),n.flags|=128,null):(a&n.child.childLanes)!==0?Gf(e,n,a):(ln(n),e=zi(e,n,a),e!==null?e.sibling:null);ln(n);break;case 19:var d=(e.flags&128)!==0;if(o=(a&n.childLanes)!==0,o||(As(e,n,a,!1),o=(a&n.childLanes)!==0),d){if(o)return qf(e,n,a);n.flags|=128}if(d=n.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),$(ee,ee.current),o)break;return null;case 22:return n.lanes=0,zf(e,n,a,n.pendingProps);case 24:nn(n,se,e.memoizedState.cache)}return zi(e,n,a)}function Yf(e,n,a){if(e!==null)if(e.memoizedProps!==n.pendingProps)re=!0;else{if(!Bc(e,a)&&(n.flags&128)===0)return re=!1,Eb(e,n,a);re=(e.flags&131072)!==0}else re=!1,Tt&&(n.flags&1048576)!==0&&_d(n,ma,n.index);switch(n.lanes=0,n.tag){case 16:t:{var o=n.pendingProps;if(e=In(n.elementType),n.type=e,typeof e=="function")jo(e)?(o=qn(e,o),n.tag=1,n=If(null,n,e,o,a)):(n.tag=0,n=Mc(null,n,e,o,a));else{if(e!=null){var d=e.$$typeof;if(d===L){n.tag=11,n=kf(null,n,e,o,a);break t}else if(d===z){n.tag=14,n=Bf(null,n,e,o,a);break t}}throw n=vt(e)||e,Error(s(306,n,""))}}return n;case 0:return Mc(e,n,n.type,n.pendingProps,a);case 1:return o=n.type,d=qn(o,n.pendingProps),If(e,n,o,d,a);case 3:t:{if(te(n,n.stateNode.containerInfo),e===null)throw Error(s(387));o=n.pendingProps;var g=n.memoizedState;d=g.element,ec(e,n),wa(n,o,null,a);var v=n.memoizedState;if(o=v.cache,nn(n,se,o),o!==g.cache&&Ko(n,[se],a,!0),_a(),o=v.element,g.isDehydrated)if(g={element:o,isDehydrated:!1,cache:v.cache},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){n=Hf(e,n,o,a);break t}else if(o!==d){d=ei(Error(s(424)),n),ba(d),n=Hf(e,n,o,a);break t}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Gt=ri(e.firstChild),me=n,Tt=!0,tn=null,si=!0,a=Pd(n,null,o,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(zn(),o===d){n=zi(e,n,a);break t}ye(e,n,o,a)}n=n.child}return n;case 26:return rl(e,n),e===null?(a=ng(n.type,null,n.pendingProps,null))?n.memoizedState=a:Tt||(a=n.type,e=n.pendingProps,o=_l(ut.current).createElement(a),o[ge]=n,o[De]=e,ve(o,a,e),he(o),n.stateNode=o):n.memoizedState=ng(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Mn(n),e===null&&Tt&&(o=n.stateNode=tg(n.type,n.pendingProps,ut.current),me=n,si=!0,d=Gt,mn(n.type)?(pu=d,Gt=ri(o.firstChild)):Gt=d),ye(e,n,n.pendingProps.children,a),rl(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Tt&&((d=o=Gt)&&(o=ey(o,n.type,n.pendingProps,si),o!==null?(n.stateNode=o,me=n,Gt=ri(o.firstChild),si=!1,d=!0):d=!1),d||en(n)),Mn(n),d=n.type,g=n.pendingProps,v=e!==null?e.memoizedProps:null,o=g.children,cu(d,g)?o=null:v!==null&&cu(d,v)&&(n.flags|=32),n.memoizedState!==null&&(d=oc(e,n,mb,null,null,a),Va._currentValue=d),rl(e,n),ye(e,n,o,a),n.child;case 6:return e===null&&Tt&&((e=a=Gt)&&(a=iy(a,n.pendingProps,si),a!==null?(n.stateNode=a,me=n,Gt=null,e=!0):e=!1),e||en(n)),null;case 13:return Gf(e,n,a);case 4:return te(n,n.stateNode.containerInfo),o=n.pendingProps,e===null?n.child=Gn(n,null,o,a):ye(e,n,o,a),n.child;case 11:return kf(e,n,n.type,n.pendingProps,a);case 7:return ye(e,n,n.pendingProps,a),n.child;case 8:return ye(e,n,n.pendingProps.children,a),n.child;case 12:return ye(e,n,n.pendingProps.children,a),n.child;case 10:return o=n.pendingProps,nn(n,n.type,o.value),ye(e,n,o.children,a),n.child;case 9:return d=n.type._context,o=n.pendingProps.children,Un(n),d=be(d),o=o(d),n.flags|=1,ye(e,n,o,a),n.child;case 14:return Bf(e,n,n.type,n.pendingProps,a);case 15:return Pf(e,n,n.type,n.pendingProps,a);case 19:return qf(e,n,a);case 31:return wb(e,n,a);case 22:return zf(e,n,a,n.pendingProps);case 24:return Un(n),o=be(se),e===null?(d=Zo(),d===null&&(d=It,g=Qo(),d.pooledCache=g,g.refCount++,g!==null&&(d.pooledCacheLanes|=a),d=g),n.memoizedState={parent:o,cache:d},tc(n),nn(n,se,d)):((e.lanes&a)!==0&&(ec(e,n),wa(n,null,null,a),_a()),d=e.memoizedState,g=n.memoizedState,d.parent!==o?(d={parent:o,cache:o},n.memoizedState=d,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=d),nn(n,se,o)):(o=g.cache,nn(n,se,o),o!==d.cache&&Ko(n,[se],a,!0))),ye(e,n,n.pendingProps.children,a),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function Fi(e){e.flags|=4}function Pc(e,n,a,o,d){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(vp())e.flags|=8192;else throw Hn=qr,Jo}else e.flags&=-16777217}function Xf(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!og(n))if(vp())e.flags|=8192;else throw Hn=qr,Jo}function ol(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Eh():536870912,e.lanes|=n,Os|=n)}function Da(e,n){if(!Tt)switch(e.tailMode){case"hidden":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Vt(e){var n=e.alternate!==null&&e.alternate.child===e.child,a=0,o=0;if(n)for(var d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags&65011712,o|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags,o|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=o,e.childLanes=a,n}function Tb(e,n,a){var o=n.pendingProps;switch(Vo(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vt(n),null;case 1:return Vt(n),null;case 3:return a=n.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),ki(se),jt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(vs(n)?Fi(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Yo())),Vt(n),null;case 26:var d=n.type,g=n.memoizedState;return e===null?(Fi(n),g!==null?(Vt(n),Xf(n,g)):(Vt(n),Pc(n,d,null,o,a))):g?g!==e.memoizedState?(Fi(n),Vt(n),Xf(n,g)):(Vt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==o&&Fi(n),Vt(n),Pc(n,d,e,o,a)),null;case 27:if(Ki(n),a=ut.current,d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&Fi(n);else{if(!o){if(n.stateNode===null)throw Error(s(166));return Vt(n),null}e=tt.current,vs(n)?Ed(n):(e=tg(d,o,a),n.stateNode=e,Fi(n))}return Vt(n),null;case 5:if(Ki(n),d=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&Fi(n);else{if(!o){if(n.stateNode===null)throw Error(s(166));return Vt(n),null}if(g=tt.current,vs(n))Ed(n);else{var v=_l(ut.current);switch(g){case 1:g=v.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:g=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":g=v.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":g=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":g=v.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof o.is=="string"?v.createElement("select",{is:o.is}):v.createElement("select"),o.multiple?g.multiple=!0:o.size&&(g.size=o.size);break;default:g=typeof o.is=="string"?v.createElement(d,{is:o.is}):v.createElement(d)}}g[ge]=n,g[De]=o;t:for(v=n.child;v!==null;){if(v.tag===5||v.tag===6)g.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===n)break t;for(;v.sibling===null;){if(v.return===null||v.return===n)break t;v=v.return}v.sibling.return=v.return,v=v.sibling}n.stateNode=g;t:switch(ve(g,d,o),d){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&Fi(n)}}return Vt(n),Pc(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,a),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==o&&Fi(n);else{if(typeof o!="string"&&n.stateNode===null)throw Error(s(166));if(e=ut.current,vs(n)){if(e=n.stateNode,a=n.memoizedProps,o=null,d=me,d!==null)switch(d.tag){case 27:case 5:o=d.memoizedProps}e[ge]=n,e=!!(e.nodeValue===a||o!==null&&o.suppressHydrationWarning===!0||Gp(e.nodeValue,a)),e||en(n,!0)}else e=_l(e).createTextNode(o),e[ge]=n,n.stateNode=e}return Vt(n),null;case 31:if(a=n.memoizedState,e===null||e.memoizedState!==null){if(o=vs(n),a!==null){if(e===null){if(!o)throw Error(s(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[ge]=n}else zn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Vt(n),e=!1}else a=Yo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return n.flags&256?(Ye(n),n):(Ye(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Vt(n),null;case 13:if(o=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=vs(n),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(s(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));d[ge]=n}else zn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Vt(n),d=!1}else d=Yo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return n.flags&256?(Ye(n),n):(Ye(n),null)}return Ye(n),(n.flags&128)!==0?(n.lanes=a,n):(a=o!==null,e=e!==null&&e.memoizedState!==null,a&&(o=n.child,d=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(d=o.alternate.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==d&&(o.flags|=2048)),a!==e&&a&&(n.child.flags|=8192),ol(n,n.updateQueue),Vt(n),null);case 4:return jt(),e===null&&su(n.stateNode.containerInfo),Vt(n),null;case 10:return ki(n.type),Vt(n),null;case 19:if(H(ee),o=n.memoizedState,o===null)return Vt(n),null;if(d=(n.flags&128)!==0,g=o.rendering,g===null)if(d)Da(o,!1);else{if(Wt!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(g=Kr(e),g!==null){for(n.flags|=128,Da(o,!1),e=g.updateQueue,n.updateQueue=e,ol(n,e),n.subtreeFlags=0,e=a,a=n.child;a!==null;)Ad(a,e),a=a.sibling;return $(ee,ee.current&1|2),Tt&&Oi(n,o.treeForkCount),n.child}e=e.sibling}o.tail!==null&&je()>fl&&(n.flags|=128,d=!0,Da(o,!1),n.lanes=4194304)}else{if(!d)if(e=Kr(g),e!==null){if(n.flags|=128,d=!0,e=e.updateQueue,n.updateQueue=e,ol(n,e),Da(o,!0),o.tail===null&&o.tailMode==="hidden"&&!g.alternate&&!Tt)return Vt(n),null}else 2*je()-o.renderingStartTime>fl&&a!==536870912&&(n.flags|=128,d=!0,Da(o,!1),n.lanes=4194304);o.isBackwards?(g.sibling=n.child,n.child=g):(e=o.last,e!==null?e.sibling=g:n.child=g,o.last=g)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=je(),e.sibling=null,a=ee.current,$(ee,d?a&1|2:a&1),Tt&&Oi(n,o.treeForkCount),e):(Vt(n),null);case 22:case 23:return Ye(n),ac(),o=n.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(n.flags|=8192):o&&(n.flags|=8192),o?(a&536870912)!==0&&(n.flags&128)===0&&(Vt(n),n.subtreeFlags&6&&(n.flags|=8192)):Vt(n),a=n.updateQueue,a!==null&&ol(n,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),o=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),o!==a&&(n.flags|=2048),e!==null&&H(jn),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),n.memoizedState.cache!==a&&(n.flags|=2048),ki(se),Vt(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function Cb(e,n){switch(Vo(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return ki(se),jt(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return Ki(n),null;case 31:if(n.memoizedState!==null){if(Ye(n),n.alternate===null)throw Error(s(340));zn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(Ye(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));zn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return H(ee),null;case 4:return jt(),null;case 10:return ki(n.type),null;case 22:case 23:return Ye(n),ac(),e!==null&&H(jn),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return ki(se),null;case 25:return null;default:return null}}function $f(e,n){switch(Vo(n),n.tag){case 3:ki(se),jt();break;case 26:case 27:case 5:Ki(n);break;case 4:jt();break;case 31:n.memoizedState!==null&&Ye(n);break;case 13:Ye(n);break;case 19:H(ee);break;case 10:ki(n.type);break;case 22:case 23:Ye(n),ac(),e!==null&&H(jn);break;case 24:ki(se)}}function Na(e,n){try{var a=n.updateQueue,o=a!==null?a.lastEffect:null;if(o!==null){var d=o.next;a=d;do{if((a.tag&e)===e){o=void 0;var g=a.create,v=a.inst;o=g(),v.destroy=o}a=a.next}while(a!==d)}}catch(_){Bt(n,n.return,_)}}function cn(e,n,a){try{var o=n.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var g=d.next;o=g;do{if((o.tag&e)===e){var v=o.inst,_=v.destroy;if(_!==void 0){v.destroy=void 0,d=n;var C=a,U=_;try{U()}catch(G){Bt(d,C,G)}}}o=o.next}while(o!==g)}}catch(G){Bt(n,n.return,G)}}function Kf(e){var n=e.updateQueue;if(n!==null){var a=e.stateNode;try{Fd(n,a)}catch(o){Bt(e,e.return,o)}}}function Qf(e,n,a){a.props=qn(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(o){Bt(e,n,o)}}function Oa(e,n){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof a=="function"?e.refCleanup=a(o):a.current=o}}catch(d){Bt(e,n,d)}}function yi(e,n){var a=e.ref,o=e.refCleanup;if(a!==null)if(typeof o=="function")try{o()}catch(d){Bt(e,n,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(d){Bt(e,n,d)}else a.current=null}function Wf(e){var n=e.type,a=e.memoizedProps,o=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":a.autoFocus&&o.focus();break t;case"img":a.src?o.src=a.src:a.srcSet&&(o.srcset=a.srcSet)}}catch(d){Bt(e,e.return,d)}}function zc(e,n,a){try{var o=e.stateNode;Kb(o,e.type,a,n),o[De]=n}catch(d){Bt(e,e.return,d)}}function Zf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&mn(e.type)||e.tag===4}function Fc(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Zf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&mn(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Uc(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,n):(n=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,n.appendChild(e),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=Ri));else if(o!==4&&(o===27&&mn(e.type)&&(a=e.stateNode,n=null),e=e.child,e!==null))for(Uc(e,n,a),e=e.sibling;e!==null;)Uc(e,n,a),e=e.sibling}function cl(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?a.insertBefore(e,n):a.appendChild(e);else if(o!==4&&(o===27&&mn(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(cl(e,n,a),e=e.sibling;e!==null;)cl(e,n,a),e=e.sibling}function Jf(e){var n=e.stateNode,a=e.memoizedProps;try{for(var o=e.type,d=n.attributes;d.length;)n.removeAttributeNode(d[0]);ve(n,o,a),n[ge]=e,n[De]=a}catch(g){Bt(e,e.return,g)}}var Ui=!1,le=!1,jc=!1,tp=typeof WeakSet=="function"?WeakSet:Set,de=null;function Mb(e,n){if(e=e.containerInfo,lu=Dl,e=hd(e),Lo(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else t:{a=(a=e.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var d=o.anchorOffset,g=o.focusNode;o=o.focusOffset;try{a.nodeType,g.nodeType}catch{a=null;break t}var v=0,_=-1,C=-1,U=0,G=0,X=e,j=null;e:for(;;){for(var I;X!==a||d!==0&&X.nodeType!==3||(_=v+d),X!==g||o!==0&&X.nodeType!==3||(C=v+o),X.nodeType===3&&(v+=X.nodeValue.length),(I=X.firstChild)!==null;)j=X,X=I;for(;;){if(X===e)break e;if(j===a&&++U===d&&(_=v),j===g&&++G===o&&(C=v),(I=X.nextSibling)!==null)break;X=j,j=X.parentNode}X=I}a=_===-1||C===-1?null:{start:_,end:C}}else a=null}a=a||{start:0,end:0}}else a=null;for(ou={focusedElem:e,selectionRange:a},Dl=!1,de=n;de!==null;)if(n=de,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,de=e;else for(;de!==null;){switch(n=de,g=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)d=e[a],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&g!==null){e=void 0,a=n,d=g.memoizedProps,g=g.memoizedState,o=a.stateNode;try{var it=qn(a.type,d);e=o.getSnapshotBeforeUpdate(it,g),o.__reactInternalSnapshotBeforeUpdate=e}catch(ct){Bt(a,a.return,ct)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,a=e.nodeType,a===9)hu(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":hu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,de=e;break}de=n.return}}function ep(e,n,a){var o=a.flags;switch(a.tag){case 0:case 11:case 15:Ii(e,a),o&4&&Na(5,a);break;case 1:if(Ii(e,a),o&4)if(e=a.stateNode,n===null)try{e.componentDidMount()}catch(v){Bt(a,a.return,v)}else{var d=qn(a.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(d,n,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Bt(a,a.return,v)}}o&64&&Kf(a),o&512&&Oa(a,a.return);break;case 3:if(Ii(e,a),o&64&&(e=a.updateQueue,e!==null)){if(n=null,a.child!==null)switch(a.child.tag){case 27:case 5:n=a.child.stateNode;break;case 1:n=a.child.stateNode}try{Fd(e,n)}catch(v){Bt(a,a.return,v)}}break;case 27:n===null&&o&4&&Jf(a);case 26:case 5:Ii(e,a),n===null&&o&4&&Wf(a),o&512&&Oa(a,a.return);break;case 12:Ii(e,a);break;case 31:Ii(e,a),o&4&&sp(e,a);break;case 13:Ii(e,a),o&4&&ap(e,a),o&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=zb.bind(null,a),ny(e,a))));break;case 22:if(o=a.memoizedState!==null||Ui,!o){n=n!==null&&n.memoizedState!==null||le,d=Ui;var g=le;Ui=o,(le=n)&&!g?Hi(e,a,(a.subtreeFlags&8772)!==0):Ii(e,a),Ui=d,le=g}break;case 30:break;default:Ii(e,a)}}function ip(e){var n=e.alternate;n!==null&&(e.alternate=null,ip(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&mo(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var qt=null,Oe=!1;function ji(e,n,a){for(a=a.child;a!==null;)np(e,n,a),a=a.sibling}function np(e,n,a){if(Ie&&typeof Ie.onCommitFiberUnmount=="function")try{Ie.onCommitFiberUnmount(ia,a)}catch{}switch(a.tag){case 26:le||yi(a,n),ji(e,n,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:le||yi(a,n);var o=qt,d=Oe;mn(a.type)&&(qt=a.stateNode,Oe=!1),ji(e,n,a),Ia(a.stateNode),qt=o,Oe=d;break;case 5:le||yi(a,n);case 6:if(o=qt,d=Oe,qt=null,ji(e,n,a),qt=o,Oe=d,qt!==null)if(Oe)try{(qt.nodeType===9?qt.body:qt.nodeName==="HTML"?qt.ownerDocument.body:qt).removeChild(a.stateNode)}catch(g){Bt(a,n,g)}else try{qt.removeChild(a.stateNode)}catch(g){Bt(a,n,g)}break;case 18:qt!==null&&(Oe?(e=qt,Kp(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),js(e)):Kp(qt,a.stateNode));break;case 4:o=qt,d=Oe,qt=a.stateNode.containerInfo,Oe=!0,ji(e,n,a),qt=o,Oe=d;break;case 0:case 11:case 14:case 15:cn(2,a,n),le||cn(4,a,n),ji(e,n,a);break;case 1:le||(yi(a,n),o=a.stateNode,typeof o.componentWillUnmount=="function"&&Qf(a,n,o)),ji(e,n,a);break;case 21:ji(e,n,a);break;case 22:le=(o=le)||a.memoizedState!==null,ji(e,n,a),le=o;break;default:ji(e,n,a)}}function sp(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{js(e)}catch(a){Bt(n,n.return,a)}}}function ap(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{js(e)}catch(a){Bt(n,n.return,a)}}function Rb(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new tp),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new tp),n;default:throw Error(s(435,e.tag))}}function ul(e,n){var a=Rb(e);n.forEach(function(o){if(!a.has(o)){a.add(o);var d=Fb.bind(null,e,o);o.then(d,d)}})}function Le(e,n){var a=n.deletions;if(a!==null)for(var o=0;o<a.length;o++){var d=a[o],g=e,v=n,_=v;t:for(;_!==null;){switch(_.tag){case 27:if(mn(_.type)){qt=_.stateNode,Oe=!1;break t}break;case 5:qt=_.stateNode,Oe=!1;break t;case 3:case 4:qt=_.stateNode.containerInfo,Oe=!0;break t}_=_.return}if(qt===null)throw Error(s(160));np(g,v,d),qt=null,Oe=!1,g=d.alternate,g!==null&&(g.return=null),d.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)rp(n,e),n=n.sibling}var fi=null;function rp(e,n){var a=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Le(n,e),ke(e),o&4&&(cn(3,e,e.return),Na(3,e),cn(5,e,e.return));break;case 1:Le(n,e),ke(e),o&512&&(le||a===null||yi(a,a.return)),o&64&&Ui&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?o:a.concat(o))));break;case 26:var d=fi;if(Le(n,e),ke(e),o&512&&(le||a===null||yi(a,a.return)),o&4){var g=a!==null?a.memoizedState:null;if(o=e.memoizedState,a===null)if(o===null)if(e.stateNode===null){t:{o=e.type,a=e.memoizedProps,d=d.ownerDocument||d;e:switch(o){case"title":g=d.getElementsByTagName("title")[0],(!g||g[aa]||g[ge]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=d.createElement(o),d.head.insertBefore(g,d.querySelector("head > title"))),ve(g,o,a),g[ge]=e,he(g),o=g;break t;case"link":var v=rg("link","href",d).get(o+(a.href||""));if(v){for(var _=0;_<v.length;_++)if(g=v[_],g.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&g.getAttribute("rel")===(a.rel==null?null:a.rel)&&g.getAttribute("title")===(a.title==null?null:a.title)&&g.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){v.splice(_,1);break e}}g=d.createElement(o),ve(g,o,a),d.head.appendChild(g);break;case"meta":if(v=rg("meta","content",d).get(o+(a.content||""))){for(_=0;_<v.length;_++)if(g=v[_],g.getAttribute("content")===(a.content==null?null:""+a.content)&&g.getAttribute("name")===(a.name==null?null:a.name)&&g.getAttribute("property")===(a.property==null?null:a.property)&&g.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&g.getAttribute("charset")===(a.charSet==null?null:a.charSet)){v.splice(_,1);break e}}g=d.createElement(o),ve(g,o,a),d.head.appendChild(g);break;default:throw Error(s(468,o))}g[ge]=e,he(g),o=g}e.stateNode=o}else lg(d,e.type,e.stateNode);else e.stateNode=ag(d,o,e.memoizedProps);else g!==o?(g===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):g.count--,o===null?lg(d,e.type,e.stateNode):ag(d,o,e.memoizedProps)):o===null&&e.stateNode!==null&&zc(e,e.memoizedProps,a.memoizedProps)}break;case 27:Le(n,e),ke(e),o&512&&(le||a===null||yi(a,a.return)),a!==null&&o&4&&zc(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Le(n,e),ke(e),o&512&&(le||a===null||yi(a,a.return)),e.flags&32){d=e.stateNode;try{cs(d,"")}catch(it){Bt(e,e.return,it)}}o&4&&e.stateNode!=null&&(d=e.memoizedProps,zc(e,d,a!==null?a.memoizedProps:d)),o&1024&&(jc=!0);break;case 6:if(Le(n,e),ke(e),o&4){if(e.stateNode===null)throw Error(s(162));o=e.memoizedProps,a=e.stateNode;try{a.nodeValue=o}catch(it){Bt(e,e.return,it)}}break;case 3:if(Tl=null,d=fi,fi=wl(n.containerInfo),Le(n,e),fi=d,ke(e),o&4&&a!==null&&a.memoizedState.isDehydrated)try{js(n.containerInfo)}catch(it){Bt(e,e.return,it)}jc&&(jc=!1,lp(e));break;case 4:o=fi,fi=wl(e.stateNode.containerInfo),Le(n,e),ke(e),fi=o;break;case 12:Le(n,e),ke(e);break;case 31:Le(n,e),ke(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,ul(e,o)));break;case 13:Le(n,e),ke(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(dl=je()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,ul(e,o)));break;case 22:d=e.memoizedState!==null;var C=a!==null&&a.memoizedState!==null,U=Ui,G=le;if(Ui=U||d,le=G||C,Le(n,e),le=G,Ui=U,ke(e),o&8192)t:for(n=e.stateNode,n._visibility=d?n._visibility&-2:n._visibility|1,d&&(a===null||C||Ui||le||Yn(e)),a=null,n=e;;){if(n.tag===5||n.tag===26){if(a===null){C=a=n;try{if(g=C.stateNode,d)v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{_=C.stateNode;var X=C.memoizedProps.style,j=X!=null&&X.hasOwnProperty("display")?X.display:null;_.style.display=j==null||typeof j=="boolean"?"":(""+j).trim()}}catch(it){Bt(C,C.return,it)}}}else if(n.tag===6){if(a===null){C=n;try{C.stateNode.nodeValue=d?"":C.memoizedProps}catch(it){Bt(C,C.return,it)}}}else if(n.tag===18){if(a===null){C=n;try{var I=C.stateNode;d?Qp(I,!0):Qp(C.stateNode,!1)}catch(it){Bt(C,C.return,it)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;a===n&&(a=null),n=n.return}a===n&&(a=null),n.sibling.return=n.return,n=n.sibling}o&4&&(o=e.updateQueue,o!==null&&(a=o.retryQueue,a!==null&&(o.retryQueue=null,ul(e,a))));break;case 19:Le(n,e),ke(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,ul(e,o)));break;case 30:break;case 21:break;default:Le(n,e),ke(e)}}function ke(e){var n=e.flags;if(n&2){try{for(var a,o=e.return;o!==null;){if(Zf(o)){a=o;break}o=o.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var d=a.stateNode,g=Fc(e);cl(e,g,d);break;case 5:var v=a.stateNode;a.flags&32&&(cs(v,""),a.flags&=-33);var _=Fc(e);cl(e,_,v);break;case 3:case 4:var C=a.stateNode.containerInfo,U=Fc(e);Uc(e,U,C);break;default:throw Error(s(161))}}catch(G){Bt(e,e.return,G)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function lp(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;lp(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function Ii(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)ep(e,n.alternate,n),n=n.sibling}function Yn(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:cn(4,n,n.return),Yn(n);break;case 1:yi(n,n.return);var a=n.stateNode;typeof a.componentWillUnmount=="function"&&Qf(n,n.return,a),Yn(n);break;case 27:Ia(n.stateNode);case 26:case 5:yi(n,n.return),Yn(n);break;case 22:n.memoizedState===null&&Yn(n);break;case 30:Yn(n);break;default:Yn(n)}e=e.sibling}}function Hi(e,n,a){for(a=a&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var o=n.alternate,d=e,g=n,v=g.flags;switch(g.tag){case 0:case 11:case 15:Hi(d,g,a),Na(4,g);break;case 1:if(Hi(d,g,a),o=g,d=o.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(U){Bt(o,o.return,U)}if(o=g,d=o.updateQueue,d!==null){var _=o.stateNode;try{var C=d.shared.hiddenCallbacks;if(C!==null)for(d.shared.hiddenCallbacks=null,d=0;d<C.length;d++)zd(C[d],_)}catch(U){Bt(o,o.return,U)}}a&&v&64&&Kf(g),Oa(g,g.return);break;case 27:Jf(g);case 26:case 5:Hi(d,g,a),a&&o===null&&v&4&&Wf(g),Oa(g,g.return);break;case 12:Hi(d,g,a);break;case 31:Hi(d,g,a),a&&v&4&&sp(d,g);break;case 13:Hi(d,g,a),a&&v&4&&ap(d,g);break;case 22:g.memoizedState===null&&Hi(d,g,a),Oa(g,g.return);break;case 30:break;default:Hi(d,g,a)}n=n.sibling}}function Ic(e,n){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&ya(a))}function Hc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&ya(e))}function pi(e,n,a,o){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)op(e,n,a,o),n=n.sibling}function op(e,n,a,o){var d=n.flags;switch(n.tag){case 0:case 11:case 15:pi(e,n,a,o),d&2048&&Na(9,n);break;case 1:pi(e,n,a,o);break;case 3:pi(e,n,a,o),d&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&ya(e)));break;case 12:if(d&2048){pi(e,n,a,o),e=n.stateNode;try{var g=n.memoizedProps,v=g.id,_=g.onPostCommit;typeof _=="function"&&_(v,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(C){Bt(n,n.return,C)}}else pi(e,n,a,o);break;case 31:pi(e,n,a,o);break;case 13:pi(e,n,a,o);break;case 23:break;case 22:g=n.stateNode,v=n.alternate,n.memoizedState!==null?g._visibility&2?pi(e,n,a,o):La(e,n):g._visibility&2?pi(e,n,a,o):(g._visibility|=2,Rs(e,n,a,o,(n.subtreeFlags&10256)!==0||!1)),d&2048&&Ic(v,n);break;case 24:pi(e,n,a,o),d&2048&&Hc(n.alternate,n);break;default:pi(e,n,a,o)}}function Rs(e,n,a,o,d){for(d=d&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var g=e,v=n,_=a,C=o,U=v.flags;switch(v.tag){case 0:case 11:case 15:Rs(g,v,_,C,d),Na(8,v);break;case 23:break;case 22:var G=v.stateNode;v.memoizedState!==null?G._visibility&2?Rs(g,v,_,C,d):La(g,v):(G._visibility|=2,Rs(g,v,_,C,d)),d&&U&2048&&Ic(v.alternate,v);break;case 24:Rs(g,v,_,C,d),d&&U&2048&&Hc(v.alternate,v);break;default:Rs(g,v,_,C,d)}n=n.sibling}}function La(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var a=e,o=n,d=o.flags;switch(o.tag){case 22:La(a,o),d&2048&&Ic(o.alternate,o);break;case 24:La(a,o),d&2048&&Hc(o.alternate,o);break;default:La(a,o)}n=n.sibling}}var ka=8192;function Ds(e,n,a){if(e.subtreeFlags&ka)for(e=e.child;e!==null;)cp(e,n,a),e=e.sibling}function cp(e,n,a){switch(e.tag){case 26:Ds(e,n,a),e.flags&ka&&e.memoizedState!==null&&gy(a,fi,e.memoizedState,e.memoizedProps);break;case 5:Ds(e,n,a);break;case 3:case 4:var o=fi;fi=wl(e.stateNode.containerInfo),Ds(e,n,a),fi=o;break;case 22:e.memoizedState===null&&(o=e.alternate,o!==null&&o.memoizedState!==null?(o=ka,ka=16777216,Ds(e,n,a),ka=o):Ds(e,n,a));break;default:Ds(e,n,a)}}function up(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Ba(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];de=o,dp(o,e)}up(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)hp(e),e=e.sibling}function hp(e){switch(e.tag){case 0:case 11:case 15:Ba(e),e.flags&2048&&cn(9,e,e.return);break;case 3:Ba(e);break;case 12:Ba(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,hl(e)):Ba(e);break;default:Ba(e)}}function hl(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];de=o,dp(o,e)}up(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:cn(8,n,n.return),hl(n);break;case 22:a=n.stateNode,a._visibility&2&&(a._visibility&=-3,hl(n));break;default:hl(n)}e=e.sibling}}function dp(e,n){for(;de!==null;){var a=de;switch(a.tag){case 0:case 11:case 15:cn(8,a,n);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var o=a.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:ya(a.memoizedState.cache)}if(o=a.child,o!==null)o.return=a,de=o;else t:for(a=e;de!==null;){o=de;var d=o.sibling,g=o.return;if(ip(o),o===a){de=null;break t}if(d!==null){d.return=g,de=d;break t}de=g}}}var Db={getCacheForType:function(e){var n=be(se),a=n.data.get(e);return a===void 0&&(a=e(),n.data.set(e,a)),a},cacheSignal:function(){return be(se).controller.signal}},Nb=typeof WeakMap=="function"?WeakMap:Map,Nt=0,It=null,xt=null,wt=0,kt=0,Xe=null,un=!1,Ns=!1,Gc=!1,Gi=0,Wt=0,hn=0,Xn=0,Vc=0,$e=0,Os=0,Pa=null,Be=null,qc=!1,dl=0,fp=0,fl=1/0,pl=null,dn=null,ue=0,fn=null,Ls=null,Vi=0,Yc=0,Xc=null,pp=null,za=0,$c=null;function Ke(){return(Nt&2)!==0&&wt!==0?wt&-wt:P.T!==null?tu():Rh()}function gp(){if($e===0)if((wt&536870912)===0||Tt){var e=xr;xr<<=1,(xr&3932160)===0&&(xr=262144),$e=e}else $e=536870912;return e=qe.current,e!==null&&(e.flags|=32),$e}function Pe(e,n,a){(e===It&&(kt===2||kt===9)||e.cancelPendingCommit!==null)&&(ks(e,0),pn(e,wt,$e,!1)),sa(e,a),((Nt&2)===0||e!==It)&&(e===It&&((Nt&2)===0&&(Xn|=a),Wt===4&&pn(e,wt,$e,!1)),vi(e))}function mp(e,n,a){if((Nt&6)!==0)throw Error(s(327));var o=!a&&(n&127)===0&&(n&e.expiredLanes)===0||na(e,n),d=o?kb(e,n):Qc(e,n,!0),g=o;do{if(d===0){Ns&&!o&&pn(e,n,0,!1);break}else{if(a=e.current.alternate,g&&!Ob(a)){d=Qc(e,n,!1),g=!1;continue}if(d===2){if(g=n,e.errorRecoveryDisabledLanes&g)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){n=v;t:{var _=e;d=Pa;var C=_.current.memoizedState.isDehydrated;if(C&&(ks(_,v).flags|=256),v=Qc(_,v,!1),v!==2){if(Gc&&!C){_.errorRecoveryDisabledLanes|=g,Xn|=g,d=4;break t}g=Be,Be=d,g!==null&&(Be===null?Be=g:Be.push.apply(Be,g))}d=v}if(g=!1,d!==2)continue}}if(d===1){ks(e,0),pn(e,n,0,!0);break}t:{switch(o=e,g=d,g){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:pn(o,n,$e,!un);break t;case 2:Be=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(d=dl+300-je(),10<d)){if(pn(o,n,$e,!un),wr(o,0,!0)!==0)break t;Vi=n,o.timeoutHandle=Xp(bp.bind(null,o,a,Be,pl,qc,n,$e,Xn,Os,un,g,"Throttled",-0,0),d);break t}bp(o,a,Be,pl,qc,n,$e,Xn,Os,un,g,null,-0,0)}}break}while(!0);vi(e)}function bp(e,n,a,o,d,g,v,_,C,U,G,X,j,I){if(e.timeoutHandle=-1,X=n.subtreeFlags,X&8192||(X&16785408)===16785408){X={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ri},cp(n,g,X);var it=(g&62914560)===g?dl-je():(g&4194048)===g?fp-je():0;if(it=my(X,it),it!==null){Vi=g,e.cancelPendingCommit=it(Ep.bind(null,e,n,g,a,o,d,v,_,C,G,X,null,j,I)),pn(e,g,v,!U);return}}Ep(e,n,g,a,o,d,v,_,C)}function Ob(e){for(var n=e;;){var a=n.tag;if((a===0||a===11||a===15)&&n.flags&16384&&(a=n.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var o=0;o<a.length;o++){var d=a[o],g=d.getSnapshot;d=d.value;try{if(!Ge(g(),d))return!1}catch{return!1}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function pn(e,n,a,o){n&=~Vc,n&=~Xn,e.suspendedLanes|=n,e.pingedLanes&=~n,o&&(e.warmLanes|=n),o=e.expirationTimes;for(var d=n;0<d;){var g=31-He(d),v=1<<g;o[g]=-1,d&=~v}a!==0&&Th(e,a,n)}function gl(){return(Nt&6)===0?(Fa(0),!1):!0}function Kc(){if(xt!==null){if(kt===0)var e=xt.return;else e=xt,Li=Fn=null,hc(e),ws=null,Aa=0,e=xt;for(;e!==null;)$f(e.alternate,e),e=e.return;xt=null}}function ks(e,n){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,Zb(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Vi=0,Kc(),It=e,xt=a=Ni(e.current,null),wt=n,kt=0,Xe=null,un=!1,Ns=na(e,n),Gc=!1,Os=$e=Vc=Xn=hn=Wt=0,Be=Pa=null,qc=!1,(n&8)!==0&&(n|=n&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=n;0<o;){var d=31-He(o),g=1<<d;n|=e[d],o&=~g}return Gi=n,Pr(),a}function yp(e,n){bt=null,P.H=Ma,n===_s||n===Vr?(n=Ld(),kt=3):n===Jo?(n=Ld(),kt=4):kt=n===Cc?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Xe=n,xt===null&&(Wt=1,sl(e,ei(n,e.current)))}function vp(){var e=qe.current;return e===null?!0:(wt&4194048)===wt?ai===null:(wt&62914560)===wt||(wt&536870912)!==0?e===ai:!1}function Ap(){var e=P.H;return P.H=Ma,e===null?Ma:e}function Sp(){var e=P.A;return P.A=Db,e}function ml(){Wt=4,un||(wt&4194048)!==wt&&qe.current!==null||(Ns=!0),(hn&134217727)===0&&(Xn&134217727)===0||It===null||pn(It,wt,$e,!1)}function Qc(e,n,a){var o=Nt;Nt|=2;var d=Ap(),g=Sp();(It!==e||wt!==n)&&(pl=null,ks(e,n)),n=!1;var v=Wt;t:do try{if(kt!==0&&xt!==null){var _=xt,C=Xe;switch(kt){case 8:Kc(),v=6;break t;case 3:case 2:case 9:case 6:qe.current===null&&(n=!0);var U=kt;if(kt=0,Xe=null,Bs(e,_,C,U),a&&Ns){v=0;break t}break;default:U=kt,kt=0,Xe=null,Bs(e,_,C,U)}}Lb(),v=Wt;break}catch(G){yp(e,G)}while(!0);return n&&e.shellSuspendCounter++,Li=Fn=null,Nt=o,P.H=d,P.A=g,xt===null&&(It=null,wt=0,Pr()),v}function Lb(){for(;xt!==null;)xp(xt)}function kb(e,n){var a=Nt;Nt|=2;var o=Ap(),d=Sp();It!==e||wt!==n?(pl=null,fl=je()+500,ks(e,n)):Ns=na(e,n);t:do try{if(kt!==0&&xt!==null){n=xt;var g=Xe;e:switch(kt){case 1:kt=0,Xe=null,Bs(e,n,g,1);break;case 2:case 9:if(Nd(g)){kt=0,Xe=null,_p(n);break}n=function(){kt!==2&&kt!==9||It!==e||(kt=7),vi(e)},g.then(n,n);break t;case 3:kt=7;break t;case 4:kt=5;break t;case 7:Nd(g)?(kt=0,Xe=null,_p(n)):(kt=0,Xe=null,Bs(e,n,g,7));break;case 5:var v=null;switch(xt.tag){case 26:v=xt.memoizedState;case 5:case 27:var _=xt;if(v?og(v):_.stateNode.complete){kt=0,Xe=null;var C=_.sibling;if(C!==null)xt=C;else{var U=_.return;U!==null?(xt=U,bl(U)):xt=null}break e}}kt=0,Xe=null,Bs(e,n,g,5);break;case 6:kt=0,Xe=null,Bs(e,n,g,6);break;case 8:Kc(),Wt=6;break t;default:throw Error(s(462))}}Bb();break}catch(G){yp(e,G)}while(!0);return Li=Fn=null,P.H=o,P.A=d,Nt=a,xt!==null?0:(It=null,wt=0,Pr(),Wt)}function Bb(){for(;xt!==null&&!s0();)xp(xt)}function xp(e){var n=Yf(e.alternate,e,Gi);e.memoizedProps=e.pendingProps,n===null?bl(e):xt=n}function _p(e){var n=e,a=n.alternate;switch(n.tag){case 15:case 0:n=jf(a,n,n.pendingProps,n.type,void 0,wt);break;case 11:n=jf(a,n,n.pendingProps,n.type.render,n.ref,wt);break;case 5:hc(n);default:$f(a,n),n=xt=Ad(n,Gi),n=Yf(a,n,Gi)}e.memoizedProps=e.pendingProps,n===null?bl(e):xt=n}function Bs(e,n,a,o){Li=Fn=null,hc(n),ws=null,Aa=0;var d=n.return;try{if(_b(e,d,n,a,wt)){Wt=1,sl(e,ei(a,e.current)),xt=null;return}}catch(g){if(d!==null)throw xt=d,g;Wt=1,sl(e,ei(a,e.current)),xt=null;return}n.flags&32768?(Tt||o===1?e=!0:Ns||(wt&536870912)!==0?e=!1:(un=e=!0,(o===2||o===9||o===3||o===6)&&(o=qe.current,o!==null&&o.tag===13&&(o.flags|=16384))),wp(n,e)):bl(n)}function bl(e){var n=e;do{if((n.flags&32768)!==0){wp(n,un);return}e=n.return;var a=Tb(n.alternate,n,Gi);if(a!==null){xt=a;return}if(n=n.sibling,n!==null){xt=n;return}xt=n=e}while(n!==null);Wt===0&&(Wt=5)}function wp(e,n){do{var a=Cb(e.alternate,e);if(a!==null){a.flags&=32767,xt=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!n&&(e=e.sibling,e!==null)){xt=e;return}xt=e=a}while(e!==null);Wt=6,xt=null}function Ep(e,n,a,o,d,g,v,_,C){e.cancelPendingCommit=null;do yl();while(ue!==0);if((Nt&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(g=n.lanes|n.childLanes,g|=Fo,p0(e,a,g,v,_,C),e===It&&(xt=It=null,wt=0),Ls=n,fn=e,Vi=a,Yc=g,Xc=d,pp=o,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ub(Ar,function(){return Dp(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||o){o=P.T,P.T=null,d=V.p,V.p=2,v=Nt,Nt|=4;try{Mb(e,n,a)}finally{Nt=v,V.p=d,P.T=o}}ue=1,Tp(),Cp(),Mp()}}function Tp(){if(ue===1){ue=0;var e=fn,n=Ls,a=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||a){a=P.T,P.T=null;var o=V.p;V.p=2;var d=Nt;Nt|=4;try{rp(n,e);var g=ou,v=hd(e.containerInfo),_=g.focusedElem,C=g.selectionRange;if(v!==_&&_&&_.ownerDocument&&ud(_.ownerDocument.documentElement,_)){if(C!==null&&Lo(_)){var U=C.start,G=C.end;if(G===void 0&&(G=U),"selectionStart"in _)_.selectionStart=U,_.selectionEnd=Math.min(G,_.value.length);else{var X=_.ownerDocument||document,j=X&&X.defaultView||window;if(j.getSelection){var I=j.getSelection(),it=_.textContent.length,ct=Math.min(C.start,it),Ft=C.end===void 0?ct:Math.min(C.end,it);!I.extend&&ct>Ft&&(v=Ft,Ft=ct,ct=v);var B=cd(_,ct),N=cd(_,Ft);if(B&&N&&(I.rangeCount!==1||I.anchorNode!==B.node||I.anchorOffset!==B.offset||I.focusNode!==N.node||I.focusOffset!==N.offset)){var F=X.createRange();F.setStart(B.node,B.offset),I.removeAllRanges(),ct>Ft?(I.addRange(F),I.extend(N.node,N.offset)):(F.setEnd(N.node,N.offset),I.addRange(F))}}}}for(X=[],I=_;I=I.parentNode;)I.nodeType===1&&X.push({element:I,left:I.scrollLeft,top:I.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<X.length;_++){var Y=X[_];Y.element.scrollLeft=Y.left,Y.element.scrollTop=Y.top}}Dl=!!lu,ou=lu=null}finally{Nt=d,V.p=o,P.T=a}}e.current=n,ue=2}}function Cp(){if(ue===2){ue=0;var e=fn,n=Ls,a=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||a){a=P.T,P.T=null;var o=V.p;V.p=2;var d=Nt;Nt|=4;try{ep(e,n.alternate,n)}finally{Nt=d,V.p=o,P.T=a}}ue=3}}function Mp(){if(ue===4||ue===3){ue=0,a0();var e=fn,n=Ls,a=Vi,o=pp;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?ue=5:(ue=0,Ls=fn=null,Rp(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(dn=null),po(a),n=n.stateNode,Ie&&typeof Ie.onCommitFiberRoot=="function")try{Ie.onCommitFiberRoot(ia,n,void 0,(n.current.flags&128)===128)}catch{}if(o!==null){n=P.T,d=V.p,V.p=2,P.T=null;try{for(var g=e.onRecoverableError,v=0;v<o.length;v++){var _=o[v];g(_.value,{componentStack:_.stack})}}finally{P.T=n,V.p=d}}(Vi&3)!==0&&yl(),vi(e),d=e.pendingLanes,(a&261930)!==0&&(d&42)!==0?e===$c?za++:(za=0,$c=e):za=0,Fa(0)}}function Rp(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,ya(n)))}function yl(){return Tp(),Cp(),Mp(),Dp()}function Dp(){if(ue!==5)return!1;var e=fn,n=Yc;Yc=0;var a=po(Vi),o=P.T,d=V.p;try{V.p=32>a?32:a,P.T=null,a=Xc,Xc=null;var g=fn,v=Vi;if(ue=0,Ls=fn=null,Vi=0,(Nt&6)!==0)throw Error(s(331));var _=Nt;if(Nt|=4,hp(g.current),op(g,g.current,v,a),Nt=_,Fa(0,!1),Ie&&typeof Ie.onPostCommitFiberRoot=="function")try{Ie.onPostCommitFiberRoot(ia,g)}catch{}return!0}finally{V.p=d,P.T=o,Rp(e,n)}}function Np(e,n,a){n=ei(a,n),n=Tc(e.stateNode,n,2),e=rn(e,n,2),e!==null&&(sa(e,2),vi(e))}function Bt(e,n,a){if(e.tag===3)Np(e,e,a);else for(;n!==null;){if(n.tag===3){Np(n,e,a);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(dn===null||!dn.has(o))){e=ei(a,e),a=Of(2),o=rn(n,a,2),o!==null&&(Lf(a,o,n,e),sa(o,2),vi(o));break}}n=n.return}}function Wc(e,n,a){var o=e.pingCache;if(o===null){o=e.pingCache=new Nb;var d=new Set;o.set(n,d)}else d=o.get(n),d===void 0&&(d=new Set,o.set(n,d));d.has(a)||(Gc=!0,d.add(a),e=Pb.bind(null,e,n,a),n.then(e,e))}function Pb(e,n,a){var o=e.pingCache;o!==null&&o.delete(n),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,It===e&&(wt&a)===a&&(Wt===4||Wt===3&&(wt&62914560)===wt&&300>je()-dl?(Nt&2)===0&&ks(e,0):Vc|=a,Os===wt&&(Os=0)),vi(e)}function Op(e,n){n===0&&(n=Eh()),e=Bn(e,n),e!==null&&(sa(e,n),vi(e))}function zb(e){var n=e.memoizedState,a=0;n!==null&&(a=n.retryLane),Op(e,a)}function Fb(e,n){var a=0;switch(e.tag){case 31:case 13:var o=e.stateNode,d=e.memoizedState;d!==null&&(a=d.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(s(314))}o!==null&&o.delete(n),Op(e,a)}function Ub(e,n){return co(e,n)}var vl=null,Ps=null,Zc=!1,Al=!1,Jc=!1,gn=0;function vi(e){e!==Ps&&e.next===null&&(Ps===null?vl=Ps=e:Ps=Ps.next=e),Al=!0,Zc||(Zc=!0,Ib())}function Fa(e,n){if(!Jc&&Al){Jc=!0;do for(var a=!1,o=vl;o!==null;){if(e!==0){var d=o.pendingLanes;if(d===0)var g=0;else{var v=o.suspendedLanes,_=o.pingedLanes;g=(1<<31-He(42|e)+1)-1,g&=d&~(v&~_),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(a=!0,Pp(o,g))}else g=wt,g=wr(o,o===It?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(g&3)===0||na(o,g)||(a=!0,Pp(o,g));o=o.next}while(a);Jc=!1}}function jb(){Lp()}function Lp(){Al=Zc=!1;var e=0;gn!==0&&Wb()&&(e=gn);for(var n=je(),a=null,o=vl;o!==null;){var d=o.next,g=kp(o,n);g===0?(o.next=null,a===null?vl=d:a.next=d,d===null&&(Ps=a)):(a=o,(e!==0||(g&3)!==0)&&(Al=!0)),o=d}ue!==0&&ue!==5||Fa(e),gn!==0&&(gn=0)}function kp(e,n){for(var a=e.suspendedLanes,o=e.pingedLanes,d=e.expirationTimes,g=e.pendingLanes&-62914561;0<g;){var v=31-He(g),_=1<<v,C=d[v];C===-1?((_&a)===0||(_&o)!==0)&&(d[v]=f0(_,n)):C<=n&&(e.expiredLanes|=_),g&=~_}if(n=It,a=wt,a=wr(e,e===n?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,a===0||e===n&&(kt===2||kt===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&uo(o),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||na(e,a)){if(n=a&-a,n===e.callbackPriority)return n;switch(o!==null&&uo(o),po(a)){case 2:case 8:a=_h;break;case 32:a=Ar;break;case 268435456:a=wh;break;default:a=Ar}return o=Bp.bind(null,e),a=co(a,o),e.callbackPriority=n,e.callbackNode=a,n}return o!==null&&o!==null&&uo(o),e.callbackPriority=2,e.callbackNode=null,2}function Bp(e,n){if(ue!==0&&ue!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(yl()&&e.callbackNode!==a)return null;var o=wt;return o=wr(e,e===It?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(mp(e,o,n),kp(e,je()),e.callbackNode!=null&&e.callbackNode===a?Bp.bind(null,e):null)}function Pp(e,n){if(yl())return null;mp(e,n,!0)}function Ib(){Jb(function(){(Nt&6)!==0?co(xh,jb):Lp()})}function tu(){if(gn===0){var e=Ss;e===0&&(e=Sr,Sr<<=1,(Sr&261888)===0&&(Sr=256)),gn=e}return gn}function zp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Mr(""+e)}function Fp(e,n){var a=n.ownerDocument.createElement("input");return a.name=n.name,a.value=n.value,e.id&&a.setAttribute("form",e.id),n.parentNode.insertBefore(a,n),e=new FormData(e),a.parentNode.removeChild(a),e}function Hb(e,n,a,o,d){if(n==="submit"&&a&&a.stateNode===d){var g=zp((d[De]||null).action),v=o.submitter;v&&(n=(n=v[De]||null)?zp(n.formAction):v.getAttribute("formAction"),n!==null&&(g=n,v=null));var _=new Or("action","action",null,o,d);e.push({event:_,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(gn!==0){var C=v?Fp(d,v):new FormData(d);Ac(a,{pending:!0,data:C,method:d.method,action:g},null,C)}}else typeof g=="function"&&(_.preventDefault(),C=v?Fp(d,v):new FormData(d),Ac(a,{pending:!0,data:C,method:d.method,action:g},g,C))},currentTarget:d}]})}}for(var eu=0;eu<zo.length;eu++){var iu=zo[eu],Gb=iu.toLowerCase(),Vb=iu[0].toUpperCase()+iu.slice(1);di(Gb,"on"+Vb)}di(pd,"onAnimationEnd"),di(gd,"onAnimationIteration"),di(md,"onAnimationStart"),di("dblclick","onDoubleClick"),di("focusin","onFocus"),di("focusout","onBlur"),di(rb,"onTransitionRun"),di(lb,"onTransitionStart"),di(ob,"onTransitionCancel"),di(bd,"onTransitionEnd"),ls("onMouseEnter",["mouseout","mouseover"]),ls("onMouseLeave",["mouseout","mouseover"]),ls("onPointerEnter",["pointerout","pointerover"]),ls("onPointerLeave",["pointerout","pointerover"]),Nn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Nn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Nn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Nn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Nn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Nn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ua));function Up(e,n){n=(n&4)!==0;for(var a=0;a<e.length;a++){var o=e[a],d=o.event;o=o.listeners;t:{var g=void 0;if(n)for(var v=o.length-1;0<=v;v--){var _=o[v],C=_.instance,U=_.currentTarget;if(_=_.listener,C!==g&&d.isPropagationStopped())break t;g=_,d.currentTarget=U;try{g(d)}catch(G){Br(G)}d.currentTarget=null,g=C}else for(v=0;v<o.length;v++){if(_=o[v],C=_.instance,U=_.currentTarget,_=_.listener,C!==g&&d.isPropagationStopped())break t;g=_,d.currentTarget=U;try{g(d)}catch(G){Br(G)}d.currentTarget=null,g=C}}}}function _t(e,n){var a=n[go];a===void 0&&(a=n[go]=new Set);var o=e+"__bubble";a.has(o)||(jp(n,e,2,!1),a.add(o))}function nu(e,n,a){var o=0;n&&(o|=4),jp(a,e,o,n)}var Sl="_reactListening"+Math.random().toString(36).slice(2);function su(e){if(!e[Sl]){e[Sl]=!0,Oh.forEach(function(a){a!=="selectionchange"&&(qb.has(a)||nu(a,!1,e),nu(a,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Sl]||(n[Sl]=!0,nu("selectionchange",!1,n))}}function jp(e,n,a,o){switch(gg(n)){case 2:var d=vy;break;case 8:d=Ay;break;default:d=vu}a=d.bind(null,n,a,e),d=void 0,!wo||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(d=!0),o?d!==void 0?e.addEventListener(n,a,{capture:!0,passive:d}):e.addEventListener(n,a,!0):d!==void 0?e.addEventListener(n,a,{passive:d}):e.addEventListener(n,a,!1)}function au(e,n,a,o,d){var g=o;if((n&1)===0&&(n&2)===0&&o!==null)t:for(;;){if(o===null)return;var v=o.tag;if(v===3||v===4){var _=o.stateNode.containerInfo;if(_===d)break;if(v===4)for(v=o.return;v!==null;){var C=v.tag;if((C===3||C===4)&&v.stateNode.containerInfo===d)return;v=v.return}for(;_!==null;){if(v=ss(_),v===null)return;if(C=v.tag,C===5||C===6||C===26||C===27){o=g=v;continue t}_=_.parentNode}}o=o.return}Vh(function(){var U=g,G=xo(a),X=[];t:{var j=yd.get(e);if(j!==void 0){var I=Or,it=e;switch(e){case"keypress":if(Dr(a)===0)break t;case"keydown":case"keyup":I=F0;break;case"focusin":it="focus",I=Mo;break;case"focusout":it="blur",I=Mo;break;case"beforeblur":case"afterblur":I=Mo;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=Xh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=T0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=I0;break;case pd:case gd:case md:I=R0;break;case bd:I=G0;break;case"scroll":case"scrollend":I=w0;break;case"wheel":I=q0;break;case"copy":case"cut":case"paste":I=N0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Kh;break;case"toggle":case"beforetoggle":I=X0}var ct=(n&4)!==0,Ft=!ct&&(e==="scroll"||e==="scrollend"),B=ct?j!==null?j+"Capture":null:j;ct=[];for(var N=U,F;N!==null;){var Y=N;if(F=Y.stateNode,Y=Y.tag,Y!==5&&Y!==26&&Y!==27||F===null||B===null||(Y=la(N,B),Y!=null&&ct.push(ja(N,Y,F))),Ft)break;N=N.return}0<ct.length&&(j=new I(j,it,null,a,G),X.push({event:j,listeners:ct}))}}if((n&7)===0){t:{if(j=e==="mouseover"||e==="pointerover",I=e==="mouseout"||e==="pointerout",j&&a!==So&&(it=a.relatedTarget||a.fromElement)&&(ss(it)||it[ns]))break t;if((I||j)&&(j=G.window===G?G:(j=G.ownerDocument)?j.defaultView||j.parentWindow:window,I?(it=a.relatedTarget||a.toElement,I=U,it=it?ss(it):null,it!==null&&(Ft=l(it),ct=it.tag,it!==Ft||ct!==5&&ct!==27&&ct!==6)&&(it=null)):(I=null,it=U),I!==it)){if(ct=Xh,Y="onMouseLeave",B="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(ct=Kh,Y="onPointerLeave",B="onPointerEnter",N="pointer"),Ft=I==null?j:ra(I),F=it==null?j:ra(it),j=new ct(Y,N+"leave",I,a,G),j.target=Ft,j.relatedTarget=F,Y=null,ss(G)===U&&(ct=new ct(B,N+"enter",it,a,G),ct.target=F,ct.relatedTarget=Ft,Y=ct),Ft=Y,I&&it)e:{for(ct=Yb,B=I,N=it,F=0,Y=B;Y;Y=ct(Y))F++;Y=0;for(var at=N;at;at=ct(at))Y++;for(;0<F-Y;)B=ct(B),F--;for(;0<Y-F;)N=ct(N),Y--;for(;F--;){if(B===N||N!==null&&B===N.alternate){ct=B;break e}B=ct(B),N=ct(N)}ct=null}else ct=null;I!==null&&Ip(X,j,I,ct,!1),it!==null&&Ft!==null&&Ip(X,Ft,it,ct,!0)}}t:{if(j=U?ra(U):window,I=j.nodeName&&j.nodeName.toLowerCase(),I==="select"||I==="input"&&j.type==="file")var Rt=nd;else if(ed(j))if(sd)Rt=nb;else{Rt=eb;var st=tb}else I=j.nodeName,!I||I.toLowerCase()!=="input"||j.type!=="checkbox"&&j.type!=="radio"?U&&Ao(U.elementType)&&(Rt=nd):Rt=ib;if(Rt&&(Rt=Rt(e,U))){id(X,Rt,a,G);break t}st&&st(e,j,U),e==="focusout"&&U&&j.type==="number"&&U.memoizedProps.value!=null&&vo(j,"number",j.value)}switch(st=U?ra(U):window,e){case"focusin":(ed(st)||st.contentEditable==="true")&&(fs=st,ko=U,ga=null);break;case"focusout":ga=ko=fs=null;break;case"mousedown":Bo=!0;break;case"contextmenu":case"mouseup":case"dragend":Bo=!1,dd(X,a,G);break;case"selectionchange":if(ab)break;case"keydown":case"keyup":dd(X,a,G)}var yt;if(Do)t:{switch(e){case"compositionstart":var Et="onCompositionStart";break t;case"compositionend":Et="onCompositionEnd";break t;case"compositionupdate":Et="onCompositionUpdate";break t}Et=void 0}else ds?Jh(e,a)&&(Et="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Et="onCompositionStart");Et&&(Qh&&a.locale!=="ko"&&(ds||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&ds&&(yt=qh()):(Zi=G,Eo="value"in Zi?Zi.value:Zi.textContent,ds=!0)),st=xl(U,Et),0<st.length&&(Et=new $h(Et,e,null,a,G),X.push({event:Et,listeners:st}),yt?Et.data=yt:(yt=td(a),yt!==null&&(Et.data=yt)))),(yt=K0?Q0(e,a):W0(e,a))&&(Et=xl(U,"onBeforeInput"),0<Et.length&&(st=new $h("onBeforeInput","beforeinput",null,a,G),X.push({event:st,listeners:Et}),st.data=yt)),Hb(X,e,U,a,G)}Up(X,n)})}function ja(e,n,a){return{instance:e,listener:n,currentTarget:a}}function xl(e,n){for(var a=n+"Capture",o=[];e!==null;){var d=e,g=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||g===null||(d=la(e,a),d!=null&&o.unshift(ja(e,d,g)),d=la(e,n),d!=null&&o.push(ja(e,d,g))),e.tag===3)return o;e=e.return}return[]}function Yb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Ip(e,n,a,o,d){for(var g=n._reactName,v=[];a!==null&&a!==o;){var _=a,C=_.alternate,U=_.stateNode;if(_=_.tag,C!==null&&C===o)break;_!==5&&_!==26&&_!==27||U===null||(C=U,d?(U=la(a,g),U!=null&&v.unshift(ja(a,U,C))):d||(U=la(a,g),U!=null&&v.push(ja(a,U,C)))),a=a.return}v.length!==0&&e.push({event:n,listeners:v})}var Xb=/\r\n?/g,$b=/\u0000|\uFFFD/g;function Hp(e){return(typeof e=="string"?e:""+e).replace(Xb,`
`).replace($b,"")}function Gp(e,n){return n=Hp(n),Hp(e)===n}function zt(e,n,a,o,d,g){switch(a){case"children":typeof o=="string"?n==="body"||n==="textarea"&&o===""||cs(e,o):(typeof o=="number"||typeof o=="bigint")&&n!=="body"&&cs(e,""+o);break;case"className":Tr(e,"class",o);break;case"tabIndex":Tr(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":Tr(e,a,o);break;case"style":Hh(e,o,g);break;case"data":if(n!=="object"){Tr(e,"data",o);break}case"src":case"href":if(o===""&&(n!=="a"||a!=="href")){e.removeAttribute(a);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Mr(""+o),e.setAttribute(a,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(a==="formAction"?(n!=="input"&&zt(e,n,"name",d.name,d,null),zt(e,n,"formEncType",d.formEncType,d,null),zt(e,n,"formMethod",d.formMethod,d,null),zt(e,n,"formTarget",d.formTarget,d,null)):(zt(e,n,"encType",d.encType,d,null),zt(e,n,"method",d.method,d,null),zt(e,n,"target",d.target,d,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=Mr(""+o),e.setAttribute(a,o);break;case"onClick":o!=null&&(e.onclick=Ri);break;case"onScroll":o!=null&&_t("scroll",e);break;case"onScrollEnd":o!=null&&_t("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}a=Mr(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""+o):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":o===!0?e.setAttribute(a,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,o):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(a,o):e.removeAttribute(a);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(a):e.setAttribute(a,o);break;case"popover":_t("beforetoggle",e),_t("toggle",e),Er(e,"popover",o);break;case"xlinkActuate":Mi(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Mi(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Mi(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Mi(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Mi(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Mi(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Mi(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Mi(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Mi(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":Er(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=x0.get(a)||a,Er(e,a,o))}}function ru(e,n,a,o,d,g){switch(a){case"style":Hh(e,o,g);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(s(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof o=="string"?cs(e,o):(typeof o=="number"||typeof o=="bigint")&&cs(e,""+o);break;case"onScroll":o!=null&&_t("scroll",e);break;case"onScrollEnd":o!=null&&_t("scrollend",e);break;case"onClick":o!=null&&(e.onclick=Ri);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lh.hasOwnProperty(a))t:{if(a[0]==="o"&&a[1]==="n"&&(d=a.endsWith("Capture"),n=a.slice(2,d?a.length-7:void 0),g=e[De]||null,g=g!=null?g[a]:null,typeof g=="function"&&e.removeEventListener(n,g,d),typeof o=="function")){typeof g!="function"&&g!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(n,o,d);break t}a in e?e[a]=o:o===!0?e.setAttribute(a,""):Er(e,a,o)}}}function ve(e,n,a){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",e),_t("load",e);var o=!1,d=!1,g;for(g in a)if(a.hasOwnProperty(g)){var v=a[g];if(v!=null)switch(g){case"src":o=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:zt(e,n,g,v,a,null)}}d&&zt(e,n,"srcSet",a.srcSet,a,null),o&&zt(e,n,"src",a.src,a,null);return;case"input":_t("invalid",e);var _=g=v=d=null,C=null,U=null;for(o in a)if(a.hasOwnProperty(o)){var G=a[o];if(G!=null)switch(o){case"name":d=G;break;case"type":v=G;break;case"checked":C=G;break;case"defaultChecked":U=G;break;case"value":g=G;break;case"defaultValue":_=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(s(137,n));break;default:zt(e,n,o,G,a,null)}}Fh(e,g,_,C,U,v,d,!1);return;case"select":_t("invalid",e),o=v=g=null;for(d in a)if(a.hasOwnProperty(d)&&(_=a[d],_!=null))switch(d){case"value":g=_;break;case"defaultValue":v=_;break;case"multiple":o=_;default:zt(e,n,d,_,a,null)}n=g,a=v,e.multiple=!!o,n!=null?os(e,!!o,n,!1):a!=null&&os(e,!!o,a,!0);return;case"textarea":_t("invalid",e),g=d=o=null;for(v in a)if(a.hasOwnProperty(v)&&(_=a[v],_!=null))switch(v){case"value":o=_;break;case"defaultValue":d=_;break;case"children":g=_;break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(s(91));break;default:zt(e,n,v,_,a,null)}jh(e,o,d,g);return;case"option":for(C in a)if(a.hasOwnProperty(C)&&(o=a[C],o!=null))switch(C){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:zt(e,n,C,o,a,null)}return;case"dialog":_t("beforetoggle",e),_t("toggle",e),_t("cancel",e),_t("close",e);break;case"iframe":case"object":_t("load",e);break;case"video":case"audio":for(o=0;o<Ua.length;o++)_t(Ua[o],e);break;case"image":_t("error",e),_t("load",e);break;case"details":_t("toggle",e);break;case"embed":case"source":case"link":_t("error",e),_t("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(U in a)if(a.hasOwnProperty(U)&&(o=a[U],o!=null))switch(U){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:zt(e,n,U,o,a,null)}return;default:if(Ao(n)){for(G in a)a.hasOwnProperty(G)&&(o=a[G],o!==void 0&&ru(e,n,G,o,a,void 0));return}}for(_ in a)a.hasOwnProperty(_)&&(o=a[_],o!=null&&zt(e,n,_,o,a,null))}function Kb(e,n,a,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,g=null,v=null,_=null,C=null,U=null,G=null;for(I in a){var X=a[I];if(a.hasOwnProperty(I)&&X!=null)switch(I){case"checked":break;case"value":break;case"defaultValue":C=X;default:o.hasOwnProperty(I)||zt(e,n,I,null,o,X)}}for(var j in o){var I=o[j];if(X=a[j],o.hasOwnProperty(j)&&(I!=null||X!=null))switch(j){case"type":g=I;break;case"name":d=I;break;case"checked":U=I;break;case"defaultChecked":G=I;break;case"value":v=I;break;case"defaultValue":_=I;break;case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(s(137,n));break;default:I!==X&&zt(e,n,j,I,o,X)}}yo(e,v,_,C,U,G,g,d);return;case"select":I=v=_=j=null;for(g in a)if(C=a[g],a.hasOwnProperty(g)&&C!=null)switch(g){case"value":break;case"multiple":I=C;default:o.hasOwnProperty(g)||zt(e,n,g,null,o,C)}for(d in o)if(g=o[d],C=a[d],o.hasOwnProperty(d)&&(g!=null||C!=null))switch(d){case"value":j=g;break;case"defaultValue":_=g;break;case"multiple":v=g;default:g!==C&&zt(e,n,d,g,o,C)}n=_,a=v,o=I,j!=null?os(e,!!a,j,!1):!!o!=!!a&&(n!=null?os(e,!!a,n,!0):os(e,!!a,a?[]:"",!1));return;case"textarea":I=j=null;for(_ in a)if(d=a[_],a.hasOwnProperty(_)&&d!=null&&!o.hasOwnProperty(_))switch(_){case"value":break;case"children":break;default:zt(e,n,_,null,o,d)}for(v in o)if(d=o[v],g=a[v],o.hasOwnProperty(v)&&(d!=null||g!=null))switch(v){case"value":j=d;break;case"defaultValue":I=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(s(91));break;default:d!==g&&zt(e,n,v,d,o,g)}Uh(e,j,I);return;case"option":for(var it in a)if(j=a[it],a.hasOwnProperty(it)&&j!=null&&!o.hasOwnProperty(it))switch(it){case"selected":e.selected=!1;break;default:zt(e,n,it,null,o,j)}for(C in o)if(j=o[C],I=a[C],o.hasOwnProperty(C)&&j!==I&&(j!=null||I!=null))switch(C){case"selected":e.selected=j&&typeof j!="function"&&typeof j!="symbol";break;default:zt(e,n,C,j,o,I)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ct in a)j=a[ct],a.hasOwnProperty(ct)&&j!=null&&!o.hasOwnProperty(ct)&&zt(e,n,ct,null,o,j);for(U in o)if(j=o[U],I=a[U],o.hasOwnProperty(U)&&j!==I&&(j!=null||I!=null))switch(U){case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(137,n));break;default:zt(e,n,U,j,o,I)}return;default:if(Ao(n)){for(var Ft in a)j=a[Ft],a.hasOwnProperty(Ft)&&j!==void 0&&!o.hasOwnProperty(Ft)&&ru(e,n,Ft,void 0,o,j);for(G in o)j=o[G],I=a[G],!o.hasOwnProperty(G)||j===I||j===void 0&&I===void 0||ru(e,n,G,j,o,I);return}}for(var B in a)j=a[B],a.hasOwnProperty(B)&&j!=null&&!o.hasOwnProperty(B)&&zt(e,n,B,null,o,j);for(X in o)j=o[X],I=a[X],!o.hasOwnProperty(X)||j===I||j==null&&I==null||zt(e,n,X,j,o,I)}function Vp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Qb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,a=performance.getEntriesByType("resource"),o=0;o<a.length;o++){var d=a[o],g=d.transferSize,v=d.initiatorType,_=d.duration;if(g&&_&&Vp(v)){for(v=0,_=d.responseEnd,o+=1;o<a.length;o++){var C=a[o],U=C.startTime;if(U>_)break;var G=C.transferSize,X=C.initiatorType;G&&Vp(X)&&(C=C.responseEnd,v+=G*(C<_?1:(_-U)/(C-U)))}if(--o,n+=8*(g+v)/(d.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var lu=null,ou=null;function _l(e){return e.nodeType===9?e:e.ownerDocument}function qp(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Yp(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function cu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var uu=null;function Wb(){var e=window.event;return e&&e.type==="popstate"?e===uu?!1:(uu=e,!0):(uu=null,!1)}var Xp=typeof setTimeout=="function"?setTimeout:void 0,Zb=typeof clearTimeout=="function"?clearTimeout:void 0,$p=typeof Promise=="function"?Promise:void 0,Jb=typeof queueMicrotask=="function"?queueMicrotask:typeof $p<"u"?function(e){return $p.resolve(null).then(e).catch(ty)}:Xp;function ty(e){setTimeout(function(){throw e})}function mn(e){return e==="head"}function Kp(e,n){var a=n,o=0;do{var d=a.nextSibling;if(e.removeChild(a),d&&d.nodeType===8)if(a=d.data,a==="/$"||a==="/&"){if(o===0){e.removeChild(d),js(n);return}o--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")o++;else if(a==="html")Ia(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,Ia(a);for(var g=a.firstChild;g;){var v=g.nextSibling,_=g.nodeName;g[aa]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&g.rel.toLowerCase()==="stylesheet"||a.removeChild(g),g=v}}else a==="body"&&Ia(e.ownerDocument.body);a=d}while(a);js(n)}function Qp(e,n){var a=e;e=0;do{var o=a.nextSibling;if(a.nodeType===1?n?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(n?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),o&&o.nodeType===8)if(a=o.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=o}while(a)}function hu(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var a=n;switch(n=n.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":hu(a),mo(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function ey(e,n,a,o){for(;e.nodeType===1;){var d=a;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[aa])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(g=e.getAttribute("rel"),g==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(g!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(g=e.getAttribute("src"),(g!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&g&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var g=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===g)return e}else return e;if(e=ri(e.nextSibling),e===null)break}return null}function iy(e,n,a){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=ri(e.nextSibling),e===null))return null;return e}function Wp(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=ri(e.nextSibling),e===null))return null;return e}function du(e){return e.data==="$?"||e.data==="$~"}function fu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function ny(e,n){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||a.readyState!=="loading")n();else{var o=function(){n(),a.removeEventListener("DOMContentLoaded",o)};a.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function ri(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var pu=null;function Zp(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(n===0)return ri(e.nextSibling);n--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||n++}e=e.nextSibling}return null}function Jp(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(n===0)return e;n--}else a!=="/$"&&a!=="/&"||n++}e=e.previousSibling}return null}function tg(e,n,a){switch(n=_l(a),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Ia(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);mo(e)}var li=new Map,eg=new Set;function wl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var qi=V.d;V.d={f:sy,r:ay,D:ry,C:ly,L:oy,m:cy,X:hy,S:uy,M:dy};function sy(){var e=qi.f(),n=gl();return e||n}function ay(e){var n=as(e);n!==null&&n.tag===5&&n.type==="form"?yf(n):qi.r(e)}var zs=typeof document>"u"?null:document;function ig(e,n,a){var o=zs;if(o&&typeof n=="string"&&n){var d=Je(n);d='link[rel="'+e+'"][href="'+d+'"]',typeof a=="string"&&(d+='[crossorigin="'+a+'"]'),eg.has(d)||(eg.add(d),e={rel:e,crossOrigin:a,href:n},o.querySelector(d)===null&&(n=o.createElement("link"),ve(n,"link",e),he(n),o.head.appendChild(n)))}}function ry(e){qi.D(e),ig("dns-prefetch",e,null)}function ly(e,n){qi.C(e,n),ig("preconnect",e,n)}function oy(e,n,a){qi.L(e,n,a);var o=zs;if(o&&e&&n){var d='link[rel="preload"][as="'+Je(n)+'"]';n==="image"&&a&&a.imageSrcSet?(d+='[imagesrcset="'+Je(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(d+='[imagesizes="'+Je(a.imageSizes)+'"]')):d+='[href="'+Je(e)+'"]';var g=d;switch(n){case"style":g=Fs(e);break;case"script":g=Us(e)}li.has(g)||(e=b({rel:"preload",href:n==="image"&&a&&a.imageSrcSet?void 0:e,as:n},a),li.set(g,e),o.querySelector(d)!==null||n==="style"&&o.querySelector(Ha(g))||n==="script"&&o.querySelector(Ga(g))||(n=o.createElement("link"),ve(n,"link",e),he(n),o.head.appendChild(n)))}}function cy(e,n){qi.m(e,n);var a=zs;if(a&&e){var o=n&&typeof n.as=="string"?n.as:"script",d='link[rel="modulepreload"][as="'+Je(o)+'"][href="'+Je(e)+'"]',g=d;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Us(e)}if(!li.has(g)&&(e=b({rel:"modulepreload",href:e},n),li.set(g,e),a.querySelector(d)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Ga(g)))return}o=a.createElement("link"),ve(o,"link",e),he(o),a.head.appendChild(o)}}}function uy(e,n,a){qi.S(e,n,a);var o=zs;if(o&&e){var d=rs(o).hoistableStyles,g=Fs(e);n=n||"default";var v=d.get(g);if(!v){var _={loading:0,preload:null};if(v=o.querySelector(Ha(g)))_.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":n},a),(a=li.get(g))&&gu(e,a);var C=v=o.createElement("link");he(C),ve(C,"link",e),C._p=new Promise(function(U,G){C.onload=U,C.onerror=G}),C.addEventListener("load",function(){_.loading|=1}),C.addEventListener("error",function(){_.loading|=2}),_.loading|=4,El(v,n,o)}v={type:"stylesheet",instance:v,count:1,state:_},d.set(g,v)}}}function hy(e,n){qi.X(e,n);var a=zs;if(a&&e){var o=rs(a).hoistableScripts,d=Us(e),g=o.get(d);g||(g=a.querySelector(Ga(d)),g||(e=b({src:e,async:!0},n),(n=li.get(d))&&mu(e,n),g=a.createElement("script"),he(g),ve(g,"link",e),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(d,g))}}function dy(e,n){qi.M(e,n);var a=zs;if(a&&e){var o=rs(a).hoistableScripts,d=Us(e),g=o.get(d);g||(g=a.querySelector(Ga(d)),g||(e=b({src:e,async:!0,type:"module"},n),(n=li.get(d))&&mu(e,n),g=a.createElement("script"),he(g),ve(g,"link",e),a.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},o.set(d,g))}}function ng(e,n,a,o){var d=(d=ut.current)?wl(d):null;if(!d)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(n=Fs(a.href),a=rs(d).hoistableStyles,o=a.get(n),o||(o={type:"style",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Fs(a.href);var g=rs(d).hoistableStyles,v=g.get(e);if(v||(d=d.ownerDocument||d,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(e,v),(g=d.querySelector(Ha(e)))&&!g._p&&(v.instance=g,v.state.loading=5),li.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},li.set(e,a),g||fy(d,e,a,v.state))),n&&o===null)throw Error(s(528,""));return v}if(n&&o!==null)throw Error(s(529,""));return null;case"script":return n=a.async,a=a.src,typeof a=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Us(a),a=rs(d).hoistableScripts,o=a.get(n),o||(o={type:"script",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Fs(e){return'href="'+Je(e)+'"'}function Ha(e){return'link[rel="stylesheet"]['+e+"]"}function sg(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function fy(e,n,a,o){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?o.loading=1:(n=e.createElement("link"),o.preload=n,n.addEventListener("load",function(){return o.loading|=1}),n.addEventListener("error",function(){return o.loading|=2}),ve(n,"link",a),he(n),e.head.appendChild(n))}function Us(e){return'[src="'+Je(e)+'"]'}function Ga(e){return"script[async]"+e}function ag(e,n,a){if(n.count++,n.instance===null)switch(n.type){case"style":var o=e.querySelector('style[data-href~="'+Je(a.href)+'"]');if(o)return n.instance=o,he(o),o;var d=b({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),he(o),ve(o,"style",d),El(o,a.precedence,e),n.instance=o;case"stylesheet":d=Fs(a.href);var g=e.querySelector(Ha(d));if(g)return n.state.loading|=4,n.instance=g,he(g),g;o=sg(a),(d=li.get(d))&&gu(o,d),g=(e.ownerDocument||e).createElement("link"),he(g);var v=g;return v._p=new Promise(function(_,C){v.onload=_,v.onerror=C}),ve(g,"link",o),n.state.loading|=4,El(g,a.precedence,e),n.instance=g;case"script":return g=Us(a.src),(d=e.querySelector(Ga(g)))?(n.instance=d,he(d),d):(o=a,(d=li.get(g))&&(o=b({},a),mu(o,d)),e=e.ownerDocument||e,d=e.createElement("script"),he(d),ve(d,"link",o),e.head.appendChild(d),n.instance=d);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(o=n.instance,n.state.loading|=4,El(o,a.precedence,e));return n.instance}function El(e,n,a){for(var o=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=o.length?o[o.length-1]:null,g=d,v=0;v<o.length;v++){var _=o[v];if(_.dataset.precedence===n)g=_;else if(g!==d)break}g?g.parentNode.insertBefore(e,g.nextSibling):(n=a.nodeType===9?a.head:a,n.insertBefore(e,n.firstChild))}function gu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function mu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Tl=null;function rg(e,n,a){if(Tl===null){var o=new Map,d=Tl=new Map;d.set(a,o)}else d=Tl,o=d.get(a),o||(o=new Map,d.set(a,o));if(o.has(e))return o;for(o.set(e,null),a=a.getElementsByTagName(e),d=0;d<a.length;d++){var g=a[d];if(!(g[aa]||g[ge]||e==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var v=g.getAttribute(n)||"";v=e+v;var _=o.get(v);_?_.push(g):o.set(v,[g])}}return o}function lg(e,n,a){e=e.ownerDocument||e,e.head.insertBefore(a,n==="title"?e.querySelector("head > title"):null)}function py(e,n,a){if(a===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function og(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function gy(e,n,a,o){if(a.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var d=Fs(o.href),g=n.querySelector(Ha(d));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=Cl.bind(e),n.then(e,e)),a.state.loading|=4,a.instance=g,he(g);return}g=n.ownerDocument||n,o=sg(o),(d=li.get(d))&&gu(o,d),g=g.createElement("link"),he(g);var v=g;v._p=new Promise(function(_,C){v.onload=_,v.onerror=C}),ve(g,"link",o),a.instance=g}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,n),(n=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=Cl.bind(e),n.addEventListener("load",a),n.addEventListener("error",a))}}var bu=0;function my(e,n){return e.stylesheets&&e.count===0&&Rl(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var o=setTimeout(function(){if(e.stylesheets&&Rl(e,e.stylesheets),e.unsuspend){var g=e.unsuspend;e.unsuspend=null,g()}},6e4+n);0<e.imgBytes&&bu===0&&(bu=62500*Qb());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Rl(e,e.stylesheets),e.unsuspend)){var g=e.unsuspend;e.unsuspend=null,g()}},(e.imgBytes>bu?50:800)+n);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(o),clearTimeout(d)}}:null}function Cl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Rl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Ml=null;function Rl(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Ml=new Map,n.forEach(by,e),Ml=null,Cl.call(e))}function by(e,n){if(!(n.state.loading&4)){var a=Ml.get(e);if(a)var o=a.get(null);else{a=new Map,Ml.set(e,a);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<d.length;g++){var v=d[g];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(a.set(v.dataset.precedence,v),o=v)}o&&a.set(null,o)}d=n.instance,v=d.getAttribute("data-precedence"),g=a.get(v)||o,g===o&&a.set(null,d),a.set(v,d),this.count++,o=Cl.bind(this),d.addEventListener("load",o),d.addEventListener("error",o),g?g.parentNode.insertBefore(d,g.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),n.state.loading|=4}}var Va={$$typeof:T,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function yy(e,n,a,o,d,g,v,_,C){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ho(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ho(0),this.hiddenUpdates=ho(null),this.identifierPrefix=o,this.onUncaughtError=d,this.onCaughtError=g,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=C,this.incompleteTransitions=new Map}function cg(e,n,a,o,d,g,v,_,C,U,G,X){return e=new yy(e,n,a,v,C,U,G,X,_),n=1,g===!0&&(n|=24),g=Ve(3,null,null,n),e.current=g,g.stateNode=e,n=Qo(),n.refCount++,e.pooledCache=n,n.refCount++,g.memoizedState={element:o,isDehydrated:a,cache:n},tc(g),e}function ug(e){return e?(e=ms,e):ms}function hg(e,n,a,o,d,g){d=ug(d),o.context===null?o.context=d:o.pendingContext=d,o=an(n),o.payload={element:a},g=g===void 0?null:g,g!==null&&(o.callback=g),a=rn(e,o,n),a!==null&&(Pe(a,e,n),xa(a,e,n))}function dg(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<n?a:n}}function yu(e,n){dg(e,n),(e=e.alternate)&&dg(e,n)}function fg(e){if(e.tag===13||e.tag===31){var n=Bn(e,67108864);n!==null&&Pe(n,e,67108864),yu(e,67108864)}}function pg(e){if(e.tag===13||e.tag===31){var n=Ke();n=fo(n);var a=Bn(e,n);a!==null&&Pe(a,e,n),yu(e,n)}}var Dl=!0;function vy(e,n,a,o){var d=P.T;P.T=null;var g=V.p;try{V.p=2,vu(e,n,a,o)}finally{V.p=g,P.T=d}}function Ay(e,n,a,o){var d=P.T;P.T=null;var g=V.p;try{V.p=8,vu(e,n,a,o)}finally{V.p=g,P.T=d}}function vu(e,n,a,o){if(Dl){var d=Au(o);if(d===null)au(e,n,o,Nl,a),mg(e,o);else if(xy(d,e,n,a,o))o.stopPropagation();else if(mg(e,o),n&4&&-1<Sy.indexOf(e)){for(;d!==null;){var g=as(d);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var v=Dn(g.pendingLanes);if(v!==0){var _=g;for(_.pendingLanes|=2,_.entangledLanes|=2;v;){var C=1<<31-He(v);_.entanglements[1]|=C,v&=~C}vi(g),(Nt&6)===0&&(fl=je()+500,Fa(0))}}break;case 31:case 13:_=Bn(g,2),_!==null&&Pe(_,g,2),gl(),yu(g,2)}if(g=Au(o),g===null&&au(e,n,o,Nl,a),g===d)break;d=g}d!==null&&o.stopPropagation()}else au(e,n,o,null,a)}}function Au(e){return e=xo(e),Su(e)}var Nl=null;function Su(e){if(Nl=null,e=ss(e),e!==null){var n=l(e);if(n===null)e=null;else{var a=n.tag;if(a===13){if(e=c(n),e!==null)return e;e=null}else if(a===31){if(e=u(n),e!==null)return e;e=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return Nl=e,null}function gg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(r0()){case xh:return 2;case _h:return 8;case Ar:case l0:return 32;case wh:return 268435456;default:return 32}default:return 32}}var xu=!1,bn=null,yn=null,vn=null,qa=new Map,Ya=new Map,An=[],Sy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mg(e,n){switch(e){case"focusin":case"focusout":bn=null;break;case"dragenter":case"dragleave":yn=null;break;case"mouseover":case"mouseout":vn=null;break;case"pointerover":case"pointerout":qa.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ya.delete(n.pointerId)}}function Xa(e,n,a,o,d,g){return e===null||e.nativeEvent!==g?(e={blockedOn:n,domEventName:a,eventSystemFlags:o,nativeEvent:g,targetContainers:[d]},n!==null&&(n=as(n),n!==null&&fg(n)),e):(e.eventSystemFlags|=o,n=e.targetContainers,d!==null&&n.indexOf(d)===-1&&n.push(d),e)}function xy(e,n,a,o,d){switch(n){case"focusin":return bn=Xa(bn,e,n,a,o,d),!0;case"dragenter":return yn=Xa(yn,e,n,a,o,d),!0;case"mouseover":return vn=Xa(vn,e,n,a,o,d),!0;case"pointerover":var g=d.pointerId;return qa.set(g,Xa(qa.get(g)||null,e,n,a,o,d)),!0;case"gotpointercapture":return g=d.pointerId,Ya.set(g,Xa(Ya.get(g)||null,e,n,a,o,d)),!0}return!1}function bg(e){var n=ss(e.target);if(n!==null){var a=l(n);if(a!==null){if(n=a.tag,n===13){if(n=c(a),n!==null){e.blockedOn=n,Dh(e.priority,function(){pg(a)});return}}else if(n===31){if(n=u(a),n!==null){e.blockedOn=n,Dh(e.priority,function(){pg(a)});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ol(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var a=Au(e.nativeEvent);if(a===null){a=e.nativeEvent;var o=new a.constructor(a.type,a);So=o,a.target.dispatchEvent(o),So=null}else return n=as(a),n!==null&&fg(n),e.blockedOn=a,!1;n.shift()}return!0}function yg(e,n,a){Ol(e)&&a.delete(n)}function _y(){xu=!1,bn!==null&&Ol(bn)&&(bn=null),yn!==null&&Ol(yn)&&(yn=null),vn!==null&&Ol(vn)&&(vn=null),qa.forEach(yg),Ya.forEach(yg)}function Ll(e,n){e.blockedOn===n&&(e.blockedOn=null,xu||(xu=!0,p.unstable_scheduleCallback(p.unstable_NormalPriority,_y)))}var kl=null;function vg(e){kl!==e&&(kl=e,p.unstable_scheduleCallback(p.unstable_NormalPriority,function(){kl===e&&(kl=null);for(var n=0;n<e.length;n+=3){var a=e[n],o=e[n+1],d=e[n+2];if(typeof o!="function"){if(Su(o||a)===null)continue;break}var g=as(a);g!==null&&(e.splice(n,3),n-=3,Ac(g,{pending:!0,data:d,method:a.method,action:o},o,d))}}))}function js(e){function n(C){return Ll(C,e)}bn!==null&&Ll(bn,e),yn!==null&&Ll(yn,e),vn!==null&&Ll(vn,e),qa.forEach(n),Ya.forEach(n);for(var a=0;a<An.length;a++){var o=An[a];o.blockedOn===e&&(o.blockedOn=null)}for(;0<An.length&&(a=An[0],a.blockedOn===null);)bg(a),a.blockedOn===null&&An.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(o=0;o<a.length;o+=3){var d=a[o],g=a[o+1],v=d[De]||null;if(typeof g=="function")v||vg(a);else if(v){var _=null;if(g&&g.hasAttribute("formAction")){if(d=g,v=g[De]||null)_=v.formAction;else if(Su(d)!==null)continue}else _=v.action;typeof _=="function"?a[o+1]=_:(a.splice(o,3),o-=3),vg(a)}}}function Ag(){function e(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(v){return d=v})},focusReset:"manual",scroll:"manual"})}function n(){d!==null&&(d(),d=null),o||setTimeout(a,20)}function a(){if(!o&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var o=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(a,100),function(){o=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),d!==null&&(d(),d=null)}}}function _u(e){this._internalRoot=e}Bl.prototype.render=_u.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var a=n.current,o=Ke();hg(a,o,e,n,null,null)},Bl.prototype.unmount=_u.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;hg(e.current,2,null,e,null,null),gl(),n[ns]=null}};function Bl(e){this._internalRoot=e}Bl.prototype.unstable_scheduleHydration=function(e){if(e){var n=Rh();e={blockedOn:null,target:e,priority:n};for(var a=0;a<An.length&&n!==0&&n<An[a].priority;a++);An.splice(a,0,e),a===0&&bg(e)}};var Sg=t.version;if(Sg!=="19.2.3")throw Error(s(527,Sg,"19.2.3"));V.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=f(n),e=e!==null?m(e):null,e=e===null?null:e.stateNode,e};var wy={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pl.isDisabled&&Pl.supportsFiber)try{ia=Pl.inject(wy),Ie=Pl}catch{}}return Ka.createRoot=function(e,n){if(!r(e))throw Error(s(299));var a=!1,o="",d=Mf,g=Rf,v=Df;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(d=n.onUncaughtError),n.onCaughtError!==void 0&&(g=n.onCaughtError),n.onRecoverableError!==void 0&&(v=n.onRecoverableError)),n=cg(e,1,!1,null,null,a,o,null,d,g,v,Ag),e[ns]=n.current,su(e),new _u(n)},Ka.hydrateRoot=function(e,n,a){if(!r(e))throw Error(s(299));var o=!1,d="",g=Mf,v=Rf,_=Df,C=null;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(_=a.onRecoverableError),a.formState!==void 0&&(C=a.formState)),n=cg(e,1,!0,n,a??null,o,d,C,g,v,_,Ag),n.context=ug(null),a=n.current,o=Ke(),o=fo(o),d=an(o),d.callback=null,rn(a,d,o),a=o,n.current.lanes=a,sa(n,a),vi(n),e[ns]=n.current,su(e),new Bl(n)},Ka.version="19.2.3",Ka}var Lg;function Py(){if(Lg)return Cu.exports;Lg=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(t){console.error(t)}}return p(),Cu.exports=By(),Cu.exports}var zy=Py();function ym(p){if(p==null||!Number.isFinite(p))return"";const t=Math.abs(p),i=p<0?"-":"";return t>=1e9?`${i}$${(t/1e9).toFixed(2)}B`:t>=1e6?`${i}$${(t/1e6).toFixed(2)}M`:t>=1e3?`${i}$${Math.round(t/1e3)}K`:`${i}$${t.toFixed(0)}`}function kg(p){if(p==null||!Number.isFinite(p))return{number:"",suffix:""};const t=Math.abs(p),i=p<0?"-":"";return t>=1e9?{number:`${i}$${(t/1e9).toFixed(2)}`,suffix:"B"}:t>=1e6?{number:`${i}$${(t/1e6).toFixed(2)}`,suffix:"M"}:t>=1e3?{number:`${i}$${Math.round(t/1e3)}`,suffix:"K"}:{number:`${i}$${t.toFixed(0)}`,suffix:""}}function $n(p,t=2,i=!1){return p==null||!Number.isFinite(p)?"":`${i&&p>0?"+":""}${p.toFixed(t)}%`}function Nu(p){if(!p)return"";try{return new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return p}}function Bg(p){if(!p)return"";try{return new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short"})}catch{return p}}function Fy(p){return p.charAt(0).toUpperCase()+p.slice(1)}function Uy(p){return{defensive:"Low Risk",balanced:"Medium Risk",growth:"High Risk",unknown:""}[p]||""}function jy(p){return{defensive:"Defensive Income Fund",balanced:"Balanced Growth Fund",growth:"Growth Strategy Fund",unknown:"Investment Portfolio"}[p]||"Investment Portfolio"}const Iy={"Australian Equities":"#4299e1","Australian Fixed Interest":"#48bb78",Cash:"#ecc94b","International Equities":"#9f7aea","Listed Property":"#ed8936",Other:"#718096",Unknown:"#a0aec0"},Hy={"Australian Equities":"AU Equities","Australian Fixed Interest":"Fixed Interest",Cash:"Cash","International Equities":"Intl Equities","Listed Property":"Property",Other:"Other",Unknown:"Unknown"};function Pg(p,t=100){if(p==null||!Number.isFinite(p))return 0;const i=Math.min(Math.abs(p)/15*t,t);return Math.max(i,10)}function Gy({fund:p}){const t=p?.classification?.classification||"unknown",i=p?.classification?.growthPercent??0,s=p?.classification?.defensivePercent??0,r=p?.classification?.otherPercent??0,l=p?.assetAllocation?.totalValue||p?.performance?.endingValue||null,c=p?.assetAllocation?.assetClasses||[],u=p?.assetAllocation?.asAtDate||null,h=p?.performance?.dollarReturn||null,f=p?.performance?.period?.start||null,m=p?.performance?.period?.end||null,b=p?.performance?.twr?.oneYear??null;p?.performance?.twr?.threeYears,p?.performance?.twr?.sinceStart;const y=p?.benchmark?.name||"Benchmark",A=p?.benchmarkComparison||{},x=p?.performanceScore??null,S=p?.fundId||"",E=p?.lastUpdated||null;p?.derivedInsights;const w=kg(l),M=kg(h),T=f&&m?`${Bg(f)}  ${Bg(m)}`:"",L=A?.oneYear?.benchmarkReturn??null,O=A?.oneYear?.difference??null;A?.sinceInception?.benchmarkReturn,A?.sinceInception?.difference;const k=x!==null?Math.min(Math.max(x,0),100):0,q=[...c].filter(Z=>Z.value&&Z.value>0).sort((Z,ht)=>(ht.value||0)-(Z.value||0)).map(Z=>{const ht=l>0?Z.value/l*100:0;return{...Z,percent:ht,color:Iy[Z.name]||"#718096",label:Hy[Z.name]||Z.name}}),K=q.slice(0,4),J=q.slice(0,6),W=Vy({classification:t,growthPercent:i,oneYearDiff:O,dollarReturn:h});return R.jsx("div",{style:{width:"100vw",minHeight:"100vh",background:"linear-gradient(165deg, #0a0a0f 0%, #12121a 50%, #0d0d14 100%)",fontFamily:'"DM Sans", system-ui, sans-serif',color:"#ffffff",position:"relative",overflowX:"hidden"},children:R.jsxs("div",{style:{padding:"48px 56px",maxWidth:"1600px",margin:"0 auto",position:"relative",zIndex:1},children:[R.jsx("div",{style:{position:"absolute",top:"-200px",right:"-100px",width:"600px",height:"600px",background:"radial-gradient(circle, rgba(99, 179, 237, 0.08) 0%, transparent 70%)",pointerEvents:"none"}}),R.jsx("div",{style:{position:"absolute",bottom:"-300px",left:"-200px",width:"800px",height:"800px",background:"radial-gradient(circle, rgba(72, 187, 120, 0.06) 0%, transparent 70%)",pointerEvents:"none"}}),R.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"56px",position:"relative",zIndex:1},children:[R.jsxs("div",{children:[R.jsx("div",{style:{fontSize:"11px",letterSpacing:"3px",textTransform:"uppercase",color:"rgba(255,255,255,0.4)",marginBottom:"8px",fontWeight:"500"},children:"Fund Analytics Report"}),R.jsx("h1",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"42px",fontWeight:"600",margin:0,letterSpacing:"-0.5px",background:"linear-gradient(135deg, #ffffff 0%, rgba(255,255,255,0.8) 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:jy(t)}),R.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"rgba(255,255,255,0.5)"},children:["As of ",u?Nu(u):m?Nu(m):""]})]}),R.jsxs("div",{style:{textAlign:"center",position:"relative"},children:[R.jsx("div",{style:{width:"140px",height:"140px",borderRadius:"50%",background:x!==null?`conic-gradient(from 0deg, #48bb78 0%, #38a169 ${k}%, rgba(255,255,255,0.08) ${k}%)`:"rgba(255,255,255,0.08)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:R.jsx("div",{style:{width:"110px",height:"110px",borderRadius:"50%",background:"#0d0d14",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:R.jsx("span",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"48px",fontWeight:"700",lineHeight:1},children:x!==null?x:""})})}),R.jsx("div",{style:{marginTop:"12px",fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.5)"},children:"Performance Score"})]})]}),R.jsxs("section",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"32px",marginBottom:"56px",position:"relative",zIndex:1},children:[R.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.02) 100%)",borderRadius:"20px",padding:"36px 40px",border:"1px solid rgba(255,255,255,0.08)",backdropFilter:"blur(20px)"},children:[R.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"16px"},children:"Total Portfolio Value"}),R.jsxs("div",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"52px",fontWeight:"600",letterSpacing:"-1px",lineHeight:1},children:[w.number,R.jsx("span",{style:{fontSize:"32px",color:"rgba(255,255,255,0.6)"},children:w.suffix})]})]}),R.jsxs("div",{style:{background:h!==null&&h>=0?"linear-gradient(145deg, rgba(72, 187, 120, 0.15) 0%, rgba(72, 187, 120, 0.05) 100%)":"linear-gradient(145deg, rgba(245, 101, 101, 0.15) 0%, rgba(245, 101, 101, 0.05) 100%)",borderRadius:"20px",padding:"36px 40px",border:h!==null&&h>=0?"1px solid rgba(72, 187, 120, 0.25)":"1px solid rgba(245, 101, 101, 0.25)",backdropFilter:"blur(20px)"},children:[R.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:h!==null&&h>=0?"rgba(72, 187, 120, 0.8)":"rgba(245, 101, 101, 0.8)",marginBottom:"16px"},children:"Period Return"}),R.jsxs("div",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"52px",fontWeight:"600",letterSpacing:"-1px",lineHeight:1,color:h!==null&&h>=0?"#48bb78":"#f56565"},children:[h!==null&&h>=0?"+":"",M.number,M.suffix]}),R.jsx("div",{style:{marginTop:"12px",fontSize:"13px",color:"rgba(255,255,255,0.5)"},children:T})]}),R.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(99, 179, 237, 0.12) 0%, rgba(99, 179, 237, 0.04) 100%)",borderRadius:"20px",padding:"36px 40px",border:"1px solid rgba(99, 179, 237, 0.2)",backdropFilter:"blur(20px)"},children:[R.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(99, 179, 237, 0.8)",marginBottom:"16px"},children:"1-Year Return"}),R.jsxs("div",{style:{fontFamily:'"Playfair Display", Georgia, serif',fontSize:"52px",fontWeight:"600",letterSpacing:"-1px",lineHeight:1,color:"#63b3ed"},children:[b!==null&&b>=0?"+":"",$n(b,2,!1).replace("%",""),R.jsx("span",{style:{fontSize:"28px"},children:"%"})]}),R.jsx("div",{style:{marginTop:"12px",display:"flex",alignItems:"center",gap:"8px"},children:O!==null&&R.jsxs("span",{style:{background:O>=0?"rgba(72, 187, 120, 0.2)":"rgba(245, 101, 101, 0.2)",color:O>=0?"#48bb78":"#f56565",padding:"4px 10px",borderRadius:"20px",fontSize:"12px",fontWeight:"600"},children:[$n(O,2,!0)," vs benchmark"]})})]})]}),R.jsxs("section",{style:{display:"grid",gridTemplateColumns:"1.2fr 0.8fr",gap:"32px",marginBottom:"56px",position:"relative",zIndex:1},children:[R.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0.01) 100%)",borderRadius:"20px",padding:"32px 36px",border:"1px solid rgba(255,255,255,0.06)"},children:[R.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"28px"},children:"Asset Allocation"}),R.jsx("div",{style:{marginBottom:"28px"},children:R.jsx("div",{style:{display:"flex",height:"48px",borderRadius:"8px",overflow:"hidden"},children:K.length>0?K.map((Z,ht)=>R.jsx("div",{style:{width:`${Z.percent}%`,background:`linear-gradient(135deg, ${Z.color}, ${qy(Z.color,-20)})`,position:"relative"},children:Z.percent>8&&R.jsxs("span",{style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",fontSize:"13px",fontWeight:"600"},children:[Z.percent.toFixed(1),"%"]})},Z.name)):R.jsx("div",{style:{width:"100%",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",color:"rgba(255,255,255,0.4)",fontSize:"13px"},children:"No allocation data"})})}),R.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px"},children:J.length>0?J.map((Z,ht)=>R.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[R.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"3px",background:Z.color}}),R.jsxs("div",{children:[R.jsx("div",{style:{fontSize:"12px",color:"rgba(255,255,255,0.6)"},children:Z.label}),R.jsx("div",{style:{fontSize:"14px",fontWeight:"600"},children:ym(Z.value)})]})]},Z.name)):R.jsx("div",{style:{gridColumn:"span 3",color:"rgba(255,255,255,0.4)",fontSize:"13px"},children:"Upload asset allocation report for breakdown"})})]}),R.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0.01) 100%)",borderRadius:"20px",padding:"32px 36px",border:"1px solid rgba(255,255,255,0.06)"},children:[R.jsxs("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"28px"},children:["vs ",y]}),R.jsxs("div",{style:{marginBottom:"32px"},children:[R.jsx("div",{style:{fontSize:"12px",color:"rgba(255,255,255,0.5)",marginBottom:"12px"},children:"1 Year"}),R.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:"20px"},children:[R.jsxs("div",{style:{flex:1},children:[R.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:"12px",marginBottom:"8px"},children:[R.jsx("div",{style:{height:`${Pg(b,80)}px`,width:"48px",background:b!==null&&b>=0?"linear-gradient(180deg, #48bb78 0%, #38a169 100%)":"linear-gradient(180deg, #f56565 0%, #c53030 100%)",borderRadius:"6px 6px 0 0",position:"relative"},children:R.jsx("span",{style:{position:"absolute",top:"-28px",left:"50%",transform:"translateX(-50%)",fontSize:"18px",fontWeight:"700",color:b!==null&&b>=0?"#48bb78":"#f56565"},children:$n(b,2)})}),R.jsx("div",{style:{height:`${Pg(L,80)}px`,width:"48px",background:"rgba(255,255,255,0.15)",borderRadius:"6px 6px 0 0",position:"relative"},children:R.jsx("span",{style:{position:"absolute",top:"-28px",left:"50%",transform:"translateX(-50%)",fontSize:"18px",fontWeight:"600",color:"rgba(255,255,255,0.6)"},children:$n(L,2)})})]}),R.jsxs("div",{style:{display:"flex",gap:"12px"},children:[R.jsx("span",{style:{width:"48px",fontSize:"10px",color:"rgba(255,255,255,0.5)",textAlign:"center"},children:"Fund"}),R.jsx("span",{style:{width:"48px",fontSize:"10px",color:"rgba(255,255,255,0.5)",textAlign:"center"},children:"Bench"})]})]}),O!==null&&R.jsxs("div",{style:{background:O>=0?"rgba(72, 187, 120, 0.15)":"rgba(245, 101, 101, 0.15)",border:O>=0?"1px solid rgba(72, 187, 120, 0.3)":"1px solid rgba(245, 101, 101, 0.3)",borderRadius:"12px",padding:"12px 16px",textAlign:"center"},children:[R.jsx("div",{style:{fontSize:"10px",color:O>=0?"rgba(72, 187, 120, 0.8)":"rgba(245, 101, 101, 0.8)",marginBottom:"4px"},children:"ALPHA"}),R.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:O>=0?"#48bb78":"#f56565"},children:$n(O,2,!0)})]})]})]})]})]}),R.jsxs("section",{style:{display:"grid",gridTemplateColumns:"0.7fr 1.3fr",gap:"32px",position:"relative",zIndex:1},children:[R.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0.01) 100%)",borderRadius:"20px",padding:"32px 36px",border:"1px solid rgba(255,255,255,0.06)"},children:[R.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"24px"},children:"Risk Profile"}),R.jsxs("div",{style:{marginBottom:"24px"},children:[R.jsxs("div",{style:{display:"flex",height:"12px",borderRadius:"6px",overflow:"hidden",marginBottom:"12px"},children:[R.jsx("div",{style:{width:`${i}%`,background:"linear-gradient(90deg, #4299e1, #63b3ed)"}}),R.jsx("div",{style:{width:`${s}%`,background:"linear-gradient(90deg, #48bb78, #68d391)"}}),r>0&&R.jsx("div",{style:{width:`${r}%`,background:"#718096"}})]}),R.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[R.jsxs("span",{style:{color:"#63b3ed"},children:["Growth ",$n(i,1)]}),R.jsxs("span",{style:{color:"#68d391"},children:["Defensive ",$n(s,1)]})]})]}),R.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"16px 20px",textAlign:"center"},children:[R.jsx("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.5)",marginBottom:"4px"},children:"Classification"}),R.jsx("div",{style:{fontSize:"20px",fontWeight:"600"},children:Fy(t)}),R.jsx("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.4)",marginTop:"4px"},children:Uy(t)})]})]}),R.jsxs("div",{style:{background:"linear-gradient(145deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0.01) 100%)",borderRadius:"20px",padding:"32px 36px",border:"1px solid rgba(255,255,255,0.06)"},children:[R.jsx("div",{style:{fontSize:"11px",letterSpacing:"2px",textTransform:"uppercase",color:"rgba(255,255,255,0.45)",marginBottom:"24px"},children:"Key Insights"}),R.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px"},children:W.map((Z,ht)=>R.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",borderRadius:"14px",padding:"20px",borderLeft:`3px solid ${Z.accent}`},children:[R.jsx("div",{style:{fontSize:"28px",marginBottom:"12px"},children:Z.icon}),R.jsx("div",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"6px"},children:Z.title}),R.jsx("div",{style:{fontSize:"12px",color:"rgba(255,255,255,0.5)"},children:Z.desc})]},ht))})]})]}),R.jsxs("footer",{style:{marginTop:"48px",paddingTop:"24px",borderTop:"1px solid rgba(255,255,255,0.06)",display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1},children:[R.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.35)"},children:["Fund ID: ",S]}),R.jsxs("div",{style:{fontSize:"11px",color:"rgba(255,255,255,0.35)"},children:["Last updated: ",E?Nu(E):"","  Confidential"]})]}),R.jsx("style",{children:`
          @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap');
        `})]})})}function Vy({classification:p,growthPercent:t,oneYearDiff:i,dollarReturn:s}){const r=[];if(p!=="unknown"){const l={defensive:"",balanced:"",growth:""},c={defensive:"Defensive Strategy",balanced:"Balanced Strategy",growth:"Growth Strategy"};r.push({icon:l[p]||"",title:c[p]||"Investment Strategy",desc:t>0?`${t.toFixed(1)}% growth allocation`:"Classification determined",accent:"#63b3ed"})}else r.push({icon:"",title:"Awaiting Data",desc:"Upload allocation report",accent:"#718096"});if(i!==null){const l=i>=0;r.push({icon:l?"":"",title:l?"Strong Outperformance":"Below Benchmark",desc:`${i>=0?"+":""}${i.toFixed(2)}% vs benchmark`,accent:l?"#48bb78":"#f56565"})}else r.push({icon:"",title:"Benchmark Pending",desc:"Upload performance report",accent:"#718096"});if(s!==null){const l=s>=0;r.push({icon:l?"":"",title:l?"Capital Growth":"Capital Loss",desc:`${l?"+":""}${ym(s)} this period`,accent:l?"#ecc94b":"#f56565"})}else r.push({icon:"",title:"Returns Pending",desc:"Upload performance report",accent:"#718096"});return r}function qy(p,t){const i=f=>Math.min(255,Math.max(0,f));p=p.replace("#","");const s=parseInt(p.substring(0,2),16),r=parseInt(p.substring(2,4),16),l=parseInt(p.substring(4,6),16),c=i(s+t),u=i(r+t),h=i(l+t);return`#${c.toString(16).padStart(2,"0")}${u.toString(16).padStart(2,"0")}${h.toString(16).padStart(2,"0")}`}const Yy=p=>p.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Xy=p=>p.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,i,s)=>s?s.toUpperCase():i.toLowerCase()),zg=p=>{const t=Xy(p);return t.charAt(0).toUpperCase()+t.slice(1)},vm=(...p)=>p.filter((t,i,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===i).join(" ").trim(),$y=p=>{for(const t in p)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var Ky={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Qy=Zt.forwardRef(({color:p="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:r="",children:l,iconNode:c,...u},h)=>Zt.createElement("svg",{ref:h,...Ky,width:t,height:t,stroke:p,strokeWidth:s?Number(i)*24/Number(t):i,className:vm("lucide",r),...!l&&!$y(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,m])=>Zt.createElement(f,m)),...Array.isArray(l)?l:[l]]));const dr=(p,t)=>{const i=Zt.forwardRef(({className:s,...r},l)=>Zt.createElement(Qy,{ref:l,iconNode:t,className:vm(`lucide-${Yy(zg(p))}`,`lucide-${p}`,s),...r}));return i.displayName=zg(p),i};const Wy=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Zy=dr("chevron-down",Wy);const Jy=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],tv=dr("chevron-up",Jy);const ev=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],iv=dr("download",ev);const nv=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Fg=dr("file-text",nv);const sv=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],av=dr("refresh-cw",sv);function rv({onFileSelect:p,status:t="idle",label:i,description:s,errorMessage:r,acceptedFileName:l}){const c=h=>{const f=h.target.files?.[0];if(console.log("[DropZone] File selected:",f?.name),!f){p(null,"No file selected");return}p(f,null)},u=()=>{switch(t){case"processing":return"border-blue-300 bg-blue-50/50 ring-4 ring-blue-100/50";case"success":return"border-emerald-300 bg-emerald-50/50";case"error":return"border-red-300 bg-red-50/50";default:return"border-gray-200 bg-gray-50/30 hover:border-blue-300 hover:bg-blue-50/30 hover:ring-4 hover:ring-blue-100/30"}};return R.jsxs("div",{className:"space-y-2",children:[i&&R.jsx("label",{className:"block text-sm font-medium text-gray-700",children:i}),R.jsxs("div",{className:`
        relative rounded-xl border-2 border-dashed transition-all duration-300
        ${u()}
      `,children:[R.jsx("input",{type:"file",accept:"application/pdf",onChange:c,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",disabled:t==="processing"}),R.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[R.jsxs("div",{className:`
            w-12 h-12 rounded-xl flex items-center justify-center mb-4 transition-all duration-300
            ${t==="processing"?"bg-blue-100":""}
            ${t==="success"?"bg-emerald-100":""}
            ${t==="error"?"bg-red-100":""}
            ${t==="idle"?"bg-gray-100":""}
          `,children:[t==="processing"&&R.jsxs("svg",{className:"w-6 h-6 text-blue-600 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[R.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),R.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t==="success"&&R.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),t==="error"&&R.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t==="idle"&&R.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]}),R.jsxs("div",{className:"text-center",children:[t==="processing"&&R.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Processing PDF"}),t==="success"&&R.jsx("p",{className:"text-sm font-medium text-emerald-700",children:l||"File uploaded successfully"}),t==="error"&&R.jsx("p",{className:"text-sm font-medium text-red-700",children:r||"Upload failed"}),t==="idle"&&R.jsxs(R.Fragment,{children:[R.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Drop PDF here or ",R.jsx("span",{className:"text-blue-600 font-semibold",children:"browse"})]}),s&&R.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s})]})]})]})]}),t==="idle"&&R.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Accepts PDF files only"})]})}const Ce=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Vu=[.001,0,0,.001,0,0],Ou=1.35,Qe={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},xn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},lr="pdfjs_internal_editor_",mt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ct={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},lv={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},qu={TRIANGLES:1,LATTICE:2},Ae={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Yl={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ce={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Hs={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Jl={ERRORS:0,WARNINGS:1,INFOS:5},or={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Qa={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},ov={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let to=Jl.WARNINGS;function cv(p){Number.isInteger(p)&&(to=p)}function uv(){return to}function eo(p){to>=Jl.INFOS&&console.info(`Info: ${p}`)}function pt(p){to>=Jl.WARNINGS&&console.warn(`Warning: ${p}`)}function Ht(p){throw new Error(p)}function Mt(p,t){p||Ht(t)}function hv(p){switch(p?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Am(p,t=null,i=null){if(!p)return null;if(i&&typeof p=="string"&&(i.addDefaultProtocol&&p.startsWith("www.")&&p.match(/\./g)?.length>=2&&(p=`http://${p}`),i.tryConvertEncoding))try{p=mv(p)}catch{}const s=t?URL.parse(p,t):URL.parse(p);return hv(s)?s:null}function Sm(p,t,i=!1){const s=URL.parse(p);return s?(s.hash=t,s.href):i&&Am(p,"http://example.com")?p.split("#",1)[0]+`${t?`#${t}`:""}`:""}function gt(p,t,i,s=!1){return Object.defineProperty(p,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const es=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Ug extends es{constructor(t,i){super(t,"PasswordException"),this.code=i}}class Lu extends es{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class Yu extends es{constructor(t){super(t,"InvalidPDFException")}}class Kl extends es{constructor(t,i,s){super(t,"ResponseException"),this.status=i,this.missing=s}}class dv extends es{constructor(t){super(t,"FormatError")}}class Tn extends es{constructor(t){super(t,"AbortException")}}function xm(p){(typeof p!="object"||p?.length===void 0)&&Ht("Invalid argument for bytesToString");const t=p.length,i=8192;if(t<i)return String.fromCharCode.apply(null,p);const s=[];for(let r=0;r<t;r+=i){const l=Math.min(r+i,t),c=p.subarray(r,l);s.push(String.fromCharCode.apply(null,c))}return s.join("")}function fr(p){typeof p!="string"&&Ht("Invalid argument for stringToBytes");const t=p.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=p.charCodeAt(s)&255;return i}function fv(p){return String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,p&255)}function pv(){const p=new Uint8Array(4);return p[0]=1,new Uint32Array(p.buffer,0,1)[0]===1}function gv(){try{return new Function(""),!0}catch{return!1}}class _e{static get isLittleEndian(){return gt(this,"isLittleEndian",pv())}static get isEvalSupported(){return gt(this,"isEvalSupported",gv())}static get isOffscreenCanvasSupported(){return gt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return gt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return gt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return gt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return gt(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return gt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const ku=Array.from(Array(256).keys(),p=>p.toString(16).padStart(2,"0"));class nt{static makeHexColor(t,i,s){return`#${ku[t]}${ku[i]}${ku[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,s=0){const r=t[s],l=t[s+1];t[s]=r*i[0]+l*i[2]+i[4],t[s+1]=r*i[1]+l*i[3]+i[5]}static applyTransformToBezier(t,i,s=0){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5];for(let m=0;m<6;m+=2){const b=t[s+m],y=t[s+m+1];t[s+m]=b*r+y*c+h,t[s+m+1]=b*l+y*u+f}}static applyInverseTransform(t,i){const s=t[0],r=t[1],l=i[0]*i[3]-i[1]*i[2];t[0]=(s*i[3]-r*i[2]+i[2]*i[5]-i[4]*i[3])/l,t[1]=(-s*i[1]+r*i[0]+i[4]*i[1]-i[5]*i[0])/l}static axialAlignedBoundingBox(t,i,s){const r=i[0],l=i[1],c=i[2],u=i[3],h=i[4],f=i[5],m=t[0],b=t[1],y=t[2],A=t[3];let x=r*m+h,S=x,E=r*y+h,w=E,M=u*b+f,T=M,L=u*A+f,O=L;if(l!==0||c!==0){const k=l*m,z=l*y,q=c*b,K=c*A;x+=q,w+=q,E+=K,S+=K,M+=k,O+=k,L+=z,T+=z}s[0]=Math.min(s[0],x,E,S,w),s[1]=Math.min(s[1],M,L,T,O),s[2]=Math.max(s[2],x,E,S,w),s[3]=Math.max(s[3],M,L,T,O)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const s=t[0],r=t[1],l=t[2],c=t[3],u=s**2+r**2,h=s*l+r*c,f=l**2+c**2,m=(u+f)/2,b=Math.sqrt(m**2-(u*f-h**2));i[0]=Math.sqrt(m+b||1),i[1]=Math.sqrt(m-b||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>r)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return l>c?null:[s,l,r,c]}static pointBoundingBox(t,i,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],i),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],i)}static rectBoundingBox(t,i,s,r,l){l[0]=Math.min(l[0],t,s),l[1]=Math.min(l[1],i,r),l[2]=Math.max(l[2],t,s),l[3]=Math.max(l[3],i,r)}static#t(t,i,s,r,l,c,u,h,f,m){if(f<=0||f>=1)return;const b=1-f,y=f*f,A=y*f,x=b*(b*(b*t+3*f*i)+3*y*s)+A*r,S=b*(b*(b*l+3*f*c)+3*y*u)+A*h;m[0]=Math.min(m[0],x),m[1]=Math.min(m[1],S),m[2]=Math.max(m[2],x),m[3]=Math.max(m[3],S)}static#e(t,i,s,r,l,c,u,h,f,m,b,y){if(Math.abs(f)<1e-12){Math.abs(m)>=1e-12&&this.#t(t,i,s,r,l,c,u,h,-b/m,y);return}const A=m**2-4*b*f;if(A<0)return;const x=Math.sqrt(A),S=2*f;this.#t(t,i,s,r,l,c,u,h,(-m+x)/S,y),this.#t(t,i,s,r,l,c,u,h,(-m-x)/S,y)}static bezierBoundingBox(t,i,s,r,l,c,u,h,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],i,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],i,h),this.#e(t,s,l,u,i,r,c,h,3*(-t+3*(s-l)+u),6*(t-2*s+l),3*(s-t),f),this.#e(t,s,l,u,i,r,c,h,3*(-i+3*(r-c)+h),6*(i-2*r+c),3*(r-i),f)}}function mv(p){return decodeURIComponent(escape(p))}let Bu=null,jg=null;function bv(p){return Bu||(Bu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,jg=new Map([["","t"]])),p.replaceAll(Bu,(t,i,s)=>i?i.normalize("NFKC"):jg.get(s))}function _m(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const p=new Uint8Array(32);return crypto.getRandomValues(p),xm(p)}const qs="pdfjs_internal_id_";function yv(p,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[s,r,...l]=i;if(!p(s)&&!Number.isInteger(s)||!t(r))return!1;const c=l.length;let u=!0;switch(r.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const h of l)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Me(p,t,i){return Math.min(Math.max(p,t),i)}function wm(p){return Uint8Array.prototype.toBase64?p.toBase64():btoa(xm(p))}function vv(p){return Uint8Array.fromBase64?Uint8Array.fromBase64(p):fr(atob(p))}typeof Promise.try!="function"&&(Promise.try=function(p,...t){return new Promise(i=>{i(p(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(p){return p.reduce((t,i)=>t+i,0)});class cr{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function r(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(cr.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&i.push({str:c}),!!l.children)for(const h of l.children)r(h)}return r(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Em{static setupStorage(t,i,s,r,l){const c=r.getValue(i,{value:null});switch(s.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(c.value===s.attributes.xfaOn?t.setAttribute("checked",!0):c.value===s.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{r.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(i,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of s.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(i,{value:f})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:r,linkService:l}){const{attributes:c}=i,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${r}`);for(const[h,f]of Object.entries(c))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),s&&c.dataId&&this.setupStorage(t,c.dataId,i,s)}static render(t){const i=t.annotationStorage,s=t.linkService,r=t.xfaHtml,l=t.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:l,linkService:s});const u=l!=="richText",h=t.div;if(h.append(c),t.viewport){const b=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=b}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const b=document.createTextNode(r.value);c.append(b),u&&cr.shouldBuildText(r.name)&&f.push(b)}return{textDivs:f}}const m=[[r,-1,c]];for(;m.length>0;){const[b,y,A]=m.at(-1);if(y+1===b.children.length){m.pop();continue}const x=b.children[++m.at(-1)[1]];if(x===null)continue;const{name:S}=x;if(S==="#text"){const w=document.createTextNode(x.value);f.push(w),A.append(w);continue}const E=x?.attributes?.xmlns?document.createElementNS(x.attributes.xmlns,S):document.createElement(S);if(A.append(E),x.attributes&&this.setAttributes({html:E,element:x,storage:i,intent:l,linkService:s}),x.children?.length>0)m.push([x,-1,E]);else if(x.value){const w=document.createTextNode(x.value);u&&cr.shouldBuildText(S)&&f.push(w),E.append(w)}}for(const b of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const Yi="http://www.w3.org/2000/svg";class ta{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function pr(p,t="text"){if(nr(p,document.baseURI)){const i=await fetch(p);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const r=new XMLHttpRequest;r.open("GET",p,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(r.response);return}i(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class gr{constructor({viewBox:t,userUnit:i,scale:s,rotation:r,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=s,this.rotation=r,this.offsetX=l,this.offsetY=c,s*=i;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let m,b,y,A;switch(r%=360,r<0&&(r+=360),r){case 180:m=-1,b=0,y=0,A=1;break;case 90:m=0,b=1,y=1,A=0;break;case 270:m=0,b=-1,y=-1,A=0;break;case 0:m=1,b=0,y=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(y=-y,A=-A);let x,S,E,w;m===0?(x=Math.abs(f-t[1])*s+l,S=Math.abs(h-t[0])*s+c,E=(t[3]-t[1])*s,w=(t[2]-t[0])*s):(x=Math.abs(h-t[0])*s+l,S=Math.abs(f-t[1])*s+c,E=(t[2]-t[0])*s,w=(t[3]-t[1])*s),this.transform=[m*s,b*s,y*s,A*s,x-m*s*h-y*s*f,S-b*s*h-A*s*f],this.width=E,this.height=w}get rawDims(){const t=this.viewBox;return gt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:l=!1}={}){return new gr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:l})}convertToViewportPoint(t,i){const s=[t,i];return nt.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const i=[t[0],t[1]];nt.applyTransform(i,this.transform);const s=[t[2],t[3]];return nt.applyTransform(s,this.transform),[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){const s=[t,i];return nt.applyInverseTransform(s,this.transform),s}}class ah extends es{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function io(p){const t=p.length;let i=0;for(;i<t&&p[i].trim()==="";)i++;return p.substring(i,i+5).toLowerCase()==="data:"}function rh(p){return typeof p=="string"&&/\.pdf$/i.test(p)}function Av(p){return[p]=p.split(/[#?]/,1),p.substring(p.lastIndexOf("/")+1)}function Sv(p,t="document.pdf"){if(typeof p!="string")return t;if(io(p))return pt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(p);if(!s)return t;const r=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},l=/\.pdf$/i,c=s.pathname.split("/").at(-1);if(l.test(c))return r(c);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const f of u)if(l.test(f))return r(f);const h=Array.from(s.searchParams.keys()).reverse();for(const f of h)if(l.test(f))return r(f)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return r(h[0])}return t}class Ig{started=Object.create(null);times=[];time(t){t in this.started&&pt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||pt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:r,end:l}of this.times)t.push(`${s.padEnd(i)} ${l-r}ms
`);return t.join("")}}function nr(p,t){const i=t?URL.parse(p,t):URL.parse(p);return i?.protocol==="http:"||i?.protocol==="https:"}function hi(p){p.preventDefault()}function Jt(p){p.preventDefault(),p.stopPropagation()}function xv(p){console.log("Deprecated API usage: "+p)}class Xu{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const s=parseInt(i[1],10);let r=parseInt(i[2],10);r=r>=1&&r<=12?r-1:0;let l=parseInt(i[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(i[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(i[6],10);h=h>=0&&h<=59?h:0;const f=i[7]||"Z";let m=parseInt(i[8],10);m=m>=0&&m<=23?m:0;let b=parseInt(i[9],10)||0;return b=b>=0&&b<=59?b:0,f==="-"?(c+=m,u+=b):f==="+"&&(c-=m,u-=b),new Date(Date.UTC(s,r,l,c,u,h))}}function _v(p,{scale:t=1,rotation:i=0}){const{width:s,height:r}=p.attributes.style,l=[0,0,parseInt(s),parseInt(r)];return new gr({viewBox:l,userUnit:1,scale:t,rotation:i})}function mr(p){if(p.startsWith("#")){const t=parseInt(p.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return p.startsWith("rgb(")?p.slice(4,-1).split(",").map(t=>parseInt(t)):p.startsWith("rgba(")?p.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(pt(`Not a valid color format: "${p}"`),[0,0,0])}function wv(p){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of p.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;p.set(i,mr(s))}t.remove()}function $t(p){const{a:t,b:i,c:s,d:r,e:l,f:c}=p.getTransform();return[t,i,s,r,l,c]}function xi(p){const{a:t,b:i,c:s,d:r,e:l,f:c}=p.getTransform().invertSelf();return[t,i,s,r,l,c]}function Jn(p,t,i=!1,s=!0){if(t instanceof gr){const{pageWidth:r,pageHeight:l}=t.rawDims,{style:c}=p,u=_e.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${l}px`,m=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,b=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!i||t.rotation%180===0?(c.width=m,c.height=b):(c.width=b,c.height=m)}s&&p.setAttribute("data-main-rotation",t.rotation)}class Ti{constructor(){const{pixelRatio:t}=Ti;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,s,r,l=-1){let c=1/0,u=1/0,h=1/0;s=Ti.capPixels(s,l),s>0&&(c=Math.sqrt(s/(t*i))),r!==-1&&(u=r/t,h=r/i);const f=Math.min(c,u,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,s):s}return t}}const $u=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Ev{static get isDarkMode(){return gt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class Tv{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),gt(this,"commentForegroundColor",mr(s))}}function Cv(p,t,i,s){s=Math.min(Math.max(s??1,0),1);const r=255*(1-s);return p=Math.round(p*s+r),t=Math.round(t*s+r),i=Math.round(i*s+r),[p,t,i]}function Hg(p,t){const i=p[0]/255,s=p[1]/255,r=p[2]/255,l=Math.max(i,s,r),c=Math.min(i,s,r),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const h=l-c;switch(t[1]=u<.5?h/(l+c):h/(2-l-c),l){case i:t[0]=((s-r)/h+(s<r?6:0))*60;break;case s:t[0]=((r-i)/h+2)*60;break;case r:t[0]=((i-s)/h+4)*60;break}}t[2]=u}function Ku(p,t){const i=p[0],s=p[1],r=p[2],l=(1-Math.abs(2*r-1))*s,c=l*(1-Math.abs(i/60%2-1)),u=r-l/2;switch(Math.floor(i/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function Gg(p){return p<=.03928?p/12.92:((p+.055)/1.055)**2.4}function Vg(p,t,i){Ku(p,i),i.map(Gg);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];Ku(t,i),i.map(Gg);const r=.2126*i[0]+.7152*i[1]+.0722*i[2];return s>r?(s+.05)/(r+.05):(r+.05)/(s+.05)}const qg=new Map;function Mv(p,t){const i=p[0]+p[1]*256+p[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=qg.get(i);if(s)return s;const r=new Float32Array(9),l=r.subarray(0,3),c=r.subarray(3,6);Hg(p,c);const u=r.subarray(6,9);Hg(t,u);const h=u[2]<.5,f=h?12:4.5;if(c[2]=h?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),Vg(c,u,l)<f){let m,b;h?(m=c[2],b=1):(m=0,b=c[2]);const y=.005;for(;b-m>y;){const A=c[2]=(m+b)/2;h===Vg(c,u,l)<f?m=A:b=A}c[2]=h?b:m}return Ku(c,l),s=nt.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),qg.set(i,s),s}function Tm({html:p,dir:t,className:i},s){const r=document.createDocumentFragment();if(typeof p=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=p.split(/(?:\r\n?|\n)/);for(let u=0,h=c.length;u<h;++u){const f=c[u];l.append(document.createTextNode(f)),u<h-1&&l.append(document.createElement("br"))}r.append(l)}else Em.render({xfaHtml:p,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",i),s.append(r)}function Cm(p){const t=new Path2D;if(!p)return t;for(let i=0,s=p.length;i<s;)switch(p[i++]){case Qa.moveTo:t.moveTo(p[i++],p[i++]);break;case Qa.lineTo:t.lineTo(p[i++],p[i++]);break;case Qa.curveTo:t.bezierCurveTo(p[i++],p[i++],p[i++],p[i++],p[i++],p[i++]);break;case Qa.quadraticCurveTo:t.quadraticCurveTo(p[i++],p[i++],p[i++],p[i++]);break;case Qa.closePath:t.closePath();break;default:pt(`Unrecognized drawing path operator: ${p[i-1]}`);break}return t}class rr{#t=null;#e=null;#n;#i=null;#r=null;#a=null;#s=null;#l=null;static#c=null;constructor(t){this.#n=t,rr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#n._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",hi,{signal:i}),t.addEventListener("pointerdown",rr.#o,{signal:i}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const r=this.#n.toolbarPosition;if(r){const{style:l}=t,c=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#o(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,Jt(t)}#h(t){this.#n._focusEventsAllowed=!0,Jt(t)}#f(t){const i=this.#n._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",hi,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",rr.#c[t]),this.#f(s)&&s.addEventListener("click",r=>{i.delete()},{signal:i._signal}),this.#i.append(s)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#m),this.#r=t}addComment(t,i=null){if(this.#a)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const r=this.#s=this.#m;i?(this.#i.insertBefore(s,i),this.#i.insertBefore(r,i)):this.#i.append(s,r),this.#a=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#m)}async addEditSignatureButton(t){const i=this.#l=await t.renderEditButton(this.#n);this.#f(i),this.#i.append(i,this.#m)}removeButton(t){switch(t){case"comment":this.#a?.removeToolbarCommentButton(),this.#a=null,this.#s?.remove(),this.#s=null;break}}async addButton(t,i){switch(t){case"colorPicker":i&&this.addColorPicker(i);break;case"altText":i&&await this.addAltText(i);break;case"editSignature":i&&await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":i&&this.addComment(i);break}}async addButtonBefore(t,i,s){if(!i&&t==="comment")return;const r=this.#i.querySelector(s);r&&t==="comment"&&this.addComment(i,r)}updateEditSignatureButton(t){this.#l&&(this.#l.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class Rv{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#n._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",hi,{signal:i});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#r(t,i){let s=0,r=0;for(const l of t){const c=l.y+l.height;if(c<s)continue;const u=l.x+(i?l.width:0);if(c>s){r=u,s=c;continue}i?u>r&&(r=u):u<r&&(r=u)}return[i?1-r:r,s]}show(t,i,s){const[r,l]=this.#r(i,s),{style:c}=this.#e||=this.#i();t.append(this.#e),c.insetInlineEnd=`${100*r}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#a(t,i,s,r){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",i);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",hi,{signal:u}),l.addEventListener("click",r,{signal:u})),this.#t.append(l)}}function Mm(p,t,i){for(const s of i)t.addEventListener(s,p[s].bind(p))}class Lt{static#t=NaN;static#e=null;static#n=NaN;static#i=null;static initializeAndAddPointerId(t){(Lt.#e||=new Set).add(t)}static setPointer(t,i){Lt.#t||=i,Lt.#i??=t}static setTimeStamp(t){Lt.#n=t}static isSamePointerId(t){return Lt.#t===t}static isSamePointerIdOrRemove(t){return Lt.#t===t?!0:(Lt.#e?.delete(t),!1)}static isSamePointerType(t){return Lt.#i===t}static isInitializedAndDifferentPointerType(t){return Lt.#i!==null&&!Lt.isSamePointerType(t)}static isSameTimeStamp(t){return Lt.#n===t}static isUsingMultiplePointers(){return Lt.#e?.size>=1}static clearPointerType(){Lt.#i=null}static clearPointerIds(){Lt.#t=NaN,Lt.#e=null}static clearTimeStamp(){Lt.#n=NaN}}class Dv{#t=0;get id(){return`${lr}${this.#t++}`}}class lh{#t=_m();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const l=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return gt(this,"_isSVGFittingCanvas",l)}async#i(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof i=="string"?(s.url=i,r=await pr(i,"blob")):i instanceof File?r=s.file=i:i instanceof Blob&&(r=i),r.type==="image/svg+xml"){const l=lh._isSVGFittingCanvas,c=new FileReader,u=new Image,h=new Promise((f,m)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},c.onload=async()=>{const b=s.svgUrl=c.result;u.src=await l?`${b}#svgView(preserveAspectRatio(none))`:b},u.onerror=c.onerror=m});c.readAsDataURL(r),await h}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){pt(r),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:i,name:s,size:r,type:l}=t;return this.#i(`${i}_${s}_${r}_${l}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const s=await i;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(i.width,i.height);return r.getContext("2d").drawImage(i,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const i=this.#n.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=r.convertToBlob()}s.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class Nv{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:i,post:s,mustExec:r,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:i,post:s,type:l};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(c&&this.#t[this.#i].type===l){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class br{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=_e.platform;for(const[s,r,l={}]of t)for(const c of s){const u=c.startsWith("mac+");i&&u?(this.callbacks.set(c.slice(4),{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1))):!i&&!u&&(this.callbacks.set(c,{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(this.#t(i));if(!s)return;const{callback:r,options:{bubbles:l=!1,args:c=[],checker:u=null}}=s;u&&!u(t,i)||(r.bind(t,...c,i)(),l||Jt(i))}}class oh{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return wv(t),gt(this,"_colors",t)}convert(t){const i=mr(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,r]of this._colors)if(r.every((l,c)=>l===i[c]))return oh._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?nt.makeHexColor(...i):t}}class Cn{#t=new AbortController;#e=null;#n=null;#i=new Map;#r=new Map;#a=null;#s=null;#l=null;#c=new Nv;#o=null;#d=null;#h=null;#f=0;#m=new Set;#g=null;#u=null;#p=new Set;_editorUndoBar=null;#b=!1;#v=!1;#y=!1;#E=null;#_=null;#S=null;#C=null;#A=!1;#w=null;#D=new Dv;#M=!1;#R=!1;#z=!1;#O=null;#k=null;#F=null;#B=null;#V=null;#T=mt.NONE;#x=new Set;#L=null;#U=null;#I=null;#X=null;#Y=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#P=null;#q=null;#Z=null;#J=null;#j=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Cn.prototype,i=c=>c.#q.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),s=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return gt(this,"_keyboardManager",new br([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#q.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#q.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:i}]]))}constructor(t,i,s,r,l,c,u,h,f,m,b,y,A,x,S,E){const w=this._signal=this.#t.signal;this.#q=t,this.#Z=i,this.#J=s,this.#a=r,this.#o=l,this.#U=c,this.#Y=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:w}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:w}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:w}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:w}),u._on("setpreference",this.onSetPreference.bind(this),{signal:w}),u._on("switchannotationeditorparams",M=>this.updateParams(M.type,M.value),{signal:w}),window.addEventListener("pointerdown",()=>{this.#R=!0},{capture:!0,signal:w}),window.addEventListener("pointerup",()=>{this.#R=!1},{capture:!0,signal:w}),this.#rt(),this.#dt(),this.#et(),this.#s=h.annotationStorage,this.#E=h.filterFactory,this.#I=f,this.#C=m||null,this.#b=b,this.#v=y,this.#y=A,this.#V=x||null,this.viewParameters={realScale:ta.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=E!==!1,l?.setSidebarUiManager(this)}destroy(){this.#j?.resolve(),this.#j=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#p.clear(),this.#B?.clear(),this.#e=null,this.#x.clear(),this.#c.destroy(),this.#a?.destroy(),this.#o?.destroy(),this.#U?.destroy(),this.#w?.hide(),this.#w=null,this.#F?.destroy(),this.#F=null,this.#n=null,this.#_&&(clearTimeout(this.#_),this.#_=null),this.#P&&(clearTimeout(this.#P),this.#P=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return gt(this,"hcmFilter",this.#I?this.#E.addHCMFilter(this.#I.foreground,this.#I.background):"none")}get direction(){return gt(this,"direction",getComputedStyle(this.#q).direction)}get _highlightColors(){return gt(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return gt(this,"highlightColors",null);const i=new Map,s=!!this.#I;for(const[r,l]of t){const c=r.endsWith("_HCM");if(s&&c){i.set(r.replace("_HCM",""),l);continue}!s&&!c&&i.set(r,l)}return gt(this,"highlightColors",i)}get highlightColorNames(){return gt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,i=!1){this.#a?.editAltText(this,t,i)}hasCommentManager(){return!!this.#o}editComment(t,i,s,r){this.#o?.showDialog(this,t,i,s,r)}selectComment(t,i){this.#r.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#o?.updateComment(t.getData())}updatePopupColor(t){this.#o?.updatePopupColor(t)}removeComment(t){this.#o?.removeComments([t.uid])}toggleComment(t,i,s=void 0){this.#o?.toggleCommentPopup(t,i,s)}makeCommentColor(t,i){return t&&this.#o?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#o?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:i,promise:s}=Promise.withResolvers(),r=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",r),i())};this._eventBus.on("editorsrendered",r),await s}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":this.#y=i;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#q.focus()}findParent(t,i){for(const s of this.#r.values()){const{x:r,y:l,width:c,height:u}=s.div.getBoundingClientRect();if(t>=r&&t<=r+c&&i>=l&&i<=l+u)return s}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ta.PDF_TO_CSS_UNITS;for(const i of this.#p)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of this.#r.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",i=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u}=s,h=s.toString(),m=this.#W(s).closest(".textLayer"),b=this.getSelectionBoxes(m);if(!b)return;s.empty();const y=this.#tt(m),A=this.#T===mt.NONE,x=()=>{const S=y?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:b,anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u,text:h});A&&this.showAllEditors("highlight",!0,!0),i&&S?.editComment()};if(A){this.switchToMode(mt.HIGHLIGHT,x);return}x()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#W(t).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(this.#w||=new Rv(this),this.#w.show(s,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const i=`${lr}${t}`,s=this.#s.getRawValue(i);return s&&this.#s.remove(i),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,i=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),i?s.setAttribute("data-l10n-args",JSON.stringify(i)):s.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#L&&(this.#w?.hide(),this.#L=null,this.#N({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#L)return;const r=this.#W(t).closest(".textLayer");if(!r){this.#L&&(this.#w?.hide(),this.#L=null,this.#N({hasSelectedText:!1}));return}if(this.#w?.hide(),this.#L=i,this.#N({hasSelectedText:!0}),!(this.#T!==mt.HIGHLIGHT&&this.#T!==mt.NONE)&&(this.#T===mt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#T===mt.HIGHLIGHT?this.#tt(r):null;if(l?.toggleDrawing(),this.#R){const c=new AbortController,u=this.combinedSignal(c),h=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else l?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#T===mt.HIGHLIGHT?this.highlightSelection(t):this.#b&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#lt(){if(this.#S)return;this.#S=new AbortController;const t=this.combinedSignal(this.#S);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ot(){this.#S?.abort(),this.#S=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#x)if(i.div.contains(t)){this.#k=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#k)return;const[t,i]=this.#k;this.#k=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#O)return;this.#O=new AbortController;const t=this.combinedSignal(this.#O);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#O?.abort(),this.#O=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of this.#x){const r=s.serialize(!0);r&&i.push(r)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const l of i.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(l){pt(`paste: "${l.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const l=[];for(const h of s){const f=await r.deserialize(h);if(!f)return;l.push(f)}const c=()=>{for(const h of l)this.#it(h);this.#nt(l)},u=()=>{for(const h of l)h.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){pt(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==mt.NONE&&!this.isEditorHandlingKeyboard&&Cn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#N(t){Object.entries(t).some(([s,r])=>this.#$[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#T===mt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#G([[Ct.HIGHLIGHT_FREE,!0]]))}#G(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#lt(),this.#ut(),this.#N({isEditing:this.#T!==mt.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ot(),this.#ht(),this.#N({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#G(i.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#M?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,i=null,s=!1,r=!1,l=!1){if(this.#T!==t&&!(this.#j&&(await this.#j.promise,!this.#j))){if(this.#j=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===mt.POPUP&&this.#o?.hideSidebar(),this.#o?.destroyPopup(),this.#T=t,t===mt.NONE){this.setEditingState(!1),this.#pt();for(const c of this.#i.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#j.resolve();return}for(const c of this.#i.values())c.addStandaloneCommentButton();t===mt.SIGNATURE&&await this.#U?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const c of this.#r.values())c.updateMode(t);if(t===mt.POPUP){this.#n||=await this.#Y.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const c=new Set,u=[];for(const h of this.#i.values()){const{annotationElementId:f,hasComment:m,deleted:b}=h;f&&c.add(f),m&&!b&&u.push(h.getData())}for(const h of this.#n){const{id:f,popupRef:m,contentsObj:b}=h;m&&b?.str&&!c.has(f)&&!this.#m.has(f)&&u.push(h)}this.#o?.showSidebar(u)}if(!i){s&&this.addNewEditorFromKeyboard(),this.#j.resolve();return}for(const c of this.#i.values())c.uid===i?(this.setSelected(c),l?c.editComment():r?c.enterInEditMode():c.focus()):c.unselect();this.#j.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case Ct.CREATE:this.currentLayer.addNewEditor(i);return;case Ct.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#X||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const s of this.#x)s.updateParams(t,i);else for(const s of this.#u)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(const l of this.#i.values())l.editorType===t&&l.show(i);(this.#X?.get(Ct.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#G([[Ct.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#z!==t){this.#z=t;for(const i of this.#r.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#M){this.#M=!0;const t=[];for(const i of this.#r.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#pt(){if(this.unselectAll(),this.#M){this.#M=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#_&&clearTimeout(this.#_),this.#_=setTimeout(()=>{this.focusMainContainer(),this.#_=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const i=this.#r.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#G(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#x);return t}updateUI(t){this.#gt===t&&this.#G(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#G(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#x.has(t)){this.#x.delete(t),t.unselect(),this.#N({hasSelectedEditor:this.hasSelection});return}this.#x.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const i of this.#x)i!==t&&i.unselect();this.#x.clear(),this.#x.add(t),t.select(),this.#G(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}isSelected(t){return this.#x.has(t)}get firstSelectedEditor(){return this.#x.values().next().value}unselect(t){t.unselect(),this.#x.delete(t),this.#N({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#x.size!==0}get isEnterHandled(){return this.#x.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#N({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#x],s=()=>{this._editorUndoBar?.show(r,i.length===1?i[0].editorType:i.length);for(const l of i)l.remove()},r=()=>{for(const l of i)this.#it(l)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#nt(t){for(const i of this.#x)i.unselect();this.#x.clear();for(const i of t)i.isEmpty()||(this.#x.add(i),i.select());this.#N({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#x)t.commit();this.#nt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==mt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#x)t.unselect();this.#x.clear(),this.#N({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=i;const[r,l]=this.#H,c=[...this.#x],u=1e3;this.#P&&clearTimeout(this.#P),this.#P=setTimeout(()=>{this.#P=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(r,l),h.translationDone())},undo:()=>{for(const h of c)this.#i.has(h.id)&&(h.translateInPage(-r,-l),h.translationDone())},mustExec:!1})},u);for(const h of c)h.translateInPage(t,i),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#x)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let i=!1;for(const[{x:r,y:l,pageIndex:c},u]of t)u.newX=r,u.newY=l,u.newPageIndex=c,i||=r!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!i)return!1;const s=(r,l,c,u)=>{if(this.#i.has(r.id)){const h=this.#r.get(u);h?r._setParentAndPosition(h,l,c):(r.pageIndex=u,r.x=l,r.y=c)}};return this.addCommands({cmd:()=>{for(const[r,{newX:l,newY:c,newPageIndex:u}]of t)s(r,l,c,u)},undo:()=>{for(const[r,{savedX:l,savedY:c,savedPageIndex:u}]of t)s(r,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#g)for(const s of this.#g.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#x.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==mt.NONE}get imageManager(){return gt(this,"imageManager",new lh)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let f=0,m=i.rangeCount;f<m;f++)if(!t.contains(i.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:r,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,m,b,y)=>({x:(m-r)/c,y:1-(f+b-s)/l,width:y/c,height:b/l});break;case"180":u=(f,m,b,y)=>({x:1-(f+b-s)/l,y:1-(m+y-r)/c,width:b/l,height:y/c});break;case"270":u=(f,m,b,y)=>({x:1-(m+y-r)/c,y:(f-s)/l,width:y/c,height:b/l});break;default:u=(f,m,b,y)=>({x:(f-s)/l,y:(m-r)/c,width:b/l,height:y/c});break}const h=[];for(let f=0,m=i.rangeCount;f<m;f++){const b=i.getRangeAt(f);if(!b.collapsed)for(const{x:y,y:A,width:x,height:S}of b.getClientRects())x===0||S===0||h.push(u(y,A,x,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#l||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const i=this.#l?.get(t.data.id);if(!i)return;const s=this.#s.getRawValue(i);s&&(this.#T===mt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,i,s){const r=this.#B?.get(t);r&&(r.setCanvas(i,s),this.#B.delete(t))}addMissingCanvas(t,i){(this.#B||=new Map).set(t,i)}}class Ei{#t=null;#e=!1;#n=null;#i=null;#r=null;#a=null;#s=!1;#l=null;#c=null;#o=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Ei.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ei._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ei.#f.missing),i.setAttribute("data-l10n-id",Ei.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",hi,{signal:s}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const r=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#s=!0,r(l))},{signal:s}),await this.#g(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#o:this.isEmpty()}get guessedText(){return this.#o}async setGuessedText(t){this.#t===null&&(this.#o=t,this.#d=await Ei._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#l?.remove(),this.#l=null;return}if(!this.#l){const i=this.#l=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#l.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#o===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#o,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:r,cancel:l=!1}){s&&(this.#o=s,this.#d=r),!(this.#t===t&&this.#e===i)&&(l||(this.#t=t,this.#e=i),this.#g())}toggle(t=!1){this.#n&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#l?.remove(),this.#l=null}async#g(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ei.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",Ei.#f[`${this.#m}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#r;if(!i){this.#r=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const r=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#r?.classList.remove("show")},{signal:l})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class zl{#t=null;#e=null;#n=!1;#i=null;#r=null;#a=null;#s=null;#l=null;#c=!1;#o=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const r=this.#i.commentButtonColor;r&&(s.backgroundColor=r)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#o)return this.#o;if(!this.#t)return null;const{x:t,y:i,height:s}=this.#t.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#i.parent.boundingClientRect;return[(t-r)/c,(i+s-l)/u]}set commentPopupPositionInLayer(t){this.#o=t}hasDefaultPopupPosition(){return this.#o===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",hi,{signal:s}),i&&(t.addEventListener("focusin",l=>{this.#i._focusEventsAllowed=!1,Jt(l)},{capture:!0,signal:s}),t.addEventListener("focusout",l=>{this.#i._focusEventsAllowed=!0,Jt(l)},{capture:!0,signal:s})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const r=l=>{l.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#n=!0,r(l))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const i=this.commentPopupPositionInLayer;let s,r;if(i)[s,r]=i;else{[s,r]=this.#i.commentButtonPosition;const{width:m,height:b,x:y,y:A}=this.#i;s=y+s*m,r=A+r*b}const l=this.#i.parent.boundingClientRect,{x:c,y:u,width:h,height:f}=l;this.#i._uiManager.editComment(this.#i,c+s*h,u+r*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#r}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#a,date:this.#l,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#a=null),t===null){this.#s="",this.#c=!0;return}this.#s=t,this.#l=new Date,this.#c=!1}setInitialText(t,i=null){this.#r=t,this.data=t,this.#l=null,this.#a=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#a=null,this.#l=null,this.#i=null,this.#n=!1,this.#c=!1}}class no{#t;#e=!1;#n=null;#i;#r;#a;#s;#l=null;#c;#o=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#n=s,this.#i=i,this.#r=r,this.#a=l,this.#s=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ti.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#l)return;const r=this.#l=new AbortController,l=AbortSignal.any([this.#c,r.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#l?.abort(),this.#l=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(Jt(f),h(f))},u),c.addEventListener("pointerup",h,u),c.addEventListener("pointercancel",h,u);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:r,capture:!1,passive:!1};l.addEventListener("touchmove",this.#m.bind(this),c);const u=this.#g.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",Jt,c),l.addEventListener("pointermove",Jt,c),l.addEventListener("pointercancel",Jt,c),l.addEventListener("pointerup",Jt,c),this.#r?.()}if(Jt(t),t.touches.length!==2||this.#n?.()){this.#o=null;return}let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]),this.#o={touch0X:i.screenX,touch0Y:i.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(t){if(!this.#o||t.touches.length!==2)return;Jt(t);let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]);const{screenX:r,screenY:l}=i,{screenX:c,screenY:u}=s,h=this.#o,{touch0X:f,touch0Y:m,touch1X:b,touch1Y:y}=h,A=b-f,x=y-m,S=c-r,E=u-l,w=Math.hypot(S,E)||1,M=Math.hypot(A,x)||1;if(!this.#e&&Math.abs(M-w)<=no.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=l,h.touch1X=c,h.touch1Y=u,!this.#e){this.#e=!0;return}const T=[(r+c)/2,(l+u)/2];this.#a?.(T,M,w)}#g(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#o&&(Jt(t),this.#o=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#l?.abort(),this.#l=null}}class rt{#t=null;#e=null;#n=null;#i=null;#r=null;#a=!1;#s=null;#l="";#c=null;#o=null;#d=null;#h=null;#f=null;#m="";#g=!1;#u=null;#p=!1;#b=!1;#v=!1;#y=null;#E=0;#_=0;#S=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#w=rt._zIndex++;static _borderLineWidth=-1;static _colorManager=new oh;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=rt.prototype._resizeWithKeyboard,i=Cn.TRANSLATE_SMALL,s=Cn.TRANSLATE_BIG;return gt(this,"_resizerKeyboardManager",new br([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],rt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:i,rawDims:{pageWidth:s,pageHeight:r,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[l,c];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return gt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new Ov({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(rt._l10n??=t,rt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),rt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);rt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){Ht("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#w}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#P(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,r){const[l,c]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(t+s)/l,this.y=(i+r)/c,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[s,r]=this.parentDimensions;this.setAt(t*s,i*r,this.width*s,this.height*r),this._onTranslated()}#D([t,i],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/t,this.y+=r/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#D(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#D(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[r,l]}=this;if(this.x+=t/r,this.y+=i/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:b,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,b,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[h,f]=this.getBaseTranslation();c+=h,u+=f;const{style:m}=s;m.left=`${(100*c).toFixed(2)}%`,m.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=rt,r=s/t,l=s/i;switch(this.rotation){case 90:return[-r,l];case 180:return[r,l];case 270:return[r,-l];default:return[-r,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[s,r]}=this;let{x:l,y:c,width:u,height:h}=this;if(u*=s,h*=r,l*=s,c*=r,this._mustFixPosition)switch(t){case 0:l=Me(l,0,s-u),c=Me(c,0,r-h);break;case 90:l=Me(l,0,s-h),c=Me(c,u,r);break;case 180:l=Me(l,u,s),c=Me(c,h,r);break;case 270:l=Me(l,h,s),c=Me(c,0,r-u);break}this.x=l/=s,this.y=c/=r;const[f,m]=this.getBaseTranslation();l+=f,c+=m,i.left=`${(100*l).toFixed(2)}%`,i.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#M(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return rt.#M(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return rt.#M(t,i,360-this.parentRotation)}#R(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(){const{div:{style:t},width:i,height:s}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#z(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",this.#O.bind(this,s),{signal:i}),r.addEventListener("contextmenu",hi,{signal:i}),r.tabIndex=-1}this.div.prepend(this.#c)}#O(t,i){i.preventDefault();const{isMac:s}=_e.platform;if(i.button!==0||i.ctrlKey&&s)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#o=[i.screenX,i.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",Jt,{passive:!1,signal:c}),window.addEventListener("contextmenu",hi,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#F()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#k(t,i,s,r){this.width=s,this.height=r,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:s,savedHeight:r}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,h=this.height;l===t&&c===i&&u===s&&h===r||this.addCommands({cmd:this.#k.bind(this,l,c,u,h),undo:this.#k.bind(this,t,i,s,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,i){const[s,r]=this.parentDimensions,l=this.x,c=this.y,u=this.width,h=this.height,f=rt.MIN_SIZE/s,m=rt.MIN_SIZE/r,b=this.#R(this.rotation),y=(P,V)=>[b[0]*P+b[2]*V,b[1]*P+b[3]*V],A=this.#R(360-this.rotation),x=(P,V)=>[A[0]*P+A[2]*V,A[1]*P+A[3]*V];let S,E,w=!1,M=!1;switch(t){case"topLeft":w=!0,S=(P,V)=>[0,0],E=(P,V)=>[P,V];break;case"topMiddle":S=(P,V)=>[P/2,0],E=(P,V)=>[P/2,V];break;case"topRight":w=!0,S=(P,V)=>[P,0],E=(P,V)=>[0,V];break;case"middleRight":M=!0,S=(P,V)=>[P,V/2],E=(P,V)=>[0,V/2];break;case"bottomRight":w=!0,S=(P,V)=>[P,V],E=(P,V)=>[0,0];break;case"bottomMiddle":S=(P,V)=>[P/2,V],E=(P,V)=>[P/2,0];break;case"bottomLeft":w=!0,S=(P,V)=>[0,V],E=(P,V)=>[P,0];break;case"middleLeft":M=!0,S=(P,V)=>[0,V/2],E=(P,V)=>[P,V/2];break}const T=S(u,h),L=E(u,h);let O=y(...L);const k=rt._round(l+O[0]),z=rt._round(c+O[1]);let q=1,K=1,J,W;if(i.fromKeyboard)({deltaX:J,deltaY:W}=i);else{const{screenX:P,screenY:V}=i,[Q,dt]=this.#o;[J,W]=this.screenToPageTranslation(P-Q,V-dt),this.#o[0]=P,this.#o[1]=V}if([J,W]=x(J/s,W/r),w){const P=Math.hypot(u,h);q=K=Math.max(Math.min(Math.hypot(L[0]-T[0]-J,L[1]-T[1]-W)/P,1/u,1/h),f/u,m/h)}else M?q=Me(Math.abs(L[0]-T[0]-J),f,1)/u:K=Me(Math.abs(L[1]-T[1]-W),m,1)/h;const Z=rt._round(u*q),ht=rt._round(h*K);O=y(...E(Z,ht));const vt=k-O[0],At=z-O[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=Z,this.height=ht,this.x=vt,this.y=At,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#b)return this._editToolbar;this._editToolbar=new rr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,s]of t)await this._editToolbar.addButton(i,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Ei.initialize(rt._l10n),this.#n=new Ei(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new zl(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#i.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:i,date:s,deleted:r}}=this.#i;return{text:i,richText:t,date:s,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new zl(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:s}){if(!i||(this.#i||=new zl(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new zl(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,h=r-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#I();const[i,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/s).toFixed(2)}%`);const[r,l]=this.getInitialTranslation();return this.translate(r,l),Mm(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new no({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#x.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#V(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,i,s){let l=.7*(s/i)+1-.7;if(l===1)return;const c=this.#R(this.rotation),u=(k,z)=>[c[0]*k+c[2]*z,c[1]*k+c[3]*z],[h,f]=this.parentDimensions,m=this.x,b=this.y,y=this.width,A=this.height,x=rt.MIN_SIZE/h,S=rt.MIN_SIZE/f;l=Math.max(Math.min(l,1/y,1/A),x/y,S/A);const E=rt._round(y*l),w=rt._round(A*l);if(E===y&&w===A)return;this.#u||=[m,b,y,A];const M=u(y/2,A/2),T=rt._round(m+M[0]),L=rt._round(b+M[1]),O=u(E/2,w/2);this.x=T-O[0],this.y=L-O[1],this.width=E,this.height=w,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#x(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:i}=_e.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#U(t);return}this.#L(t)}#L(t){const{isMac:i}=_e.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,l=this._uiManager.combinedSignal(r),c={capture:!0,passive:!1,signal:l},u=f=>{r.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#L(f),s&&this._onStopDragging()};i&&(this.#E=t.clientX,this.#_=t.clientY,this.#s=t.pointerId,this.#l=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:m,clientY:b,pointerId:y}=f;if(y!==this.#s){Jt(f);return}const[A,x]=this.screenToPageTranslation(m-this.#E,b-this.#_);this.#E=m,this.#_=b,this._uiManager.dragSelectedEditors(A,x)},c),window.addEventListener("touchmove",Jt,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#l&&(this.#C||f.isPrimary)&&u(f),Jt(f)},c));const h=f=>{if(!this.#s||this.#s===f.pointerId){u(f);return}Jt(f)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,s=this.rotation){const r=this.parentScale,[l,c]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/r,m=i/r,b=this.x*l,y=this.y*c,A=this.width*l,x=this.height*c;switch(s){case 0:return[b+f+u,c-y-m-x+h,b+f+A+u,c-y-m+h];case 90:return[b+m+u,c-y+f+h,b+m+x+u,c-y+f+A+h];case 180:return[b-f-A+u,c-y+m+h,b-f+u,c-y+m+x+h];case 270:return[b-m-x+u,c-y-f-A+h,b-m+u,c-y-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,r,l,c]=t,u=l-s,h=c-r;switch(this.rotation){case 0:return[s,i-c,u,h];case 90:return[s,i-r,h,u];case 180:return[l,i-r,u,h];case 270:return[l,i-c,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&rt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:s,opacity:r,deleted:l,richText:c},uid:u,pageIndex:h,creationDate:f,modificationDate:m}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:s||m,popupRef:!l,color:i,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#b=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#b=!1,!0):!1}isInEditMode(){return this.#b}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return i<c&&r>0&&t<l&&s>0}#I(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#I()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,s){const r=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[l,c]=r.pageDimensions,[u,h,f,m]=r.getRectInCurrentCoords(t.rect,c);return r.x=u/l,r.y=h/c,r.width=f/l,r.height=m/c,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#P(),this.removeEditToolbar(),this.#S){for(const t of this.#S.values())clearTimeout(t);this.#S=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#z(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[s,r,l,c]=this.getPDFRect();return[rt._round(s+(l-s)*t),rt._round(r+(c-r)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const c=this.#X.bind(this),u=this.#Y.bind(this),h=this._uiManager._signal;for(const f of this.#e){const m=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",this.#$.bind(this,m),{signal:h}),f.setAttribute("data-l10n-id",rt._l10nResizer[m])}}const s=this.#e[0];let r=0;for(const c of i){if(c===s)break;r++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==r){if(l<r)for(let u=0;u<r-l;u++)this.#c.append(this.#c.firstElementChild);else if(l>r)for(let u=0;u<l-r;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of i){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",rt._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#X(t){rt._resizerKeyboardManager.exec(this,t)}#Y(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#P()}#$(t){this.#m=this.#v?t:""}#H(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#B(this.#m,{deltaX:t,deltaY:i,fromKeyboard:!0})}#P(){this.#v=!1,this.#H(-1),this.#F()}_stopResizingWithKeyboard(){this.#P(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#S||=new Map;const{action:s}=t;let r=this.#S.get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#S.delete(s),this.#S.size===0&&(this.#S=null)},rt._telemetryTimeout),this.#S.set(s,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstElementChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class Ov extends rt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Yg=3285377520,oi=4294901760,_i=65535;class Rm{constructor(t){this.h1=t?t&4294967295:Yg,this.h2=t?t&4294967295:Yg}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let S=0,E=t.length;S<E;S++){const w=t.charCodeAt(S);w<=255?i[s++]=w:(i[s++]=w>>>8,i[s++]=w&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,l=s-r*4,c=new Uint32Array(i.buffer,0,r);let u=0,h=0,f=this.h1,m=this.h2;const b=3432918353,y=461845907,A=b&_i,x=y&_i;for(let S=0;S<r;S++)S&1?(u=c[S],u=u*b&oi|u*A&_i,u=u<<15|u>>>17,u=u*y&oi|u*x&_i,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=c[S],h=h*b&oi|h*A&_i,h=h<<15|h>>>17,h=h*y&oi|h*x&_i,m^=h,m=m<<13|m>>>19,m=m*5+3864292196);switch(u=0,l){case 3:u^=i[r*4+2]<<16;case 2:u^=i[r*4+1]<<8;case 1:u^=i[r*4],u=u*b&oi|u*A&_i,u=u<<15|u>>>17,u=u*y&oi|u*x&_i,r&1?f^=u:m^=u}this.h1=f,this.h2=m}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&oi|t*36045&_i,i=i*4283543511&oi|((i<<16|t>>>16)*2950163797&oi)>>>16,t^=i>>>1,t=t*444984403&oi|t*60499&_i,i=i*3301882366&oi|((i<<16|t>>>16)*3120437893&oi)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const Qu=Object.freeze({map:null,hash:"",transfer:void 0});class ch{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=this.#i.get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof rt&&this.#n.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof rt)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=this.#i.get(t);let r=!1;if(s!==void 0)for(const[l,c]of Object.entries(i))s[l]!==c&&(r=!0,s[l]=c);else r=!0,this.#i.set(t,i);r&&this.#r(),i instanceof rt&&((this.#n||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Dm(this)}get serializable(){if(this.#i.size===0)return Qu;const t=new Map,i=new Rm,s=[],r=Object.create(null);let l=!1;for(const[c,u]of this.#i){const h=u instanceof rt?u.serialize(!1,r):u;h&&(t.set(c,h),i.update(`${c}:${JSON.stringify(h)}`),l||=!!h.bitmap)}if(l)for(const c of t.values())c.bitmap&&s.push(c.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:Qu}get editorStats(){let t=null;const i=new Map;let s=0,r=0;for(const l of this.#i.values()){if(!(l instanceof rt)){l.popup&&(l.popup.deleted?r+=1:s+=1);continue}l.isCommentDeleted?r+=1:l.hasEditedComment&&(s+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;i.has(u)||i.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const h=t[u]||=new Map;for(const[f,m]of Object.entries(c)){if(f==="type")continue;let b=h.get(f);b||(b=new Map,h.set(f,b));const y=b.get(m)??0;b.set(m,y+1)}}if((r>0||s>0)&&(t||=Object.create(null),t.comments={deleted:r,edited:s}),!t)return null;for(const[l,c]of i)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const s=this.#n?.get(t);return s?(s.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const i of this.#n.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class Dm extends ch{#t;constructor(t){super();const{map:i,hash:s,transfer:r}=t.serializable,l=structuredClone(i,r?{transfer:r}:null);this.#t={map:l,hash:s,transfer:r}}get print(){Ht("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return gt(this,"modifiedIds",{ids:new Set,hash:""})}}class Lv{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(Mt(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:l,style:c}=t,u=new FontFace(r,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(r),s?.(t)}catch{pt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Ht("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw pt(`Failed to load font '${s.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return gt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return gt(this,"isSyncFontLoadingSupported",Ce||_e.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Mt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const l=s.shift();setTimeout(l.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:i,callback:t};return s.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return gt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(L,O){return L.charCodeAt(O)<<24|L.charCodeAt(O+1)<<16|L.charCodeAt(O+2)<<8|L.charCodeAt(O+3)&255}function r(L,O,k,z){const q=L.substring(0,O),K=L.substring(O+k);return q+z+K}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function m(L,O){if(++f>30){pt("Load test font never loaded."),O();return}if(h.font="30px "+L,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(m.bind(null,L,O))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=r(y,976,b.length,b);const x=16,S=1482184792;let E=s(y,x);for(l=0,c=b.length-3;l<c;l+=4)E=E-S+s(b,l)|0;l<b.length&&(E=E-S+s(b+"XXX",l)|0),y=r(y,x,4,fv(E));const w=`url(data:font/opentype;base64,${btoa(y)});`,M=`@font-face {font-family:"${b}";src:${w}}`;this.insertRule(M);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const L of[t.loadedName,b]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=L,T.append(O)}this._document.body.append(T),m(b,()=>{T.remove(),i.complete()})}}class kv{#t;constructor(t,i=null,s,r){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,s&&Object.assign(this,s),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${wm(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const s=this.loadedName+"_path_"+i;let r;try{r=t.get(s)}catch(c){pt(`getPathGenerator - ignoring character: "${c}".`)}const l=Cm(r);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[i]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){gt(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){gt(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class Ks{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,s={};let r=0;for(const f of Ks.strings){const m=i.encode(t[f]);s[f]=m,r+=4+m.length}const l=new ArrayBuffer(r),c=new Uint8Array(l),u=new DataView(l);let h=0;for(const f of Ks.strings){const m=s[f],b=m.length;u.setUint32(h,b),c.set(m,h+4),h+=4+b}return Mt(h===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){Mt(t<Ks.strings.length,"Invalid string index");let i=0;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class Qs{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,s={};let r=0;for(const y of Qs.strings){const A=i.encode(t[y]);s[y]=A,r+=4+A.length}r+=4;let l,c,u=1+r;t.style&&(l=i.encode(t.style.style),c=i.encode(t.style.weight),u+=4+l.length+4+c.length);const h=new ArrayBuffer(u),f=new Uint8Array(h),m=new DataView(h);let b=0;m.setUint8(b++,t.guessFallback?1:0),m.setUint32(b,0),b+=4,r=0;for(const y of Qs.strings){const A=s[y],x=A.length;r+=4+x,m.setUint32(b,x),f.set(A,b+4),b+=4+x}return m.setUint32(b-r-4,r),t.style&&(m.setUint32(b,l.length),f.set(l,b+4),b+=4+l.length,m.setUint32(b,c.length),f.set(c,b+4),b+=4+c.length),Mt(b<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(b)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){Mt(t<Qs.strings.length,"Invalid string index");let i=5;for(let r=0;r<t;r++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),s=this.#n.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const r=this.#e.getUint32(t),l=this.#n.decode(new Uint8Array(this.#t,t+4,r));return{style:s,weight:l}}}class Ut{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#r=this.#i+1+6;#a;#s;#l;constructor({data:t,extra:i}){this.#a=t,this.#s=new TextDecoder,this.#l=new DataView(this.#a),i&&Object.assign(this,i)}#c(t){Mt(t<Ut.bools.length,"Invalid boolean index");const i=Math.floor(t/4),s=t*2%8,r=this.#l.getUint8(i)>>s&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#o(t){return Mt(t<Ut.numbers.length,"Invalid number index"),this.#l.getFloat64(Ut.#t+t*8)}get ascent(){return this.#o(0)}get defaultWidth(){return this.#o(1)}get descent(){return this.#o(2)}get bbox(){let t=Ut.#e;if(this.#l.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<4;r++)s.push(this.#l.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=Ut.#n;if(this.#l.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<6;r++)s.push(this.#l.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=Ut.#i;if(this.#l.getUint8(t)===0)return;t+=1;const s=[];for(let r=0;r<3;r++)s.push(this.#l.getInt16(t,!0)),t+=2;return s}#d(t){Mt(t<Ut.strings.length,"Invalid string index");let i=Ut.#r+4;for(let l=0;l<t;l++)i+=this.#l.getUint32(i)+4;const s=this.#l.getUint32(i),r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,i+4,s)),this.#s.decode(r)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Ut.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);t+=4+s;const r=this.#l.getUint32(t);t+=4+r;const l=this.#l.getUint32(t);if(l!==0)return new Uint8Array(this.#a,t+4,l)}clearData(){let t=Ut.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);t+=4+s;const r=this.#l.getUint32(t);t+=4+r;const l=this.#l.getUint32(t);new Uint8Array(this.#a,t+4,l).fill(0),this.#l.setUint32(t,0)}get cssFontInfo(){let t=Ut.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);t+=4+s;const r=this.#l.getUint32(t);if(r===0)return null;const l=new Uint8Array(r);return l.set(new Uint8Array(this.#a,t+4,r)),new Ks(l.buffer)}get systemFontInfo(){let t=Ut.#r;const i=this.#l.getUint32(t);t+=4+i;const s=this.#l.getUint32(t);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(this.#a,t+4,s)),new Qs(r.buffer)}static write(t){const i=t.systemFontInfo?Qs.write(t.systemFontInfo):null,s=t.cssFontInfo?Ks.write(t.cssFontInfo):null,r=new TextEncoder,l={};let c=0;for(const S of Ut.strings)l[S]=r.encode(t[S]),c+=4+l[S].length;const u=Ut.#r+4+c+4+(i?i.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),f=new Uint8Array(h),m=new DataView(h);let b=0;const y=Ut.bools.length;let A=0,x=0;for(let S=0;S<y;S++){const E=t[Ut.bools[S]];A|=(E===void 0?0:E?2:1)<<x,x+=2,(x===8||S===y-1)&&(m.setUint8(b++,A),A=0,x=0)}Mt(b===Ut.#t,"FontInfo.write: Boolean properties offset mismatch");for(const S of Ut.numbers)m.setFloat64(b,t[S]),b+=8;if(Mt(b===Ut.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){m.setUint8(b++,4);for(const S of t.bbox)m.setInt16(b,S,!0),b+=2}else m.setUint8(b++,0),b+=8;if(Mt(b===Ut.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){m.setUint8(b++,6);for(const S of t.fontMatrix)m.setFloat64(b,S,!0),b+=8}else m.setUint8(b++,0),b+=48;if(Mt(b===Ut.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){m.setUint8(b++,1);for(const S of t.defaultVMetrics)m.setInt16(b,S,!0),b+=2}else m.setUint8(b++,0),b+=6;Mt(b===Ut.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),m.setUint32(Ut.#r,0),b+=4;for(const S of Ut.strings){const E=l[S],w=E.length;m.setUint32(b,w),f.set(E,b+4),b+=4+w}if(m.setUint32(Ut.#r,b-Ut.#r-4),!i)m.setUint32(b,0),b+=4;else{const S=i.byteLength;m.setUint32(b,S),Mt(b+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(i),b+4),b+=4+S}if(!s)m.setUint32(b,0),b+=4;else{const S=s.byteLength;m.setUint32(b,S),Mt(b+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(s),b+4),b+=4+S}return t.data===void 0?(m.setUint32(b,0),b+=4):(m.setUint32(b,t.data.length),f.set(t.data,b+4),b+=4+t.data.length),Mt(b<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(b)}}class fe{static#t=0;static#e=1;static#n=2;static#i=3;static#r=4;static#a=8;static#s=12;static#l=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let i,s=null,r=[],l=[],c=[],u=[],h=null,f=null;switch(t[0]){case"RadialAxial":i=t[1]==="axial"?1:2,s=t[2],c=t[3],i===1?r.push(...t[4],...t[5]):r.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":i=3,h=t[1],r=t[2],l=t[3],u=t[4]||[],s=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const m=Math.floor(r.length/2),b=Math.floor(l.length/3),y=c.length,A=u.length;let x=0;for(const O of u)x+=1,x=Math.ceil(x/4)*4,x+=4+O.coords.length*4,x+=4+O.colors.length*4,O.verticesPerRow!==void 0&&(x+=4);const S=20+m*8+b*3+y*8+(s?16:0)+(f?3:0)+x,E=new ArrayBuffer(S),w=new DataView(E),M=new Uint8Array(E);w.setUint8(fe.#t,i),w.setUint8(fe.#e,s?1:0),w.setUint8(fe.#n,f?1:0),w.setUint8(fe.#i,h),w.setUint32(fe.#r,m,!0),w.setUint32(fe.#a,b,!0),w.setUint32(fe.#s,y,!0),w.setUint32(fe.#l,A,!0);let T=20;new Float32Array(E,T,m*2).set(r),T+=m*8,M.set(l,T),T+=b*3;for(const[O,k]of c)w.setFloat32(T,O,!0),T+=4,w.setUint32(T,parseInt(k.slice(1),16),!0),T+=4;if(s)for(const O of s)w.setFloat32(T,O,!0),T+=4;f&&(M.set(f,T),T+=3);for(let O=0;O<u.length;O++){const k=u[O];w.setUint8(T,k.type),T+=1,T=Math.ceil(T/4)*4,w.setUint32(T,k.coords.length,!0),T+=4,new Int32Array(E,T,k.coords.length).set(k.coords),T+=k.coords.length*4,w.setUint32(T,k.colors.length,!0),T+=4,new Int32Array(E,T,k.colors.length).set(k.colors),T+=k.colors.length*4,k.verticesPerRow!==void 0&&(w.setUint32(T,k.verticesPerRow,!0),T+=4)}return E}getIR(){const t=this.view,i=this.data[fe.#t],s=!!this.data[fe.#e],r=!!this.data[fe.#n],l=t.getUint32(fe.#r,!0),c=t.getUint32(fe.#a,!0),u=t.getUint32(fe.#s,!0),h=t.getUint32(fe.#l,!0);let f=20;const m=new Float32Array(this.buffer,f,l*2);f+=l*8;const b=new Uint8Array(this.buffer,f,c*3);f+=c*3;const y=[];for(let E=0;E<u;++E){const w=t.getFloat32(f,!0);f+=4;const M=t.getUint32(f,!0);f+=4,y.push([w,`#${M.toString(16).padStart(6,"0")}`])}let A=null;if(s){A=[];for(let E=0;E<4;++E)A.push(t.getFloat32(f,!0)),f+=4}let x=null;r&&(x=new Uint8Array(this.buffer,f,3),f+=3);const S=[];for(let E=0;E<h;++E){const w=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const M=t.getUint32(f,!0);f+=4;const T=new Int32Array(this.buffer,f,M);f+=M*4;const L=t.getUint32(f,!0);f+=4;const O=new Int32Array(this.buffer,f,L);f+=L*4;const k={type:w,coords:T,colors:O};w===qu.LATTICE&&(k.verticesPerRow=t.getUint32(f,!0),f+=4),S.push(k)}if(i===1)return["RadialAxial","axial",A,y,Array.from(m.slice(0,2)),Array.from(m.slice(2,4)),null,null];if(i===2)return["RadialAxial","radial",A,y,[m[0],m[1]],[m[3],m[4]],m[2],m[5]];if(i===3){const E=this.data[fe.#i];let w=null;if(m.length>0){let M=m[0],T=m[0],L=m[1],O=m[1];for(let k=0;k<m.length;k+=2){const z=m[k],q=m[k+1];M=M>z?z:M,L=L>q?q:L,T=T<z?z:T,O=O<q?q:O}w=[M,L,T,O]}return["Mesh",E,m,b,S,w,A,x]}throw new Error(`Unsupported pattern kind: ${i}`)}}function Bv(p){if(p instanceof URL)return p.href;if(typeof p=="string"){if(Ce)return p;const t=URL.parse(p,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Pv(p){if(Ce&&typeof Buffer<"u"&&p instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength)return p;if(typeof p=="string")return fr(p);if(p instanceof ArrayBuffer||ArrayBuffer.isView(p)||typeof p=="object"&&!isNaN(p?.length))return new Uint8Array(p);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Fl(p){if(typeof p!="string")return null;if(p.endsWith("/"))return p;throw new Error(`Invalid factory url: "${p}" must include trailing slash.`)}const Wu=p=>typeof p=="object"&&Number.isInteger(p?.num)&&p.num>=0&&Number.isInteger(p?.gen)&&p.gen>=0,zv=p=>typeof p=="object"&&typeof p?.name=="string",Fv=yv.bind(null,Wu,zv);class Uv{#t=new Map;#e=Promise.resolve();postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,s)})}addEventListener(t,i,s=null){let r=null;if(s?.signal instanceof AbortSignal){const{signal:l}=s;if(l.aborted){pt("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,i);r=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(i,r)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Ul={DATA:1,ERROR:2},oe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Xg(){}function Fe(p){if(p instanceof Tn||p instanceof Yu||p instanceof Ug||p instanceof Kl||p instanceof Lu)return p;switch(p instanceof Error||typeof p=="object"&&p!==null||Ht('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new Tn(p.message);case"InvalidPDFException":return new Yu(p.message);case"PasswordException":return new Ug(p.message,p.code);case"ResponseException":return new Kl(p.message,p.status,p.missing);case"UnknownErrorException":return new Lu(p.message,p.details)}return new Lu(p.message,p.toString())}class sr{#t=new AbortController;constructor(t,i,s){this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===Ul.DATA)r.resolve(t.data);else if(t.callback===Ul.ERROR)r.reject(Fe(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,r=t.sourceName,l=this.comObj;Promise.try(i,t.data).then(function(c){l.postMessage({sourceName:s,targetName:r,callback:Ul.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:s,targetName:r,callback:Ul.ERROR,callbackId:t.callbackId,reason:Fe(c)})});return}if(t.streamId){this.#n(t);return}i(t.data)}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const r=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[r]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:i},s)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,i,s,r){const l=this.streamId++,c=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const m=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:i,desiredSize:f.desiredSize},r),m.promise},pull:f=>{const m=Promise.withResolvers();return this.streamControllers[l].pullCall=m,h.postMessage({sourceName:c,targetName:u,stream:oe.PULL,streamId:l,desiredSize:f.desiredSize}),m.promise},cancel:f=>{Mt(f instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[l].cancelCall=m,this.streamControllers[l].isClosed=!0,h.postMessage({sourceName:c,targetName:u,stream:oe.CANCEL,streamId:l,reason:Fe(f)}),m.promise}},s)}#n(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],h={enqueue(f,m=1,b){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=m,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:s,targetName:r,stream:oe.ENQUEUE,streamId:i,chunk:f},b)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:r,stream:oe.CLOSE,streamId:i}),delete c.streamSinks[i])},error(f){Mt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:r,stream:oe.ERROR,streamId:i,reason:Fe(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,Promise.try(u,t.data,h).then(function(){l.postMessage({sourceName:s,targetName:r,stream:oe.START_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:oe.START_COMPLETE,streamId:i,reason:Fe(f)})})}#i(t){const i=t.streamId,s=this.sourceName,r=t.sourceName,l=this.comObj,c=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case oe.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(Fe(t.reason));break;case oe.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(Fe(t.reason));break;case oe.PULL:if(!u){l.postMessage({sourceName:s,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Xg).then(function(){l.postMessage({sourceName:s,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:oe.PULL_COMPLETE,streamId:i,reason:Fe(f)})});break;case oe.ENQUEUE:if(Mt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case oe.CLOSE:if(Mt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,i);break;case oe.ERROR:Mt(c,"error should have stream controller"),c.controller.error(Fe(t.reason)),this.#r(c,i);break;case oe.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(Fe(t.reason)),this.#r(c,i);break;case oe.CANCEL:if(!u)break;const h=Fe(t.reason);Promise.try(u.onCancel||Xg,h).then(function(){l.postMessage({sourceName:s,targetName:r,stream:oe.CANCEL_COMPLETE,streamId:i,success:!0})},function(f){l.postMessage({sourceName:s,targetName:r,stream:oe.CANCEL_COMPLETE,streamId:i,reason:Fe(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#r(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class Nm{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){Ht("Abstract method `_createCanvas` called.")}}class jv extends Nm{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class Om{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){Ht("Abstract method `_fetch` called.")}}class $g extends Om{async _fetch(t){const i=await pr(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):fr(i)}}class Lm{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,r,l){return"none"}destroy(t=!1){}}class Iv extends Lm{#t;#e;#n;#i;#r;#a;#s=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#r=i}get#l(){return this.#e||=new Map}get#c(){return this.#a||=new Map}get#o(){if(!this.#n){const t=this.#r.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=this.#r.createElementNS(Yi,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#r.createElementNS(Yi,"defs"),t.append(s),s.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let b=0;b<256;b++)f[b]=h[b]/255;const m=f.join(",");return[m,m,m]}const[i,s,r]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let h=0;h<256;h++)l[h]=i[h]/255,c[h]=s[h]/255,u[h]=r[h]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#r.URL;i!==this.#r.baseURI&&(io(i)?pt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Sm(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#l.get(t);if(i)return i;const[s,r,l]=this.#d(t),c=t.length===1?s:`${s}${r}${l}`;if(i=this.#l.get(c),i)return this.#l.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#s++}`,h=this.#h(u);this.#l.set(t,h),this.#l.set(c,h);const f=this.#g(u);return this.#p(s,r,l,f),h}addHCMFilter(t,i){const s=`${t}-${i}`,r="base";let l=this.#c.get(r);if(l?.key===s||(l?(l.filter?.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},this.#c.set(r,l)),!t||!i))return l.url;const c=this.#v(t);t=nt.makeHexColor(...c);const u=this.#v(i);if(i=nt.makeHexColor(...u),this.#o.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return l.url;const h=new Array(256);for(let A=0;A<=255;A++){const x=A/255;h[A]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const f=h.join(","),m=`g_${this.#i}_hcm_filter`,b=l.filter=this.#g(m);this.#p(f,f,f,b),this.#m(b);const y=(A,x)=>{const S=c[A]/255,E=u[A]/255,w=new Array(x+1);for(let M=0;M<=x;M++)w[M]=S+M/x*(E-S);return w.join(",")};return this.#p(y(0,5),y(1,5),y(2,5),b),l.url=this.#h(m),l.url}addAlphaFilter(t){let i=this.#l.get(t);if(i)return i;const[s]=this.#d([t]),r=`alpha_${s}`;if(i=this.#l.get(r),i)return this.#l.set(t,i),i;const l=`g_${this.#i}_alpha_map_${this.#s++}`,c=this.#h(l);this.#l.set(t,c),this.#l.set(r,c);const u=this.#g(l);return this.#b(s,u),c}addLuminosityFilter(t){let i=this.#l.get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=this.#d([t]),r=`luminosity_${s}`):r="luminosity",i=this.#l.get(r),i)return this.#l.set(t,i),i;const l=`g_${this.#i}_luminosity_map_${this.#s++}`,c=this.#h(l);this.#l.set(t,c),this.#l.set(r,c);const u=this.#g(l);return this.#f(u),t&&this.#b(s,u),c}addHighlightHCMFilter(t,i,s,r,l){const c=`${i}-${s}-${r}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!i||!s))return u.url;const[h,f]=[i,s].map(this.#v.bind(this));let m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),b=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[y,A]=[r,l].map(this.#v.bind(this));b<m&&([m,b,y,A]=[b,m,A,y]),this.#o.style.color="";const x=(w,M,T)=>{const L=new Array(256),O=(b-m)/T,k=w/255,z=(M-w)/(255*T);let q=0;for(let K=0;K<=T;K++){const J=Math.round(m+K*O),W=k+K*z;for(let Z=q;Z<=J;Z++)L[Z]=W;q=J+1}for(let K=q;K<256;K++)L[K]=L[q-1];return L.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,E=u.filter=this.#g(S);return this.#m(E),this.#p(x(y[0],A[0],5),x(y[1],A[1],5),x(y[2],A[2],5),E),u.url=this.#h(S),u.url}destroy(t=!1){t&&this.#a?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#a?.clear(),this.#a=null,this.#s=0)}#f(t){const i=this.#r.createElementNS(Yi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#m(t){const i=this.#r.createElementNS(Yi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#g(t){const i=this.#r.createElementNS(Yi,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#o.append(i),i}#u(t,i,s){const r=this.#r.createElementNS(Yi,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)}#p(t,i,s,r){const l=this.#r.createElementNS(Yi,"feComponentTransfer");r.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",i),this.#u(l,"feFuncB",s)}#b(t,i){const s=this.#r.createElementNS(Yi,"feComponentTransfer");i.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#o.style.color=t,mr(getComputedStyle(this.#o).getPropertyValue("color"))}}class km{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){Ht("Abstract method `_fetch` called.")}}class Kg extends km{async _fetch(t){const i=await pr(t,"arraybuffer");return new Uint8Array(i)}}class Bm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){Ht("Abstract method `_fetch` called.")}}class Qg extends Bm{async _fetch(t){const i=await pr(t,"arraybuffer");return new Uint8Array(i)}}Ce&&pt("Please use the `legacy` build in Node.js environments.");async function uh(p){const i=await process.getBuiltinModule("fs").promises.readFile(p);return new Uint8Array(i)}class Hv extends Lm{}class Gv extends Nm{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class Vv extends Om{async _fetch(t){return uh(t)}}class qv extends km{async _fetch(t){return uh(t)}}class Yv extends Bm{async _fetch(t){return uh(t)}}const Is="__forcedDependency",{floor:Wg,ceil:Zg}=Math;function jl(p,t,i,s,r,l){p[t*4+0]=Math.min(p[t*4+0],i),p[t*4+1]=Math.min(p[t*4+1],s),p[t*4+2]=Math.max(p[t*4+2],r),p[t*4+3]=Math.max(p[t*4+3],l)}const Zu=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class Xv{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Zu}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Il=(p,t)=>{if(!p)return;let i=p.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},p.set(t,i)),i};class $v{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Is]:[]};#n=new Map;#i=[];#r=[];#a=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#l=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#o=new Set;#d=new Map;#h=new Map;#f;#m;#g;#u;#p;constructor(t,i,s=!1){this.#f=t.width,this.#m=t.height,this.#b(i),s&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#b(t,this.#u)}#b(t,i){const s=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),i&&i.length>0?(this.#u.set(i),this.#u.fill(Zu,i.length)):this.#u.fill(Zu)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Is]:{__proto__:this.#e[Is]}},this.#s={__proto__:this.#s},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const s=this.#i.pop();return s!==void 0&&(Il(this.#p,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(Il(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const i=this.#r.pop();return i!==void 0&&(Il(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#a.push(nt.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#n.set(t,i),this}recordSimpleDataFromNamed(t,i,s){this.#t[t]=this.#n.get(i)??s}recordFutureForcedDependency(t,i){return this.recordIncrementalData(Is,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#o)this.recordFutureForcedDependency(Is,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#l[0]=1/0,this.#l[1]=1/0,this.#l[2]=-1/0,this.#l[3]=-1/0),this}recordClipBox(t,i,s,r,l,c){const u=nt.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform()),h=[1/0,1/0,-1/0,-1/0];nt.axialAlignedBoundingBox([s,l,r,c],u,h);const f=nt.intersect(this.#s,h);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,i,s,r,l,c){const u=this.#s;if(u[0]===1/0)return this;const h=nt.multiplyByDOMMatrix(this.#a.at(-1),i.getTransform());if(u[0]===-1/0)return nt.axialAlignedBoundingBox([s,l,r,c],h,this.#l),this;const f=[1/0,1/0,-1/0,-1/0];return nt.axialAlignedBoundingBox([s,l,r,c],h,f),this.#l[0]=Math.min(this.#l[0],Math.max(f[0],u[0])),this.#l[1]=Math.min(this.#l[1],Math.max(f[1],u[1])),this.#l[2]=Math.max(this.#l[2],Math.min(f[2],u[2])),this.#l[3]=Math.max(this.#l[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,i,s,r=1,l=0,c=0,u){const h=s.bbox;let f,m;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(s),f!==!1&&(m=[0,0,0,0],nt.axialAlignedBoundingBox(h,s.fontMatrix,m),(r!==1||l!==0||c!==0)&&nt.scaleMinMax([r,0,0,-r,l,c],m),f)))return this.recordBBox(t,i,m[0],m[2],m[1],m[3]);if(!u)return this.recordFullPageBBox(t);const b=u();return h&&m&&f===void 0&&(f=m[0]<=l-b.actualBoundingBoxLeft&&m[2]>=l+b.actualBoundingBoxRight&&m[1]<=c-b.actualBoundingBoxAscent&&m[3]>=c+b.actualBoundingBoxDescent,this.#h.set(s,f),f)?this.recordBBox(t,i,m[0],m[2],m[1],m[3]):this.recordBBox(t,i,l-b.actualBoundingBoxLeft,l+b.actualBoundingBoxRight,c-b.actualBoundingBoxAscent,c+b.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#l[0]=Math.max(0,this.#s[0]),this.#l[1]=Math.max(0,this.#s[1]),this.#l[2]=Math.min(this.#f,this.#s[2]),this.#l[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const s=this.#o,r=this.#t,l=this.#e;for(const c of i)c in this.#t?s.add(r[c]):c in l&&l[c].forEach(s.add,s);return this}recordNamedDependency(t,i){return this.#n.has(i)&&this.#o.add(this.#n.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[Is]),this.#p){const s=Il(this.#p,t),{dependencies:r}=s;this.#o.forEach(r.add,r),this.#i.forEach(r.add,r),this.#r.forEach(r.add,r),r.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=Wg(this.#l[0]*256/this.#f),r=Wg(this.#l[1]*256/this.#m),l=Zg(this.#l[2]*256/this.#f),c=Zg(this.#l[3]*256/this.#m);jl(this.#g,t,s,r,l,c);for(const u of this.#o)u!==t&&jl(this.#g,u,s,r,l,c);for(const u of this.#i)u!==t&&jl(this.#g,u,s,r,l,c);for(const u of this.#r)u!==t&&jl(this.#g,u,s,r,l,c);i||(this.#o.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const s=Array.from(this.#o);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const r of s)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#l[0]),this.#s[1]=Math.max(this.#s[1],this.#l[1]),this.#s[2]=Math.min(this.#s[2],this.#l[2]),this.#s[3]=Math.min(this.#s[3],this.#l[3]),i||this.#o.clear()),this}_takePendingDependencies(){const t=this.#o;return this.#o=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#o.add(i)}take(){return this.#h.clear(),new Xv(this.#u,this.#g)}takeDebugMetadata(){return this.#p}}class Ql{#t;#e;#n;#i=0;#r=0;constructor(t,i,s){if(t instanceof Ql&&t.#n===!!s)return t;this.#t=t,this.#e=i,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,s){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,s,r,l,c){return this.#n||this.#t.recordClipBox(this.#e,i,s,r,l,c),this}recordBBox(t,i,s,r,l,c){return this.#n||this.#t.recordBBox(this.#e,i,s,r,l,c),this}recordCharacterBBox(t,i,s,r,l,c,u){return this.#n||this.#t.recordCharacterBBox(this.#e,i,s,r,l,c,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const ci={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},xe={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Ju(p,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],i,s),p.clip(r)}class hh{isModifyingCurrentTransform(){return!1}getPattern(){Ht("Abstract method `getPattern` called.")}}class Kv extends hh{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let i;this._type==="axial"?i=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)i.addColorStop(s[0],s[1]);return i}getPattern(t,i,s,r){let l;if(r===xe.STROKE||r===xe.FILL){const c=i.current.getClippedPathBoundingBox(r,$t(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,h=Math.ceil(c[3]-c[1])||1,f=i.cachedCanvases.getCanvas("pattern",u,h),m=f.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-c[0],-c[1]),s=nt.transform(s,[1,0,0,1,c[0],c[1]]),m.transform(...i.baseTransform),this.matrix&&m.transform(...this.matrix),Ju(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),l=t.createPattern(f.canvas,"no-repeat");const b=new DOMMatrix(s);l.setTransform(b)}else Ju(t,this._bbox),l=this._createGradient(t);return l}}function Pu(p,t,i,s,r,l,c,u){const h=t.coords,f=t.colors,m=p.data,b=p.width*4;let y;h[i+1]>h[s+1]&&(y=i,i=s,s=y,y=l,l=c,c=y),h[s+1]>h[r+1]&&(y=s,s=r,r=y,y=c,c=u,u=y),h[i+1]>h[s+1]&&(y=i,i=s,s=y,y=l,l=c,c=y);const A=(h[i]+t.offsetX)*t.scaleX,x=(h[i+1]+t.offsetY)*t.scaleY,S=(h[s]+t.offsetX)*t.scaleX,E=(h[s+1]+t.offsetY)*t.scaleY,w=(h[r]+t.offsetX)*t.scaleX,M=(h[r+1]+t.offsetY)*t.scaleY;if(x>=M)return;const T=f[l],L=f[l+1],O=f[l+2],k=f[c],z=f[c+1],q=f[c+2],K=f[u],J=f[u+1],W=f[u+2],Z=Math.round(x),ht=Math.round(M);let vt,At,P,V,Q,dt,St,D;for(let H=Z;H<=ht;H++){if(H<E){const ot=H<x?0:(x-H)/(x-E);vt=A-(A-S)*ot,At=T-(T-k)*ot,P=L-(L-z)*ot,V=O-(O-q)*ot}else{let ot;H>M?ot=1:E===M?ot=0:ot=(E-H)/(E-M),vt=S-(S-w)*ot,At=k-(k-K)*ot,P=z-(z-J)*ot,V=q-(q-W)*ot}let $;H<x?$=0:H>M?$=1:$=(x-H)/(x-M),Q=A-(A-w)*$,dt=T-(T-K)*$,St=L-(L-J)*$,D=O-(O-W)*$;const tt=Math.round(Math.min(vt,Q)),lt=Math.round(Math.max(vt,Q));let ut=b*H+tt*4;for(let ot=tt;ot<=lt;ot++)$=(vt-ot)/(vt-Q),$<0?$=0:$>1&&($=1),m[ut++]=At-(At-dt)*$|0,m[ut++]=P-(P-St)*$|0,m[ut++]=V-(V-D)*$|0,m[ut++]=255}}function Qv(p,t,i){const s=t.coords,r=t.colors;let l,c;switch(t.type){case qu.LATTICE:const u=t.verticesPerRow,h=Math.floor(s.length/u)-1,f=u-1;for(l=0;l<h;l++){let m=l*u;for(let b=0;b<f;b++,m++)Pu(p,i,s[m],s[m+1],s[m+u],r[m],r[m+1],r[m+u]),Pu(p,i,s[m+u+1],s[m+1],s[m+u],r[m+u+1],r[m+1],r[m+u])}break;case qu.TRIANGLES:for(l=0,c=s.length;l<c;l+=3)Pu(p,i,s[l],s[l+1],s[l+2],r[l],r[l+1],r[l+2]);break;default:throw new Error("illegal figure")}}class Wv extends hh{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,m=Math.ceil(this._bounds[3])-h,b=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(m*t[1]*1.1)),3e3),A=f/b,x=m/y,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/A,scaleY:1/x},E=b+4,w=y+4,M=s.getCanvas("mesh",E,w),T=M.context,L=T.createImageData(b,y);if(i){const k=L.data;for(let z=0,q=k.length;z<q;z+=4)k[z]=i[0],k[z+1]=i[1],k[z+2]=i[2],k[z+3]=255}for(const k of this._figures)Qv(L,k,S);return T.putImageData(L,2,2),{canvas:M.canvas,offsetX:u-2*A,offsetY:h-2*x,scaleX:A,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(t,i,s,r){Ju(t,this._bbox);const l=new Float32Array(2);if(r===xe.SHADING)nt.singularValueDecompose2dScale($t(t),l);else if(this.matrix){nt.singularValueDecompose2dScale(this.matrix,l);const[u,h]=l;nt.singularValueDecompose2dScale(i.baseTransform,l),l[0]*=u,l[1]*=h}else nt.singularValueDecompose2dScale(i.baseTransform,l);const c=this._createMeshCanvas(l,r===xe.SHADING?null:this._background,i.cachedCanvases);return r!==xe.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class Zv extends hh{getPattern(){return"hotpink"}}function Jv(p){switch(p[0]){case"RadialAxial":return new Kv(p);case"Mesh":return new Wv(p);case"Dummy":return new Zv}throw new Error(`Unknown IR type: ${p[0]}`)}const Jg={COLORED:1,UNCOLORED:2};class dh{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(t,i){const{bbox:s,operatorList:r,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:m}=this;f=Math.abs(f),m=Math.abs(m),eo("TilingType: "+c);const b=s[0],y=s[1],A=s[2],x=s[3],S=A-b,E=x-y,w=new Float32Array(2);nt.singularValueDecompose2dScale(this.matrix,w);const[M,T]=w;nt.singularValueDecompose2dScale(this.baseTransform,w);const L=M*w[0],O=T*w[1];let k=S,z=E,q=!1,K=!1;const J=Math.ceil(f*L),W=Math.ceil(m*O),Z=Math.ceil(S*L),ht=Math.ceil(E*O);J>=Z?k=f:q=!0,W>=ht?z=m:K=!0;const vt=this.getSizeAndScale(k,this.ctx.canvas.width,L),At=this.getSizeAndScale(z,this.ctx.canvas.height,O),P=t.cachedCanvases.getCanvas("pattern",vt.size,At.size),V=P.context,Q=h.createCanvasGraphics(V,i);if(Q.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Q,l,u),V.translate(-vt.scale*b,-At.scale*y),Q.transform(0,vt.scale,0,0,At.scale,0,0),V.save(),Q.dependencyTracker?.save(),this.clipBbox(Q,b,y,A,x),Q.baseTransform=$t(Q.ctx),Q.executeOperatorList(r),Q.endDrawing(),Q.dependencyTracker?.restore(),V.restore(),q||K){const dt=P.canvas;q&&(k=f),K&&(z=m);const St=this.getSizeAndScale(k,this.ctx.canvas.width,L),D=this.getSizeAndScale(z,this.ctx.canvas.height,O),H=St.size,$=D.size,tt=t.cachedCanvases.getCanvas("pattern-workaround",H,$),lt=tt.context,ut=q?Math.floor(S/f):0,ot=K?Math.floor(E/m):0;for(let te=0;te<=ut;te++)for(let jt=0;jt<=ot;jt++)lt.drawImage(dt,H*te,$*jt,H,$,0,0,H,$);return{canvas:tt.canvas,scaleX:St.scale,scaleY:D.scale,offsetX:b,offsetY:y}}return{canvas:P.canvas,scaleX:vt.scale,scaleY:At.scale,offsetX:b,offsetY:y}}getSizeAndScale(t,i,s){const r=Math.max(dh.MAX_PATTERN_SIZE,i);let l=Math.ceil(t*s);return l>=r?l=r:s=l/t,{scale:s,size:l}}clipBbox(t,i,s,r,l){const c=r-i,u=l-s;t.ctx.rect(i,s,c,u),nt.axialAlignedBoundingBox([i,s,r,l],$t(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const r=t.ctx,l=t.current;switch(i){case Jg.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;r.fillStyle=l.fillColor=c,r.strokeStyle=l.strokeColor=u;break;case Jg.UNCOLORED:r.fillStyle=r.strokeStyle=s,l.fillColor=l.strokeColor=s;break;default:throw new dv(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,s,r,l){let c=s;r!==xe.SHADING&&(c=nt.transform(c,i.baseTransform),this.matrix&&(c=nt.transform(c,this.matrix)));const u=this.createPatternCanvas(i,l);let h=new DOMMatrix(c);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(h),f}}function tA({src:p,srcPos:t=0,dest:i,width:s,height:r,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=_e.isLittleEndian?4278190080:255,[h,f]=c?[l,u]:[u,l],m=s>>3,b=s&7,y=p.length;i=new Uint32Array(i.buffer);let A=0;for(let x=0;x<r;x++){for(const E=t+m;t<E;t++){const w=t<y?p[t]:255;i[A++]=w&128?f:h,i[A++]=w&64?f:h,i[A++]=w&32?f:h,i[A++]=w&16?f:h,i[A++]=w&8?f:h,i[A++]=w&4?f:h,i[A++]=w&2?f:h,i[A++]=w&1?f:h}if(b===0)continue;const S=t<y?p[t++]:255;for(let E=0;E<b;E++)i[A++]=S&1<<7-E?f:h}return{srcPos:t,destPos:A}}const tm=16,em=100,eA=15,im=10,Ue=16,zu=new DOMMatrix,We=new Float32Array(2),Ys=new Float32Array([1/0,1/0,-1/0,-1/0]);function iA(p,t){if(p._removeMirroring)throw new Error("Context is already forwarding operations.");p.__originalSave=p.save,p.__originalRestore=p.restore,p.__originalRotate=p.rotate,p.__originalScale=p.scale,p.__originalTranslate=p.translate,p.__originalTransform=p.transform,p.__originalSetTransform=p.setTransform,p.__originalResetTransform=p.resetTransform,p.__originalClip=p.clip,p.__originalMoveTo=p.moveTo,p.__originalLineTo=p.lineTo,p.__originalBezierCurveTo=p.bezierCurveTo,p.__originalRect=p.rect,p.__originalClosePath=p.closePath,p.__originalBeginPath=p.beginPath,p._removeMirroring=()=>{p.save=p.__originalSave,p.restore=p.__originalRestore,p.rotate=p.__originalRotate,p.scale=p.__originalScale,p.translate=p.__originalTranslate,p.transform=p.__originalTransform,p.setTransform=p.__originalSetTransform,p.resetTransform=p.__originalResetTransform,p.clip=p.__originalClip,p.moveTo=p.__originalMoveTo,p.lineTo=p.__originalLineTo,p.bezierCurveTo=p.__originalBezierCurveTo,p.rect=p.__originalRect,p.closePath=p.__originalClosePath,p.beginPath=p.__originalBeginPath,delete p._removeMirroring},p.save=function(){t.save(),this.__originalSave()},p.restore=function(){t.restore(),this.__originalRestore()},p.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},p.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},p.transform=function(i,s,r,l,c,u){t.transform(i,s,r,l,c,u),this.__originalTransform(i,s,r,l,c,u)},p.setTransform=function(i,s,r,l,c,u){t.setTransform(i,s,r,l,c,u),this.__originalSetTransform(i,s,r,l,c,u)},p.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},p.rotate=function(i){t.rotate(i),this.__originalRotate(i)},p.clip=function(i){t.clip(i),this.__originalClip(i)},p.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},p.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},p.bezierCurveTo=function(i,s,r,l,c,u){t.bezierCurveTo(i,s,r,l,c,u),this.__originalBezierCurveTo(i,s,r,l,c,u)},p.rect=function(i,s,r,l){t.rect(i,s,r,l),this.__originalRect(i,s,r,l)},p.closePath=function(){t.closePath(),this.__originalClosePath()},p.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class nA{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,i,s)):(r=this.canvasFactory.create(i,s),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function Hl(p,t,i,s,r,l,c,u,h,f){const[m,b,y,A,x,S]=$t(p);if(b===0&&y===0){const M=c*m+x,T=Math.round(M),L=u*A+S,O=Math.round(L),k=(c+h)*m+x,z=Math.abs(Math.round(k)-T)||1,q=(u+f)*A+S,K=Math.abs(Math.round(q)-O)||1;return p.setTransform(Math.sign(m),0,0,Math.sign(A),T,O),p.drawImage(t,i,s,r,l,0,0,z,K),p.setTransform(m,b,y,A,x,S),[z,K]}if(m===0&&A===0){const M=u*y+x,T=Math.round(M),L=c*b+S,O=Math.round(L),k=(u+f)*y+x,z=Math.abs(Math.round(k)-T)||1,q=(c+h)*b+S,K=Math.abs(Math.round(q)-O)||1;return p.setTransform(0,Math.sign(b),Math.sign(y),0,T,O),p.drawImage(t,i,s,r,l,0,0,K,z),p.setTransform(m,b,y,A,x,S),[K,z]}p.drawImage(t,i,s,r,l,c,u,h,f);const E=Math.hypot(m,b),w=Math.hypot(y,A);return[E*h,w*f]}class nm{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Vu;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Ae.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,s){s?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=Ys.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=xe.FILL,i=null){const s=this.minMax.slice();if(t===xe.STROKE){i||Ht("Stroke bounding box must include transform."),nt.singularValueDecompose2dScale(i,We);const r=We[0]*this.lineWidth/2,l=We[1]*this.lineWidth/2;s[0]-=r,s[1]-=l,s[2]+=r,s[3]+=l}return s}updateClipFromPath(){const t=nt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Ys,0)}getClippedPathBoundingBox(t=xe.FILL,i=null){return nt.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function sm(p,t){if(t instanceof ImageData){p.putImageData(t,0,0);return}const i=t.height,s=t.width,r=i%Ue,l=(i-r)/Ue,c=r===0?l:l+1,u=p.createImageData(s,Ue);let h=0,f;const m=t.data,b=u.data;let y,A,x,S;if(t.kind===Yl.GRAYSCALE_1BPP){const E=m.byteLength,w=new Uint32Array(b.buffer,0,b.byteLength>>2),M=w.length,T=s+7>>3,L=4294967295,O=_e.isLittleEndian?4278190080:255;for(y=0;y<c;y++){for(x=y<l?Ue:r,f=0,A=0;A<x;A++){const k=E-h;let z=0;const q=k>T?s:k*8-7,K=q&-8;let J=0,W=0;for(;z<K;z+=8)W=m[h++],w[f++]=W&128?L:O,w[f++]=W&64?L:O,w[f++]=W&32?L:O,w[f++]=W&16?L:O,w[f++]=W&8?L:O,w[f++]=W&4?L:O,w[f++]=W&2?L:O,w[f++]=W&1?L:O;for(;z<q;z++)J===0&&(W=m[h++],J=128),w[f++]=W&J?L:O,J>>=1}for(;f<M;)w[f++]=0;p.putImageData(u,0,y*Ue)}}else if(t.kind===Yl.RGBA_32BPP){for(A=0,S=s*Ue*4,y=0;y<l;y++)b.set(m.subarray(h,h+S)),h+=S,p.putImageData(u,0,A),A+=Ue;y<c&&(S=s*r*4,b.set(m.subarray(h,h+S)),p.putImageData(u,0,A))}else if(t.kind===Yl.RGB_24BPP)for(x=Ue,S=s*x,y=0;y<c;y++){for(y>=l&&(x=r,S=s*x),f=0,A=S;A--;)b[f++]=m[h++],b[f++]=m[h++],b[f++]=m[h++],b[f++]=255;p.putImageData(u,0,y*Ue)}else throw new Error(`bad image kind: ${t.kind}`)}function am(p,t){if(t.bitmap){p.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,r=i%Ue,l=(i-r)/Ue,c=r===0?l:l+1,u=p.createImageData(s,Ue);let h=0;const f=t.data,m=u.data;for(let b=0;b<c;b++){const y=b<l?Ue:r;({srcPos:h}=tA({src:f,srcPos:h,dest:m,width:s,height:y,nonBlackColor:0})),p.putImageData(u,0,b*Ue)}}function Wa(p,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)p[s]!==void 0&&(t[s]=p[s]);p.setLineDash!==void 0&&(t.setLineDash(p.getLineDash()),t.lineDashOffset=p.lineDashOffset)}function Gl(p){p.strokeStyle=p.fillStyle="#000000",p.fillRule="nonzero",p.globalAlpha=1,p.lineWidth=1,p.lineCap="butt",p.lineJoin="miter",p.miterLimit=10,p.globalCompositeOperation="source-over",p.font="10px sans-serif",p.setLineDash!==void 0&&(p.setLineDash([]),p.lineDashOffset=0);const{filter:t}=p;t!=="none"&&t!==""&&(p.filter="none")}function rm(p,t){if(t)return!0;nt.singularValueDecompose2dScale(p,We);const i=Math.fround(Ti.pixelRatio*ta.PDF_TO_CSS_UNITS);return We[0]<=i&&We[1]<=i}const sA=["butt","round","square"],aA=["miter","round","bevel"],rA={},lm={};class Ws{constructor(t,i,s,r,l,{optionalContentConfig:c,markedContentStack:u=null},h,f,m){this.ctx=t,this.current=new nm(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=r,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new nA(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=m??null}getObject(t,i,s=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):s}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:r=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...$t(this.compositeCtx))}this.ctx.save(),Gl(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=$t(this.ctx)}executeOperatorList(t,i,s,r,l){const c=t.argsArray,u=t.fnArray;let h=i||0;const f=c.length;if(f===h)return h;const m=f-h>im&&typeof s=="function",b=m?Date.now()+eA:0;let y=0;const A=this.commonObjs,x=this.objs;let S,E;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,s),h;if(!l||l(h))if(S=u[h],E=c[h]??null,S!==or.dependency)E===null?this[S](h):this[S](h,...E);else for(const w of E){this.dependencyTracker?.recordNamedData(w,h);const M=w.startsWith("g_")?A:x;if(!M.has(w))return M.get(w,s),h}if(h++,h===f)return h;if(m&&++y>im){if(Date.now()>b)return s(),h;y=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const s=t.width??t.displayWidth,r=t.height??t.displayHeight;let l=Math.max(Math.hypot(i[0],i[1]),1),c=Math.max(Math.hypot(i[2],i[3]),1),u=s,h=r,f="prescale1",m,b;for(;l>2&&u>1||c>2&&h>1;){let y=u,A=h;l>2&&u>1&&(y=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/y),c>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/A),m=this.cachedCanvases.getCanvas(f,y,A),b=m.context,b.clearRect(0,0,y,A),b.drawImage(t,0,0,u,h,0,0,y,A),t=m.canvas,u=y,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,i){const s=this.ctx,{width:r,height:l}=i,c=this.current.fillColor,u=this.current.patternFill,h=$t(s);let f,m,b,y;if((i.bitmap||i.data)&&i.count>1){const J=i.bitmap||i.data.buffer;m=JSON.stringify(u?h:[h.slice(0,4),c]),f=this._cachedBitmapsMap.get(J),f||(f=new Map,this._cachedBitmapsMap.set(J,f));const W=f.get(m);if(W&&!u){const Z=Math.round(Math.min(h[0],h[2])+h[4]),ht=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,ci.transformAndFill),{canvas:W,offsetX:Z,offsetY:ht}}b=W}b||(y=this.cachedCanvases.getCanvas("maskCanvas",r,l),am(y.context,i));let A=nt.transform(h,[1/r,0,0,-1/l,0,0]);A=nt.transform(A,[1,0,0,1,0,-l]);const x=Ys.slice();nt.axialAlignedBoundingBox([0,0,r,l],A,x);const[S,E,w,M]=x,T=Math.round(w-S)||1,L=Math.round(M-E)||1,O=this.cachedCanvases.getCanvas("fillCanvas",T,L),k=O.context,z=S,q=E;k.translate(-z,-q),k.transform(...A),b||(b=this._scaleImage(y.canvas,xi(k)),b=b.img,f&&u&&f.set(m,b)),k.imageSmoothingEnabled=rm($t(k),i.interpolate),Hl(k,b,0,0,b.width,b.height,0,0,r,l),k.globalCompositeOperation="source-in";const K=nt.transform(xi(k),[1,0,0,1,-z,-q]);return k.fillStyle=u?c.getPattern(s,this,K,xe.FILL,t):c,k.fillRect(0,0,r,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(m,O.canvas)),this.dependencyTracker?.recordDependencies(t,ci.transformAndFill),{canvas:O.canvas,offsetX:Math.round(z),offsetY:Math.round(q)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=sA[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=aA[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,s){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(i),r.lineDashOffset=s)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[s,r]of i)switch(s){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,s=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(r,i,s);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),Wa(this.suspendedCtx,c),iA(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Wa(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,r){const l=r[0],c=r[1],u=r[2]-l,h=r[3]-c;u===0||h===0||(this.genericComposeSMask(i.context,s,u,h,i.subtype,i.backdrop,i.transferMap,l,c,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,r,l,c,u,h,f,m,b){let y=t.canvas,A=h-m,x=f-b;if(c)if(A<0||x<0||A+s>y.width||x+r>y.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,r),w=E.context;w.drawImage(y,-A,-x),w.globalCompositeOperation="destination-atop",w.fillStyle=c,w.fillRect(0,0,s,r),w.globalCompositeOperation="source-over",y=E.canvas,A=x=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(A,x,s,r),t.clip(E),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(A,x,s,r),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(h,f,s,r),i.clip(S),i.globalCompositeOperation="destination-in",i.drawImage(y,A,x,s,r,h,f,s,r),i.restore()}save(t){this.inSMaskMode&&Wa(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Wa(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,s,r,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,s,r,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s,r){let[l]=s;if(!r){l||=s[0]=new Path2D,this[i](t,l);return}if(this.dependencyTracker!==null){const c=i===or.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-c,r[2]+c,r[1]-c,r[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=s[0]=Cm(l)),nt.axialAlignedBoundingBox(r,$t(this.ctx),this.current.minMax),this[i](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,s=!0){const r=this.ctx,l=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=l.getPattern(r,this,xi(r),xe.STROKE,t),c){const u=new Path2D;u.addPath(i,r.getTransform().invertSelf().multiplySelf(c)),i=u}this.rescaleAndStroke(i,!1),r.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,ci.stroke),s&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(xe.STROKE,$t(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,s=!0){const r=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=l.getPattern(r,this,xi(r),xe.FILL,t),f){const m=new Path2D;m.addPath(i,r.getTransform().invertSelf().multiplySelf(f)),i=m}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(i,"evenodd"),this.pendingEOFill=!1):r.fill(i)),this.dependencyTracker?.recordDependencies(t,ci.fill),u&&(r.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,i,h)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,ci.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=rA}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=lm}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;i!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(i!==void 0){const r=new Path2D,l=s.getTransform().invertSelf();for(const{transform:c,x:u,y:h,fontSize:f,path:m}of i)m&&r.addPath(m,new DOMMatrix(c).preMultiplySelf(l).translate(u,h).scale(f,-f));s.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const r=this.commonObjs.get(i),l=this.current;if(!r)throw new Error(`Can't find font for ${i}`);if(l.fontMatrix=r.fontMatrix||Vu,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&pt("Invalid font matrix for font "+i),s<0?(s=-s,l.fontDirection=-1):l.fontDirection=1,this.current.font=r,this.current.fontSize=s,r.isType3Font)return;const c=r.loadedName||"sans-serif",u=r.systemFontInfo?.css||`"${c}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let m=s;s<tm?m=tm:s>em&&(m=em),this.current.fontSizeScale=s/m,this.ctx.font=`${f} ${h} ${m}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,i,s){this.setLeading(t,-s),this.moveText(t,i,s)}setTextMatrix(t,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=i,s.textMatrixScale=Math.hypot(i[0],i[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,i,s){const r=new Path2D;return r.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(i)),r}paintChar(t,i,s,r,l,c){const u=this.ctx,h=this.current,f=h.font,m=h.textRenderingMode,b=h.fontSize/h.fontSizeScale,y=m&Ae.FILL_STROKE_MASK,A=!!(m&Ae.ADD_TO_PATH_FLAG),x=h.patternFill&&!f.missingFile,S=h.patternStroke&&!f.missingFile;let E;if((f.disableFontFace||A||x||S)&&!f.missingFile&&(E=f.getPathGenerator(this.commonObjs,i)),E&&(f.disableFontFace||x||S)){u.save(),u.translate(s,r),u.scale(b,-b),this.dependencyTracker?.recordCharacterBBox(t,u,f);let w;if(y===Ae.FILL||y===Ae.FILL_STROKE)if(l){w=u.getTransform(),u.setTransform(...l);const M=this.#n(E,w,l);u.fill(M)}else u.fill(E);if(y===Ae.STROKE||y===Ae.FILL_STROKE)if(c){w||=u.getTransform(),u.setTransform(...c);const{a:M,b:T,c:L,d:O}=w,k=nt.inverseTransform(c),z=nt.transform([M,T,L,O,0,0],k);nt.singularValueDecompose2dScale(z,We),u.lineWidth*=Math.max(We[0],We[1])/b,u.stroke(this.#n(E,w,c))}else u.lineWidth/=b,u.stroke(E);u.restore()}else(y===Ae.FILL||y===Ae.FILL_STROKE)&&(u.fillText(i,s,r),this.dependencyTracker?.recordCharacterBBox(t,u,f,b,s,r,()=>u.measureText(i))),(y===Ae.STROKE||y===Ae.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,b,s,r,()=>u.measureText(i)).recordDependencies(t,ci.stroke),u.strokeText(i,s,r));A&&((this.pendingTextPaths||=[]).push({transform:$t(u),x:s,y:r,fontSize:b,path:E}),this.dependencyTracker?.recordCharacterBBox(t,u,f,b,s,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<i.length;r+=4)if(i[r]>0&&i[r]<255){s=!0;break}return gt(this,"isFontSubpixelAAEnabled",s)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,ci.showText).resetBBox(t),this.current.textRenderingMode&Ae.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,r=s.font;if(r.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const l=s.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=s.fontSizeScale,h=s.charSpacing,f=s.wordSpacing,m=s.fontDirection,b=s.textHScale*m,y=i.length,A=r.vertical,x=A?1:-1,S=r.defaultVMetrics,E=l*s.fontMatrix[0],w=s.textRenderingMode===Ae.FILL&&!r.disableFontFace&&!s.patternFill;c.save(),s.textMatrix&&c.transform(...s.textMatrix),c.translate(s.x,s.y+s.textRise),m>0?c.scale(b,-1):c.scale(b,1);let M,T;if(s.patternFill){c.save();const q=s.fillColor.getPattern(c,this,xi(c),xe.FILL,t);M=$t(c),c.restore(),c.fillStyle=q}if(s.patternStroke){c.save();const q=s.strokeColor.getPattern(c,this,xi(c),xe.STROKE,t);T=$t(c),c.restore(),c.strokeStyle=q}let L=s.lineWidth;const O=s.textMatrixScale;if(O===0||L===0){const q=s.textRenderingMode&Ae.FILL_STROKE_MASK;(q===Ae.STROKE||q===Ae.FILL_STROKE)&&(L=this.getSinglePixelWidth())}else L/=O;if(u!==1&&(c.scale(u,u),L/=u),c.lineWidth=L,r.isInvalidPDFjsFont){const q=[];let K=0;for(const W of i)q.push(W.unicode),K+=W.width;const J=q.join("");if(c.fillText(J,0,0),this.dependencyTracker!==null){const W=c.measureText(J);this.dependencyTracker.recordBBox(t,this.ctx,-W.actualBoundingBoxLeft,W.actualBoundingBoxRight,-W.actualBoundingBoxAscent,W.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=K*E*b,c.restore(),this.compose();return}let k=0,z;for(z=0;z<y;++z){const q=i[z];if(typeof q=="number"){k+=x*q*l/1e3;continue}let K=!1;const J=(q.isSpace?f:0)+h,W=q.fontChar,Z=q.accent;let ht,vt,At=q.width;if(A){const Q=q.vmetric||S,dt=-(q.vmetric?Q[1]:At*.5)*E,St=Q[2]*E;At=Q?-Q[0]:At,ht=dt/u,vt=(k+St)/u}else ht=k/u,vt=0;let P;if(r.remeasure&&At>0){P=c.measureText(W);const Q=P.width*1e3/l*u;if(At<Q&&this.isFontSubpixelAAEnabled){const dt=At/Q;K=!0,c.save(),c.scale(dt,1),ht/=dt}else At!==Q&&(ht+=(At-Q)/2e3*l/u)}if(this.contentVisible&&(q.isInFont||r.missingFile)){if(w&&!Z)c.fillText(W,ht,vt),this.dependencyTracker?.recordCharacterBBox(t,c,P?{bbox:null}:r,l/u,ht,vt,()=>P??c.measureText(W));else if(this.paintChar(t,W,ht,vt,M,T),Z){const Q=ht+l*Z.offset.x/u,dt=vt-l*Z.offset.y/u;this.paintChar(t,Z.fontChar,Q,dt,M,T)}}const V=A?At*E-J*m:At*E+J*m;k+=V,K&&c.restore()}A?s.y-=k:s.x+=k*b,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const s=this.ctx,r=this.current,l=r.font,c=r.fontSize,u=r.fontDirection,h=l.vertical?1:-1,f=r.charSpacing,m=r.wordSpacing,b=r.textHScale*u,y=r.fontMatrix||Vu,A=i.length,x=r.textRenderingMode===Ae.INVISIBLE;let S,E,w,M;if(x||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),r.textMatrix&&s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),s.scale(b,u);const T=this.dependencyTracker;for(this.dependencyTracker=T?new Ql(T,t):null,S=0;S<A;++S){if(E=i[S],typeof E=="number"){M=h*E*c/1e3,this.ctx.translate(M,0),r.x+=M*b;continue}const L=(E.isSpace?m:0)+f,O=l.charProcOperatorList[E.operatorListId];O?this.contentVisible&&(this.save(),s.scale(c,c),s.transform(...y),this.executeOperatorList(O),this.restore()):pt(`Type3 character "${E.operatorListId}" is not available.`);const k=[E.width,0];nt.applyTransform(k,y),w=k[0]*c+L,s.translate(w,0),r.x+=w*b}s.restore(),T&&(this.dependencyTracker=T)}setCharWidth(t,i,s){}setCharWidthAndBounds(t,i,s,r,l,c,u){const h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,r,c,l,u).recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}getColorN_Pattern(t,i){let s;if(i[0]==="TilingPattern"){const r=this.baseTransform||$t(this.ctx),l={createCanvasGraphics:(c,u)=>new Ws(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Ql(this.dependencyTracker,u,!0):null)};s=new dh(i,this.ctx,l,r)}else s=this._getPattern(t,i[1],i[2]);return s}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,s=null){let r;return this.cachedPatterns.has(i)?r=this.cachedPatterns.get(i):(r=Jv(this.getObject(t,i)),this.cachedPatterns.set(i,r)),s&&(r.matrix=s),r}shadingFill(t,i){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const r=this._getPattern(t,i);s.fillStyle=r.getPattern(s,this,xi(s),xe.SHADING,t);const l=xi(s);if(l){const{width:c,height:u}=s.canvas,h=Ys.slice();nt.axialAlignedBoundingBox([0,0,c,u],l,h);const[f,m,b,y]=h;this.ctx.fillRect(f,m,b-f,y-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,ci.transform).recordDependencies(t,ci.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Ht("Should not call beginInlineImage")}beginImageData(){Ht("Should not call beginImageData")}paintFormXObjectBegin(t,i,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=$t(this.ctx),s)){nt.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,l,c,u]=s,h=new Path2D;h.rect(r,l,c-r,u-l),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;i.isolated||eo("TODO: Support non-isolated groups."),i.knockout&&pt("Knockout groups not supported.");const r=$t(s);if(i.matrix&&s.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let l=Ys.slice();nt.axialAlignedBoundingBox(i.bbox,$t(s),l);const c=[0,0,s.canvas.width,s.canvas.height];l=nt.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),h=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),m=Math.max(Math.ceil(l[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,m]);let b="groupAt"+this.groupLevel;i.smask&&(b+="_smask_"+this.smaskCounter++%2);const y=this.cachedCanvases.getCanvas(b,f,m),A=y.context;A.translate(-u,-h),A.transform(...r);let x=new Path2D;const[S,E,w,M]=i.bbox;if(x.rect(S,E,w-S,M-E),i.matrix){const T=new Path2D;T.addPath(x,new DOMMatrix(i.matrix)),x=T}A.clip(x),i.smask&&this.smaskStack.push({canvas:y.canvas,context:A,offsetX:u,offsetY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,h),s.save()),Wa(s,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=$t(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=Ys.slice();nt.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],l,c),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,i,s,r,l,c){if(this.#t(),Gl(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],h=s[3]-s[1];if(c&&this.annotationCanvasMap){r=r.slice(),r[4]-=s[0],r[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=h,nt.singularValueDecompose2dScale($t(this.ctx),We);const{viewportScale:f}=this,m=Math.ceil(u*this.outputScaleX*f),b=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(m,b);const{canvas:y,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(i,y),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(We[0],0,0,-We[1],0,h*We[1]),Gl(this.ctx)}else{Gl(this.ctx),this.endPath(t);const f=new Path2D;f.rect(s[0],s[1],u,h),this.ctx.clip(f)}}this.current=new nm(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const s=i.count;i=this.getObject(t,i.data,i),i.count=s;const r=this.ctx,l=this._createMaskCanvas(t,i),c=l.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s,r=0,l=0,c,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const h=this.ctx;h.save();const f=$t(h);h.transform(s,r,l,c,0,0);const m=this._createMaskCanvas(t,i);h.setTransform(1,0,0,1,m.offsetX-f[4],m.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let b=0,y=u.length;b<y;b+=2){const A=nt.transform(f,[s,r,l,c,u[b],u[b+1]]);h.drawImage(m.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+m.canvas.width,A[5],A[5]+m.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,ci.transformAndFill);for(const c of i){const{data:u,width:h,height:f,transform:m}=c,b=this.cachedCanvases.getCanvas("maskCanvas",h,f),y=b.context;y.save();const A=this.getObject(t,u,c);am(y,A),y.globalCompositeOperation="source-in",y.fillStyle=l?r.getPattern(y,this,xi(s),xe.FILL,t):r,y.fillRect(0,0,h,f),y.restore(),s.save(),s.transform(...m),s.scale(1,-1),Hl(s,b.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,h,0,f),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const s=this.getObject(t,i);if(!s){pt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,i,s,r,l){if(!this.contentVisible)return;const c=this.getObject(t,i);if(!c){pt("Dependent image isn't ready yet");return}const u=c.width,h=c.height,f=[];for(let m=0,b=l.length;m<b;m+=2)f.push({transform:[s,0,0,r,l[m],l[m+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:r}=t,l=this.cachedCanvases.getCanvas("inlineImage",s,r),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(i,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const s=i.width,r=i.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/s,-1/r);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const m=this.cachedCanvases.getCanvas("inlineImage",s,r).context;sm(m,i),u=this.applyTransferMapsToCanvas(m)}const h=this._scaleImage(u,xi(l));l.imageSmoothingEnabled=rm($t(l),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,s,-r,0).recordDependencies(t,ci.imageXObject).recordOperation(t),Hl(l,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,s,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,s){if(!this.contentVisible)return;const r=this.ctx;let l;if(i.bitmap)l=i.bitmap;else{const c=i.width,u=i.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;sm(f,i),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of s)r.save(),r.transform(...c.transform),r.scale(1,-1),Hl(r,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,ci.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,s){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,s){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,s){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const l=this.ctx;this.pendingClip?(r||(this.pendingClip===lm?l.clip(i,"evenodd"):l.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=$t(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:r,d:l}=this.ctx.getTransform();let c,u;if(s===0&&r===0){const h=Math.abs(i),f=Math.abs(l);if(h===f)if(t===0)c=u=1/h;else{const m=h*t;c=u=m<1?1/m:1}else if(t===0)c=1/h,u=1/f;else{const m=h*t,b=f*t;c=m<1?1/m:1,u=b<1?1/b:1}}else{const h=Math.abs(i*l-s*r),f=Math.hypot(i,s),m=Math.hypot(r,l);if(t===0)c=m/h,u=f/h;else{const b=t*h;c=m>b?m/b:1,u=f>b?f/b:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:s,current:{lineWidth:r}}=this,[l,c]=this.getScaleForStroking();if(l===c){s.lineWidth=(r||1)*l,s.stroke(t);return}const u=s.getLineDash();i&&s.save(),s.scale(l,c),zu.a=1/l,zu.d=1/c;const h=new Path2D;if(h.addPath(t,zu),u.length>0){const f=Math.max(l,c);s.setLineDash(u.map(m=>m/f)),s.lineDashOffset/=f}s.lineWidth=r||1,s.stroke(h),i&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const p in or)Ws.prototype[p]!==void 0&&(Ws.prototype[or[p]]=Ws.prototype[p]);class Zs{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class lA{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Gs=Symbol("INTERNAL");class oA{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:i,intent:s,usage:r,rbGroups:l}){this.#t=!!(t&Qe.DISPLAY),this.#e=!!(t&Qe.PRINT),this.name=i,this.intent=s,this.usage=r,this.rbGroups=l}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,s=!1){t!==Gs&&Ht("Internal method `_setVisible` called."),this.#n=s,this.#i=i}}class cA{#t=null;#e=new Map;#n=null;#i=null;constructor(t,i=Qe.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new oA(i,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(Gs,!1);for(const s of t.on)this.#e.get(s)._setVisible(Gs,!0);for(const s of t.off)this.#e.get(s)._setVisible(Gs,!1);this.#n=this.getHash()}}#r(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let r=1;r<i;r++){const l=t[r];let c;if(Array.isArray(l))c=this.#r(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return pt(`Optional content group not found: ${l}`),!0;switch(s){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return eo("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(pt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return pt(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return pt(`Unknown optional content policy ${t.policy}.`),!0}return pt(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){const r=this.#e.get(t);if(!r){pt(`Optional content group not found: ${t}`);return}if(s&&i&&r.rbGroups.length)for(const l of r.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(Gs,!1,!0);r._setVisible(Gs,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let s;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const l=this.#e.get(r);if(l)switch(s){case"ON":this.setVisibility(r,!0,i);break;case"OFF":this.setVisibility(r,!1,i);break;case"Toggle":this.setVisibility(r,!l.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Rm;for(const[i,s]of this.#e)t.update(`${i}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class uA{constructor(t,{disableRange:i=!1,disableStream:s=!1}){Mt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:l,progressiveDone:c,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,l?.length>0){const h=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!i,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const s=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(s),!0)});Mt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){Mt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new hA(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new dA(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class hA{constructor(t,i,s=!1,r=null){this._stream=t,this._done=s||!1,this._filename=rh(r)?r:null,this._queuedChunks=i||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class dA{constructor(t,i,s){this._stream=t,this._begin=i,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function fA(p){let t=!0,i=s("filename\\*","i").exec(p);if(i){i=i[1];let m=u(i);return m=unescape(m),m=h(m),m=f(m),l(m)}if(i=c(p),i){const m=f(i);return l(m)}if(i=s("filename","i").exec(p),i){i=i[1];let m=u(i);return m=f(m),l(m)}function s(m,b){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function r(m,b){if(m){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const y=new TextDecoder(m,{fatal:!0}),A=fr(b);b=y.decode(A),t=!1}catch{}}return b}function l(m){return t&&/[\x80-\xff]/.test(m)&&(m=r("utf-8",m),t&&(m=r("iso-8859-1",m))),m}function c(m){const b=[];let y;const A=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=A.exec(m))!==null;){let[,S,E,w]=y;if(S=parseInt(S,10),S in b){if(S===0)break;continue}b[S]=[E,w]}const x=[];for(let S=0;S<b.length&&S in b;++S){let[E,w]=b[S];w=u(w),E&&(w=unescape(w),S===0&&(w=h(w))),x.push(w)}return x.join("")}function u(m){if(m.startsWith('"')){const b=m.slice(1).split('\\"');for(let y=0;y<b.length;++y){const A=b[y].indexOf('"');A!==-1&&(b[y]=b[y].slice(0,A),b.length=y+1),b[y]=b[y].replaceAll(/\\(.)/g,"$1")}m=b.join('"')}return m}function h(m){const b=m.indexOf("'");if(b===-1)return m;const y=m.slice(0,b),x=m.slice(b+1).replace(/^[^']*'/,"");return r(y,x)}function f(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,y,A,x){if(A==="q"||A==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,E){return String.fromCharCode(parseInt(E,16))}),r(y,x);try{x=atob(x)}catch{}return r(y,x)})}return""}function Pm(p,t){const i=new Headers;if(!p||!t||typeof t!="object")return i;for(const s in t){const r=t[s];r!==void 0&&i.append(s,r)}return i}function so(p){return URL.parse(p)?.origin??null}function zm({responseHeaders:p,isHttp:t,rangeChunkSize:i,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(p.get("Content-Length"),10);return!Number.isInteger(l)||(r.suggestedLength=l,l<=2*i)||s||!t||p.get("Accept-Ranges")!=="bytes"||(p.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function Fm(p){const t=p.get("Content-Disposition");if(t){let i=fA(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(rh(i))return i}return null}function yr(p,t){return new Kl(`Unexpected server response (${p}) while retrieving PDF "${t}".`,p,p===404||p===0&&t.startsWith("file:"))}function Um(p){return p===200||p===206}function jm(p,t,i){return{method:"GET",headers:p,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Im(p){return p instanceof Uint8Array?p.buffer:p instanceof ArrayBuffer?p:(pt(`getArrayBuffer - unexpected data format: ${p}`),new Uint8Array(p).buffer)}class pA{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Pm(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Mt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new gA(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new mA(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class gA{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const s=new Headers(t.headers),r=i.url;fetch(r,jm(s,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=so(l.url),!Um(l.status))throw yr(l.status,r);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:u,suggestedLength:h}=zm({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=Fm(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Tn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Im(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class mA{constructor(t,i,s){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${i}-${s-1}`);const c=r.url;fetch(c,jm(l,this._withCredentials,this._abortController)).then(u=>{const h=so(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!Um(u.status))throw yr(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Im(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Fu=200,Uu=206;function bA(p){const t=p.response;return typeof t!="string"?t:fr(t).buffer}class yA{_responseOrigin=null;constructor({url:t,httpHeaders:i,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Pm(this.isHttp,i),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const i=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[l,c]of this.headers)i.setRequestHeader(l,c);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=Uu):r.expectedStatus=Fu,i.responseType="arraybuffer",Mt(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>{t.onError(i.status)},i.onreadystatechange=this.onStateChange.bind(this,s),i.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,i.send(null),s}onProgress(t,i){const s=this.pendingRequests[t];s&&s.onProgress?.(i)}onStateChange(t,i){const s=this.pendingRequests[t];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){s.onError(r.status);return}const l=r.status||Fu;if(!(l===Fu&&s.expectedStatus===Uu)&&l!==s.expectedStatus){s.onError(r.status);return}const u=bA(r);if(l===Uu){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?s.onDone({begin:parseInt(f[1],10),chunk:u}):(pt('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class vA{constructor(t){this._source=t,this._manager=new yA(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return Mt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new AA(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const s=new SA(this._manager,t,i);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class AA{constructor(t,i){this._manager=t,this._url=i.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t);this._manager._responseOrigin=so(i.responseURL);const s=i.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=zm({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=Fm(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=yr(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class SA{constructor(t,i,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:i,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=so(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=yr(t,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const xA=/^[a-z][a-z0-9\-+.]+:/i;function _A(p){if(xA.test(p))return new URL(p);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(p))}class wA{constructor(t){this.source=t,this.url=_A(t.url),Mt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Mt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new EA(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new TA(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class EA{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=yr(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Tn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class TA{constructor(t,i,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:i,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Za=Symbol("INITIAL_DATA");class Hm{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Za}}get(t,i=null){if(i){const r=this.#e(t);return r.promise.then(()=>i(r.data)),null}const s=this.#t[t];if(!s||s.data===Za)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=this.#t[t];return!!i&&i.data!==Za}delete(t){const i=this.#t[t];return!i||i.data===Za?!1:(delete this.#t[t],!0)}resolve(t,i=null){const s=this.#e(t);s.data=i,s.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==Za&&(yield[t,i])}}}const CA=1e5,om=30;class Te{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#a=null;#s=0;#l=0;#c=null;#o=null;#d=0;#h=0;#f=Object.create(null);#m=[];#g=null;#u=[];#p=new WeakMap;#b=null;static#v=new Map;static#y=new Map;static#E=new WeakMap;static#_=null;static#S=new Set;constructor({textContentSource:t,container:i,viewport:s}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#o=i,this.#h=s.scale*Ti.pixelRatio,this.#d=s.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:l,pageX:c,pageY:u}=s.rawDims;this.#b=[1,0,0,-1,-c,u+l],this.#l=r,this.#s=l,Te.#R(),Jn(i,s),this.#t.promise.finally(()=>{Te.#S.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=_e.platform;return gt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:s})=>{if(s){this.#t.resolve();return}this.#r??=i.lang,Object.assign(this.#f,i.styles),this.#C(i.items),t()},this.#t.reject)};return this.#c=this.#g.getReader(),Te.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const s=t.scale*Ti.pixelRatio,r=t.rotation;if(r!==this.#d&&(i?.(),this.#d=r,Jn(this.#o,{rotation:r})),s!==this.#h){i?.(),this.#h=s;const l={div:null,properties:null,ctx:Te.#D(this.#r)};for(const c of this.#u)l.properties=this.#p.get(c),l.div=c,this.#w(l)}}cancel(){const t=new Tn("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(t){if(this.#n)return;this.#a.ctx??=Te.#D(this.#r);const i=this.#u,s=this.#m;for(const r of t){if(i.length>CA){pt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),l.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(r.str),this.#A(r)}}#A(t){const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const r=nt.transform(this.#b,t.transform);let l=Math.atan2(r[1],r[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#i&&c.fontSubstitution||c.fontFamily;u=Te.fontFamilyMap.get(u)||u;const h=Math.hypot(r[2],r[3]),f=h*Te.#z(u,c,this.#r);let m,b;l===0?(m=r[4],b=r[5]-f):(m=r[4]+f*Math.sin(l),b=r[5]-f*Math.cos(l));const y="calc(var(--total-scale-factor) *",A=i.style;this.#e===this.#o?(A.left=`${(100*m/this.#l).toFixed(2)}%`,A.top=`${(100*b/this.#s).toFixed(2)}%`):(A.left=`${y}${m.toFixed(2)}px)`,A.top=`${y}${b.toFixed(2)}px)`),A.fontSize=`${y}${(Te.#_*h).toFixed(2)}px)`,A.fontFamily=u,s.fontSize=h,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(s.angle=l*(180/Math.PI));let x=!1;if(t.str.length>1)x=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),E=Math.abs(t.transform[3]);S!==E&&Math.max(S,E)/Math.min(S,E)>1.5&&(x=!0)}if(x&&(s.canvasWidth=c.vertical?t.height:t.width),this.#p.set(i,s),this.#a.div=i,this.#a.properties=s,this.#w(this.#a),s.hasText&&this.#e.append(i),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#w(t){const{div:i,properties:s,ctx:r}=t,{style:l}=i;let c="";if(Te.#_>1&&(c=`scale(${1/Te.#_})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=l,{canvasWidth:h,fontSize:f}=s;Te.#M(r,f*this.#h,u);const{width:m}=r.measureText(i.textContent);m>0&&(c=`scaleX(${h*this.#h/m}) ${c}`)}s.angle!==0&&(c=`rotate(${s.angle}deg) ${c}`),c.length>0&&(l.transform=c)}static cleanup(){if(!(this.#S.size>0)){this.#v.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#D(t=null){let i=this.#y.get(t||="");if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,i),this.#E.set(i,{size:0,family:""})}return i}static#M(t,i,s){const r=this.#E.get(t);i===r.size&&s===r.family||(t.font=`${i}px ${s}`,r.size=i,r.family=s)}static#R(){if(this.#_!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#_=t.getBoundingClientRect().height,t.remove()}static#z(t,i,s){const r=this.#v.get(t);if(r)return r;const l=this.#D(s);l.canvas.width=l.canvas.height=om,this.#M(l,om,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,h=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+h):(_e.platform.isFirefox&&pt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?f=i.ascent:i.descent&&(f=1+i.descent)),this.#v.set(t,f),f}}const MA=100;function Gm(p={}){typeof p=="string"||p instanceof URL?p={url:p}:(p instanceof ArrayBuffer||ArrayBuffer.isView(p))&&(p={data:p});const t=new fh,{docId:i}=t,s=p.url?Bv(p.url):null,r=p.data?Pv(p.data):null,l=p.httpHeaders||null,c=p.withCredentials===!0,u=p.password??null,h=p.range instanceof Vm?p.range:null,f=Number.isInteger(p.rangeChunkSize)&&p.rangeChunkSize>0?p.rangeChunkSize:2**16;let m=p.worker instanceof ur?p.worker:null;const b=p.verbosity,y=typeof p.docBaseUrl=="string"&&!io(p.docBaseUrl)?p.docBaseUrl:null,A=Fl(p.cMapUrl),x=p.cMapPacked!==!1,S=p.CMapReaderFactory||(Ce?Vv:$g),E=Fl(p.iccUrl),w=Fl(p.standardFontDataUrl),M=p.StandardFontDataFactory||(Ce?qv:Kg),T=Fl(p.wasmUrl),L=p.WasmFactory||(Ce?Yv:Qg),O=p.stopAtErrors!==!0,k=Number.isInteger(p.maxImageSize)&&p.maxImageSize>-1?p.maxImageSize:-1,z=p.isEvalSupported!==!1,q=typeof p.isOffscreenCanvasSupported=="boolean"?p.isOffscreenCanvasSupported:!Ce,K=typeof p.isImageDecoderSupported=="boolean"?p.isImageDecoderSupported:!Ce&&(_e.platform.isFirefox||!globalThis.chrome),J=Number.isInteger(p.canvasMaxAreaInBytes)?p.canvasMaxAreaInBytes:-1,W=typeof p.disableFontFace=="boolean"?p.disableFontFace:Ce,Z=p.fontExtraProperties===!0,ht=p.enableXfa===!0,vt=p.ownerDocument||globalThis.document,At=p.disableRange===!0,P=p.disableStream===!0,V=p.disableAutoFetch===!0,Q=p.pdfBug===!0,dt=p.CanvasFactory||(Ce?Gv:jv),St=p.FilterFactory||(Ce?Hv:Iv),D=p.enableHWA===!0,H=p.useWasm!==!1,$=h?h.length:p.length??NaN,tt=typeof p.useSystemFonts=="boolean"?p.useSystemFonts:!Ce&&!W,lt=typeof p.useWorkerFetch=="boolean"?p.useWorkerFetch:!!(S===$g&&M===Kg&&L===Qg&&A&&w&&T&&nr(A,document.baseURI)&&nr(w,document.baseURI)&&nr(T,document.baseURI)),ut=null;cv(b);const ot={canvasFactory:new dt({ownerDocument:vt,enableHWA:D}),filterFactory:new St({docId:i,ownerDocument:vt}),cMapReaderFactory:lt?null:new S({baseUrl:A,isCompressed:x}),standardFontDataFactory:lt?null:new M({baseUrl:w}),wasmFactory:lt?null:new L({baseUrl:T})};m||(m=ur.create({verbosity:b,port:Zs.workerPort}),t._worker=m);const te={docId:i,apiVersion:"5.4.449",data:r,password:u,disableAutoFetch:V,rangeChunkSize:f,length:$,docBaseUrl:y,enableXfa:ht,evaluatorOptions:{maxImageSize:k,disableFontFace:W,ignoreErrors:O,isEvalSupported:z,isOffscreenCanvasSupported:q,isImageDecoderSupported:K,canvasMaxAreaInBytes:J,fontExtraProperties:Z,useSystemFonts:tt,useWasm:H,useWorkerFetch:lt,cMapUrl:A,iccUrl:E,standardFontDataUrl:w,wasmUrl:T}},jt={ownerDocument:vt,pdfBug:Q,styleElement:ut,loadingParams:{disableAutoFetch:V,enableXfa:ht}};return m.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const Mn=m.messageHandler.sendWithPromise("GetDocRequest",te,r?[r.buffer]:null);let Ki;if(h)Ki=new uA(h,{disableRange:At,disableStream:P});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Rn=nr(s)?pA:Ce?wA:vA;Ki=new Rn({url:s,length:$,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:At,disableStream:P})}return Mn.then(Rn=>{if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const ea=new sr(i,Rn,m.port),Ci=new NA(ea,t,Ki,jt,ot,D);t._transport=Ci,ea.send("Ready",null)})}).catch(t._capability.reject),t}class fh{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${fh.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Vm{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#r=[];constructor(t,i,s=!1,r=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const s of this.#r)s(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const s of this.#i)s(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#n)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){Ht("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class RA{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return gt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class DA{#t=!1;constructor(t,i,s,r=!1){this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=r?new Ig:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new Hm,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:l=!1}={}){return new gr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:r,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return gt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:s,intent:r="display",annotationMode:l=xn.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:m=null,printAnnotationStorage:b=null,isEditing:y=!1,recordOperations:A=!1,operationsFilter:x=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(r,l,b,y),{renderingIntent:E,cacheKey:w}=S;this.#t=!1,h||=this._transport.getOptionalContentConfig(E);let M=this._intentStates.get(w);M||(M=Object.create(null),this._intentStates.set(w,M)),M.streamReaderCancelTimeout&&(clearTimeout(M.streamReaderCancelTimeout),M.streamReaderCancelTimeout=null);const T=!!(E&Qe.PRINT);M.displayReadyCapability||(M.displayReadyCapability=Promise.withResolvers(),M.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const L=!!(this._pdfBug&&globalThis.StepperManager?.enabled),O=!this.recordedBBoxes&&(A||L),k=K=>{if(M.renderTasks.delete(z),O){const J=z.gfx?.dependencyTracker.take();J&&(z.stepper&&z.stepper.setOperatorBBoxes(J,z.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=J))}T&&(this.#t=!0),this.#e(),K?(z.capability.reject(K),this._abortOperatorList({intentState:M,reason:K instanceof Error?K:new Error(K)})):z.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},z=new Xs({callback:k,params:{canvas:i,canvasContext:t,dependencyTracker:O?new $v(i,M.operatorList.length,L):null,viewport:s,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:M.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:m,enableHWA:this._transport.enableHWA,operationsFilter:x});(M.renderTasks||=new Set).add(z);const q=z.task;return Promise.all([M.displayReadyCapability.promise,h]).then(([K,J])=>{if(this.destroyed){k();return}if(this._stats?.time("Rendering"),!(J.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");z.initializeGraphics({transparency:K,optionalContentConfig:J}),z.operatorListChanged()}).catch(k),q}getOperatorList({intent:t="display",annotationMode:i=xn.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const c=this._transport.getRenderingIntent(t,i,s,r,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>cr.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,r){function l(){c.read().then(function({value:h,done:f}){if(f){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),l()},r)}const c=i.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#e();return t&&i&&(this._stats&&=new Ig),i}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const s=this._intentStates.get(i);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let s=0,r=t.length;s<r;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:r}){const{map:l,transfer:c}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:l,modifiedIds:r},c).getReader(),f=this._intentStates.get(i);f.streamReader=h;const m=()=>{h.read().then(({value:b,done:y})=>{if(y){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(b,f),m())},b=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const y of f.renderTasks)y.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(b);else if(f.opListReadCapability)f.opListReadCapability.reject(b);else throw b}})};m()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof ah){let r=MA;i.extraDelay>0&&i.extraDelay<1e3&&(r+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},r);return}}if(t.streamReader.cancel(new Tn(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,l]of this._intentStates)if(l===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var wn,gi,$i,Qn,Zl,Wn,Zn,Re,Xl,qm,Ym,ar,Js,$l;const Xt=class Xt{constructor({name:t=null,port:i=null,verbosity:s=uv()}={}){Ai(this,Re);Ai(this,wn,Promise.withResolvers());Ai(this,gi,null);Ai(this,$i,null);Ai(this,Qn,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,i){if(Yt(Xt,Zn).has(i))throw new Error("Cannot use more than one PDFWorker per port.");Yt(Xt,Zn).set(i,this),Si(this,Re,qm).call(this,i)}else Si(this,Re,Ym).call(this)}get promise(){return Yt(this,wn).promise}get port(){return Yt(this,$i)}get messageHandler(){return Yt(this,gi)}destroy(){this.destroyed=!0,Yt(this,Qn)?.terminate(),ze(this,Qn,null),Yt(Xt,Zn).delete(Yt(this,$i)),ze(this,$i,null),Yt(this,gi)?.destroy(),ze(this,gi,null)}static create(t){const i=Yt(this,Zn).get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new Xt(t)}static get workerSrc(){if(Zs.workerSrc)return Zs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return gt(this,"_setupFakeWorkerGlobal",(async()=>Yt(this,Js,$l)?Yt(this,Js,$l):(await import(this.workerSrc)).WorkerMessageHandler)())}};wn=new WeakMap,gi=new WeakMap,$i=new WeakMap,Qn=new WeakMap,Zl=new WeakMap,Wn=new WeakMap,Zn=new WeakMap,Re=new WeakSet,Xl=function(){Yt(this,wn).resolve(),Yt(this,gi).send("configure",{verbosity:this.verbosity})},qm=function(t){ze(this,$i,t),ze(this,gi,new sr("main","worker",t)),Yt(this,gi).on("ready",()=>{}),Si(this,Re,Xl).call(this)},Ym=function(){if(Yt(Xt,Wn)||Yt(Xt,Js,$l)){Si(this,Re,ar).call(this);return}let{workerSrc:t}=Xt;try{Xt._isSameOrigin(window.location,t)||(t=Xt._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new sr("main","worker",i),r=()=>{l.abort(),s.destroy(),i.terminate(),this.destroyed?Yt(this,wn).reject(new Error("Worker was destroyed")):Si(this,Re,ar).call(this)},l=new AbortController;i.addEventListener("error",()=>{Yt(this,Qn)||r()},{signal:l.signal}),s.on("test",u=>{if(l.abort(),this.destroyed||!u){r();return}ze(this,gi,s),ze(this,$i,i),ze(this,Qn,i),Si(this,Re,Xl).call(this)}),s.on("ready",u=>{if(l.abort(),this.destroyed){r();return}try{c()}catch{Si(this,Re,ar).call(this)}});const c=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};c();return}catch{eo("The worker has been disabled.")}Si(this,Re,ar).call(this)},ar=function(){Yt(Xt,Wn)||(pt("Setting up fake worker."),ze(Xt,Wn,!0)),Xt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Yt(this,wn).reject(new Error("Worker was destroyed"));return}const i=new Uv;ze(this,$i,i);const s=`fake${_g(Xt,Zl)._++}`,r=new sr(s+"_worker",s,i);t.setup(r,i),ze(this,gi,new sr(s,s+"_worker",i)),Si(this,Re,Xl).call(this)}).catch(t=>{Yt(this,wn).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Js=new WeakSet,$l=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ai(Xt,Js),Ai(Xt,Zl,0),Ai(Xt,Wn,!1),Ai(Xt,Zn,new WeakMap),Ce&&(ze(Xt,Wn,!0),Zs.workerSrc||="./pdf.worker.mjs"),Xt._isSameOrigin=(t,i)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const r=new URL(i,s);return s.origin===r.origin},Xt._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},Xt.fromPort=t=>{if(xv("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Xt.create(t)};let ur=Xt;class NA{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,i,s,r,l,c){this.messageHandler=t,this.loadingTask=i,this.commonObjs=new Hm,this.fontLoader=new Lv({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=c,this.setupMessageHandler()}#a(t,i=null){const s=this.#t.get(t);if(s)return s;const r=this.messageHandler.sendWithPromise(t,i);return this.#t.set(t,r),r}get annotationStorage(){return gt(this,"annotationStorage",new ch)}getRenderingIntent(t,i=xn.ENABLE,s=null,r=!1,l=!1){let c=Qe.DISPLAY,u=Qu;switch(t){case"any":c=Qe.ANY;break;case"display":break;case"print":c=Qe.PRINT;break;default:pt(`getRenderingIntent - invalid intent: ${t}`)}const h=c&Qe.PRINT&&s instanceof Dm?s:this.annotationStorage;switch(i){case xn.DISABLE:c+=Qe.ANNOTATIONS_DISABLE;break;case xn.ENABLE:break;case xn.ENABLE_FORMS:c+=Qe.ANNOTATIONS_FORMS;break;case xn.ENABLE_STORAGE:c+=Qe.ANNOTATIONS_STORAGE,u=h.serializable;break;default:pt(`getRenderingIntent - invalid annotationMode: ${i}`)}r&&(c+=Qe.IS_EDITING),l&&(c+=Qe.OPLIST);const{ids:f,hash:m}=h.modifiedIds,b=[c,u.hash,m];return{renderingIntent:c,cacheKey:b.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Te.cleanup(),this._networkStream?.cancelAllRequests(new Tn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,r)=>{Mt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},r.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){r.close();return}Mt(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{this._fullReader.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:l,contentLength:c}=this._fullReader;return(!r||!l)&&(this._lastProgress&&i.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{i.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(s,r)=>{Mt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(s.begin,s.end);if(!l){r.close();return}r.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){r.close();return}Mt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{r.error(c)})},r.onCancel=c=>{l.cancel(c),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new RA(s,this))}),t.on("DocException",s=>{i._capability.reject(Fe(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!i.onPassword)throw Fe(s);const r=l=>{l instanceof Error?this.#r.reject(l):this.#r.resolve({password:l})};i.onPassword(r,s.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),t.on("DataLoaded",s=>{i.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,r,l])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in l){const b=l.error;pt(`Error during font loading: ${b}`),this.commonObjs.resolve(s,b);break}const c=new Ut(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(b,y)=>globalThis.FontInspector.fontAdded(b,y):null,h=new kv(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:f}=l;Mt(f,"The imageRef must be defined.");for(const b of this.#e.values())for(const[,y]of b.objs)if(y?.ref===f)return y.dataLen?(this.commonObjs.resolve(s,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(s,l);break;case"Pattern":const m=new fe(l);this.commonObjs.resolve(s,m.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([s,r,l,c])=>{if(this.destroyed)return;const u=this.#e.get(r);if(!u.objs.has(s)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(s,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",s=>{this.destroyed||i.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&pt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=this.#n.get(i);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#i.set(l.refStr,t);const c=new DA(i,l,this,this._params.pdfBug);return this.#e.set(i,c),c});return this.#n.set(i,r),r}getPageIndex(t){return Wu(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#a("GetOptionalContentConfig").then(i=>new cA(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new lA(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:r[2]}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#e.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Te.cleanup()}}cachedPageNumber(t){if(!Wu(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(i)??null}}class OA{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this.#t;return t.form||t.canvas&&i?.size>0}}class Xs{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:s,commonObjs:r,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:m=!1,pdfBug:b=!1,pageColors:y=null,enableHWA:A=!1,operationsFilter:x=null}){this.callback=t,this.params=i,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=b,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new OA(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=A,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=x}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(Xs.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Xs.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:r,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Ws(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:r,viewport:s,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Xs.#e.delete(this._canvas),t||=new ah(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Xs.#e.delete(this._canvas),this.callback())))}}const LA="5.4.449",kA="f44e5f0e6";class ui{#t=null;#e=null;#n;#i=null;#r=!1;#a=!1;#s=null;#l;#c=null;#o=null;static#d=null;static get _keyboardManager(){return gt(this,"_keyboardManager",new br([[["Escape","mac+Escape"],ui.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ui.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ui.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ui.prototype._moveToPrevious],[["Home","mac+Home"],ui.prototype._moveToBeginning],[["End","mac+End"],ui.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#a=!1,this.#s=t):this.#a=!0,this.#o=t?._uiManager||i,this.#l=this.#o._eventBus,this.#n=t?.color?.toUpperCase()||this.#o?.highlightColors.values().next().value||"#FFFF98",ui.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const i=this.#o._signal;t.addEventListener("click",this.#g.bind(this),{signal:i}),t.addEventListener("keydown",this.#m.bind(this),{signal:i});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#o._signal;t.addEventListener("contextmenu",hi,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[s,r]of this.#o.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",r),l.title=s,l.setAttribute("data-l10n-id",ui.#d[s]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=r,l.ariaSelected=r===this.#n,l.addEventListener("click",this.#f.bind(this,r),{signal:i}),t.append(l)}return t.addEventListener("keydown",this.#m.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:Ct.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#p){this.#g(t);return}if(t.target===this.#t){this.#i.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#g(t);return}this.#i.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#g(t);return}this.#i.lastElementChild?.focus()}#m(t){ui._keyboardManager.exec(this,t)}#g(t){if(this.#p){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#o.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#o.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class hr{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,hr.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,color:s}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=s||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",hr.#i[t]),r.addEventListener("input",()=>{this.#n.updateParams(i,r.value)},{signal:this.#n._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function cm(p){return Math.floor(Math.max(0,Math.min(1,p))*255).toString(16).padStart(2,"0")}function Ja(p){return Math.max(0,Math.min(255,255*p))}class um{static CMYK_G([t,i,s,r]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Ja(t),[t,t,t]}static G_HTML([t]){const i=cm(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(Ja)}static RGB_HTML(t){return`#${t.map(cm).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,s+r),1-Math.min(1,i+r)]}static CMYK_rgb([t,i,s,r]){return[Ja(1-Math.min(1,t+r)),Ja(1-Math.min(1,s+r)),Ja(1-Math.min(1,i+r))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const r=1-t,l=1-i,c=1-s,u=Math.min(r,l,c);return["CMYK",r,l,c,u]}}class BA{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${i}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${i}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ht("Abstract method `_createSVG` called.")}}class Wl extends BA{_createSVG(t){return document.createElementNS(Yi,t)}}const PA=9,ts=new WeakSet,zA=new Date().getTimezoneOffset()*60*1e3;class ju{static create(t){switch(t.data.annotationType){case ce.LINK:return new ph(t);case ce.TEXT:return new UA(t);case ce.WIDGET:switch(t.data.fieldType){case"Tx":return new jA(t);case"Btn":return t.data.radioButton?new Xm(t):t.data.checkBox?new HA(t):new GA(t);case"Ch":return new VA(t);case"Sig":return new IA(t)}return new is(t);case ce.POPUP:return new th(t);case ce.FREETEXT:return new $m(t);case ce.LINE:return new YA(t);case ce.SQUARE:return new XA(t);case ce.CIRCLE:return new $A(t);case ce.POLYLINE:return new Km(t);case ce.CARET:return new QA(t);case ce.INK:return new gh(t);case ce.POLYGON:return new KA(t);case ce.HIGHLIGHT:return new Qm(t);case ce.UNDERLINE:return new WA(t);case ce.SQUIGGLY:return new ZA(t);case ce.STRIKEOUT:return new JA(t);case ce.STAMP:return new Wm(t);case ce.FILEATTACHMENT:return new t1(t);default:return new Kt(t)}}}class Kt{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,i&&(this.contentElement=this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Kt._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:s,rect:r}=this.data;let l=-1/0,c=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>c?(c=i[u+1],l=i[u+2]):i[u+1]===c&&(l=Math.max(l,i[u+2]));return[l,c]}if(s?.length>=1){for(const u of s)for(let h=0,f=u.length;h<f;h+=2)u[h+1]>c?(c=u[h+1],l=u[h]):u[h+1]===c&&(l=Math.max(l,u[h]));if(l!==1/0)return[l,c]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:l,pageY:c}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-l)/s,t[1]=100*(t[1]-c)/r,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${lr}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:s})||this.annotationStorage.setValue(`${lr}${i.id}`,{id:i.id,annotationType:i.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:s}=t;i&&this.#i(i);let r=this.#n?.popup||this.popup;!r&&s?.text&&(this._createPopup(s),r=this.#n.popup),r&&(r.updateEdited(t),s?.deleted&&(r.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...t),i.left=`${100*(t[0]-u)/l}%`,i.top=`${100*(c-t[3]+h)/c}%`,r===0?(i.width=`${100*(t[2]-t[0])/l}%`,i.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(r)}_createContainer(t){const{data:i,parent:{page:s,viewport:r}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",i.id),!(this instanceof is)&&!(this instanceof ph)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(l.title=i.alternativeText),i.noRotate&&l.classList.add("norotate"),!i.rect||this instanceof th){const{rotation:S}=i;return!i.hasOwnCanvas&&S!==0&&this.setRotation(S,l),l}const{width:u,height:h}=this;if(!t&&i.borderStyle.width>0){c.borderWidth=`${i.borderStyle.width}px`;const S=i.borderStyle.horizontalCornerRadius,E=i.borderStyle.verticalCornerRadius;if(S>0||E>0){const M=`calc(${S}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;c.borderRadius=M}else if(this instanceof Xm){const M=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;c.borderRadius=M}switch(i.borderStyle.style){case Hs.SOLID:c.borderStyle="solid";break;case Hs.DASHED:c.borderStyle="dashed";break;case Hs.BEVELED:pt("Unimplemented border style: beveled");break;case Hs.INSET:pt("Unimplemented border style: inset");break;case Hs.UNDERLINE:c.borderBottomStyle="solid";break}const w=i.borderColor||null;w?(this.#e=!0,c.borderColor=nt.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):c.borderWidth=0}const f=nt.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:m,pageHeight:b,pageX:y,pageY:A}=r.rawDims;c.left=`${100*(f[0]-y)/m}%`,c.top=`${100*(f[1]-A)/b}%`;const{rotation:x}=i;return i.hasOwnCanvas||x===0?(c.width=`${100*u/m}%`,c.height=`${100*h/b}%`):this.setRotation(x,l),l}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),i.style.width=`${100*l/s}%`,i.style.height=`${100*c/r}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,r)=>{const l=r.detail[i],c=l[0],u=l.slice(1);r.target.style[s]=um[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:um[`${c}_rgb`](u)})};return gt(this,"_commonActions",{display:i=>{const{display:s}=i.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const r of Object.keys(i.detail))(t[r]||s[r])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[r,l]of Object.entries(i)){const c=s[r];if(c){const u={detail:{[r]:l},target:t};c(u),delete i[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,r,l]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,E,w,M]=t.subarray(2,6);if(r===S&&l===E&&i===w&&s===M)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:E}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const h=r-i,f=l-s,{svgFactory:m}=this,b=m.createElement("svg");b.classList.add("quadrilateralsContainer"),b.setAttribute("width",0),b.setAttribute("height",0),b.role="none";const y=m.createElement("defs");b.append(y);const A=m.createElement("clipPath"),x=`clippath_${this.data.id}`;A.setAttribute("id",x),A.setAttribute("clipPathUnits","objectBoundingBox"),y.append(A);for(let S=2,E=t.length;S<E;S+=8){const w=t[S],M=t[S+1],T=t[S+2],L=t[S+3],O=m.createElement("rect"),k=(T-i)/h,z=(l-M)/f,q=(w-T)/h,K=(M-L)/f;O.setAttribute("x",k),O.setAttribute("y",z),O.setAttribute("width",q),O.setAttribute("height",K),A.append(O),u?.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${z}" width="${q}" height="${K}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(b),this.container.style.clipPath=`url(#${x})`}_createPopup(t=null){const{data:i}=this;let s,r;t?(s={str:t.text},r=t.date):(s=i.contentsObj,r=i.modificationDate),this.#n=new th({data:{color:i.color,titleObj:i.titleObj,modificationDate:r,contentsObj:s,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){Ht("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:l,id:c,exportValues:u}of r){if(l===-1||c===i)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!ts.has(f)){pt(`_getElementsByName - element not allowed: ${c}`);continue}s.push({id:c,exportValue:h,domElement:f})}return s}for(const r of document.getElementsByName(t)){const{exportValue:l}=r,c=r.getAttribute("data-element-id");c!==i&&ts.has(r)&&s.push({id:c,exportValue:l,domElement:r})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class FA extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class ph extends Kt{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#n(s,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=s,this.container.append(s)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),this.#t()}#e(t,i,s="",r=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,r),!1),this.#t()}#n(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const l=s.get(r);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){pt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:r,refs:l,include:c}=i,u=[];if(r.length!==0||l.length!==0){const m=new Set(l);for(const b of r){const y=this._fieldObjects[b]||[];for(const{id:A}of y)m.add(A)}for(const b of Object.values(this._fieldObjects))for(const y of b)m.has(y.id)===c&&u.push(y)}else for(const m of Object.values(this._fieldObjects))u.push(...m);const h=this.annotationStorage,f=[];for(const m of u){const{id:b}=m;switch(f.push(b),m.type){case"text":{const A=m.defaultValue||"";h.setValue(b,{value:A});break}case"checkbox":case"radiobutton":{const A=m.defaultValue===m.exportValues;h.setValue(b,{value:A});break}case"combobox":case"listbox":{const A=m.defaultValue||"";h.setValue(b,{value:A});break}default:continue}const y=document.querySelector(`[data-element-id="${b}"]`);if(y){if(!ts.has(y)){pt(`_bindResetFormAction - element not allowed: ${b}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class UA extends Kt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class is extends Kt{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return _e.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,r,l){s.includes("mouse")?t.addEventListener(s,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(s,c=>{if(s==="blur"){if(!i.focused||!c.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c)}})})}_setEventListeners(t,i,s,r){for(const[l,c]of s)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,l,c,r),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":nt.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||PA,l=t.style;let c;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),m=Math.round(f/(Ou*r))||1,b=f/m;c=Math.min(r,h(b/Ou))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(r,h(f/Ou))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=nt.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(l.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class jA extends is{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,r){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[i]=s),l.setValue(c.id,{[r]:s})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=t.getValue(i,{value:this.data.fieldValue});let l=r.value||"";const c=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),ts.add(s),this.contentElement=s,s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:f,datetimeType:m,timeStep:b}=this.data,y=!!m&&this.enableScripting;f&&(s.title=f),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",x=>{t.setValue(i,{value:x.target.value}),this.setPropertyOnSiblings(s,"value",x.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",x=>{const S=this.data.defaultFieldValue??"";s.value=h.userValue=S,h.formattedValue=null});let A=x=>{const{formattedValue:S}=h;S!=null&&(x.target.value=S),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",S=>{if(h.focused)return;const{target:E}=S;if(y&&(E.type=m,b&&(E.step=b)),h.userValue){const w=h.userValue;if(y)if(m==="time"){const M=new Date(w),T=[M.getHours(),M.getMinutes(),M.getSeconds()];E.value=T.map(L=>L.toString().padStart(2,"0")).join(":")}else E.value=new Date(w-zA).toISOString().split(m==="date"?"T":".",1)[0];else E.value=w}h.lastCommittedValue=E.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const E={value(w){h.userValue=w.detail.value??"",y||t.setValue(i,{value:h.userValue.toString()}),w.target.value=h.userValue},formattedValue(w){const{formattedValue:M}=w.detail;h.formattedValue=M,M!=null&&w.target!==document.activeElement&&(w.target.value=M);const T={formattedValue:M};y&&(T.value=M),t.setValue(i,T)},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{const{charLimit:M}=w.detail,{target:T}=w;if(M===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",M);let L=h.userValue;!L||L.length<=M||(L=L.slice(0,M),T.value=h.userValue=L,t.setValue(i,{value:L}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:L,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(E,S)}),s.addEventListener("keydown",S=>{h.commitKey=1;let E=-1;if(S.key==="Escape"?E=0:S.key==="Enter"&&!this.data.multiLine?E=2:S.key==="Tab"&&(h.commitKey=3),E===-1)return;const{value:w}=S.target;h.lastCommittedValue!==w&&(h.lastCommittedValue=w,h.userValue=w,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:w,willCommit:!0,commitKey:E,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const x=A;A=null,s.addEventListener("blur",S=>{if(!h.focused||!S.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:E}=S;let{value:w}=E;if(y){if(w&&m==="time"){const M=w.split(":").map(T=>parseInt(T,10));w=new Date(2e3,0,1,M[0],M[1],M[2]||0).valueOf(),E.step=""}else w.includes("T")||(w=`${w}T00:00`),w=new Date(w).valueOf();E.type="text"}h.userValue=w,h.lastCommittedValue!==w&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:w,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),x(S)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",S=>{h.lastCommittedValue=null;const{data:E,target:w}=S,{value:M,selectionStart:T,selectionEnd:L}=w;let O=T,k=L;switch(S.inputType){case"deleteWordBackward":{const z=M.substring(0,T).match(/\w*[^\w]*$/);z&&(O-=z[0].length);break}case"deleteWordForward":{const z=M.substring(T).match(/^[^\w]*\w*/);z&&(k+=z[0].length);break}case"deleteContentBackward":T===L&&(O-=1);break;case"deleteContentForward":T===L&&(k+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:M,change:E||"",willCommit:!1,selStart:O,selEnd:k}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(A&&s.addEventListener("blur",A),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class IA extends is{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class HA extends is{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return ts.add(l),l.setAttribute("data-element-id",s),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.setAttribute("exportValue",i.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s)){const m=h&&f.exportValue===i.exportValue;f.domElement&&(f.domElement.checked=m),t.setValue(f.id,{value:m})}t.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue||"Off";c.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class Xm extends is{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let r=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof r=="string"&&(r=r!==i.buttonValue,t.setValue(s,{value:r})),r)for(const c of this._getElementsByName(i.fieldName,s))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(ts.add(l),l.setAttribute("data-element-id",s),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=i.fieldName,r&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=i.defaultFieldValue;c.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const c=i.buttonValue;l.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const m=c===f.detail.value;for(const b of this._getElementsByName(f.target.name)){const y=m&&b.id===s;b.domElement&&(b.domElement.checked=y),t.setValue(b.id,{value:y})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class GA extends ph{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class VA extends is{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),r=document.createElement("select");ts.add(r),r.setAttribute("data-element-id",i),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",m=>{const b=this.data.defaultFieldValue;for(const y of r.options)y.selected=y.value===b});for(const m of this.data.options){const b=document.createElement("option");b.textContent=m.displayValue,b.value=m.exportValue,s.value.includes(m.exportValue)&&(b.setAttribute("selected",!0),l=!1),r.append(b)}let c=null;if(l){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),r.prepend(m),c=()=>{m.remove(),r.removeEventListener("input",c),c=null},r.addEventListener("input",c)}const u=m=>{const b=m?"value":"textContent",{options:y,multiple:A}=r;return A?Array.prototype.filter.call(y,x=>x.selected).map(x=>x[b]):y.selectedIndex===-1?null:y[y.selectedIndex][b]};let h=u(!1);const f=m=>{const b=m.target.options;return Array.prototype.map.call(b,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",m=>{const b={value(y){c?.();const A=y.detail.value,x=new Set(Array.isArray(A)?A:[A]);for(const S of r.options)S.selected=x.has(S.value);t.setValue(i,{value:u(!0)}),h=u(!1)},multipleSelection(y){r.multiple=!0},remove(y){const A=r.options,x=y.detail.remove;A[x].selected=!1,r.remove(x),A.length>0&&Array.prototype.findIndex.call(A,E=>E.selected)===-1&&(A[0].selected=!0),t.setValue(i,{value:u(!0),items:f(y)}),h=u(!1)},clear(y){for(;r.length!==0;)r.remove(0);t.setValue(i,{value:null,items:[]}),h=u(!1)},insert(y){const{index:A,displayValue:x,exportValue:S}=y.detail.insert,E=r.children[A],w=document.createElement("option");w.textContent=x,w.value=S,E?E.before(w):r.append(w),t.setValue(i,{value:u(!0),items:f(y)}),h=u(!1)},items(y){const{items:A}=y.detail;for(;r.length!==0;)r.remove(0);for(const x of A){const{displayValue:S,exportValue:E}=x,w=document.createElement("option");w.textContent=S,w.value=E,r.append(w)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(i,{value:u(!0),items:f(y)}),h=u(!1)},indices(y){const A=new Set(y.detail.indices);for(const x of y.target.options)x.selected=A.has(x.index);t.setValue(i,{value:u(!0)}),h=u(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(b,m)}),r.addEventListener("input",m=>{const b=u(!0),y=u(!1);t.setValue(i,{value:b}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:h,change:y,changeEx:b,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):r.addEventListener("input",function(m){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class th extends Kt{constructor(t){const{data:i,elements:s,parent:r}=t,l=!!r._commentManager;if(super(t,{isRenderable:!l&&Kt._hasPopupData(i)}),this.elements=s,l&&Kt._hasPopupData(i)){const c=this.popup=this.#t();for(const u of s)u.popup=c}else this.popup=null}#t(){return new qA({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),s=[];for(const r of this.elements)r.popup=i,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${qs}${r}`).join(",")),this.container}}class qA{#t=null;#e=this.#V.bind(this);#n=this.#U.bind(this);#i=this.#L.bind(this);#r=this.#x.bind(this);#a=null;#s=null;#l=null;#c=null;#o=null;#d=null;#h=null;#f=!1;#m=null;#g=null;#u=null;#p=null;#b=null;#v=null;#y=null;#E=null;#_=null;#S=null;#C=!1;#A=null;#w=null;constructor({container:t,color:i,elements:s,titleObj:r,modificationDate:l,contentsObj:c,richText:u,parent:h,rect:f,parentRect:m,open:b,commentManager:y=null}){this.#s=t,this.#_=r,this.#l=c,this.#E=u,this.#d=h,this.#a=i,this.#y=f,this.#h=m,this.#o=s,this.#t=y,this.#A=s[0],this.#c=Xu.toDateObject(l),this.trigger=s.flatMap(A=>A.getElementsToTriggerPopup()),y||(this.#D(),this.#s.hidden=!0,b&&this.#x())}#D(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const i of this.trigger)i.addEventListener("click",this.#r,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#n,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#o)i.container?.addEventListener("keydown",this.#e,{signal:t})}#M(){const t=this.#o.find(i=>i.hasCommentButton);t&&(this.#b=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#A.container.after(this.#p);return}if(this.#b||this.#M(),!this.#b)return;const{signal:t}=this.#g=new AbortController,i=this.#A.hasOwnCommentButton,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},r=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#p=this.#A.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#p=document.createElement("button");c.className="annotationCommentButton";const u=this.#A.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#z(),this.#R(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",s,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#R(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#p||this.renderCommentButton();const[t,i]=this.#b,{style:s}=this.#p;s.left=`calc(${t}%)`,s.top=`calc(${i}% - var(--comment-button-dim))`}#z(){this.#A.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:i,opacity:s,creationDate:r,modificationDate:l}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:s,creationDate:r,modificationDate:l}}get elementBeforePopup(){return this.#p}get comment(){return this.#w||=this.#A.commentText,this.#w}set comment(t){t!==this.comment&&(this.#A.commentText=this.#w=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=i)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:s}=this.#p.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#A.layer.getBoundingClientRect();return[(t-r)/c,(i+s-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#b}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,s]=this.#v||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:l,y:c,width:u,height:h}=r;this.#t.showDialog(null,this,l+i*u,c+s*h,{...t,parentDimensions:r})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#a){const s=t.style.outlineColor=nt.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#_?.str){const s=document.createElement("span");s.className="title",i.append(s),{dir:s.dir,str:s.textContent}=this.#_}if(t.append(i),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),i.append(s)}Tm({html:this.#O||this.#l.str,dir:this.#l?.dir,className:"popupContent"},t),this.#s.append(t)}get#O(){const t=this.#E,i=this.#l;return t?.str&&(!i?.str||i.str===t.str)&&this.#E.html||null}get#k(){return this.#O?.attributes?.style?.fontSize||0}get#F(){return this.#O?.attributes?.style?.color||null}#B(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},r={style:{color:this.#F,fontSize:this.#k?`calc(${this.#k}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))i.push({name:"span",value:l,attributes:r});return s}#V(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#x()}updateEdited({rect:t,popup:i,deleted:s}){if(this.#t){s?(this.remove(),this.#w=null):i&&(i.deleted?this.remove():(this.#z(),this.#w=i.text)),t&&(this.#b=null,this.#M(),this.#R());return}if(s||i?.deleted){this.remove();return}this.#D(),this.#S||={contentsObj:this.#l,richText:this.#E},t&&(this.#u=null),i&&i.text&&(this.#E=this.#B(i.text),this.#c=Xu.toDateObject(i.date),this.#l=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#S&&({contentsObj:this.#l,richText:this.#E}=this.#S,this.#S=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#y;for(const x of this.#o)if(!u||nt.intersect(x.data.rect,u)!==null){u=x.data.rect,c=!0;break}const h=nt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),m=c?u[2]-u[0]+5:0,b=h[0]+m,y=h[1];this.#u=[100*(b-r)/i,100*(y-l)/s];const{style:A}=this.#s;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#x(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#L(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#U(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#L(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#T(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#U(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#D(),this.#C&&(this.#m||this.#L(),this.#C=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class $m extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=mt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class YA extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class XA extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",i-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class $A extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",i/2),c.setAttribute("cy",s/2),c.setAttribute("rx",i/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Km extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:l,height:c}=this;if(!i)return this.container;const u=this.svgFactory.create(l,c,!0);let h=[];for(let m=0,b=i.length;m<b;m+=2){const y=i[m]-t[0],A=t[3]-i[m+1];h.push(`${y},${A}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class KA extends Km{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class QA extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class gh extends Kt{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?mt.HIGHLIGHT:mt.INK}#n(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:l}}=this,{transform:c,width:u,height:h}=this.#n(i,t),f=this.svgFactory.create(u,h,!0),m=this.#t=this.svgFactory.createElement("svg:g");f.append(m),m.setAttribute("stroke-width",r.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",c);for(let b=0,y=s.length;b<y;b++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",s[b].join(",")),m.append(A)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,l=this.#t;if(i>=0&&l.setAttribute("stroke-width",i||1),s)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",s[c].join(","));if(r){const{transform:c,width:u,height:h}=this.#n(this.data.rotation,r);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Qm extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=mt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class WA extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class ZA extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class JA extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Wm extends Kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=mt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class t1 extends Kt{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:r}=_e.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(r?l.metaKey:l.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class mh{#t=null;#e=null;#n=null;#i=new Map;#r=null;#a=null;#s=[];#l=!1;constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:r,page:l,viewport:c,structTreeLayer:u,commentManager:h,linkService:f,annotationStorage:m}){this.div=t,this.#t=i,this.#e=s,this.#r=u||null,this.#a=f||null,this.#n=m||new ch,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:i}=t,s=this.div;Jn(s,this.viewport);const r=new Map,l=[],c={data:null,layer:s,linkService:this.#a,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Wl,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of i){if(u.noHTML)continue;const h=u.annotationType===ce.POPUP;if(h){const b=r.get(u.id);if(!b)continue;if(!this._commentManager){l.push(u);continue}c.elements=b}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=ju.create(c);if(!f.isRenderable)continue;if(!h&&(this.#s.push(f),u.popupRef)){const b=r.get(u.popupRef);b?b.push(f):r.set(u.popupRef,[f])}const m=f.render();u.hidden&&(m.style.visibility="hidden"),f._isEditable&&(this.#i.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const h=c.elements=r.get(u.id);c.data=u;const f=ju.create(c);if(!f.isRenderable)continue;const m=f.render();f.contentElement.id=`${qs}${u.id}`,u.hidden&&(m.style.visibility="hidden"),h.at(-1).container.after(m)}this.#o()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#l){this.#l=!0;for(const{contentElement:s,data:{id:r}}of this.#s){const l=s.id=`${qs}${r}`;t.push(this.#r?.getAriaAttributes(l).then(c=>{if(c)for(const[u,h]of c)s.setAttribute(u,h)}))}}this.#s.sort(({data:{rect:[s,r,l,c]}},{data:{rect:[u,h,f,m]}})=>{if(s===l&&r===c)return 1;if(u===f&&h===m)return-1;const b=c,y=r,A=(r+c)/2,x=m,S=h,E=(h+m)/2;if(A>=x&&E<=y)return-1;if(E>=b&&A<=S)return 1;const w=(s+l)/2,M=(u+f)/2;return w-M});const i=document.createDocumentFragment();for(const s of this.#s)i.append(s.container),this._commentManager?(s.extraPopupElement?.popup||s.popup)?.renderCommentButton():s.extraPopupElement&&i.append(s.extraPopupElement.render());if(this.div.append(i),await Promise.all(t),this.#t)for(const s of this.#s)this.#t.addPointerInTextLayer(s.contentElement,!1)}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#a,svgFactory:new Wl,parent:this};for(const s of t){s.borderStyle||=mh._defaultBorderStyle,i.data=s;const r=ju.create(i);r.isRenderable&&(r.render(),r.contentElement.id=`${qs}${s.id}`,this.#s.push(r))}await this.#c()}update({viewport:t}){const i=this.div;this.viewport=t,Jn(i,{rotation:t.rotation}),this.#o(),i.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[i,s]of this.#e){const r=t.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:l}=r;l?l.nodeName==="CANVAS"?l.replaceWith(s):l.classList.contains("annotationContent")?l.after(s):l.before(s):r.append(s);const c=this.#i.get(i);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,r.id,s),c._hasNoCanvas=!1):c.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:s,rotation:r}=t,l=new FA({data:{id:s,rect:t.getPDFRect(),rotation:r},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#n});return l.render(),l.contentElement.id=`${qs}${s}`,l.createOrUpdatePopup(),this.#s.push(l),l}removeAnnotation(t){const i=this.#s.findIndex(r=>r.data.id===t);if(i<0)return;const[s]=this.#s.splice(i,1);this.#t?.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const i of t)i.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return gt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Hs.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Vl=/\r\n?|\n/g;class pe extends rt{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=pe.prototype,i=l=>l.isEmpty(),s=Cn.TRANSLATE_SMALL,r=Cn.TRANSLATE_BIG;return gt(this,"_keyboardManager",new br([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static _type="freetext";static _editorType=mt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||pe._defaultColor||rt._defaultLineColor,this.#i=t.fontSize||pe._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,i){rt.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Ct.FREETEXT_SIZE:pe._defaultFontSize=i;break;case Ct.FREETEXT_COLOR:pe._defaultColor=i;break}}updateParams(t,i){switch(t){case Ct.FREETEXT_SIZE:this.#r(i);break;case Ct.FREETEXT_COLOR:this.#a(i);break}}static get defaultPropertiesToUpdate(){return[[Ct.FREETEXT_SIZE,pe._defaultFontSize],[Ct.FREETEXT_COLOR,pe._defaultColor||rt._defaultLineColor]]}get propertiesToUpdate(){return[[Ct.FREETEXT_SIZE,this.#i],[Ct.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new hr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ct.FREETEXT_COLOR}#r(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#i)*this.parentScale),this.#i=r,this.#l()},s=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(t){const i=r=>{this.color=r,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-pe._internalPadding*t,-(pe._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(pe.#c(s)),i=s);return t.join(`
`)}#l(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",r.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#s().trimEnd();if(t===i)return;const s=r=>{if(this.#t=r,!r){this.remove();return}this.#o(),this._uiManager.rebuild(this),this.#l()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),this.#l()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){pe._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[f,m]=this.pageDimensions,[b,y]=this.pageTranslation;let A,x;switch(this.rotation){case 0:A=t+(c[0]-b)/f,x=i+this.height-(c[1]-y)/m;break;case 90:A=t+(c[0]-b)/f,x=i-(c[1]-y)/m,[u,h]=[h,-u];break;case 180:A=t-this.width+(c[0]-b)/f,x=i-(c[1]-y)/m,[u,h]=[-u,-h];break;case 270:A=t+(c[0]-b-this.height*m)/f,x=i+(c[1]-y-this.width*f)/m,[u,h]=[-h,u];break}this.setAt(A*r,x*l,u,h)}else this._moveAfterPaste(t,i);this.#o(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Vl,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=pe.#h(i.getData("text")||"").replaceAll(Vl,`
`);if(!r)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:h}=c,f=[],m=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(m.push(u.nodeValue.slice(h).replaceAll(Vl,"")),A!==this.editorDiv){let x=f;for(const S of this.editorDiv.childNodes){if(S===A){x=m;continue}x.push(pe.#c(S))}}f.push(u.nodeValue.slice(0,h).replaceAll(Vl,""))}else if(u===this.editorDiv){let A=f,x=0;for(const S of this.editorDiv.childNodes)x++===h&&(A=m),A.push(pe.#c(S))}this.#t=`${f.join(`
`)}${r}${m.join(`
`)}`,this.#o();const b=new Range;let y=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const x=A.nodeValue.length;if(y<=x){b.setStart(A,y),b.setEnd(A,y);break}y-=x}l.removeAllRanges(),l.addRange(b)}#o(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=pe._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){let r=null;if(t instanceof $m){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:f,id:m,popupRef:b,richText:y,contentsObj:A,creationDate:x,modificationDate:S},textContent:E,textPosition:w,parent:{page:{pageNumber:M}}}=t;if(!E||E.length===0)return null;r=t={annotationType:mt.FREETEXT,color:Array.from(u),fontSize:c,value:E.join(`
`),position:w,pageIndex:M-1,rect:h.slice(0),rotation:f,annotationElementId:m,id:m,deleted:!1,popupRef:b,comment:A?.str||null,richText:y,creationDate:x,modificationDate:S}}const l=await super.deserialize(t,i,s);return l.#i=t.fontSize,l.color=nt.makeHexColor(...t.color),l.#t=pe.#h(t.value),l._initialData=r,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=rt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:i,fontSize:s,color:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((c,u)=>c!==r[u])||t.pageIndex!==l}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const r of this.#t.split(`
`)){const l=document.createElement("div");l.append(r?document.createTextNode(r):document.createElement("br")),i.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class et{static PRECISION=1e-4;toSVGPath(){Ht("Abstract method `toSVGPath` must be implemented.")}get box(){Ht("Abstract getter `box` must be implemented.")}serialize(t,i){Ht("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u]*r,c[u+1]=s+t[u+1]*l;return c}static _rescaleAndSwap(t,i,s,r,l,c){c||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)c[u]=i+t[u+1]*r,c[u+1]=s+t[u]*l;return c}static _translate(t,i,s,r){r||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)r[l]=i+t[l],r[l+1]=s+t[l+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,r,l){switch(l){case 90:return[1-i/s,t/r];case 180:return[1-t/s,1-i/r];case 270:return[i/s,1-t/r];default:return[t/s,i/r]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,r,l,c){return[(t+5*s)/6,(i+5*r)/6,(5*s+l)/6,(5*r+c)/6,(s+l)/2,(r+c)/2]}}class Kn{#t;#e=[];#n;#i;#r=[];#a=new Float32Array(18);#s;#l;#c;#o;#d;#h;#f=[];static#m=8;static#g=2;static#u=Kn.#m+Kn.#g;constructor({x:t,y:i},s,r,l,c,u=0){this.#t=s,this.#h=l*r,this.#i=c,this.#a.set([NaN,NaN,NaN,NaN,t,i],6),this.#n=u,this.#o=Kn.#m*r,this.#c=Kn.#u*r,this.#d=r,this.#f.push(t,i)}isEmpty(){return isNaN(this.#a[8])}#p(){const t=this.#a.subarray(4,6),i=this.#a.subarray(16,18),[s,r,l,c]=this.#t;return[(this.#s+(t[0]-i[0])/2-s)/l,(this.#l+(t[1]-i[1])/2-r)/c,(this.#s+(i[0]-t[0])/2-s)/l,(this.#l+(i[1]-t[1])/2-r)/c]}add({x:t,y:i}){this.#s=t,this.#l=i;const[s,r,l,c]=this.#t;let[u,h,f,m]=this.#a.subarray(8,12);const b=t-f,y=i-m,A=Math.hypot(b,y);if(A<this.#c)return!1;const x=A-this.#o,S=x/A,E=S*b,w=S*y;let M=u,T=h;u=f,h=m,f+=E,m+=w,this.#f?.push(t,i);const L=-w/x,O=E/x,k=L*this.#h,z=O*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([f+k,m+z],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([f-k,m-z],16),isNaN(this.#a[6])?(this.#r.length===0&&(this.#a.set([u+k,h+z],2),this.#r.push(NaN,NaN,NaN,NaN,(u+k-s)/l,(h+z-r)/c),this.#a.set([u-k,h-z],14),this.#e.push(NaN,NaN,NaN,NaN,(u-k-s)/l,(h-z-r)/c)),this.#a.set([M,T,u,h,f,m],6),!this.isEmpty()):(this.#a.set([M,T,u,h,f,m],6),Math.abs(Math.atan2(T-h,M-u)-Math.atan2(w,E))<Math.PI/2?([u,h,f,m]=this.#a.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/l,((h+m)/2-r)/c),[u,h,M,T]=this.#a.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((M+u)/2-s)/l,((T+h)/2-r)/c),!0):([M,T,u,h,f,m]=this.#a.subarray(0,6),this.#r.push(((M+5*u)/6-s)/l,((T+5*h)/6-r)/c,((5*u+f)/6-s)/l,((5*h+m)/6-r)/c,((u+f)/2-s)/l,((h+m)/2-r)/c),[f,m,u,h,M,T]=this.#a.subarray(12,18),this.#e.push(((M+5*u)/6-s)/l,((T+5*h)/6-r)/c,((5*u+f)/6-s)/l,((5*h+m)/6-r)/c,((u+f)/2-s)/l,((h+m)/2-r)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,i=this.#e;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#b();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#y(s);for(let r=i.length-6;r>=6;r-=6)isNaN(i[r])?s.push(`L${i[r+4]} ${i[r+5]}`):s.push(`C${i[r]} ${i[r+1]} ${i[r+2]} ${i[r+3]} ${i[r+4]} ${i[r+5]}`);return this.#v(s),s.join(" ")}#b(){const[t,i,s,r]=this.#t,[l,c,u,h]=this.#p();return`M${(this.#a[2]-t)/s} ${(this.#a[3]-i)/r} L${(this.#a[4]-t)/s} ${(this.#a[5]-i)/r} L${l} ${c} L${u} ${h} L${(this.#a[16]-t)/s} ${(this.#a[17]-i)/r} L${(this.#a[14]-t)/s} ${(this.#a[15]-i)/r} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#y(t){const[i,s,r,l]=this.#t,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[h,f,m,b]=this.#p();t.push(`L${(c[0]-i)/r} ${(c[1]-s)/l} L${h} ${f} L${m} ${b} L${(u[0]-i)/r} ${(u[1]-s)/l}`)}newFreeDrawOutline(t,i,s,r,l,c){return new Zm(t,i,s,r,l,c)}getOutlines(){const t=this.#r,i=this.#e,s=this.#a,[r,l,c,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let b=0,y=h.length-2;b<y;b+=2)h[b]=(this.#f[b]-r)/c,h[b+1]=(this.#f[b+1]-l)/u;if(h[h.length-2]=(this.#s-r)/c,h[h.length-1]=(this.#l-l)/u,isNaN(s[6])&&!this.isEmpty())return this.#E(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let m=t.length;for(let b=0;b<m;b+=2){if(isNaN(t[b])){f[b]=f[b+1]=NaN;continue}f[b]=t[b],f[b+1]=t[b+1]}m=this.#S(f,m);for(let b=i.length-6;b>=6;b-=6)for(let y=0;y<6;y+=2){if(isNaN(i[b+y])){f[m]=f[m+1]=NaN,m+=2;continue}f[m]=i[b+y],f[m+1]=i[b+y+1],m+=2}return this.#_(f,m),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#n,this.#i)}#E(t){const i=this.#a,[s,r,l,c]=this.#t,[u,h,f,m]=this.#p(),b=new Float32Array(36);return b.set([NaN,NaN,NaN,NaN,(i[2]-s)/l,(i[3]-r)/c,NaN,NaN,NaN,NaN,(i[4]-s)/l,(i[5]-r)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(i[16]-s)/l,(i[17]-r)/c,NaN,NaN,NaN,NaN,(i[14]-s)/l,(i[15]-r)/c],0),this.newFreeDrawOutline(b,t,this.#t,this.#d,this.#n,this.#i)}#_(t,i){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6}#S(t,i){const s=this.#a.subarray(4,6),r=this.#a.subarray(16,18),[l,c,u,h]=this.#t,[f,m,b,y]=this.#p();return t.set([NaN,NaN,NaN,NaN,(s[0]-l)/u,(s[1]-c)/h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,b,y,NaN,NaN,NaN,NaN,(r[0]-l)/u,(r[1]-c)/h],i),i+=24}}class Zm extends et{#t;#e=new Float32Array(4);#n;#i;#r;#a;#s;constructor(t,i,s,r,l,c){super(),this.#s=t,this.#r=i,this.#t=s,this.#a=r,this.#n=l,this.#i=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#l(c);const[u,h,f,m]=this.#e;for(let b=0,y=t.length;b<y;b+=2)t[b]=(t[b]-u)/f,t[b+1]=(t[b+1]-h)/m;for(let b=0,y=i.length;b<y;b+=2)i[b]=(i[b]-u)/f,i[b+1]=(i[b+1]-h)/m}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let i=6,s=this.#s.length;i<s;i+=6){if(isNaN(this.#s[i])){t.push(`L${this.#s[i+4]} ${this.#s[i+5]}`);continue}t.push(`C${this.#s[i]} ${this.#s[i+1]} ${this.#s[i+2]} ${this.#s[i+3]} ${this.#s[i+4]} ${this.#s[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],l){const c=s-t,u=r-i;let h,f;switch(l){case 0:h=et._rescale(this.#s,t,r,c,-u),f=et._rescale(this.#r,t,r,c,-u);break;case 90:h=et._rescaleAndSwap(this.#s,t,i,c,u),f=et._rescaleAndSwap(this.#r,t,i,c,u);break;case 180:h=et._rescale(this.#s,s,i,-c,u),f=et._rescale(this.#r,s,i,-c,u);break;case 270:h=et._rescaleAndSwap(this.#s,s,r,-c,-u),f=et._rescaleAndSwap(this.#r,s,r,-c,-u);break}return{outline:Array.from(h),points:[Array.from(f)]}}#l(t){const i=this.#s;let s=i[4],r=i[5];const l=[s,r,s,r];let c=s,u=r,h=s,f=r;const m=t?Math.max:Math.min,b=new Float32Array(4);for(let A=6,x=i.length;A<x;A+=6){const S=i[A+4],E=i[A+5];isNaN(i[A])?(nt.pointBoundingBox(S,E,l),u>E?(c=S,u=E):u===E&&(c=m(c,S)),f<E?(h=S,f=E):f===E&&(h=m(h,S))):(b[0]=b[1]=1/0,b[2]=b[3]=-1/0,nt.bezierBoundingBox(s,r,...i.slice(A,A+6),b),nt.rectBoundingBox(b[0],b[1],b[2],b[3],l),u>b[1]?(c=b[0],u=b[1]):u===b[1]&&(c=m(c,b[0])),f<b[3]?(h=b[2],f=b[3]):f===b[3]&&(h=m(h,b[2]))),s=S,r=E}const y=this.#e;y[0]=l[0]-this.#n,y[1]=l[1]-this.#n,y[2]=l[2]-l[0]+2*this.#n,y[3]=l[3]-l[1]+2*this.#n,this.firstPoint=[c,u],this.lastPoint=[h,f]}get box(){return this.#e}newOutliner(t,i,s,r,l,c=0){return new Kn(t,i,s,r,l,c)}getNewOutline(t,i){const[s,r,l,c]=this.#e,[u,h,f,m]=this.#t,b=l*f,y=c*m,A=s*f+u,x=r*m+h,S=this.newOutliner({x:this.#r[0]*b+A,y:this.#r[1]*y+x},this.#t,this.#a,t,this.#i,i??this.#n);for(let E=2;E<this.#r.length;E+=2)S.add({x:this.#r[E]*b+A,y:this.#r[E+1]*y+x});return S.getOutlines()}}class eh{#t;#e;#n;#i=[];#r=[];constructor(t,i=0,s=0,r=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:S,y:E,width:w,height:M}of t){const T=Math.floor((S-i)/c)*c,L=Math.ceil((S+w+i)/c)*c,O=Math.floor((E-i)/c)*c,k=Math.ceil((E+M+i)/c)*c,z=[T,O,k,!0],q=[L,O,k,!1];this.#i.push(z,q),nt.rectBoundingBox(T,O,L,k,l)}const u=l[2]-l[0]+2*s,h=l[3]-l[1]+2*s,f=l[0]-s,m=l[1]-s;let b=r?-1/0:1/0,y=1/0;const A=this.#i.at(r?-1:-2),x=[A[0],A[2]];for(const S of this.#i){const[E,w,M,T]=S;!T&&r?w<y?(y=w,b=E):w===y&&(b=Math.max(b,E)):T&&!r&&(w<y?(y=w,b=E):w===y&&(b=Math.min(b,E))),S[0]=(E-f)/u,S[1]=(w-m)/h,S[2]=(M-m)/h}this.#t=new Float32Array([f,m,u,h]),this.#e=[b,y],this.#n=x}getOutlines(){this.#i.sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#o(i)),this.#l(i)):(this.#c(i),t.push(...this.#o(i)));return this.#a(t)}#a(t){const i=[],s=new Set;for(const c of t){const[u,h,f]=c;i.push([u,h,c],[u,f,c])}i.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=i.length;c<u;c+=2){const h=i[c][2],f=i[c+1][2];h.push(f),f.push(h),s.add(h),s.add(f)}const r=[];let l;for(;s.size>0;){const c=s.values().next().value;let[u,h,f,m,b]=c;s.delete(c);let y=u,A=h;for(l=[u,f],r.push(l);;){let x;if(s.has(m))x=m;else if(s.has(b))x=b;else break;s.delete(x),[u,h,f,m,b]=x,y!==u&&(l.push(y,A,u,A===h?h:f),y=u),A=A===h?f:h}l.push(y,A)}return new e1(r,this.#t,this.#e,this.#n)}#s(t){const i=this.#r;let s=0,r=i.length-1;for(;s<=r;){const l=s+r>>1,c=i[l][0];if(c===t)return l;c<t?s=l+1:r=l-1}return r+1}#l([,t,i]){const s=this.#s(t);this.#r.splice(s,0,[t,i])}#c([,t,i]){const s=this.#s(t);for(let r=s;r<this.#r.length;r++){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}for(let r=s-1;r>=0;r--){const[l,c]=this.#r[r];if(l!==t)break;if(l===t&&c===i){this.#r.splice(r,1);return}}}#o(t){const[i,s,r]=t,l=[[i,s,r]],c=this.#s(r);for(let u=0;u<c;u++){const[h,f]=this.#r[u];for(let m=0,b=l.length;m<b;m++){const[,y,A]=l[m];if(!(f<=y||A<=h)){if(y>=h){if(A>f)l[m][1]=f;else{if(b===1)return[];l.splice(m,1),m--,b--}continue}l[m][2]=h,A>f&&l.push([i,f,A])}}}return l}}class e1 extends et{#t;#e;constructor(t,i,s,r){super(),this.#e=t,this.#t=i,this.firstPoint=s,this.lastPoint=r}toSVGPath(){const t=[];for(const i of this.#e){let[s,r]=i;t.push(`M${s} ${r}`);for(let l=2;l<i.length;l+=2){const c=i[l],u=i[l+1];c===s?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],l){const c=[],u=s-t,h=r-i;for(const f of this.#e){const m=new Array(f.length);for(let b=0;b<f.length;b+=2)m[b]=t+f[b]*u,m[b+1]=r-f[b+1]*h;c.push(m)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class ih extends Kn{newFreeDrawOutline(t,i,s,r,l,c){return new i1(t,i,s,r,l,c)}}class i1 extends Zm{newOutliner(t,i,s,r,l,c=0){return new ih(t,i,s,r,l,c)}}class ne extends rt{#t=null;#e=0;#n;#i=null;#r=null;#a=null;#s=null;#l=0;#c=null;#o=null;#d=null;#h=!1;#f=null;#m=null;#g=null;#u="";#p;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=mt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ne.prototype;return gt(this,"_keyboardManager",new br([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ne._defaultColor,this.#p=t.thickness||ne._defaultThickness,this.opacity=t.opacity||ne._defaultOpacity,this.#n=t.boxes||null,this.#b=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#y(t),this.#A()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#l=t.focusOffset,this.#v(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new eh(this.#n,.001);this.#o=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#o.box;const i=new eh(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#a=i.getOutlines();const{firstPoint:s}=this.#o;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:r}=this.#a;this.#m=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:i,clipPathId:s}){this.#o=t;const r=1.5;if(this.#a=t.getNewOutline(this.#p/2+r,.0025),i>=0)this.#d=i,this.#i=s,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ne.#w(this.#o.box,(b-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:ne.#w(this.#a.box,b),path:{d:this.#a.toSVGPath()}})}const[l,c,u,h]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=h;break;case 90:{const[b,y]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*y/b,this.height=h*b/y;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=h;break;case 270:{const[b,y]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*y/b,this.height=h*b/y;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/h];const{lastPoint:m}=this.#a;this.#m=[(m[0]-l)/u,(m[1]-c)/h]}static initialize(t,i){rt.initialize(t,i),ne._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case Ct.HIGHLIGHT_COLOR:ne._defaultColor=i;break;case Ct.HIGHLIGHT_THICKNESS:ne._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case Ct.HIGHLIGHT_COLOR:this.#E(i);break;case Ct.HIGHLIGHT_THICKNESS:this.#_(i);break}}static get defaultPropertiesToUpdate(){return[[Ct.HIGHLIGHT_COLOR,ne._defaultColor],[Ct.HIGHLIGHT_THICKNESS,ne._defaultThickness]]}get propertiesToUpdate(){return[[Ct.HIGHLIGHT_COLOR,this.color||ne._defaultColor],[Ct.HIGHLIGHT_THICKNESS,this.#p||ne._defaultThickness],[Ct.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#E(t){const i=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},s=this.color,r=this.opacity;this.addCommands({cmd:i.bind(this,t,ne._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#_(t){const i=this.#p,s=r=>{this.#p=r,this.#S(r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ct.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new ui({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#R())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#C():t&&(this.#A(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#S(t){this.#h&&(this.#y({highlightOutlines:this.#o.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#o.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#o.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#w([t,i,s,r],l){switch(l){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]}rotate(t){const{drawLayer:i}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=ne.#w(this.#o.box,t)):s=ne.#w([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(this.#g,{bbox:ne.#w(this.#a.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(),Mm(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#D(t){ne._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#M(!0);break;case 1:case 3:this.#M(!1);break}}#M(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#s,this.#l)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#M(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#R(){return this.#h?this.rotation:0}#z(){if(this.#h)return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,l=this.#n,c=new Float32Array(l.length*8);let u=0;for(const{x:h,y:f,width:m,height:b}of l){const y=h*t+s,A=(1-f)*i+r;c[u]=c[u+4]=y,c[u+1]=c[u+3]=A,c[u+2]=c[u+6]=y+m*t,c[u+5]=c[u+7]=A-b*i,u+=8}return c}#O(t){return this.#o.serialize(t,this.#R())}static startHighlighting(t,i,{target:s,x:r,y:l}){const{x:c,y:u,width:h,height:f}=s.getBoundingClientRect(),m=new AbortController,b=t.combinedSignal(m),y=A=>{m.abort(),this.#F(t,A)};window.addEventListener("blur",y,{signal:b}),window.addEventListener("pointerup",y,{signal:b}),window.addEventListener("pointerdown",Jt,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",hi,{signal:b}),s.addEventListener("pointermove",this.#k.bind(this,t),{signal:b}),this._freeHighlight=new ih({x:r,y:l},[c,u,h,f],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#k(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,s){let r=null;if(t instanceof Qm){const{data:{quadPoints:x,rect:S,rotation:E,id:w,color:M,opacity:T,popupRef:L,richText:O,contentsObj:k,creationDate:z,modificationDate:q},parent:{page:{pageNumber:K}}}=t;r=t={annotationType:mt.HIGHLIGHT,color:Array.from(M),opacity:T,quadPoints:x,boxes:null,pageIndex:K-1,rect:S.slice(0),rotation:E,annotationElementId:w,id:w,deleted:!1,popupRef:L,richText:O,comment:k?.str||null,creationDate:z,modificationDate:q}}else if(t instanceof gh){const{data:{inkLists:x,rect:S,rotation:E,id:w,color:M,borderStyle:{rawWidth:T},popupRef:L,richText:O,contentsObj:k,creationDate:z,modificationDate:q},parent:{page:{pageNumber:K}}}=t;r=t={annotationType:mt.HIGHLIGHT,color:Array.from(M),thickness:T,inkLists:x,boxes:null,pageIndex:K-1,rect:S.slice(0),rotation:E,annotationElementId:w,id:w,deleted:!1,popupRef:L,richText:O,comment:k?.str||null,creationDate:z,modificationDate:q}}const{color:l,quadPoints:c,inkLists:u,opacity:h}=t,f=await super.deserialize(t,i,s);f.color=nt.makeHexColor(...l),f.opacity=h||1,u&&(f.#p=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t);const[m,b]=f.pageDimensions,[y,A]=f.pageTranslation;if(c){const x=f.#n=[];for(let S=0;S<c.length;S+=8)x.push({x:(c[S]-y)/m,y:1-(c[S+1]-A)/b,width:(c[S+2]-c[S])/m,height:(c[S+1]-c[S+5])/b});f.#v(),f.#A(),f.rotate(f.rotation)}else if(u){f.#h=!0;const x=u[0],S={x:x[0]-y,y:b-(x[1]-A)},E=new ih(S,[0,0,m,b],1,f.#p/2,!0,.001);for(let T=0,L=x.length;T<L;T+=2)S.x=x[T]-y,S.y=b-(x[T+1]-A),E.add(S);const{id:w,clipPathId:M}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);f.#y({highlightOutlines:E.getOutlines(),highlightId:w,clipPathId:M}),f.#A(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=rt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:this.#p,quadPoints:this.#z(),outlines:this.#O(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#B(s)?null:(s.id=this.annotationElementId,s)}#B(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,r)=>s!==i[r])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Jm{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,s]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,s)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Ht("Not implemented")}}class Ot extends rt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#a(t),this.#c())}#a({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#h(t.box)}#s(t,i){const{id:s}=i.drawLayer.draw(Ot._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,l]of Object.entries(i))s.has(r)?Object.assign(t[r],l):t[r]=l;return t}static getDefaultDrawingOptions(t){Ht("Not implemented")}static get typesMap(){Ht("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(Ot.#n.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,l=r[i],c=u=>{r.updateProperty(i,u);const h=this.#t.updateProperty(i,u);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Ot._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Ot._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Ot._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#l(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#l()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#l(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#o([t,i,s,r]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[i,1-t,s*(c/l),r*(l/c)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(c/l),r*(l/c)];default:return[t,i,s,r]}}#d(){const{x:t,y:i,width:s,height:r,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-i,t,s*(l/c),r*(c/l)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(l/c),r*(c/l)];default:return[t,i,s,r]}}#h(t){[this.x,this.y,this.width,this.height]=this.#o(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:i,width:s,height:r,rotation:l,parentRotation:c,parentDimensions:[u,h]}=this;switch((l*4+c)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(u/h),r*(h/u),s*(u/h)];case 5:return[1-i,t,s*(u/h),r*(h/u)];case 6:return[1-t-r*(h/u),1-i,r*(h/u),s*(u/h)];case 7:return[i-s*(u/h),1-t-r*(h/u),s*(u/h),r*(h/u)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(h/u),i,r*(h/u),s*(u/h)];case 13:return[1-i-s*(u/h),t-r*(h/u),s*(u/h),r*(h/u)];case 14:return[1-t,1-i-s*(u/h),r*(h/u),s*(u/h)];case 15:return[i,1-t,s*(u/h),r*(h/u)];default:return[t,i,s,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ot._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");return s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,l){Ht("Not implemented")}static startDrawing(t,i,s,r){const{target:l,offsetX:c,offsetY:u,pointerId:h,pointerType:f}=r;if(Lt.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:m}}=t,{width:b,height:y}=l.getBoundingClientRect(),A=Ot.#i=new AbortController,x=t.combinedSignal(A);if(Lt.setPointer(f,h),window.addEventListener("pointerup",S=>{Lt.isSamePointerIdOrRemove(S.pointerId)&&this._endDraw(S)},{signal:x}),window.addEventListener("pointercancel",S=>{Lt.isSamePointerIdOrRemove(S.pointerId)&&this._currentParent.endDrawingSession()},{signal:x}),window.addEventListener("pointerdown",S=>{Lt.isSamePointerType(S.pointerType)&&(Lt.initializeAndAddPointerId(S.pointerId),Ot.#n.isCancellable()&&(Ot.#n.removeLastElement(),Ot.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",hi,{signal:x}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),l.addEventListener("touchmove",S=>{Lt.isSameTimeStamp(S.timeStamp)&&Jt(S)},{signal:x}),t.toggleDrawing(),i._editorUndoBar?.hide(),Ot.#n){t.drawLayer.updateProperties(this._currentDrawId,Ot.#n.startNew(c,u,b,y,m));return}i.updateUIForDefaultProperties(this),Ot.#n=this.createDrawerInstance(c,u,b,y,m),Ot.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Ot.#r.toSVGProperties(),Ot.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Lt.isSameTimeStamp(t.timeStamp),!Ot.#n)return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(Lt.isSamePointerId(r)){if(Lt.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Ot.#n.add(i,s)),Lt.setTimeStamp(t.timeStamp),Jt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Ot.#n=null,Ot.#r=null,Lt.clearPointerType(),Lt.clearTimeStamp()),Ot.#i&&(Ot.#i.abort(),Ot.#i=null,Lt.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,Ot.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=Ot.#n,r=this._currentDrawId,l=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(l))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Ct.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Ct.DRAW_STEP),!Ot.#n.isEmpty()){const{pageDimensions:[s,r],scale:l}=i,c=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Ot.#n.getOutlines(s*l,r*l,l,this._INNER_MARGIN),drawingOptions:Ot.#r,mustBeCommitted:!t});return this._cleanup(!0),c}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,l,c){Ht("Not implemented")}static async deserialize(t,i,s){const{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:u}}=i.viewport,h=this.deserializeDraw(c,u,r,l,this._INNER_MARGIN,t),f=await super.deserialize(t,i,s);return f.createDrawingOptions(t),f.#a({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[i,s]=this.pageTranslation,[r,l]=this.pageDimensions;return this.#t.serialize([i,s,r,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class n1{#t=new Float64Array(6);#e;#n;#i;#r;#a;#s="";#l=0;#c=new vr;#o;#d;constructor(t,i,s,r,l,c){this.#o=s,this.#d=r,this.#i=l,this.#r=c,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i],this.#n=[{line:u,points:this.#a}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#r=i)}#h(t,i){return et._normalizePoint(t,i,this.#o,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#a.length<=10}add(t,i){[t,i]=this.#h(t,i);const[s,r,l,c]=this.#t.subarray(2,6),u=t-l,h=i-c;return Math.hypot(this.#o*u,this.#d*h)<=2?null:(this.#a.push(t,i),isNaN(s)?(this.#t.set([l,c,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,r,l,c,t,i],0),this.#e.push(...et.createBezierPoints(s,r,l,c,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const s=this.add(t,i);return s||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,s,r,l){this.#o=s,this.#d=r,this.#i=l,[t,i]=this.#h(t,i);const c=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#a=[t,i];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:c,points:this.#a}),this.#t.set(c,0),this.#l=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#a=t.points,this.#l=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#s="";for(let t=0,i=this.#n.length;t<i;t++){const{line:s,points:r}=this.#n[t];this.#e=s,this.#a=r,this.#l=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=et.svgRound(this.#e[4]),i=et.svgRound(this.#e[5]);if(this.#a.length===2)return this.#s=`${this.#s} M ${t} ${i} Z`,this.#s;if(this.#a.length<=6){const r=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,r)} M ${t} ${i}`,this.#l=6}if(this.#a.length===4){const r=et.svgRound(this.#e[10]),l=et.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${r} ${l}`,this.#l=12,this.#s}const s=[];this.#l===0&&(s.push(`M ${t} ${i}`),this.#l=6);for(let r=this.#l,l=this.#e.length;r<l;r+=6){const[c,u,h,f,m,b]=this.#e.slice(r,r+6).map(et.svgRound);s.push(`C${c} ${u} ${h} ${f} ${m} ${b}`)}return this.#s+=s.join(" "),this.#l=this.#e.length,this.#s}getOutlines(t,i,s,r){const l=this.#n.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#n,t,i,s,this.#i,this.#r,r),this.#t=null,this.#e=null,this.#n=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class vr extends et{#t;#e=0;#n;#i;#r;#a;#s;#l;#c;build(t,i,s,r,l,c,u){this.#r=i,this.#a=s,this.#s=r,this.#l=l,this.#c=c,this.#n=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${et.svgRound(i[4])} ${et.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${et.svgRound(i[10])} ${et.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[l,c,u,h,f,m]=i.subarray(s,s+6).map(et.svgRound);t.push(`C${l} ${c} ${u} ${h} ${f} ${m}`)}}return t.join("")}serialize([t,i,s,r],l){const c=[],u=[],[h,f,m,b]=this.#d();let y,A,x,S,E,w,M,T,L;switch(this.#l){case 0:L=et._rescale,y=t,A=i+r,x=s,S=-r,E=t+h*s,w=i+(1-f-b)*r,M=t+(h+m)*s,T=i+(1-f)*r;break;case 90:L=et._rescaleAndSwap,y=t,A=i,x=s,S=r,E=t+f*s,w=i+h*r,M=t+(f+b)*s,T=i+(h+m)*r;break;case 180:L=et._rescale,y=t+s,A=i,x=-s,S=r,E=t+(1-h-m)*s,w=i+f*r,M=t+(1-h)*s,T=i+(f+b)*r;break;case 270:L=et._rescaleAndSwap,y=t+s,A=i+r,x=-s,S=-r,E=t+(1-f-b)*s,w=i+(1-h-m)*r,M=t+(1-f)*s,T=i+(1-h)*r;break}for(const{line:O,points:k}of this.#i)c.push(L(O,y,A,x,S,l?new Array(O.length):null)),u.push(L(k,y,A,x,S,l?new Array(k.length):null));return{lines:c,points:u,rect:[E,w,M,T]}}static deserialize(t,i,s,r,l,{paths:{lines:c,points:u},rotation:h,thickness:f}){const m=[];let b,y,A,x,S;switch(h){case 0:S=et._rescale,b=-t/s,y=i/r+1,A=1/s,x=-1/r;break;case 90:S=et._rescaleAndSwap,b=-i/r,y=-t/s,A=1/r,x=1/s;break;case 180:S=et._rescale,b=t/s+1,y=-i/r,A=-1/s,x=1/r;break;case 270:S=et._rescaleAndSwap,b=i/r+1,y=t/s+1,A=-1/r,x=-1/s;break}if(!c){c=[];for(const w of u){const M=w.length;if(M===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(M===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const T=new Float32Array(3*(M-2));c.push(T);let[L,O,k,z]=w.subarray(0,4);T.set([NaN,NaN,NaN,NaN,L,O],0);for(let q=4;q<M;q+=2){const K=w[q],J=w[q+1];T.set(et.createBezierPoints(L,O,k,z,K,J),(q-2)*3),[L,O,k,z]=[k,z,K,J]}}}for(let w=0,M=c.length;w<M;w++)m.push({line:S(c[w].map(T=>T??NaN),b,y,A,x),points:S(u[w].map(T=>T??NaN),b,y,A,x)});const E=new this.prototype.constructor;return E.build(m,s,r,1,h,f,l),E}#o(t=this.#c){const i=this.#n+t/2*this.#s;return this.#l%180===0?[i/this.#r,i/this.#a]:[i/this.#a,i/this.#r]}#d(){const[t,i,s,r]=this.#t,[l,c]=this.#o(0);return[t+l,i+c,s-2*l,r-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let u=4,h=r.length;u<h;u+=6)nt.pointBoundingBox(r[u],r[u+1],t);continue}let l=r[4],c=r[5];for(let u=6,h=r.length;u<h;u+=6){const[f,m,b,y,A,x]=r.subarray(u,u+6);nt.bezierBoundingBox(l,c,f,m,b,y,A,x,t),l=A,c=x}}const[i,s]=this.#o();t[0]=Me(t[0]-i,0,1),t[1]=Me(t[1]-s,0,1),t[2]=Me(t[2]+i,0,1),t[3]=Me(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,s]=this.#o();this.#c=t;const[r,l]=this.#o(),[c,u]=[r-i,l-s],h=this.#t;return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateParentDimensions([t,i],s){const[r,l]=this.#o();this.#r=t,this.#a=i,this.#s=s;const[c,u]=this.#o(),h=c-r,f=u-l,m=this.#t;return m[0]-=h,m[1]-=f,m[2]+=2*h,m[3]+=2*f,m}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(et.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let s=0,r=0,l=0,c=0,u=0,h=0;switch(this.#e){case 90:r=i/t,l=-t/i,u=t;break;case 180:s=-1,c=-1,u=t,h=i;break;case 270:r=-i/t,l=t/i,h=i;break;default:return""}return`matrix(${s} ${r} ${l} ${c} ${et.svgRound(u)} ${et.svgRound(h)})`}getPathResizingSVGProperties([t,i,s,r]){const[l,c]=this.#o(),[u,h,f,m]=this.#t;if(Math.abs(f-l)<=et.PRECISION||Math.abs(m-c)<=et.PRECISION){const S=t+s/2-(u+f/2),E=i+r/2-(h+m/2);return{path:{"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`,transform:`${this.rotationTransform} translate(${S} ${E})`}}}const b=(s-2*l)/(f-2*l),y=(r-2*c)/(m-2*c),A=f/s,x=m/r;return{path:{"transform-origin":`${et.svgRound(u)} ${et.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${x}) translate(${et.svgRound(l)} ${et.svgRound(c)}) scale(${b} ${y}) translate(${et.svgRound(-l)} ${et.svgRound(-c)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[l,c]=this.#o(),u=this.#t,[h,f,m,b]=u;if(u[0]=t,u[1]=i,u[2]=s,u[3]=r,Math.abs(m-l)<=et.PRECISION||Math.abs(b-c)<=et.PRECISION){const E=t+s/2-(h+m/2),w=i+r/2-(f+b/2);for(const{line:M,points:T}of this.#i)et._translate(M,E,w,M),et._translate(T,E,w,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(s-2*l)/(m-2*l),A=(r-2*c)/(b-2*c),x=-y*(h+l)+t+l,S=-A*(f+c)+i+c;if(y!==1||A!==1||x!==0||S!==0)for(const{line:E,points:w}of this.#i)et._rescale(E,x,S,y,A,E),et._rescale(w,x,S,y,A,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,l]=s,c=this.#t,u=t-c[0],h=i-c[1];if(this.#r===r&&this.#a===l)for(const{line:f,points:m}of this.#i)et._translate(f,u,h,f),et._translate(m,u,h,m);else{const f=this.#r/r,m=this.#a/l;this.#r=r,this.#a=l;for(const{line:b,points:y}of this.#i)et._rescale(b,u,h,f,m,b),et._rescale(y,u,h,f,m,y);c[2]*=f,c[3]*=m}return c[0]=t,c[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${et.svgRound(t)} ${et.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${et.svgRound(t[0])} ${et.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class ao extends Jm{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:rt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new ao(this._viewParameters);return t.updateAll(this),t}}class bh extends Ot{static _type="ink";static _editorType=mt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){rt.initialize(t,i),this._defaultDrawingOptions=new ao(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return gt(this,"typesMap",new Map([[Ct.INK_THICKNESS,"stroke-width"],[Ct.INK_COLOR,"stroke"],[Ct.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,l){return new n1(t,i,s,r,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,l,c){return vr.deserialize(t,i,s,r,l,c)}static async deserialize(t,i,s){let r=null;if(t instanceof gh){const{data:{inkLists:c,rect:u,rotation:h,id:f,color:m,opacity:b,borderStyle:{rawWidth:y},popupRef:A,richText:x,contentsObj:S,creationDate:E,modificationDate:w},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:mt.INK,color:Array.from(m),thickness:y,opacity:b,paths:{points:c},boxes:null,pageIndex:M-1,rect:u.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:x,comment:S?.str||null,creationDate:E,modificationDate:w}}const l=await super.deserialize(t,i,s);return l._initialData=r,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new hr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ct.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=bh.getDefaultDrawingOptions({stroke:nt.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:rt._colorManager.convert(r),opacity:l,thickness:c,paths:{lines:i,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:s,opacity:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==i[u])||t.thickness!==s||t.opacity!==r||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class nh extends vr{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const ql=8,tr=3;class Vs{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,s,r){return s-=t,r-=i,s===0?r>0?0:4:s===1?r+6:2-r}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,s,r,l,c,u){const h=this.#e(s,r,l,c);for(let f=0;f<8;f++){const m=(-f+h-u+16)%8,b=this.#n[2*m],y=this.#n[2*m+1];if(t[(s+b)*i+(r+y)]!==0)return m}return-1}static#r(t,i,s,r,l,c,u){const h=this.#e(s,r,l,c);for(let f=0;f<8;f++){const m=(f+h+u+16)%8,b=this.#n[2*m],y=this.#n[2*m+1];if(t[(s+b)*i+(r+y)]!==0)return m}return-1}static#a(t,i,s,r){const l=t.length,c=new Int32Array(l);for(let m=0;m<l;m++)c[m]=t[m]<=r?1:0;for(let m=1;m<s-1;m++)c[m*i]=c[m*i+i-1]=0;for(let m=0;m<i;m++)c[m]=c[i*s-1-m]=0;let u=1,h;const f=[];for(let m=1;m<s-1;m++){h=1;for(let b=1;b<i-1;b++){const y=m*i+b,A=c[y];if(A===0)continue;let x=m,S=b;if(A===1&&c[y-1]===0)u+=1,S-=1;else if(A>=1&&c[y+1]===0)u+=1,S+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const E=[b,m],w=S===b+1,M={isHole:w,points:E,id:u,parent:0};f.push(M);let T;for(const W of f)if(W.id===h){T=W;break}T?T.isHole?M.parent=w?T.parent:h:M.parent=w?h:T.parent:M.parent=w?h:0;const L=this.#i(c,i,m,b,x,S,0);if(L===-1){c[y]=-u,c[y]!==1&&(h=Math.abs(c[y]));continue}let O=this.#n[2*L],k=this.#n[2*L+1];const z=m+O,q=b+k;x=z,S=q;let K=m,J=b;for(;;){const W=this.#r(c,i,K,J,x,S,1);O=this.#n[2*W],k=this.#n[2*W+1];const Z=K+O,ht=J+k;E.push(ht,Z);const vt=K*i+J;if(c[vt+1]===0?c[vt]=-u:c[vt]===1&&(c[vt]=u),Z===m&&ht===b&&K===z&&J===q){c[y]!==1&&(h=Math.abs(c[y]));break}else x=K,S=J,K=Z,J=ht}}}return f}static#s(t,i,s,r){if(s-i<=4){for(let z=i;z<s-2;z+=2)r.push(t[z],t[z+1]);return}const l=t[i],c=t[i+1],u=t[s-4]-l,h=t[s-3]-c,f=Math.hypot(u,h),m=u/f,b=h/f,y=m*c-b*l,A=h/u,x=1/f,S=Math.atan(A),E=Math.cos(S),w=Math.sin(S),M=x*(Math.abs(E)+Math.abs(w)),T=x*(1-M+M**2),L=Math.max(Math.atan(Math.abs(w+E)*T),Math.atan(Math.abs(w-E)*T));let O=0,k=i;for(let z=i+2;z<s-2;z+=2){const q=Math.abs(y-m*t[z+1]+b*t[z]);q>O&&(k=z,O=q)}O>(f*L)**2?(this.#s(t,i,k+2,r),this.#s(t,k,s,r)):r.push(l,c)}static#l(t){const i=[],s=t.length;return this.#s(t,0,s,i),i.push(t[s-2],t[s-1]),i.length<=4?null:i}static#c(t,i,s,r,l,c){const u=new Float32Array(c**2),h=-2*r**2,f=c>>1;for(let S=0;S<c;S++){const E=(S-f)**2;for(let w=0;w<c;w++)u[S*c+w]=Math.exp((E+(w-f)**2)/h)}const m=new Float32Array(256),b=-2*l**2;for(let S=0;S<256;S++)m[S]=Math.exp(S**2/b);const y=t.length,A=new Uint8Array(y),x=new Uint32Array(256);for(let S=0;S<s;S++)for(let E=0;E<i;E++){const w=S*i+E,M=t[w];let T=0,L=0;for(let k=0;k<c;k++){const z=S+k-f;if(!(z<0||z>=s))for(let q=0;q<c;q++){const K=E+q-f;if(K<0||K>=i)continue;const J=t[z*i+K],W=u[k*c+q]*m[Math.abs(J-M)];T+=J*W,L+=W}}const O=A[w]=Math.round(T/L);x[O]++}return[A,x]}static#o(t){const i=new Uint32Array(256);for(const s of t)i[s]++;return i}static#d(t){const i=t.length,s=new Uint8ClampedArray(i>>2);let r=-1/0,l=1/0;for(let u=0,h=s.length;u<h;u++){const f=s[u]=t[u<<2];r=Math.max(r,f),l=Math.min(l,f)}const c=255/(r-l);for(let u=0,h=s.length;u<h;u++)s[u]=(s[u]-l)*c;return s}static#h(t){let i,s=-1/0,r=-1/0;const l=t.findIndex(h=>h!==0);let c=l,u=l;for(i=l;i<256;i++){const h=t[i];h>s&&(i-c>r&&(r=i-c,u=i-1),s=h,c=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:s,height:r}=t,{maxDim:l}=this.#t;let c=s,u=r;if(s>l||r>l){let y=s,A=r,x=Math.log2(Math.max(s,r)/l);const S=Math.floor(x);x=x===S?S-1:S;for(let w=0;w<x;w++){c=Math.ceil(y/2),u=Math.ceil(A/2);const M=new OffscreenCanvas(c,u);M.getContext("2d").drawImage(t,0,0,y,A,0,0,c,u),y=c,A=u,t!==i&&t.close(),t=M.transferToImageBitmap()}const E=Math.min(l/c,l/u);c=Math.round(c*E),u=Math.round(u*E)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const m=f.getImageData(0,0,c,u).data;return[this.#d(m),c,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:s,fontWeight:r},l,c,u,h){let f=new OffscreenCanvas(1,1),m=f.getContext("2d",{alpha:!1});const b=200,y=m.font=`${s} ${r} ${b}px ${i}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:x,actualBoundingBoxAscent:S,actualBoundingBoxDescent:E,fontBoundingBoxAscent:w,fontBoundingBoxDescent:M,width:T}=m.measureText(t),L=1.5,O=Math.ceil(Math.max(Math.abs(A)+Math.abs(x)||0,T)*L),k=Math.ceil(Math.max(Math.abs(S)+Math.abs(E)||b,Math.abs(w)+Math.abs(M)||b)*L);f=new OffscreenCanvas(O,k),m=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),m.font=y,m.filter="grayscale(1)",m.fillStyle="white",m.fillRect(0,0,O,k),m.fillStyle="black",m.fillText(t,O*(L-1)/2,k*(3-L)/2);const z=this.#d(m.getImageData(0,0,O,k).data),q=this.#o(z),K=this.#h(q),J=this.#a(z,O,k,K);return this.processDrawnLines({lines:{curves:J,width:O,height:k},pageWidth:l,pageHeight:c,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,i,s,r,l){const[c,u,h]=this.#f(t),[f,m]=this.#c(c,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),b=this.#h(m),y=this.#a(f,u,h,b);return this.processDrawnLines({lines:{curves:y,width:u,height:h},pageWidth:i,pageHeight:s,rotation:r,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:l,mustSmooth:c,areContours:u}){r%180!==0&&([i,s]=[s,i]);const{curves:h,width:f,height:m}=t,b=t.thickness??0,y=[],A=Math.min(i/f,s/m),x=A/i,S=A/s,E=[];for(const{points:M}of h){const T=c?this.#l(M):M;if(!T)continue;E.push(T);const L=T.length,O=new Float32Array(L),k=new Float32Array(3*(L===2?2:L-2));if(y.push({line:k,points:O}),L===2){O[0]=T[0]*x,O[1]=T[1]*S,k.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[z,q,K,J]=T;z*=x,q*=S,K*=x,J*=S,O.set([z,q,K,J],0),k.set([NaN,NaN,NaN,NaN,z,q],0);for(let W=4;W<L;W+=2){const Z=O[W]=T[W]*x,ht=O[W+1]=T[W+1]*S;k.set(et.createBezierPoints(z,q,K,J,Z,ht),(W-2)*3),[z,q,K,J]=[K,J,Z,ht]}}if(y.length===0)return null;const w=u?new nh:new vr;return w.build(y,i,s,1,r,u?0:b,l),{outline:w,newCurves:E,areContours:u,thickness:b,width:f,height:m}}static async compressSignature({outlines:t,areContours:i,thickness:s,width:r,height:l}){let c=1/0,u=-1/0,h=0;for(const T of t){h+=T.length;for(let L=2,O=T.length;L<O;L++){const k=T[L]-T[L-2];c=Math.min(c,k),u=Math.max(u,k)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const m=t.length,b=ql+tr*m,y=new Uint32Array(b);let A=0;y[A++]=b*Uint32Array.BYTES_PER_ELEMENT+(h-2*m)*f.BYTES_PER_ELEMENT,y[A++]=0,y[A++]=r,y[A++]=l,y[A++]=i?0:1,y[A++]=Math.max(0,Math.floor(s??0)),y[A++]=m,y[A++]=f.BYTES_PER_ELEMENT;for(const T of t)y[A++]=T.length-2,y[A++]=T[0],y[A++]=T[1];const x=new CompressionStream("deflate-raw"),S=x.writable.getWriter();await S.ready,S.write(y);const E=f.prototype.constructor;for(const T of t){const L=new E(T.length-2);for(let O=2,k=T.length;O<k;O++)L[O-2]=T[O]-T[O-2];S.write(L)}S.close();const w=await new Response(x.readable).arrayBuffer(),M=new Uint8Array(w);return wm(M)}static async decompressSignature(t){try{const i=vv(t),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),l=r.getWriter();await l.ready,l.write(i).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const T of s)c||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),c.set(T,u),u+=T.length;const h=new Uint32Array(c.buffer,0,c.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const m=h[2],b=h[3],y=h[4]===0,A=h[5],x=h[6],S=h[7],E=[],w=(ql+tr*x)*Uint32Array.BYTES_PER_ELEMENT;let M;switch(S){case Int8Array.BYTES_PER_ELEMENT:M=new Int8Array(c.buffer,w);break;case Int16Array.BYTES_PER_ELEMENT:M=new Int16Array(c.buffer,w);break;case Int32Array.BYTES_PER_ELEMENT:M=new Int32Array(c.buffer,w);break}u=0;for(let T=0;T<x;T++){const L=h[tr*T+ql],O=new Float32Array(L+2);E.push(O);for(let k=0;k<tr-1;k++)O[k]=h[tr*T+ql+k+1];for(let k=0;k<L;k++)O[k+2]=O[k]+M[u++]}return{areContours:y,thickness:A,outlines:E,width:m,height:b}}catch(i){return pt(`decompressSignature: ${i}`),null}}}class yh extends Jm{constructor(){super(),super.updateProperties({fill:rt._defaultLineColor,"stroke-width":0})}clone(){const t=new yh;return t.updateAll(this),t}}class vh extends ao{constructor(t){super(t),super.updateProperties({stroke:rt._defaultLineColor,"stroke-width":1})}clone(){const t=new vh(this._viewParameters);return t.updateAll(this),t}}class wi extends Ot{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=mt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){rt.initialize(t,i),this._defaultDrawingOptions=new yh,this._defaultDrawnSignatureOptions=new vh(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return gt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:r,mustSmooth:l,areContours:c,description:u,uuid:h,heightInPage:f}=this.#n,{rawDims:{pageWidth:m,pageHeight:b},rotation:y}=this.parent.viewport,A=Vs.processDrawnLines({lines:r,pageWidth:m,pageHeight:b,rotation:y,innerMargin:wi._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(A,f,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:l}=this.#n,c=Math.max(r,l),u=Vs.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:s,width:r,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:l,y:c}=this,{outline:u}=this.#n=t;this.#t=u instanceof nh,this.description=s;let h;this.#t?h=wi.getDefaultDrawingOptions():(h=wi._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[,f]=this.pageDimensions;let m=i/f;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return Vs.process(t,i,s,r,wi._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:l}=this.parent.viewport;return Vs.extractContoursFromText(t,i,s,r,l,wi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return Vs.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:wi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=wi.getDefaultDrawingOptions():(this._drawingOptions=wi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:r});return this.addComment(l),t?(l.paths={lines:i,points:s},l.uuid=this.#i,l.isCopy=!0):l.lines=i,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,i,s,r,l,c){return c.areContours?nh.deserialize(t,i,s,r,l,c):vr.deserialize(t,i,s,r,l,c)}static async deserialize(t,i,s){const r=await super.deserialize(t,i,s);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#i=t.uuid,r}}class s1 extends rt{#t=null;#e=null;#n=null;#i=null;#r=null;#a="";#s=null;#l=!1;#c=null;#o=!1;#d=!1;static _type="stamp";static _editorType=mt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){rt.initialize(t,i)}static isHandlingMimeForPasting(t){return $u.includes(t)}static paste(t,i){i.pasteEditor({mode:mt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#o=t.isSvg),t.file&&(this.#a=t.file.name),this.#g()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:r,width:l,height:c,channels:r.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#h(r)).finally(()=>this.#f());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(r=>this.#h(r)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=$u.join(",");const i=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e||this.#l)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#l||(this.#t?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,r&&(this.#t=r),this.#l=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#g(){const{div:t}=this;let{width:i,height:s}=this.#t;const[r,l]=this.pageDimensions,c=.75;if(this.width)i=this.width*r,s=this.height*l;else if(i>c*r||s>c*l){const h=Math.min(c*r/i,c*l/s);i*=h,s*=h}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/r,this.height=s/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,s=!1){t||(t=224);const{width:r,height:l}=this.#t,c=new Ti;let u=this.#t,h=r,f=l,m=null;if(i){if(r>i||l>i){const k=Math.min(i/r,i/l);h=Math.floor(r*k),f=Math.floor(l*k)}m=document.createElement("canvas");const y=m.width=Math.ceil(h*c.sx),A=m.height=Math.ceil(f*c.sy);this.#o||(u=this.#u(y,A));const x=m.getContext("2d");x.filter=this._uiManager.hcmFilter;let S="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":Ev.isDarkMode&&(S="#8f8f9d",E="#42414d");const w=15,M=w*c.sx,T=w*c.sy,L=new OffscreenCanvas(M*2,T*2),O=L.getContext("2d");O.fillStyle=S,O.fillRect(0,0,M*2,T*2),O.fillStyle=E,O.fillRect(0,0,M,T),O.fillRect(M,T,M,T),x.fillStyle=x.createPattern(L,"repeat"),x.fillRect(0,0,y,A),x.drawImage(u,0,0,u.width,u.height,0,0,y,A)}let b=null;if(s){let y,A;if(c.symmetric&&u.width<t&&u.height<t)y=u.width,A=u.height;else if(u=this.#t,r>t||l>t){const E=Math.min(t/r,t/l);y=Math.floor(r*E),A=Math.floor(l*E),this.#o||(u=this.#u(y,A))}const S=new OffscreenCanvas(y,A).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,y,A),b={width:y,height:A,data:S.getImageData(0,0,y,A).data}}return{canvas:m,width:h,height:f,imageData:b}}#u(t,i){const{width:s,height:r}=this.#t;let l=s,c=r,u=this.#t;for(;l>2*t||c>2*i;){const h=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*i&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const m=new OffscreenCanvas(l,c);m.getContext("2d").drawImage(u,0,0,h,f,0,0,l,c),u=m.transferToImageBitmap()}return u}#p(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,l=new Ti,c=Math.ceil(s*t*l.sx),u=Math.ceil(r*i*l.sy),h=this.#s;if(!h||h.width===c&&h.height===u)return;h.width=c,h.height=u;const f=this.#o?this.#t:this.#u(c,u),m=h.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#b(t){if(t){if(this.#o){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#o){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*ta.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*ta.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,s){let r=null,l=!1;if(t instanceof Wm){const{data:{rect:S,rotation:E,id:w,structParent:M,popupRef:T,richText:L,contentsObj:O,creationDate:k,modificationDate:z},container:q,parent:{page:{pageNumber:K}},canvas:J}=t;let W,Z;J?(delete t.canvas,{id:W,bitmap:Z}=s.imageManager.getFromCanvas(q.id,J),J.remove()):(l=!0,t._hasNoCanvas=!0);const ht=(await i._structTree.getAriaAttributes(`${qs}${w}`))?.get("aria-label")||"";r=t={annotationType:mt.STAMP,bitmapId:W,bitmap:Z,pageIndex:K-1,rect:S.slice(0),rotation:E,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:ht},isSvg:!1,structParent:M,popupRef:T,richText:L,comment:O?.str||null,creationDate:k,modificationDate:z}}const c=await super.deserialize(t,i,s),{rect:u,bitmap:h,bitmapUrl:f,bitmapId:m,isSvg:b,accessibilityData:y}=t;l?(s.addMissingCanvas(t.id,c),c.#l=!0):m&&s.imageManager.isValidId(m)?(c.#e=m,h&&(c.#t=h)):c.#i=f,c.#o=b;const[A,x]=c.pageDimensions;return c.width=(u[2]-u[0])/A,c.height=(u[3]-u[1])/x,y&&(c.altTextData=y),c._initialData=r,t.comment&&c.setCommentData(t),c.#d=!!r,c}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#o});if(this.addComment(s),t)return s.bitmapUrl=this.#b(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:l}=this.serializeAltText(!1);if(!r&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||=new Map;const c=this.#o?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:c,serialized:s}),s.bitmap=this.#b(!1);else if(this.#o){const u=i.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#b(!1))}return s}#v(t){const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,l=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Xi{#t;#e=!1;#n=null;#i=null;#r=null;#a=new Map;#s=!1;#l=!1;#c=!1;#o=null;#d=null;#h=null;#f=null;#m=null;#g=-1;#u;static _initialized=!1;static#p=new Map([pe,bh,s1,ne,wi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:r,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:h,viewport:f,l10n:m}){const b=[...Xi.#p.values()];if(!Xi._initialized){Xi._initialized=!0;for(const y of b)y.initialize(m,t)}t.registerEditorTypes(b),this.#u=t,this.pageIndex=i,this.div=s,this.#t=l,this.#n=c,this.viewport=f,this.#h=h,this.drawLayer=u,this._structTree=r,this.#u.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===mt.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#S(),t){case mt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case mt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case mt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===mt.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const s of Xi.#p.values())i.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.togglePointerEvents(t)}get#b(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const s of this.#b)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const i=this.#n;if(i)for(const s of i.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#l=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const r=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:h,timeStamp:f}=l,m=this.#g;if(f-m>500){this.#g=f;return}this.#g=-1;const{classList:b}=this.div;b.toggle("getElements",!0);const y=document.elementsFromPoint(u,h);if(b.toggle("getElements",!1),!this.div.contains(y[0]))return;let A;const x=new RegExp(`^${lr}[0-9]+$`);for(const E of y)if(x.test(E.id)){A=E.id;break}if(!A)return;const S=this.#a.get(A);S?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),S.dblclick(l))},{signal:r,capture:!0})}const t=this.#n,i=[];if(t){const r=new Map,l=new Map;for(const u of this.#b){if(u.disableEditing(),!u.annotationElementId){i.push(u);continue}if(u.serialize()!==null){r.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:h}=u.data;if(this.#u.isDeletedAnnotationElement(h)){u.updateEdited({deleted:!0});continue}let f=l.get(h);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=r.get(h),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#S(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of Xi.#p.values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(i),this.#l=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:s}=_e.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ne.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#a.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#a.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#l&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),rt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getEditorByUID(t){for(const i of this.#a.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#y(){return Xi.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const i=this.#y;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:r}=this.#_(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:s,y:r,uiManager:this.#u,isCentered:!0,...i});c&&this.add(c)}async deserialize(t){return await Xi.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,s={}){const r=this.getNextId(),l=this.#E({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...s});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#_(){const{x:t,y:i,width:s,height:r}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,i),u=Math.min(window.innerWidth,t+s),h=Math.min(window.innerHeight,i+r),f=(l+u)/2-t,m=(c+h)/2-i,[b,y]=this.viewport.rotation%180===0?[f,m]:[m,f];return{offsetX:b,offsetY:y}}addNewEditor(t={}){this.createAndAddNewEditor(this.#_(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=_e.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#s||(this.#s=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===mt.STAMP||s===mt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===mt.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:i}=_e.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#s=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#o){this.#y.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#o=new AbortController;const i=this.#u.combinedSignal(this.#o);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#y.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#o?(this.#u.setCurrentDrawingSession(null),this.#o.abort(),this.#o=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,i,s){const r=this.#u.findParent(i,s);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#o?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#o&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#a.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#S(){for(const t of this.#a.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Jn(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#S();const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,Jn(this.div,{rotation:s}),i!==s)for(const r of this.#a.values())r.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class Se{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return gt(this,"_svgFactory",new Wl)}static#r(t,[i,s,r,l]){const{style:c}=t;c.top=`${100*s}%`,c.left=`${100*i}%`,c.width=`${100*r}%`,c.height=`${100*l}%`}#a(){const t=Se._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,i){const s=Se._svgFactory.createElement("clipPath");t.append(s);const r=`clip_${i}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const l=Se._svgFactory.createElement("use");return s.append(l),l.setAttribute("href",`#${i}`),l.classList.add("clip"),r}#l(t,i){for(const[s,r]of Object.entries(i))r===null?t.removeAttribute(s):t.setAttribute(s,r)}draw(t,i=!1,s=!1){const r=Se.#i++,l=this.#a(),c=Se._svgFactory.createElement("defs");l.append(c);const u=Se._svgFactory.createElement("path");c.append(u);const h=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#n.set(r,u);const f=s?this.#s(c,h):null,m=Se._svgFactory.createElement("use");return l.append(m),m.setAttribute("href",`#${h}`),this.updateProperties(l,t),this.#e.set(r,l),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,i){const s=Se.#i++,r=this.#a(),l=Se._svgFactory.createElement("defs");r.append(l);const c=Se._svgFactory.createElement("path");l.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let h;if(i){const b=Se._svgFactory.createElement("mask");l.append(b),h=`mask_p${this.pageIndex}_${s}`,b.setAttribute("id",h),b.setAttribute("maskUnits","objectBoundingBox");const y=Se._svgFactory.createElement("rect");b.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const A=Se._svgFactory.createElement("use");b.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=Se._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const m=f.cloneNode();return r.append(m),f.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(s,r),s}finalizeDraw(t,i){this.#n.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:s,bbox:r,rootClass:l,path:c}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#l(u,s),r&&Se.#r(u,r),l){const{classList:h}=u;for(const[f,m]of Object.entries(l))h.toggle(f,m)}if(c){const f=u.firstElementChild.firstElementChild;this.#l(f,c)}}}updateParent(t,i){if(i===this)return;const s=this.#e.get(t);s&&(i.#t.append(s),this.#e.delete(t),i.#e.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:eh};globalThis.pdfjsLib={AbortException:Tn,AnnotationEditorLayer:Xi,AnnotationEditorParamsType:Ct,AnnotationEditorType:mt,AnnotationEditorUIManager:Cn,AnnotationLayer:mh,AnnotationMode:xn,AnnotationType:ce,applyOpacity:Cv,build:kA,ColorPicker:ui,createValidAbsoluteUrl:Am,CSSConstants:Tv,DOMSVGFactory:Wl,DrawLayer:Se,FeatureTest:_e,fetchData:pr,findContrastColor:Mv,getDocument:Gm,getFilenameFromUrl:Av,getPdfFilenameFromUrl:Sv,getRGB:mr,getUuid:_m,getXfaPageViewport:_v,GlobalWorkerOptions:Zs,ImageKind:Yl,InvalidPDFException:Yu,isDataScheme:io,isPdfFile:rh,isValidExplicitDest:Fv,MathClamp:Me,noContextMenu:hi,normalizeUnicode:bv,OPS:or,OutputScale:Ti,PasswordResponses:ov,PDFDataRangeTransport:Vm,PDFDateString:Xu,PDFWorker:ur,PermissionFlag:lv,PixelsPerInch:ta,RenderingCancelledException:ah,renderRichText:Tm,ResponseException:Kl,setLayerDimensions:Jn,shadow:gt,SignatureExtractor:Vs,stopEvent:Jt,SupportedImageMimeTypes:$u,TextLayer:Te,TouchManager:no,updateUrlHash:Sm,Util:nt,VerbosityLevel:Jl,version:LA,XfaLayer:Em};Zs.workerSrc=new URL("/smsf-allocation-performance/assets/pdf.worker.min-CXgfMxHN.mjs",import.meta.url).toString();async function a1(p){try{let t;if(p instanceof File)t=await p.arrayBuffer();else if(p instanceof ArrayBuffer)t=p;else throw new Error("Input must be a File or ArrayBuffer");const i=await Gm({data:t}).promise,s=[];let r="";for(let l=1;l<=i.numPages;l++){const h=(await(await i.getPage(l)).getTextContent()).items.filter(A=>A.str&&A.str.trim()).map(A=>({text:A.str,x:A.transform[4],y:A.transform[5],width:A.width,height:A.height}));h.sort((A,x)=>{const S=x.y-A.y;return Math.abs(S)>5?S:A.x-x.x});const f=[];let m=[],b=null;for(const A of h)b!==null&&Math.abs(b-A.y)>5&&(m.length>0&&f.push(m.map(x=>x.text).join(" ")),m=[]),m.push(A),b=A.y;m.length>0&&f.push(m.map(A=>A.text).join(" "));const y=f.join(`
`);s.push({pageNumber:l,lines:f,rawText:y}),r+=y+`

`}return{pages:s,fullText:r.trim(),numPages:i.numPages}}catch(t){throw console.error("PDF extraction error:",t),new Error(`Failed to extract text from PDF: ${t.message}`)}}const hm={DEFENSIVE_MAX:30,GROWTH_MIN:70},r1=["Australian Equities","International Equities","Listed Property","Direct Property"],l1=["Australian Fixed Interest","International Fixed Interest","Cash","Foreign Cash","Mortgages"],dm={defensive:{name:"Conservative Benchmark",description:"Weighted average of defensive asset indices",composition:"70% Fixed Interest, 20% Cash, 10% Equities",returns:{oneYear:5.5,threeYears:4.2,fiveYears:3.8,sinceInception:4},riskLevel:"Low",volatility:3.5},balanced:{name:"Balanced Benchmark",description:"Diversified multi-asset benchmark",composition:"50% Equities, 30% Fixed Interest, 15% Property, 5% Cash",returns:{oneYear:8.5,threeYears:6.8,fiveYears:7.2,sinceInception:7},riskLevel:"Medium",volatility:8.5},growth:{name:"Growth Benchmark",description:"High equity exposure benchmark",composition:"80% Equities, 10% Property, 10% Other",returns:{oneYear:11.5,threeYears:9.2,fiveYears:10.5,sinceInception:9.8},riskLevel:"High",volatility:14}},En={STRONG_OUTPERFORMANCE:2,SLIGHT_OUTPERFORMANCE:.5,SLIGHT_UNDERPERFORMANCE:-.5,STRONG_UNDERPERFORMANCE:-2,EXCELLENT_RETURN:15,GOOD_RETURN:8,MODERATE_RETURN:4,POOR_RETURN:0},fm={ASSET_ALLOCATION:["investment allocation","asset allocation","allocation as at","current allocation","australian equities","international equities","fixed interest","listed property","cash"],PERFORMANCE:["investment movement","movement and returns","time weighted","time weighted return","twr","opening balance","closing balance","net return"]};function $s(p){if(!p)return null;const t=p.toString().trim(),i=new Date(t);return isNaN(i)?null:i.toISOString().split("T")[0]}function Ah(p){if(!p)return null;const t=p.toString().replace(/[\$,]/g,"").replace(/\((.*?)\)/,"-$1").trim(),i=parseFloat(t);return isNaN(i)?null:i}function er(p){if(!p)return null;const t=p.toString().replace("%","").trim(),i=parseFloat(t);return isNaN(i)?null:i}function o1(p,t){console.log("[PerformanceParser] Starting parse...");const i=t.flatMap(h=>h.lines),s=c1(p),r=u1(i),l=h1(i),c=d1(i),u={reportType:"performance",period:s,startingMarketValue:r.startingMarketValue,endingMarketValue:r.endingMarketValue,movementInValue:r.movementInValue,dollarReturnBeforeExpenses:l.totalBeforeExpenses,dollarReturnAfterExpenses:l.totalAfterExpenses,investmentExpenses:l.expenses,twr:c,details:{movementInValue:r,portfolioReturn:l}};return console.log("[PerformanceParser] Parsed result:",u),u}function c1(p){const t=/for\s+the\s+period\s+from\s+(\d{1,2}\s+\w+\s+\d{4})\s+to\s+(\d{1,2}\s+\w+\s+\d{4})/i,i=p.match(t);if(i)return{from:$s(i[1]),to:$s(i[2]),rawFrom:i[1],rawTo:i[2]};const s=/period\s+from\s+(\d{1,2}\/\d{1,2}\/\d{4})\s+to\s+(\d{1,2}\/\d{1,2}\/\d{4})/i,r=p.match(s);return r?{from:$s(r[1]),to:$s(r[2]),rawFrom:r[1],rawTo:r[2]}:(console.warn("[PerformanceParser] Could not extract period dates"),{from:null,to:null})}function u1(p){const t={startingMarketValue:null,netAddition:null,realisedGainsLosses:null,investmentIncome:null,other:null,endingMarketValue:null,movementInValue:null};let i=!1,s=[];for(const r of p){const l=r.toLowerCase();if(l.includes("movement in value")&&!l.includes("portfolio")){i=!0;continue}if(i&&(l.includes("portfolio value versus")||l.includes("portfolio return")))break;i&&s.push(r)}for(const r of s){const l=r.toLowerCase(),c=r.match(/([0-9,]+\.[0-9]{2}|\([0-9,]+\.[0-9]{2}\))\s*$/),u=c?Ah(c[1]):null;l.includes("starting market value")&&u!==null?t.startingMarketValue=u:(l.includes("net addition")||l.includes("net withdrawal"))&&u!==null?t.netAddition=u:l.includes("realised")&&l.includes("gains")&&u!==null?t.realisedGainsLosses=u:l.includes("investment income")&&u!==null?t.investmentIncome=u:l.includes("other")&&u!==null?t.other=u:l.includes("ending market value")&&u!==null?t.endingMarketValue=u:l.match(/^movement\s+in\s+value/)&&u!==null&&(t.movementInValue=u)}return t}function h1(p){const t={realisedGainsLosses:null,investmentIncome:null,credits:null,totalBeforeExpenses:null,expenses:null,totalAfterExpenses:null};let i=!1,s=[];for(const r of p){const l=r.toLowerCase();if(l.includes("portfolio return")&&!l.includes("investment return")){i=!0;continue}if(i&&(l.includes("return over time")||l.includes("1 year")||l.includes("investment return before expenses")))break;i&&s.push(r)}for(const r of s){const l=r.toLowerCase(),c=r.match(/([0-9,]+\.[0-9]{2}|\([0-9,]+\.[0-9]{2}\))\s*$/),u=c?Ah(c[1]):null;l.includes("realised")&&l.includes("gains")&&u!==null?t.realisedGainsLosses=u:l.includes("investment income")&&u!==null?t.investmentIncome=u:l.includes("credits")&&!l.includes("excluding")&&u!==null?t.credits=u:l.includes("total dollar return before expenses")&&u!==null?t.totalBeforeExpenses=u:l.includes("investment expenses")&&u!==null?t.expenses=u:l.includes("total dollar return after expenses")&&u!==null&&(t.totalAfterExpenses=u)}return t}function d1(p){const t={oneYear:null,threeYears:null,sinceStart:null,sincePeriodStart:null,sinceDates:[]};let i=null,s=null;for(let l=0;l<p.length;l++){const c=p[l],u=c.toLowerCase();if(u.includes("1 year")||u.includes("3 year")){i=c;continue}if(u.includes("investment return before expenses")&&u.includes("twr")){s=c;break}}if(!s)return console.warn("[PerformanceParser] Could not find TWR row"),t;const r=s.match(/(-?\d+\.?\d*%|-)/g);if(r&&r.length>0&&(t.oneYear=er(r[0]),r.length>1&&(t.threeYears=er(r[1])),r.length>2&&(t.sinceStart=er(r[2])),r.length>3&&(t.sincePeriodStart=er(r[3]))),i){const l=/since\s+(\d{2}\/\d{2}\/\d{4})/gi;let c,u=2;for(;(c=l.exec(i))!==null;)r&&r[u]&&t.sinceDates.push({date:$s(c[1]),rawDate:c[1],value:er(r[u])}),u++}return t}const pm=["Australian Equities","Australian Fixed Interest","Cash","International Equities","Listed Property","Other","Unknown"];function f1(p,t){console.log("[AssetAllocationParser] Parsing TOTAL allocation row");const i=m1(p),s=p1(t);if(!s)return console.warn("[AssetAllocationParser] TOTAL row not found"),{reportType:"asset_allocation",asAtDate:i,totalValue:null,assetClasses:[],holdings:[],holdingsCount:0};const r=g1(s),l=r.reduce((c,u)=>c+(u.value||0),0);return{reportType:"asset_allocation",asAtDate:i,totalValue:l,assetClasses:r,holdings:[],holdingsCount:0}}function p1(p){for(const t of p)for(const i of t.lines)if(i.toLowerCase().startsWith("total"))return i;return null}function g1(p){const t=p.match(/\$?[0-9,]+\.\d{2}/g)||[],i=p.match(/\d+\.?\d*%/g)||[],s=[];for(let r=0;r<pm.length;r++){const l=t[r]?Ah(t[r]):null,c=i[r]?Number(i[r].replace("%","")):null;(l!=null||c!=null)&&s.push({name:pm[r],value:l,percent:c,source:"total_row"})}return s}function m1(p){const t=[/as\s+at\s+(\d{1,2}\s+\w+\s+\d{4})/i,/as\s+at\s+(\d{1,2}\/\d{1,2}\/\d{4})/i];for(const i of t){const s=p.match(i);if(s)return $s(s[1])}return null}const t0={performance:{name:"Investment Movement and Returns Report",fingerprints:fm.PERFORMANCE,parser:o1,minMatchCount:1},asset_allocation:{name:"Investment Allocation Report",fingerprints:fm.ASSET_ALLOCATION,parser:f1,minMatchCount:1}};function e0(p){const t=p.toLowerCase();let i=null,s=0;for(const[r,l]of Object.entries(t0)){const c=l.fingerprints.filter(h=>t.includes(h.toLowerCase())).length,u=c/l.fingerprints.length*100;c>=l.minMatchCount&&u>s&&(s=u,i={type:r,confidence:u,name:l.name,matchCount:c,totalFingerprints:l.fingerprints.length})}return i}async function b1(p){const{fullText:t,pages:i}=p,s=e0(t);if(!s)throw new Error("Could not identify report type. Please ensure this is a supported CLASS Super report (Investment Allocation or Movement and Returns).");console.log(`[Registry] Identified report as: ${s.name} (${s.confidence.toFixed(1)}% confidence)`);const r=t0[s.type];if(!r||!r.parser)throw new Error(`No parser registered for report type: ${s.type}`);const l=await r.parser(t,i);return{reportType:s.type,reportName:s.name,confidence:s.confidence,data:l}}const ir=[{id:1,key:"asset_allocation",title:"Asset Allocation Report",description:"Upload the Investment Allocation PDF",expectedType:"asset_allocation"},{id:2,key:"performance",title:"Performance Report",description:"Upload the Investment Movement and Returns PDF",expectedType:"performance"}];function y1({onComplete:p,onPartialData:t}){const[i,s]=Zt.useState(1),[r,l]=Zt.useState({asset_allocation:"idle",performance:"idle"}),[c,u]=Zt.useState({asset_allocation:null,performance:null}),[h,f]=Zt.useState({asset_allocation:null,performance:null}),m=Zt.useCallback(async(A,x,S)=>{if(x){f(E=>({...E,[S]:x})),l(E=>({...E,[S]:"error"}));return}if(A){l(E=>({...E,[S]:"processing"})),f(E=>({...E,[S]:null}));try{console.log(`[UploadWizard] Extracting text from ${A.name}...`);const E=await a1(A);if(!E.fullText||E.fullText.length<100)throw new Error("Could not extract text from PDF. The file may be image-based or corrupted.");const w=e0(E.fullText);console.log(`[UploadWizard] Identified as: ${w?.type||"unknown"}`);const M=ir.find(O=>O.key===S);if(w?.type!==M.expectedType){const O=M.title,k=w?.name||"Unknown report type";throw new Error(`This appears to be a ${k}. Please upload a ${O} for this step.`)}const T=await b1(E);console.log(`[UploadWizard] Parsed ${S}:`,T);const L={...c,[S]:T.data};u(L),l(O=>({...O,[S]:"success"})),t&&t(S,T.data),i<ir.length&&setTimeout(()=>s(i+1),500),S==="performance"&&L.asset_allocation?p&&p(L):S==="asset_allocation"&&L.performance&&p&&p(L)}catch(E){console.error(`[UploadWizard] Error processing ${S}:`,E),f(w=>({...w,[S]:E.message})),l(w=>({...w,[S]:"error"}))}}},[i,c,p,t]),b=Zt.useCallback(A=>{u(x=>({...x,[A]:null})),l(x=>({...x,[A]:null})),f(x=>({...x,[A]:null}))},[]),y=c.asset_allocation&&c.performance;return r.asset_allocation!=="idle"||r.performance,R.jsx("div",{className:"w-full max-w-[1200px] mx-auto px-6",children:R.jsxs("div",{className:"rounded-2xl bg-gradient-to-b from-[#1a1f2e] to-[#141820] border border-[#2a3142] overflow-hidden",children:[R.jsx("div",{className:"px-8 pt-8 pb-6 border-b border-[#2a3142]/60",children:R.jsxs("div",{className:"flex items-start justify-between",children:[R.jsxs("div",{children:[R.jsx("p",{className:"text-[10px] font-medium text-slate-500 tracking-[0.2em] uppercase mb-2",children:"Fund Analytics Report"}),R.jsx("h1",{className:"text-xl font-semibold text-white tracking-tight",children:"Portfolio Document Intake"}),R.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Upload allocation and performance reports to generate analysis"})]}),R.jsx("div",{className:"flex items-center gap-2",children:ir.map((A,x)=>{const S=r[A.key],E=S==="success",w=i===A.id,M=S==="error";return R.jsxs(Dy.Fragment,{children:[R.jsxs("button",{onClick:()=>s(A.id),className:`
                        flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-medium transition-all
                        ${E?"bg-emerald-500/10 text-emerald-400 border border-emerald-500/30":M?"bg-red-500/10 text-red-400 border border-red-500/30":w?"bg-slate-700/50 text-white border border-slate-600":"bg-transparent text-slate-500 border border-transparent hover:border-slate-700"}
                      `,children:[R.jsx("span",{className:`
                        w-4 h-4 rounded-full flex items-center justify-center text-[10px] font-semibold
                        ${E?"bg-emerald-500/20":M?"bg-red-500/20":w?"bg-slate-600":"bg-slate-700/50"}
                      `,children:E?R.jsx("svg",{className:"w-2.5 h-2.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}):A.id}),R.jsx("span",{className:"hidden sm:inline",children:A.key==="asset_allocation"?"Allocation":"Performance"})]}),x<ir.length-1&&R.jsx("div",{className:`w-6 h-px ${r[A.key]==="success"?"bg-emerald-500/50":"bg-slate-700"}`})]},A.id)})})]})}),R.jsxs("div",{className:"p-6",children:[R.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:ir.map(A=>R.jsx(v1,{step:A,status:r[A.key],error:h[A.key],isActive:i===A.id,parsedData:c[A.key],onFileUpload:(x,S)=>m(x,S,A.key),onReset:()=>b(A.key)},A.key))}),y&&R.jsxs("div",{className:"mt-4 flex items-center justify-center gap-3 py-4 px-6 rounded-xl bg-emerald-500/5 border border-emerald-500/20",children:[R.jsx("div",{className:"w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center",children:R.jsx("svg",{className:"w-3 h-3 text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})}),R.jsxs("div",{children:[R.jsx("p",{className:"text-sm font-medium text-white",children:"Documents processed successfully"}),R.jsx("p",{className:"text-xs text-slate-500",children:"Analysis ready  Scroll down to view results"})]})]})]}),R.jsxs("div",{className:"px-8 py-4 border-t border-[#2a3142]/40 flex items-center justify-between",children:[R.jsx("p",{className:"text-[10px] text-slate-600",children:"Documents processed locally  Not stored externally"}),R.jsx("p",{className:"text-[10px] text-slate-600",children:"Supported format: PDF"})]})]})})}function v1({step:p,status:t,error:i,isActive:s,parsedData:r,onFileUpload:l,onReset:c}){const u=t==="success",h=t==="error";return R.jsxs("div",{className:`
      rounded-xl border transition-all duration-200 overflow-hidden
      ${u?"bg-[#1a2420] border-emerald-500/20":h?"bg-[#241a1a] border-red-500/20":s?"bg-[#1e2330] border-slate-600/50":"bg-[#161a24] border-[#2a3142]/50"}
    `,children:[R.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[#2a3142]/30",children:[R.jsxs("div",{className:"flex items-center gap-3",children:[R.jsx("div",{className:`
            w-7 h-7 rounded-lg flex items-center justify-center
            ${u?"bg-emerald-500/15":h?"bg-red-500/15":"bg-slate-700/40"}
          `,children:p.key==="asset_allocation"?R.jsxs("svg",{className:`w-3.5 h-3.5 ${u?"text-emerald-400":h?"text-red-400":"text-slate-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}):R.jsx("svg",{className:`w-3.5 h-3.5 ${u?"text-emerald-400":h?"text-red-400":"text-slate-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),R.jsxs("div",{children:[R.jsxs("p",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wider",children:["Step ",p.id]}),R.jsx("h3",{className:"text-sm font-medium text-white",children:p.title})]})]}),u&&R.jsx("button",{onClick:c,className:"p-1.5 text-slate-500 hover:text-slate-300 hover:bg-slate-700/30 rounded transition-colors",title:"Replace file",children:R.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:R.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),R.jsxs("div",{className:"p-4",children:[R.jsx(rv,{onFileSelect:l,status:t,label:null,description:"PDF files only",errorMessage:i,acceptedFileName:u?`${p.title} loaded`:null}),u&&r&&R.jsx(A1,{type:p.key,data:r})]})]})}function A1({type:p,data:t}){const i=r=>r==null?"":new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),s=({label:r,value:l,accent:c})=>R.jsxs("div",{children:[R.jsx("p",{className:"text-[9px] text-slate-500 uppercase tracking-wider",children:r}),R.jsx("p",{className:`text-xs font-medium tabular-nums mt-0.5 ${c?"text-emerald-400":"text-white"}`,children:l})]});return p==="asset_allocation"&&t?R.jsxs("div",{className:"mt-3 pt-3 border-t border-[#2a3142]/30",children:[R.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[R.jsx("div",{className:"w-1 h-1 rounded-full bg-emerald-400"}),R.jsx("span",{className:"text-[10px] font-medium text-slate-400",children:"Extracted"})]}),R.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[R.jsx(s,{label:"Asset Classes",value:t.assetClasses?.length||0}),R.jsx(s,{label:"Holdings",value:t.holdings?.length||0}),R.jsx(s,{label:"Total Value",value:i(t.totalValue),accent:!0}),R.jsx(s,{label:"Report Date",value:t.asAtDate||""})]})]}):p==="performance"&&t?R.jsxs("div",{className:"mt-3 pt-3 border-t border-[#2a3142]/30",children:[R.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[R.jsx("div",{className:"w-1 h-1 rounded-full bg-emerald-400"}),R.jsx("span",{className:"text-[10px] font-medium text-slate-400",children:"Extracted"})]}),R.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2",children:[R.jsx(s,{label:"1Y TWR",value:t.twr?.oneYear!=null?`${t.twr.oneYear}%`:"",accent:!0}),R.jsx(s,{label:"Ending Value",value:i(t.endingMarketValue)}),R.jsx(s,{label:"Net Return",value:i(t.dollarReturnAfterExpenses)}),R.jsx(s,{label:"Period",value:t.period?.to||""})]})]}):null}function _n(p){const t=typeof p=="number"?p:Number(p);return Number.isFinite(t)?t:0}function Iu(p){return Number.isFinite(p)?p:0}function Hu(p){return Math.round(p*10)/10}function i0(p=[]){if(!Array.isArray(p)||p.length===0)return{classification:"unknown",growthPercent:0,defensivePercent:0,otherPercent:0};const t=p.reduce((h,f)=>h+_n(f?.value),0);if(t<=0)return{classification:"unknown",growthPercent:0,defensivePercent:0,otherPercent:0};const i=p.filter(h=>r1.includes(h?.name)).reduce((h,f)=>h+_n(f?.value),0),s=p.filter(h=>l1.includes(h?.name)).reduce((h,f)=>h+_n(f?.value),0),r=i/t*100,l=s/t*100,c=Math.max(0,100-r-l);let u="balanced";return r<hm.DEFENSIVE_MAX?u="defensive":r>hm.GROWTH_MIN&&(u="growth"),{classification:u,growthPercent:Hu(Iu(r)),defensivePercent:Hu(Iu(l)),otherPercent:Hu(Iu(c))}}function S1(p){return dm[typeof p=="string"?p:"balanced"]??dm.balanced}function x1(p,t){const i={oneYear:null,threeYears:null,sinceInception:null};if(!p||!t?.returns)return i;const s=p.oneYear,r=p.threeYears,l=p.sinceStart;if(s!=null&&t.returns.oneYear!==void 0){const c=s-t.returns.oneYear;i.oneYear={fundReturn:s,benchmarkReturn:t.returns.oneYear,difference:c,status:Gu(c)}}if(r!=null&&t.returns.threeYears!==void 0){const c=r-t.returns.threeYears;i.threeYears={fundReturn:r,benchmarkReturn:t.returns.threeYears,difference:c,status:Gu(c)}}if(l!=null&&t.returns.sinceInception!==void 0){const c=l-t.returns.sinceInception;i.sinceInception={fundReturn:l,benchmarkReturn:t.returns.sinceInception,difference:c,status:Gu(c)}}return i}function Gu(p){return p>=En.STRONG_OUTPERFORMANCE?"strong_outperformance":p>=En.SLIGHT_OUTPERFORMANCE?"slight_outperformance":p>=En.SLIGHT_UNDERPERFORMANCE?"inline":p>=En.STRONG_UNDERPERFORMANCE?"slight_underperformance":"strong_underperformance"}function _1(p,t){const i=!!p&&Array.isArray(p.assetClasses)&&p.assetClasses.length>0,s=!!t&&!!t.twr,r=i?i0(p.assetClasses):{classification:"unknown",growthPercent:0,defensivePercent:0,otherPercent:0},l=S1(r.classification),c=s?{oneYear:t.twr.oneYear??null,threeYears:t.twr.threeYears??null,sinceStart:t.twr.sinceStart??null}:null,u=c?x1(c,l):null,h=w1(t,u),f=E1(p,t,r,u,{hasAllocation:i});return{classification:r,benchmark:{name:l.name,description:l.description,composition:l.composition,riskLevel:l.riskLevel},benchmarkComparison:u,performanceScore:h,insights:f,status:i&&s?"complete":"partial",message:i&&s?null:"Upload both reports for complete analysis. Cannot classify fund without asset allocation data."}}function w1(p,t){if(!p||!t)return null;let i=50;if(t.oneYear){const r=t.oneYear.difference;i+=Math.min(Math.max(r*5,-25),25)}const s=p.twr?.oneYear;return s!=null&&(s>=En.EXCELLENT_RETURN?i+=15:s>=En.GOOD_RETURN?i+=10:s>=En.MODERATE_RETURN?i+=5:s<En.POOR_RETURN&&(i-=10)),Math.min(Math.max(Math.round(i),0),100)}function E1(p,t,i,s,r){const l=[];if(r?.hasAllocation||l.push({type:"data",title:"Asset Allocation Missing",description:"Asset allocation data was not detected. Please upload the Investment Allocation report to enable classification and allocation insights.",importance:"high"}),i?.classification&&i.classification!=="unknown"){const u=i.classification.charAt(0).toUpperCase()+i.classification.slice(1),h=typeof i.growthPercent=="number"&&Number.isFinite(i.growthPercent)?`${i.growthPercent.toFixed(1)}%`:"N/A";l.push({type:"classification",title:`${u} Investment Profile`,description:`With ${h} in growth assets, this fund follows a ${i.classification} strategy.`,importance:"high"})}if(s?.oneYear){const u=s.oneYear.difference,h=s.oneYear.status;let f;h.includes("outperformance")?f=`The fund outperformed its benchmark by ${Math.abs(u).toFixed(2)}% over the past year.`:h==="inline"?f="The fund performed in line with its benchmark over the past year.":f=`The fund underperformed its benchmark by ${Math.abs(u).toFixed(2)}% over the past year.`,l.push({type:"performance",title:"Benchmark Comparison",description:f,importance:h.includes("strong")?"high":"medium"})}if(p?.holdings&&Array.isArray(p.holdings)){const u=[...p.holdings].sort((h,f)=>_n(f?.value)-_n(h?.value)).slice(0,5);if(u.length>0&&_n(p.totalValue)>0){const f=u.reduce((m,b)=>m+_n(b?.value),0)/_n(p.totalValue)*100;f>40&&l.push({type:"concentration",title:"Portfolio Concentration",description:`The top 5 holdings represent ${f.toFixed(1)}% of the portfolio. Consider reviewing diversification.`,importance:"medium"})}}const c=t?.dollarReturnAfterExpenses??t?.dollarReturn??null;if(c!=null){const u=c>0;l.push({type:"return",title:"Total Dollar Return",description:`The fund ${u?"gained":"lost"} $${Math.abs(c).toLocaleString()} during the reporting period.`,importance:"high"})}return l}function T1(p){const t={defensive:{bgColor:"bg-green-100",textColor:"text-green-800",borderColor:"border-green-200",icon:""},balanced:{bgColor:"bg-amber-100",textColor:"text-amber-800",borderColor:"border-amber-200",icon:""},growth:{bgColor:"bg-red-100",textColor:"text-red-800",borderColor:"border-red-200",icon:""},unknown:{bgColor:"bg-gray-100",textColor:"text-gray-800",borderColor:"border-gray-200",icon:""}};return t[p]||t.unknown}function gm(p,{assetAllocation:t,performance:i}){const s=_1(t,i),r=R1(i?.twr);return{fundId:p,lastUpdated:new Date().toISOString(),assetAllocation:t?{asAtDate:t.asAtDate,totalValue:t.totalValue,assetClasses:C1(t.assetClasses,t.totalValue),holdings:t.holdings||[],holdingsCount:t.holdingsCount||t.holdings?.length||0}:null,performance:i?{period:M1(i.period),startingValue:i.startingMarketValue??i.startingValue??null,endingValue:i.endingMarketValue??i.endingValue??null,dollarReturn:i.dollarReturnAfterExpenses??i.dollarReturn??null,twr:r}:null,classification:{classification:s.classification?.classification||"unknown",growthPercent:s.classification?.growthPercent??0,defensivePercent:s.classification?.defensivePercent??0,otherPercent:s.classification?.otherPercent??0},benchmark:s.benchmark?{name:s.benchmark.name||"Benchmark",description:s.benchmark.description||"",composition:s.benchmark.composition||null,riskLevel:s.benchmark.riskLevel||null}:null,benchmarkComparison:s.benchmarkComparison||null,performanceScore:s.performanceScore,derivedInsights:s.insights||[],analysisStatus:s.status||"unknown",analysisMessage:s.message||null}}function C1(p,t){return!Array.isArray(p)||p.length===0?[]:p.map(i=>{const s=i.value??0;let r=i.percent;return r==null&&t>0&&(r=s/t*100),{name:i.name||"Unknown",value:s,percent:r??0,source:i.source||"parsed"}})}function M1(p){return p?{start:p.start||p.startDate||null,end:p.end||p.endDate||null}:{start:null,end:null}}function R1(p){return p?{oneYear:p.oneYear??p["1year"]??p["1Year"]??null,threeYears:p.threeYears??p["3years"]??p["3Years"]??null,fiveYears:p.fiveYears??p["5years"]??p["5Years"]??null,sinceStart:p.sinceStart??p.sinceInception??p.inception??null}:null}function mm(p){const t=Date.now(),i=D1(JSON.stringify(p));return`FUND-${t}-${i}`}function D1(p){let t=0;for(let i=0;i<p.length;i++){const s=p.charCodeAt(i);t=(t<<5)-t+s,t=t&t}return Math.abs(t).toString(16).substring(0,8)}function bm(p){const t=[],i=[];return!p.assetAllocation&&!p.performance&&t.push("Fund must have at least one report type parsed"),(!p.classification||p.classification.classification==="unknown")&&(p.assetAllocation?i.push("Fund classification could not be determined"):i.push("Cannot classify fund without asset allocation data")),p.performance&&!p.benchmarkComparison&&i.push("Benchmark comparison not available"),p.assetAllocation&&((!p.assetAllocation.totalValue||p.assetAllocation.totalValue<=0)&&i.push("Total portfolio value is missing or zero"),(!p.assetAllocation.assetClasses||p.assetAllocation.assetClasses.length===0)&&i.push("Asset class breakdown is missing")),p.performance&&(p.performance.dollarReturn===null&&i.push("Dollar return figure is missing"),(!p.performance.twr||p.performance.twr.oneYear===null)&&i.push("1-year TWR is missing")),{valid:t.length===0,errors:t,warnings:i,hasAssetAllocation:!!p.assetAllocation,hasPerformance:!!p.performance,isComplete:!!p.assetAllocation&&!!p.performance}}function N1(p=[]){return i0(p)}function O1(){const[p,t]=Zt.useState(null),[i,s]=Zt.useState(null),[r,l]=Zt.useState(!1),[c,u]=Zt.useState(!1),[h,f]=Zt.useState(!1),m=Zt.useCallback(x=>{const S=mm(x),E=gm(S,{assetAllocation:x.asset_allocation,performance:x.performance});E.assetAllocation?.assetClasses?.length&&(E.classification=N1(E.assetAllocation.assetClasses));const w=bm(E);t(E),s(w),w.isComplete&&(l(!0),f(!0))},[]),b=Zt.useCallback((x,S)=>{console.log(`[App] Partial data received: ${x}`);const E=mm({[x]:S}),w=gm(E,{assetAllocation:x==="asset_allocation"?S:null,performance:x==="performance"?S:null}),M=bm(w);t(w),s(M)},[]),y=Zt.useCallback(()=>{t(null),s(null),l(!1),u(!1)},[]),A=Zt.useCallback(()=>{if(!p)return;const x=JSON.stringify(p,null,2),S=new Blob([x],{type:"application/json"}),E=URL.createObjectURL(S),w=document.createElement("a");w.href=E,w.download=`fund-analysis-${p.fundId}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(E)},[p]);return p&&T1(p.classification?.classification),h&&p&&i?.isComplete?R.jsx(Gy,{fund:p,onReset:()=>{f(!1),t(null),s(null),l(!1),u(!1)}}):R.jsxs("div",{className:"min-h-screen bg-gray-50",children:[R.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-50",children:R.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4",children:R.jsxs("div",{className:"flex items-center justify-between",children:[R.jsxs("div",{className:"flex items-center gap-3",children:[R.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:R.jsx(Fg,{className:"w-6 h-6 text-blue-600"})}),R.jsxs("div",{children:[R.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"SMSF Intelligence Platform"}),R.jsx("p",{className:"text-sm text-gray-500",children:"PDF Report Analysis"})]})]}),R.jsxs("div",{className:"flex items-center gap-2",children:[p&&R.jsxs(R.Fragment,{children:[R.jsx("button",{onClick:()=>u(!c),className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:c?"Hide JSON":"View JSON"}),R.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[R.jsx(iv,{className:"w-4 h-4"}),"Export"]})]}),R.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-3 py-2 text-sm text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:[R.jsx(av,{className:"w-4 h-4"}),"New Analysis"]})]})]})})}),R.jsxs("main",{className:"max-w-6xl mx-auto px-4 py-8",children:[R.jsx("section",{className:"mb-8 transition-all duration-300 ",children:R.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[R.jsxs("button",{onClick:()=>l(!r),className:"w-full px-6 py-4 flex items-center justify-between bg-gray-50 border-b border-gray-200 hover:bg-gray-100 transition-colors",children:[R.jsxs("div",{className:"flex items-center gap-3",children:[R.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Upload Reports"}),i?.isComplete&&R.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"Complete"})]}),r?R.jsx(Zy,{className:"w-5 h-5 text-gray-500"}):R.jsx(tv,{className:"w-5 h-5 text-gray-500"})]}),!r&&R.jsx("div",{className:"p-6",children:R.jsx(y1,{onComplete:m,onPartialData:b})})]})}),!p&&R.jsxs("div",{className:"text-center py-12 text-gray-500",children:[R.jsx(Fg,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),R.jsx("p",{className:"text-lg",children:"Upload your SMSF reports to begin analysis"}),R.jsx("p",{className:"text-sm mt-2",children:"Start with the Asset Allocation report, then upload the Performance report"})]})]}),R.jsx("footer",{className:"border-t border-gray-200 bg-white mt-12",children:R.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6",children:R.jsx("p",{className:"text-center text-sm text-gray-500",children:"SMSF Intelligence Platform  Local PDF Processing  No Cloud Services"})})})]})}zy.createRoot(document.getElementById("root")).render(R.jsx(Zt.StrictMode,{children:R.jsx(O1,{})}));
